function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
var kx=(t,r,o)=>{if(!r.has(t))throw TypeError("Cannot "+o)};var Se=(t,r,o)=>(kx(t,r,"read from private field"),o?o.call(t):r.get(t)),wt=(t,r,o)=>{if(r.has(t))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(t):r.set(t,o)},pt=(t,r,o,c)=>(kx(t,r,"write to private field"),c?c.call(t,o):r.set(t,o),o);var nC=(t,r,o,c)=>({set _(d){pt(t,r,d,o)},get _(){return Se(t,r,c)}}),bn=(t,r,o)=>(kx(t,r,"access private method"),o);function nle(t,r){for(var o=0;o<r.length;o++){const c=r[o];if(typeof c!="string"&&!Array.isArray(c)){for(const d in c)if(d!=="default"&&!(d in t)){const h=Object.getOwnPropertyDescriptor(c,d);h&&Object.defineProperty(t,d,h.get?h:{enumerable:!0,get:()=>c[d]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&c(f)}).observe(document,{childList:!0,subtree:!0});function o(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function c(d){if(d.ep)return;d.ep=!0;const h=o(d);fetch(d.href,h)}})();var nt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Vd(t){if(t.__esModule)return t;var r=t.default;if(typeof r=="function"){var o=function c(){return this instanceof c?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};o.prototype=r.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(t).forEach(function(c){var d=Object.getOwnPropertyDescriptor(t,c);Object.defineProperty(o,c,d.get?d:{enumerable:!0,get:function(){return t[c]}})}),o}var QH={exports:{}},fR={},ZH={exports:{}},Ln={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s0=Symbol.for("react.element"),rle=Symbol.for("react.portal"),ile=Symbol.for("react.fragment"),sle=Symbol.for("react.strict_mode"),ole=Symbol.for("react.profiler"),ale=Symbol.for("react.provider"),cle=Symbol.for("react.context"),lle=Symbol.for("react.forward_ref"),dle=Symbol.for("react.suspense"),ule=Symbol.for("react.memo"),hle=Symbol.for("react.lazy"),TW=Symbol.iterator;function ple(t){return t===null||typeof t!="object"?null:(t=TW&&t[TW]||t["@@iterator"],typeof t=="function"?t:null)}var e7={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},t7=Object.assign,n7={};function qg(t,r,o){this.props=t,this.context=r,this.refs=n7,this.updater=o||e7}qg.prototype.isReactComponent={};qg.prototype.setState=function(t,r){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,r,"setState")};qg.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function r7(){}r7.prototype=qg.prototype;function a2(t,r,o){this.props=t,this.context=r,this.refs=n7,this.updater=o||e7}var c2=a2.prototype=new r7;c2.constructor=a2;t7(c2,qg.prototype);c2.isPureReactComponent=!0;var CW=Array.isArray,i7=Object.prototype.hasOwnProperty,l2={current:null},s7={key:!0,ref:!0,__self:!0,__source:!0};function o7(t,r,o){var c,d={},h=null,f=null;if(r!=null)for(c in r.ref!==void 0&&(f=r.ref),r.key!==void 0&&(h=""+r.key),r)i7.call(r,c)&&!s7.hasOwnProperty(c)&&(d[c]=r[c]);var _=arguments.length-2;if(_===1)d.children=o;else if(1<_){for(var v=Array(_),b=0;b<_;b++)v[b]=arguments[b+2];d.children=v}if(t&&t.defaultProps)for(c in _=t.defaultProps,_)d[c]===void 0&&(d[c]=_[c]);return{$$typeof:s0,type:t,key:h,ref:f,props:d,_owner:l2.current}}function fle(t,r){return{$$typeof:s0,type:t.type,key:r,ref:t.ref,props:t.props,_owner:t._owner}}function d2(t){return typeof t=="object"&&t!==null&&t.$$typeof===s0}function mle(t){var r={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(o){return r[o]})}var wW=/\/+/g;function xx(t,r){return typeof t=="object"&&t!==null&&t.key!=null?mle(""+t.key):r.toString(36)}function $C(t,r,o,c,d){var h=typeof t;(h==="undefined"||h==="boolean")&&(t=null);var f=!1;if(t===null)f=!0;else switch(h){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case s0:case rle:f=!0}}if(f)return f=t,d=d(f),t=c===""?"."+xx(f,0):c,CW(d)?(o="",t!=null&&(o=t.replace(wW,"$&/")+"/"),$C(d,r,o,"",function(b){return b})):d!=null&&(d2(d)&&(d=fle(d,o+(!d.key||f&&f.key===d.key?"":(""+d.key).replace(wW,"$&/")+"/")+t)),r.push(d)),1;if(f=0,c=c===""?".":c+":",CW(t))for(var _=0;_<t.length;_++){h=t[_];var v=c+xx(h,_);f+=$C(h,r,o,v,d)}else if(v=ple(t),typeof v=="function")for(t=v.call(t),_=0;!(h=t.next()).done;)h=h.value,v=c+xx(h,_++),f+=$C(h,r,o,v,d);else if(h==="object")throw r=String(t),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return f}function rC(t,r,o){if(t==null)return t;var c=[],d=0;return $C(t,c,"","",function(h){return r.call(o,h,d++)}),c}function gle(t){if(t._status===-1){var r=t._result;r=r(),r.then(function(o){(t._status===0||t._status===-1)&&(t._status=1,t._result=o)},function(o){(t._status===0||t._status===-1)&&(t._status=2,t._result=o)}),t._status===-1&&(t._status=0,t._result=r)}if(t._status===1)return t._result.default;throw t._result}var po={current:null},GC={transition:null},_le={ReactCurrentDispatcher:po,ReactCurrentBatchConfig:GC,ReactCurrentOwner:l2};Ln.Children={map:rC,forEach:function(t,r,o){rC(t,function(){r.apply(this,arguments)},o)},count:function(t){var r=0;return rC(t,function(){r++}),r},toArray:function(t){return rC(t,function(r){return r})||[]},only:function(t){if(!d2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ln.Component=qg;Ln.Fragment=ile;Ln.Profiler=ole;Ln.PureComponent=a2;Ln.StrictMode=sle;Ln.Suspense=dle;Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_le;Ln.cloneElement=function(t,r,o){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var c=t7({},t.props),d=t.key,h=t.ref,f=t._owner;if(r!=null){if(r.ref!==void 0&&(h=r.ref,f=l2.current),r.key!==void 0&&(d=""+r.key),t.type&&t.type.defaultProps)var _=t.type.defaultProps;for(v in r)i7.call(r,v)&&!s7.hasOwnProperty(v)&&(c[v]=r[v]===void 0&&_!==void 0?_[v]:r[v])}var v=arguments.length-2;if(v===1)c.children=o;else if(1<v){_=Array(v);for(var b=0;b<v;b++)_[b]=arguments[b+2];c.children=_}return{$$typeof:s0,type:t.type,key:d,ref:h,props:c,_owner:f}};Ln.createContext=function(t){return t={$$typeof:cle,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ale,_context:t},t.Consumer=t};Ln.createElement=o7;Ln.createFactory=function(t){var r=o7.bind(null,t);return r.type=t,r};Ln.createRef=function(){return{current:null}};Ln.forwardRef=function(t){return{$$typeof:lle,render:t}};Ln.isValidElement=d2;Ln.lazy=function(t){return{$$typeof:hle,_payload:{_status:-1,_result:t},_init:gle}};Ln.memo=function(t,r){return{$$typeof:ule,type:t,compare:r===void 0?null:r}};Ln.startTransition=function(t){var r=GC.transition;GC.transition={};try{t()}finally{GC.transition=r}};Ln.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ln.useCallback=function(t,r){return po.current.useCallback(t,r)};Ln.useContext=function(t){return po.current.useContext(t)};Ln.useDebugValue=function(){};Ln.useDeferredValue=function(t){return po.current.useDeferredValue(t)};Ln.useEffect=function(t,r){return po.current.useEffect(t,r)};Ln.useId=function(){return po.current.useId()};Ln.useImperativeHandle=function(t,r,o){return po.current.useImperativeHandle(t,r,o)};Ln.useInsertionEffect=function(t,r){return po.current.useInsertionEffect(t,r)};Ln.useLayoutEffect=function(t,r){return po.current.useLayoutEffect(t,r)};Ln.useMemo=function(t,r){return po.current.useMemo(t,r)};Ln.useReducer=function(t,r,o){return po.current.useReducer(t,r,o)};Ln.useRef=function(t){return po.current.useRef(t)};Ln.useState=function(t){return po.current.useState(t)};Ln.useSyncExternalStore=function(t,r,o){return po.current.useSyncExternalStore(t,r,o)};Ln.useTransition=function(){return po.current.useTransition()};Ln.version="18.2.0";ZH.exports=Ln;var K=ZH.exports;const gt=Yg(K),pw=nle({__proto__:null,default:gt},[K]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ele=K,vle=Symbol.for("react.element"),yle=Symbol.for("react.fragment"),Sle=Object.prototype.hasOwnProperty,ble=Ele.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Tle={key:!0,ref:!0,__self:!0,__source:!0};function a7(t,r,o){var c,d={},h=null,f=null;o!==void 0&&(h=""+o),r.key!==void 0&&(h=""+r.key),r.ref!==void 0&&(f=r.ref);for(c in r)Sle.call(r,c)&&!Tle.hasOwnProperty(c)&&(d[c]=r[c]);if(t&&t.defaultProps)for(c in r=t.defaultProps,r)d[c]===void 0&&(d[c]=r[c]);return{$$typeof:vle,type:t,key:h,ref:f,props:d,_owner:ble.current}}fR.Fragment=yle;fR.jsx=a7;fR.jsxs=a7;QH.exports=fR;var T=QH.exports,ZP={},c7={exports:{}},ma={},l7={exports:{}},d7={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function r(Ce,Fe){var Ye=Ce.length;Ce.push(Fe);e:for(;0<Ye;){var Mt=Ye-1>>>1,yt=Ce[Mt];if(0<d(yt,Fe))Ce[Mt]=Fe,Ce[Ye]=yt,Ye=Mt;else break e}}function o(Ce){return Ce.length===0?null:Ce[0]}function c(Ce){if(Ce.length===0)return null;var Fe=Ce[0],Ye=Ce.pop();if(Ye!==Fe){Ce[0]=Ye;e:for(var Mt=0,yt=Ce.length,Xt=yt>>>1;Mt<Xt;){var Ue=2*(Mt+1)-1,Be=Ce[Ue],at=Ue+1,Jt=Ce[at];if(0>d(Be,Ye))at<yt&&0>d(Jt,Be)?(Ce[Mt]=Jt,Ce[at]=Ye,Mt=at):(Ce[Mt]=Be,Ce[Ue]=Ye,Mt=Ue);else if(at<yt&&0>d(Jt,Ye))Ce[Mt]=Jt,Ce[at]=Ye,Mt=at;else break e}}return Fe}function d(Ce,Fe){var Ye=Ce.sortIndex-Fe.sortIndex;return Ye!==0?Ye:Ce.id-Fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;t.unstable_now=function(){return h.now()}}else{var f=Date,_=f.now();t.unstable_now=function(){return f.now()-_}}var v=[],b=[],A=1,w=null,x=3,M=!1,V=!1,G=!1,H=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(Ce){for(var Fe=o(b);Fe!==null;){if(Fe.callback===null)c(b);else if(Fe.startTime<=Ce)c(b),Fe.sortIndex=Fe.expirationTime,r(v,Fe);else break;Fe=o(b)}}function X(Ce){if(G=!1,L(Ce),!V)if(o(v)!==null)V=!0,Pe(ee);else{var Fe=o(b);Fe!==null&&$e(X,Fe.startTime-Ce)}}function ee(Ce,Fe){V=!1,G&&(G=!1,F(ne),ne=-1),M=!0;var Ye=x;try{for(L(Fe),w=o(v);w!==null&&(!(w.expirationTime>Fe)||Ce&&!ue());){var Mt=w.callback;if(typeof Mt=="function"){w.callback=null,x=w.priorityLevel;var yt=Mt(w.expirationTime<=Fe);Fe=t.unstable_now(),typeof yt=="function"?w.callback=yt:w===o(v)&&c(v),L(Fe)}else c(v);w=o(v)}if(w!==null)var Xt=!0;else{var Ue=o(b);Ue!==null&&$e(X,Ue.startTime-Fe),Xt=!1}return Xt}finally{w=null,x=Ye,M=!1}}var ce=!1,ie=null,ne=-1,fe=5,oe=-1;function ue(){return!(t.unstable_now()-oe<fe)}function Ne(){if(ie!==null){var Ce=t.unstable_now();oe=Ce;var Fe=!0;try{Fe=ie(!0,Ce)}finally{Fe?Ee():(ce=!1,ie=null)}}else ce=!1}var Ee;if(typeof B=="function")Ee=function(){B(Ne)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,Re=we.port2;we.port1.onmessage=Ne,Ee=function(){Re.postMessage(null)}}else Ee=function(){H(Ne,0)};function Pe(Ce){ie=Ce,ce||(ce=!0,Ee())}function $e(Ce,Fe){ne=H(function(){Ce(t.unstable_now())},Fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){V||M||(V=!0,Pe(ee))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):fe=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return o(v)},t.unstable_next=function(Ce){switch(x){case 1:case 2:case 3:var Fe=3;break;default:Fe=x}var Ye=x;x=Fe;try{return Ce()}finally{x=Ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,Fe){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var Ye=x;x=Ce;try{return Fe()}finally{x=Ye}},t.unstable_scheduleCallback=function(Ce,Fe,Ye){var Mt=t.unstable_now();switch(typeof Ye=="object"&&Ye!==null?(Ye=Ye.delay,Ye=typeof Ye=="number"&&0<Ye?Mt+Ye:Mt):Ye=Mt,Ce){case 1:var yt=-1;break;case 2:yt=250;break;case 5:yt=1073741823;break;case 4:yt=1e4;break;default:yt=5e3}return yt=Ye+yt,Ce={id:A++,callback:Fe,priorityLevel:Ce,startTime:Ye,expirationTime:yt,sortIndex:-1},Ye>Mt?(Ce.sortIndex=Ye,r(b,Ce),o(v)===null&&Ce===o(b)&&(G?(F(ne),ne=-1):G=!0,$e(X,Ye-Mt))):(Ce.sortIndex=yt,r(v,Ce),V||M||(V=!0,Pe(ee))),Ce},t.unstable_shouldYield=ue,t.unstable_wrapCallback=function(Ce){var Fe=x;return function(){var Ye=x;x=Fe;try{return Ce.apply(this,arguments)}finally{x=Ye}}}})(d7);l7.exports=d7;var Cle=l7.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u7=K,fa=Cle;function Ze(t){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+t,o=1;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h7=new Set,uy={};function nf(t,r){Dg(t,r),Dg(t+"Capture",r)}function Dg(t,r){for(uy[t]=r,t=0;t<r.length;t++)h7.add(r[t])}var kd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eD=Object.prototype.hasOwnProperty,wle=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,RW={},IW={};function Rle(t){return eD.call(IW,t)?!0:eD.call(RW,t)?!1:wle.test(t)?IW[t]=!0:(RW[t]=!0,!1)}function Ile(t,r,o,c){if(o!==null&&o.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return c?!1:o!==null?!o.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ale(t,r,o,c){if(r===null||typeof r>"u"||Ile(t,r,o,c))return!0;if(c)return!1;if(o!==null)switch(o.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function fo(t,r,o,c,d,h,f){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=c,this.attributeNamespace=d,this.mustUseProperty=o,this.propertyName=t,this.type=r,this.sanitizeURL=h,this.removeEmptyString=f}var Is={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Is[t]=new fo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var r=t[0];Is[r]=new fo(r,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Is[t]=new fo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Is[t]=new fo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Is[t]=new fo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Is[t]=new fo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Is[t]=new fo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Is[t]=new fo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Is[t]=new fo(t,5,!1,t.toLowerCase(),null,!1,!1)});var u2=/[\-:]([a-z])/g;function h2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var r=t.replace(u2,h2);Is[r]=new fo(r,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var r=t.replace(u2,h2);Is[r]=new fo(r,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var r=t.replace(u2,h2);Is[r]=new fo(r,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Is[t]=new fo(t,1,!1,t.toLowerCase(),null,!1,!1)});Is.xlinkHref=new fo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Is[t]=new fo(t,1,!1,t.toLowerCase(),null,!0,!0)});function p2(t,r,o,c){var d=Is.hasOwnProperty(r)?Is[r]:null;(d!==null?d.type!==0:c||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(Ale(r,o,d,c)&&(o=null),c||d===null?Rle(r)&&(o===null?t.removeAttribute(r):t.setAttribute(r,""+o)):d.mustUseProperty?t[d.propertyName]=o===null?d.type===3?!1:"":o:(r=d.attributeName,c=d.attributeNamespace,o===null?t.removeAttribute(r):(d=d.type,o=d===3||d===4&&o===!0?"":""+o,c?t.setAttributeNS(c,r,o):t.setAttribute(r,o))))}var Bd=u7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,iC=Symbol.for("react.element"),zm=Symbol.for("react.portal"),Km=Symbol.for("react.fragment"),f2=Symbol.for("react.strict_mode"),tD=Symbol.for("react.profiler"),p7=Symbol.for("react.provider"),f7=Symbol.for("react.context"),m2=Symbol.for("react.forward_ref"),nD=Symbol.for("react.suspense"),rD=Symbol.for("react.suspense_list"),g2=Symbol.for("react.memo"),zu=Symbol.for("react.lazy"),m7=Symbol.for("react.offscreen"),AW=Symbol.iterator;function yv(t){return t===null||typeof t!="object"?null:(t=AW&&t[AW]||t["@@iterator"],typeof t=="function"?t:null)}var Ci=Object.assign,Px;function Uv(t){if(Px===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Px=r&&r[1]||""}return`
`+Px+t}var Dx=!1;function Lx(t,r){if(!t||Dx)return"";Dx=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(b){var c=b}Reflect.construct(t,[],r)}else{try{r.call()}catch(b){c=b}t.call(r.prototype)}else{try{throw Error()}catch(b){c=b}t()}}catch(b){if(b&&c&&typeof b.stack=="string"){for(var d=b.stack.split(`
`),h=c.stack.split(`
`),f=d.length-1,_=h.length-1;1<=f&&0<=_&&d[f]!==h[_];)_--;for(;1<=f&&0<=_;f--,_--)if(d[f]!==h[_]){if(f!==1||_!==1)do if(f--,_--,0>_||d[f]!==h[_]){var v=`
`+d[f].replace(" at new "," at ");return t.displayName&&v.includes("<anonymous>")&&(v=v.replace("<anonymous>",t.displayName)),v}while(1<=f&&0<=_);break}}}finally{Dx=!1,Error.prepareStackTrace=o}return(t=t?t.displayName||t.name:"")?Uv(t):""}function Ole(t){switch(t.tag){case 5:return Uv(t.type);case 16:return Uv("Lazy");case 13:return Uv("Suspense");case 19:return Uv("SuspenseList");case 0:case 2:case 15:return t=Lx(t.type,!1),t;case 11:return t=Lx(t.type.render,!1),t;case 1:return t=Lx(t.type,!0),t;default:return""}}function iD(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Km:return"Fragment";case zm:return"Portal";case tD:return"Profiler";case f2:return"StrictMode";case nD:return"Suspense";case rD:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case f7:return(t.displayName||"Context")+".Consumer";case p7:return(t._context.displayName||"Context")+".Provider";case m2:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case g2:return r=t.displayName||null,r!==null?r:iD(t.type)||"Memo";case zu:r=t._payload,t=t._init;try{return iD(t(r))}catch{}}return null}function Nle(t){var r=t.type;switch(t.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=r.render,t=t.displayName||t.name||"",r.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return iD(r);case 8:return r===f2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Sh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function g7(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function kle(t){var r=g7(t)?"checked":"value",o=Object.getOwnPropertyDescriptor(t.constructor.prototype,r),c=""+t[r];if(!t.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,h=o.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return d.call(this)},set:function(f){c=""+f,h.call(this,f)}}),Object.defineProperty(t,r,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(f){c=""+f},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function sC(t){t._valueTracker||(t._valueTracker=kle(t))}function _7(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return t&&(c=g7(t)?t.checked?"true":"false":t.value),t=c,t!==o?(r.setValue(t),!0):!1}function fw(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sD(t,r){var o=r.checked;return Ci({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??t._wrapperState.initialChecked})}function OW(t,r){var o=r.defaultValue==null?"":r.defaultValue,c=r.checked!=null?r.checked:r.defaultChecked;o=Sh(r.value!=null?r.value:o),t._wrapperState={initialChecked:c,initialValue:o,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function E7(t,r){r=r.checked,r!=null&&p2(t,"checked",r,!1)}function oD(t,r){E7(t,r);var o=Sh(r.value),c=r.type;if(o!=null)c==="number"?(o===0&&t.value===""||t.value!=o)&&(t.value=""+o):t.value!==""+o&&(t.value=""+o);else if(c==="submit"||c==="reset"){t.removeAttribute("value");return}r.hasOwnProperty("value")?aD(t,r.type,o):r.hasOwnProperty("defaultValue")&&aD(t,r.type,Sh(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(t.defaultChecked=!!r.defaultChecked)}function NW(t,r,o){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var c=r.type;if(!(c!=="submit"&&c!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+t._wrapperState.initialValue,o||r===t.value||(t.value=r),t.defaultValue=r}o=t.name,o!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,o!==""&&(t.name=o)}function aD(t,r,o){(r!=="number"||fw(t.ownerDocument)!==t)&&(o==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+o&&(t.defaultValue=""+o))}var jv=Array.isArray;function cg(t,r,o,c){if(t=t.options,r){r={};for(var d=0;d<o.length;d++)r["$"+o[d]]=!0;for(o=0;o<t.length;o++)d=r.hasOwnProperty("$"+t[o].value),t[o].selected!==d&&(t[o].selected=d),d&&c&&(t[o].defaultSelected=!0)}else{for(o=""+Sh(o),r=null,d=0;d<t.length;d++){if(t[d].value===o){t[d].selected=!0,c&&(t[d].defaultSelected=!0);return}r!==null||t[d].disabled||(r=t[d])}r!==null&&(r.selected=!0)}}function cD(t,r){if(r.dangerouslySetInnerHTML!=null)throw Error(Ze(91));return Ci({},r,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kW(t,r){var o=r.value;if(o==null){if(o=r.children,r=r.defaultValue,o!=null){if(r!=null)throw Error(Ze(92));if(jv(o)){if(1<o.length)throw Error(Ze(93));o=o[0]}r=o}r==null&&(r=""),o=r}t._wrapperState={initialValue:Sh(o)}}function v7(t,r){var o=Sh(r.value),c=Sh(r.defaultValue);o!=null&&(o=""+o,o!==t.value&&(t.value=o),r.defaultValue==null&&t.defaultValue!==o&&(t.defaultValue=o)),c!=null&&(t.defaultValue=""+c)}function xW(t){var r=t.textContent;r===t._wrapperState.initialValue&&r!==""&&r!==null&&(t.value=r)}function y7(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lD(t,r){return t==null||t==="http://www.w3.org/1999/xhtml"?y7(r):t==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var oC,S7=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,o,c,d){MSApp.execUnsafeLocalFunction(function(){return t(r,o,c,d)})}:t}(function(t,r){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=r;else{for(oC=oC||document.createElement("div"),oC.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=oC.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;r.firstChild;)t.appendChild(r.firstChild)}});function hy(t,r){if(r){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=r;return}}t.textContent=r}var Yv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xle=["Webkit","ms","Moz","O"];Object.keys(Yv).forEach(function(t){xle.forEach(function(r){r=r+t.charAt(0).toUpperCase()+t.substring(1),Yv[r]=Yv[t]})});function b7(t,r,o){return r==null||typeof r=="boolean"||r===""?"":o||typeof r!="number"||r===0||Yv.hasOwnProperty(t)&&Yv[t]?(""+r).trim():r+"px"}function T7(t,r){t=t.style;for(var o in r)if(r.hasOwnProperty(o)){var c=o.indexOf("--")===0,d=b7(o,r[o],c);o==="float"&&(o="cssFloat"),c?t.setProperty(o,d):t[o]=d}}var Ple=Ci({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dD(t,r){if(r){if(Ple[t]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(Ze(137,t));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(Ze(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(Ze(61))}if(r.style!=null&&typeof r.style!="object")throw Error(Ze(62))}}function uD(t,r){if(t.indexOf("-")===-1)return typeof r.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hD=null;function _2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var pD=null,lg=null,dg=null;function PW(t){if(t=c0(t)){if(typeof pD!="function")throw Error(Ze(280));var r=t.stateNode;r&&(r=vR(r),pD(t.stateNode,t.type,r))}}function C7(t){lg?dg?dg.push(t):dg=[t]:lg=t}function w7(){if(lg){var t=lg,r=dg;if(dg=lg=null,PW(t),r)for(t=0;t<r.length;t++)PW(r[t])}}function R7(t,r){return t(r)}function I7(){}var Mx=!1;function A7(t,r,o){if(Mx)return t(r,o);Mx=!0;try{return R7(t,r,o)}finally{Mx=!1,(lg!==null||dg!==null)&&(I7(),w7())}}function py(t,r){var o=t.stateNode;if(o===null)return null;var c=vR(o);if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(Ze(231,r,typeof o));return o}var fD=!1;if(kd)try{var Sv={};Object.defineProperty(Sv,"passive",{get:function(){fD=!0}}),window.addEventListener("test",Sv,Sv),window.removeEventListener("test",Sv,Sv)}catch{fD=!1}function Dle(t,r,o,c,d,h,f,_,v){var b=Array.prototype.slice.call(arguments,3);try{r.apply(o,b)}catch(A){this.onError(A)}}var qv=!1,mw=null,gw=!1,mD=null,Lle={onError:function(t){qv=!0,mw=t}};function Mle(t,r,o,c,d,h,f,_,v){qv=!1,mw=null,Dle.apply(Lle,arguments)}function Ule(t,r,o,c,d,h,f,_,v){if(Mle.apply(this,arguments),qv){if(qv){var b=mw;qv=!1,mw=null}else throw Error(Ze(198));gw||(gw=!0,mD=b)}}function rf(t){var r=t,o=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,r.flags&4098&&(o=r.return),t=r.return;while(t)}return r.tag===3?o:null}function O7(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function DW(t){if(rf(t)!==t)throw Error(Ze(188))}function jle(t){var r=t.alternate;if(!r){if(r=rf(t),r===null)throw Error(Ze(188));return r!==t?null:t}for(var o=t,c=r;;){var d=o.return;if(d===null)break;var h=d.alternate;if(h===null){if(c=d.return,c!==null){o=c;continue}break}if(d.child===h.child){for(h=d.child;h;){if(h===o)return DW(d),t;if(h===c)return DW(d),r;h=h.sibling}throw Error(Ze(188))}if(o.return!==c.return)o=d,c=h;else{for(var f=!1,_=d.child;_;){if(_===o){f=!0,o=d,c=h;break}if(_===c){f=!0,c=d,o=h;break}_=_.sibling}if(!f){for(_=h.child;_;){if(_===o){f=!0,o=h,c=d;break}if(_===c){f=!0,c=h,o=d;break}_=_.sibling}if(!f)throw Error(Ze(189))}}if(o.alternate!==c)throw Error(Ze(190))}if(o.tag!==3)throw Error(Ze(188));return o.stateNode.current===o?t:r}function N7(t){return t=jle(t),t!==null?k7(t):null}function k7(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var r=k7(t);if(r!==null)return r;t=t.sibling}return null}var x7=fa.unstable_scheduleCallback,LW=fa.unstable_cancelCallback,Fle=fa.unstable_shouldYield,Vle=fa.unstable_requestPaint,Fi=fa.unstable_now,Ble=fa.unstable_getCurrentPriorityLevel,E2=fa.unstable_ImmediatePriority,P7=fa.unstable_UserBlockingPriority,_w=fa.unstable_NormalPriority,Wle=fa.unstable_LowPriority,D7=fa.unstable_IdlePriority,mR=null,kl=null;function $le(t){if(kl&&typeof kl.onCommitFiberRoot=="function")try{kl.onCommitFiberRoot(mR,t,void 0,(t.current.flags&128)===128)}catch{}}var Uc=Math.clz32?Math.clz32:zle,Gle=Math.log,Hle=Math.LN2;function zle(t){return t>>>=0,t===0?32:31-(Gle(t)/Hle|0)|0}var aC=64,cC=4194304;function Fv(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ew(t,r){var o=t.pendingLanes;if(o===0)return 0;var c=0,d=t.suspendedLanes,h=t.pingedLanes,f=o&268435455;if(f!==0){var _=f&~d;_!==0?c=Fv(_):(h&=f,h!==0&&(c=Fv(h)))}else f=o&~d,f!==0?c=Fv(f):h!==0&&(c=Fv(h));if(c===0)return 0;if(r!==0&&r!==c&&!(r&d)&&(d=c&-c,h=r&-r,d>=h||d===16&&(h&4194240)!==0))return r;if(c&4&&(c|=o&16),r=t.entangledLanes,r!==0)for(t=t.entanglements,r&=c;0<r;)o=31-Uc(r),d=1<<o,c|=t[o],r&=~d;return c}function Kle(t,r){switch(t){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yle(t,r){for(var o=t.suspendedLanes,c=t.pingedLanes,d=t.expirationTimes,h=t.pendingLanes;0<h;){var f=31-Uc(h),_=1<<f,v=d[f];v===-1?(!(_&o)||_&c)&&(d[f]=Kle(_,r)):v<=r&&(t.expiredLanes|=_),h&=~_}}function gD(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function L7(){var t=aC;return aC<<=1,!(aC&4194240)&&(aC=64),t}function Ux(t){for(var r=[],o=0;31>o;o++)r.push(t);return r}function o0(t,r,o){t.pendingLanes|=r,r!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,r=31-Uc(r),t[r]=o}function qle(t,r){var o=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;var c=t.eventTimes;for(t=t.expirationTimes;0<o;){var d=31-Uc(o),h=1<<d;r[d]=0,c[d]=-1,t[d]=-1,o&=~h}}function v2(t,r){var o=t.entangledLanes|=r;for(t=t.entanglements;o;){var c=31-Uc(o),d=1<<c;d&r|t[c]&r&&(t[c]|=r),o&=~d}}var vr=0;function M7(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var U7,y2,j7,F7,V7,_D=!1,lC=[],dh=null,uh=null,hh=null,fy=new Map,my=new Map,Yu=[],Xle="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function MW(t,r){switch(t){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":uh=null;break;case"mouseover":case"mouseout":hh=null;break;case"pointerover":case"pointerout":fy.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":my.delete(r.pointerId)}}function bv(t,r,o,c,d,h){return t===null||t.nativeEvent!==h?(t={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:h,targetContainers:[d]},r!==null&&(r=c0(r),r!==null&&y2(r)),t):(t.eventSystemFlags|=c,r=t.targetContainers,d!==null&&r.indexOf(d)===-1&&r.push(d),t)}function Jle(t,r,o,c,d){switch(r){case"focusin":return dh=bv(dh,t,r,o,c,d),!0;case"dragenter":return uh=bv(uh,t,r,o,c,d),!0;case"mouseover":return hh=bv(hh,t,r,o,c,d),!0;case"pointerover":var h=d.pointerId;return fy.set(h,bv(fy.get(h)||null,t,r,o,c,d)),!0;case"gotpointercapture":return h=d.pointerId,my.set(h,bv(my.get(h)||null,t,r,o,c,d)),!0}return!1}function B7(t){var r=Ap(t.target);if(r!==null){var o=rf(r);if(o!==null){if(r=o.tag,r===13){if(r=O7(o),r!==null){t.blockedOn=r,V7(t.priority,function(){j7(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function HC(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var o=ED(t.domEventName,t.eventSystemFlags,r[0],t.nativeEvent);if(o===null){o=t.nativeEvent;var c=new o.constructor(o.type,o);hD=c,o.target.dispatchEvent(c),hD=null}else return r=c0(o),r!==null&&y2(r),t.blockedOn=o,!1;r.shift()}return!0}function UW(t,r,o){HC(t)&&o.delete(r)}function Qle(){_D=!1,dh!==null&&HC(dh)&&(dh=null),uh!==null&&HC(uh)&&(uh=null),hh!==null&&HC(hh)&&(hh=null),fy.forEach(UW),my.forEach(UW)}function Tv(t,r){t.blockedOn===r&&(t.blockedOn=null,_D||(_D=!0,fa.unstable_scheduleCallback(fa.unstable_NormalPriority,Qle)))}function gy(t){function r(d){return Tv(d,t)}if(0<lC.length){Tv(lC[0],t);for(var o=1;o<lC.length;o++){var c=lC[o];c.blockedOn===t&&(c.blockedOn=null)}}for(dh!==null&&Tv(dh,t),uh!==null&&Tv(uh,t),hh!==null&&Tv(hh,t),fy.forEach(r),my.forEach(r),o=0;o<Yu.length;o++)c=Yu[o],c.blockedOn===t&&(c.blockedOn=null);for(;0<Yu.length&&(o=Yu[0],o.blockedOn===null);)B7(o),o.blockedOn===null&&Yu.shift()}var ug=Bd.ReactCurrentBatchConfig,vw=!0;function Zle(t,r,o,c){var d=vr,h=ug.transition;ug.transition=null;try{vr=1,S2(t,r,o,c)}finally{vr=d,ug.transition=h}}function ede(t,r,o,c){var d=vr,h=ug.transition;ug.transition=null;try{vr=4,S2(t,r,o,c)}finally{vr=d,ug.transition=h}}function S2(t,r,o,c){if(vw){var d=ED(t,r,o,c);if(d===null)Kx(t,r,c,yw,o),MW(t,c);else if(Jle(d,t,r,o,c))c.stopPropagation();else if(MW(t,c),r&4&&-1<Xle.indexOf(t)){for(;d!==null;){var h=c0(d);if(h!==null&&U7(h),h=ED(t,r,o,c),h===null&&Kx(t,r,c,yw,o),h===d)break;d=h}d!==null&&c.stopPropagation()}else Kx(t,r,c,null,o)}}var yw=null;function ED(t,r,o,c){if(yw=null,t=_2(c),t=Ap(t),t!==null)if(r=rf(t),r===null)t=null;else if(o=r.tag,o===13){if(t=O7(r),t!==null)return t;t=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null);return yw=t,null}function W7(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ble()){case E2:return 1;case P7:return 4;case _w:case Wle:return 16;case D7:return 536870912;default:return 16}default:return 16}}var oh=null,b2=null,zC=null;function $7(){if(zC)return zC;var t,r=b2,o=r.length,c,d="value"in oh?oh.value:oh.textContent,h=d.length;for(t=0;t<o&&r[t]===d[t];t++);var f=o-t;for(c=1;c<=f&&r[o-c]===d[h-c];c++);return zC=d.slice(t,1<c?1-c:void 0)}function KC(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function dC(){return!0}function jW(){return!1}function ga(t){function r(o,c,d,h,f){this._reactName=o,this._targetInst=d,this.type=c,this.nativeEvent=h,this.target=f,this.currentTarget=null;for(var _ in t)t.hasOwnProperty(_)&&(o=t[_],this[_]=o?o(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?dC:jW,this.isPropagationStopped=jW,this}return Ci(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=dC)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=dC)},persist:function(){},isPersistent:dC}),r}var Xg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},T2=ga(Xg),a0=Ci({},Xg,{view:0,detail:0}),tde=ga(a0),jx,Fx,Cv,gR=Ci({},a0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:C2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Cv&&(Cv&&t.type==="mousemove"?(jx=t.screenX-Cv.screenX,Fx=t.screenY-Cv.screenY):Fx=jx=0,Cv=t),jx)},movementY:function(t){return"movementY"in t?t.movementY:Fx}}),FW=ga(gR),nde=Ci({},gR,{dataTransfer:0}),rde=ga(nde),ide=Ci({},a0,{relatedTarget:0}),Vx=ga(ide),sde=Ci({},Xg,{animationName:0,elapsedTime:0,pseudoElement:0}),ode=ga(sde),ade=Ci({},Xg,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cde=ga(ade),lde=Ci({},Xg,{data:0}),VW=ga(lde),dde={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ude={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hde={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pde(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=hde[t])?!!r[t]:!1}function C2(){return pde}var fde=Ci({},a0,{key:function(t){if(t.key){var r=dde[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=KC(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ude[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:C2,charCode:function(t){return t.type==="keypress"?KC(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?KC(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),mde=ga(fde),gde=Ci({},gR,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),BW=ga(gde),_de=Ci({},a0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:C2}),Ede=ga(_de),vde=Ci({},Xg,{propertyName:0,elapsedTime:0,pseudoElement:0}),yde=ga(vde),Sde=Ci({},gR,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bde=ga(Sde),Tde=[9,13,27,32],w2=kd&&"CompositionEvent"in window,Xv=null;kd&&"documentMode"in document&&(Xv=document.documentMode);var Cde=kd&&"TextEvent"in window&&!Xv,G7=kd&&(!w2||Xv&&8<Xv&&11>=Xv),WW=" ",$W=!1;function H7(t,r){switch(t){case"keyup":return Tde.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z7(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ym=!1;function wde(t,r){switch(t){case"compositionend":return z7(r);case"keypress":return r.which!==32?null:($W=!0,WW);case"textInput":return t=r.data,t===WW&&$W?null:t;default:return null}}function Rde(t,r){if(Ym)return t==="compositionend"||!w2&&H7(t,r)?(t=$7(),zC=b2=oh=null,Ym=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return G7&&r.locale!=="ko"?null:r.data;default:return null}}var Ide={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function GW(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!Ide[t.type]:r==="textarea"}function K7(t,r,o,c){C7(c),r=Sw(r,"onChange"),0<r.length&&(o=new T2("onChange","change",null,o,c),t.push({event:o,listeners:r}))}var Jv=null,_y=null;function Ade(t){iz(t,0)}function _R(t){var r=Jm(t);if(_7(r))return t}function Ode(t,r){if(t==="change")return r}var Y7=!1;if(kd){var Bx;if(kd){var Wx="oninput"in document;if(!Wx){var HW=document.createElement("div");HW.setAttribute("oninput","return;"),Wx=typeof HW.oninput=="function"}Bx=Wx}else Bx=!1;Y7=Bx&&(!document.documentMode||9<document.documentMode)}function zW(){Jv&&(Jv.detachEvent("onpropertychange",q7),_y=Jv=null)}function q7(t){if(t.propertyName==="value"&&_R(_y)){var r=[];K7(r,_y,t,_2(t)),A7(Ade,r)}}function Nde(t,r,o){t==="focusin"?(zW(),Jv=r,_y=o,Jv.attachEvent("onpropertychange",q7)):t==="focusout"&&zW()}function kde(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _R(_y)}function xde(t,r){if(t==="click")return _R(r)}function Pde(t,r){if(t==="input"||t==="change")return _R(r)}function Dde(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Vc=typeof Object.is=="function"?Object.is:Dde;function Ey(t,r){if(Vc(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var o=Object.keys(t),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var d=o[c];if(!eD.call(r,d)||!Vc(t[d],r[d]))return!1}return!0}function KW(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function YW(t,r){var o=KW(t);t=0;for(var c;o;){if(o.nodeType===3){if(c=t+o.textContent.length,t<=r&&c>=r)return{node:o,offset:r-t};t=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=KW(o)}}function X7(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?X7(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function J7(){for(var t=window,r=fw();r instanceof t.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)t=r.contentWindow;else break;r=fw(t.document)}return r}function R2(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}function Lde(t){var r=J7(),o=t.focusedElem,c=t.selectionRange;if(r!==o&&o&&o.ownerDocument&&X7(o.ownerDocument.documentElement,o)){if(c!==null&&R2(o)){if(r=c.start,t=c.end,t===void 0&&(t=r),"selectionStart"in o)o.selectionStart=r,o.selectionEnd=Math.min(t,o.value.length);else if(t=(r=o.ownerDocument||document)&&r.defaultView||window,t.getSelection){t=t.getSelection();var d=o.textContent.length,h=Math.min(c.start,d);c=c.end===void 0?h:Math.min(c.end,d),!t.extend&&h>c&&(d=c,c=h,h=d),d=YW(o,h);var f=YW(o,c);d&&f&&(t.rangeCount!==1||t.anchorNode!==d.node||t.anchorOffset!==d.offset||t.focusNode!==f.node||t.focusOffset!==f.offset)&&(r=r.createRange(),r.setStart(d.node,d.offset),t.removeAllRanges(),h>c?(t.addRange(r),t.extend(f.node,f.offset)):(r.setEnd(f.node,f.offset),t.addRange(r)))}}for(r=[],t=o;t=t.parentNode;)t.nodeType===1&&r.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<r.length;o++)t=r[o],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Mde=kd&&"documentMode"in document&&11>=document.documentMode,qm=null,vD=null,Qv=null,yD=!1;function qW(t,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;yD||qm==null||qm!==fw(c)||(c=qm,"selectionStart"in c&&R2(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Qv&&Ey(Qv,c)||(Qv=c,c=Sw(vD,"onSelect"),0<c.length&&(r=new T2("onSelect","select",null,r,o),t.push({event:r,listeners:c}),r.target=qm)))}function uC(t,r){var o={};return o[t.toLowerCase()]=r.toLowerCase(),o["Webkit"+t]="webkit"+r,o["Moz"+t]="moz"+r,o}var Xm={animationend:uC("Animation","AnimationEnd"),animationiteration:uC("Animation","AnimationIteration"),animationstart:uC("Animation","AnimationStart"),transitionend:uC("Transition","TransitionEnd")},$x={},Q7={};kd&&(Q7=document.createElement("div").style,"AnimationEvent"in window||(delete Xm.animationend.animation,delete Xm.animationiteration.animation,delete Xm.animationstart.animation),"TransitionEvent"in window||delete Xm.transitionend.transition);function ER(t){if($x[t])return $x[t];if(!Xm[t])return t;var r=Xm[t],o;for(o in r)if(r.hasOwnProperty(o)&&o in Q7)return $x[t]=r[o];return t}var Z7=ER("animationend"),ez=ER("animationiteration"),tz=ER("animationstart"),nz=ER("transitionend"),rz=new Map,XW="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oh(t,r){rz.set(t,r),nf(r,[t])}for(var Gx=0;Gx<XW.length;Gx++){var Hx=XW[Gx],Ude=Hx.toLowerCase(),jde=Hx[0].toUpperCase()+Hx.slice(1);Oh(Ude,"on"+jde)}Oh(Z7,"onAnimationEnd");Oh(ez,"onAnimationIteration");Oh(tz,"onAnimationStart");Oh("dblclick","onDoubleClick");Oh("focusin","onFocus");Oh("focusout","onBlur");Oh(nz,"onTransitionEnd");Dg("onMouseEnter",["mouseout","mouseover"]);Dg("onMouseLeave",["mouseout","mouseover"]);Dg("onPointerEnter",["pointerout","pointerover"]);Dg("onPointerLeave",["pointerout","pointerover"]);nf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));nf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));nf("onBeforeInput",["compositionend","keypress","textInput","paste"]);nf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));nf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));nf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fde=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vv));function JW(t,r,o){var c=t.type||"unknown-event";t.currentTarget=o,Ule(c,r,void 0,t),t.currentTarget=null}function iz(t,r){r=(r&4)!==0;for(var o=0;o<t.length;o++){var c=t[o],d=c.event;c=c.listeners;e:{var h=void 0;if(r)for(var f=c.length-1;0<=f;f--){var _=c[f],v=_.instance,b=_.currentTarget;if(_=_.listener,v!==h&&d.isPropagationStopped())break e;JW(d,_,b),h=v}else for(f=0;f<c.length;f++){if(_=c[f],v=_.instance,b=_.currentTarget,_=_.listener,v!==h&&d.isPropagationStopped())break e;JW(d,_,b),h=v}}}if(gw)throw t=mD,gw=!1,mD=null,t}function qr(t,r){var o=r[wD];o===void 0&&(o=r[wD]=new Set);var c=t+"__bubble";o.has(c)||(sz(r,t,2,!1),o.add(c))}function zx(t,r,o){var c=0;r&&(c|=4),sz(o,t,c,r)}var hC="_reactListening"+Math.random().toString(36).slice(2);function vy(t){if(!t[hC]){t[hC]=!0,h7.forEach(function(o){o!=="selectionchange"&&(Fde.has(o)||zx(o,!1,t),zx(o,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[hC]||(r[hC]=!0,zx("selectionchange",!1,r))}}function sz(t,r,o,c){switch(W7(r)){case 1:var d=Zle;break;case 4:d=ede;break;default:d=S2}o=d.bind(null,r,o,t),d=void 0,!fD||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(d=!0),c?d!==void 0?t.addEventListener(r,o,{capture:!0,passive:d}):t.addEventListener(r,o,!0):d!==void 0?t.addEventListener(r,o,{passive:d}):t.addEventListener(r,o,!1)}function Kx(t,r,o,c,d){var h=c;if(!(r&1)&&!(r&2)&&c!==null)e:for(;;){if(c===null)return;var f=c.tag;if(f===3||f===4){var _=c.stateNode.containerInfo;if(_===d||_.nodeType===8&&_.parentNode===d)break;if(f===4)for(f=c.return;f!==null;){var v=f.tag;if((v===3||v===4)&&(v=f.stateNode.containerInfo,v===d||v.nodeType===8&&v.parentNode===d))return;f=f.return}for(;_!==null;){if(f=Ap(_),f===null)return;if(v=f.tag,v===5||v===6){c=h=f;continue e}_=_.parentNode}}c=c.return}A7(function(){var b=h,A=_2(o),w=[];e:{var x=rz.get(t);if(x!==void 0){var M=T2,V=t;switch(t){case"keypress":if(KC(o)===0)break e;case"keydown":case"keyup":M=mde;break;case"focusin":V="focus",M=Vx;break;case"focusout":V="blur",M=Vx;break;case"beforeblur":case"afterblur":M=Vx;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=FW;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=rde;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=Ede;break;case Z7:case ez:case tz:M=ode;break;case nz:M=yde;break;case"scroll":M=tde;break;case"wheel":M=bde;break;case"copy":case"cut":case"paste":M=cde;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=BW}var G=(r&4)!==0,H=!G&&t==="scroll",F=G?x!==null?x+"Capture":null:x;G=[];for(var B=b,L;B!==null;){L=B;var X=L.stateNode;if(L.tag===5&&X!==null&&(L=X,F!==null&&(X=py(B,F),X!=null&&G.push(yy(B,X,L)))),H)break;B=B.return}0<G.length&&(x=new M(x,V,null,o,A),w.push({event:x,listeners:G}))}}if(!(r&7)){e:{if(x=t==="mouseover"||t==="pointerover",M=t==="mouseout"||t==="pointerout",x&&o!==hD&&(V=o.relatedTarget||o.fromElement)&&(Ap(V)||V[xd]))break e;if((M||x)&&(x=A.window===A?A:(x=A.ownerDocument)?x.defaultView||x.parentWindow:window,M?(V=o.relatedTarget||o.toElement,M=b,V=V?Ap(V):null,V!==null&&(H=rf(V),V!==H||V.tag!==5&&V.tag!==6)&&(V=null)):(M=null,V=b),M!==V)){if(G=FW,X="onMouseLeave",F="onMouseEnter",B="mouse",(t==="pointerout"||t==="pointerover")&&(G=BW,X="onPointerLeave",F="onPointerEnter",B="pointer"),H=M==null?x:Jm(M),L=V==null?x:Jm(V),x=new G(X,B+"leave",M,o,A),x.target=H,x.relatedTarget=L,X=null,Ap(A)===b&&(G=new G(F,B+"enter",V,o,A),G.target=L,G.relatedTarget=H,X=G),H=X,M&&V)t:{for(G=M,F=V,B=0,L=G;L;L=Lm(L))B++;for(L=0,X=F;X;X=Lm(X))L++;for(;0<B-L;)G=Lm(G),B--;for(;0<L-B;)F=Lm(F),L--;for(;B--;){if(G===F||F!==null&&G===F.alternate)break t;G=Lm(G),F=Lm(F)}G=null}else G=null;M!==null&&QW(w,x,M,G,!1),V!==null&&H!==null&&QW(w,H,V,G,!0)}}e:{if(x=b?Jm(b):window,M=x.nodeName&&x.nodeName.toLowerCase(),M==="select"||M==="input"&&x.type==="file")var ee=Ode;else if(GW(x))if(Y7)ee=Pde;else{ee=kde;var ce=Nde}else(M=x.nodeName)&&M.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(ee=xde);if(ee&&(ee=ee(t,b))){K7(w,ee,o,A);break e}ce&&ce(t,x,b),t==="focusout"&&(ce=x._wrapperState)&&ce.controlled&&x.type==="number"&&aD(x,"number",x.value)}switch(ce=b?Jm(b):window,t){case"focusin":(GW(ce)||ce.contentEditable==="true")&&(qm=ce,vD=b,Qv=null);break;case"focusout":Qv=vD=qm=null;break;case"mousedown":yD=!0;break;case"contextmenu":case"mouseup":case"dragend":yD=!1,qW(w,o,A);break;case"selectionchange":if(Mde)break;case"keydown":case"keyup":qW(w,o,A)}var ie;if(w2)e:{switch(t){case"compositionstart":var ne="onCompositionStart";break e;case"compositionend":ne="onCompositionEnd";break e;case"compositionupdate":ne="onCompositionUpdate";break e}ne=void 0}else Ym?H7(t,o)&&(ne="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(ne="onCompositionStart");ne&&(G7&&o.locale!=="ko"&&(Ym||ne!=="onCompositionStart"?ne==="onCompositionEnd"&&Ym&&(ie=$7()):(oh=A,b2="value"in oh?oh.value:oh.textContent,Ym=!0)),ce=Sw(b,ne),0<ce.length&&(ne=new VW(ne,t,null,o,A),w.push({event:ne,listeners:ce}),ie?ne.data=ie:(ie=z7(o),ie!==null&&(ne.data=ie)))),(ie=Cde?wde(t,o):Rde(t,o))&&(b=Sw(b,"onBeforeInput"),0<b.length&&(A=new VW("onBeforeInput","beforeinput",null,o,A),w.push({event:A,listeners:b}),A.data=ie))}iz(w,r)})}function yy(t,r,o){return{instance:t,listener:r,currentTarget:o}}function Sw(t,r){for(var o=r+"Capture",c=[];t!==null;){var d=t,h=d.stateNode;d.tag===5&&h!==null&&(d=h,h=py(t,o),h!=null&&c.unshift(yy(t,h,d)),h=py(t,r),h!=null&&c.push(yy(t,h,d))),t=t.return}return c}function Lm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function QW(t,r,o,c,d){for(var h=r._reactName,f=[];o!==null&&o!==c;){var _=o,v=_.alternate,b=_.stateNode;if(v!==null&&v===c)break;_.tag===5&&b!==null&&(_=b,d?(v=py(o,h),v!=null&&f.unshift(yy(o,v,_))):d||(v=py(o,h),v!=null&&f.push(yy(o,v,_)))),o=o.return}f.length!==0&&t.push({event:r,listeners:f})}var Vde=/\r\n?/g,Bde=/\u0000|\uFFFD/g;function ZW(t){return(typeof t=="string"?t:""+t).replace(Vde,`
`).replace(Bde,"")}function pC(t,r,o){if(r=ZW(r),ZW(t)!==r&&o)throw Error(Ze(425))}function bw(){}var SD=null,bD=null;function TD(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var CD=typeof setTimeout=="function"?setTimeout:void 0,Wde=typeof clearTimeout=="function"?clearTimeout:void 0,e8=typeof Promise=="function"?Promise:void 0,$de=typeof queueMicrotask=="function"?queueMicrotask:typeof e8<"u"?function(t){return e8.resolve(null).then(t).catch(Gde)}:CD;function Gde(t){setTimeout(function(){throw t})}function Yx(t,r){var o=r,c=0;do{var d=o.nextSibling;if(t.removeChild(o),d&&d.nodeType===8)if(o=d.data,o==="/$"){if(c===0){t.removeChild(d),gy(r);return}c--}else o!=="$"&&o!=="$?"&&o!=="$!"||c++;o=d}while(o);gy(r)}function ph(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return t}function t8(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return t;r--}else o==="/$"&&r++}t=t.previousSibling}return null}var Jg=Math.random().toString(36).slice(2),Al="__reactFiber$"+Jg,Sy="__reactProps$"+Jg,xd="__reactContainer$"+Jg,wD="__reactEvents$"+Jg,Hde="__reactListeners$"+Jg,zde="__reactHandles$"+Jg;function Ap(t){var r=t[Al];if(r)return r;for(var o=t.parentNode;o;){if(r=o[xd]||o[Al]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(t=t8(t);t!==null;){if(o=t[Al])return o;t=t8(t)}return r}t=o,o=t.parentNode}return null}function c0(t){return t=t[Al]||t[xd],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Jm(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ze(33))}function vR(t){return t[Sy]||null}var RD=[],Qm=-1;function Nh(t){return{current:t}}function Jr(t){0>Qm||(t.current=RD[Qm],RD[Qm]=null,Qm--)}function $r(t,r){Qm++,RD[Qm]=t.current,t.current=r}var bh={},Ys=Nh(bh),Fo=Nh(!1),zp=bh;function Lg(t,r){var o=t.type.contextTypes;if(!o)return bh;var c=t.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===r)return c.__reactInternalMemoizedMaskedChildContext;var d={},h;for(h in o)d[h]=r[h];return c&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=d),d}function Vo(t){return t=t.childContextTypes,t!=null}function Tw(){Jr(Fo),Jr(Ys)}function n8(t,r,o){if(Ys.current!==bh)throw Error(Ze(168));$r(Ys,r),$r(Fo,o)}function oz(t,r,o){var c=t.stateNode;if(r=r.childContextTypes,typeof c.getChildContext!="function")return o;c=c.getChildContext();for(var d in c)if(!(d in r))throw Error(Ze(108,Nle(t)||"Unknown",d));return Ci({},o,c)}function Cw(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bh,zp=Ys.current,$r(Ys,t),$r(Fo,Fo.current),!0}function r8(t,r,o){var c=t.stateNode;if(!c)throw Error(Ze(169));o?(t=oz(t,r,zp),c.__reactInternalMemoizedMergedChildContext=t,Jr(Fo),Jr(Ys),$r(Ys,t)):Jr(Fo),$r(Fo,o)}var yd=null,yR=!1,qx=!1;function az(t){yd===null?yd=[t]:yd.push(t)}function Kde(t){yR=!0,az(t)}function kh(){if(!qx&&yd!==null){qx=!0;var t=0,r=vr;try{var o=yd;for(vr=1;t<o.length;t++){var c=o[t];do c=c(!0);while(c!==null)}yd=null,yR=!1}catch(d){throw yd!==null&&(yd=yd.slice(t+1)),x7(E2,kh),d}finally{vr=r,qx=!1}}return null}var Zm=[],eg=0,ww=null,Rw=0,Ka=[],Ya=0,Kp=null,wd=1,Rd="";function Tp(t,r){Zm[eg++]=Rw,Zm[eg++]=ww,ww=t,Rw=r}function cz(t,r,o){Ka[Ya++]=wd,Ka[Ya++]=Rd,Ka[Ya++]=Kp,Kp=t;var c=wd;t=Rd;var d=32-Uc(c)-1;c&=~(1<<d),o+=1;var h=32-Uc(r)+d;if(30<h){var f=d-d%5;h=(c&(1<<f)-1).toString(32),c>>=f,d-=f,wd=1<<32-Uc(r)+d|o<<d|c,Rd=h+t}else wd=1<<h|o<<d|c,Rd=t}function I2(t){t.return!==null&&(Tp(t,1),cz(t,1,0))}function A2(t){for(;t===ww;)ww=Zm[--eg],Zm[eg]=null,Rw=Zm[--eg],Zm[eg]=null;for(;t===Kp;)Kp=Ka[--Ya],Ka[Ya]=null,Rd=Ka[--Ya],Ka[Ya]=null,wd=Ka[--Ya],Ka[Ya]=null}var ua=null,da=null,ui=!1,Lc=null;function lz(t,r){var o=Xa(5,null,null,0);o.elementType="DELETED",o.stateNode=r,o.return=t,r=t.deletions,r===null?(t.deletions=[o],t.flags|=16):r.push(o)}function i8(t,r){switch(t.tag){case 5:var o=t.type;return r=r.nodeType!==1||o.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(t.stateNode=r,ua=t,da=ph(r.firstChild),!0):!1;case 6:return r=t.pendingProps===""||r.nodeType!==3?null:r,r!==null?(t.stateNode=r,ua=t,da=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(o=Kp!==null?{id:wd,overflow:Rd}:null,t.memoizedState={dehydrated:r,treeContext:o,retryLane:1073741824},o=Xa(18,null,null,0),o.stateNode=r,o.return=t,t.child=o,ua=t,da=null,!0):!1;default:return!1}}function ID(t){return(t.mode&1)!==0&&(t.flags&128)===0}function AD(t){if(ui){var r=da;if(r){var o=r;if(!i8(t,r)){if(ID(t))throw Error(Ze(418));r=ph(o.nextSibling);var c=ua;r&&i8(t,r)?lz(c,o):(t.flags=t.flags&-4097|2,ui=!1,ua=t)}}else{if(ID(t))throw Error(Ze(418));t.flags=t.flags&-4097|2,ui=!1,ua=t}}}function s8(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ua=t}function fC(t){if(t!==ua)return!1;if(!ui)return s8(t),ui=!0,!1;var r;if((r=t.tag!==3)&&!(r=t.tag!==5)&&(r=t.type,r=r!=="head"&&r!=="body"&&!TD(t.type,t.memoizedProps)),r&&(r=da)){if(ID(t))throw dz(),Error(Ze(418));for(;r;)lz(t,r),r=ph(r.nextSibling)}if(s8(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ze(317));e:{for(t=t.nextSibling,r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"){if(r===0){da=ph(t.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++}t=t.nextSibling}da=null}}else da=ua?ph(t.stateNode.nextSibling):null;return!0}function dz(){for(var t=da;t;)t=ph(t.nextSibling)}function Mg(){da=ua=null,ui=!1}function O2(t){Lc===null?Lc=[t]:Lc.push(t)}var Yde=Bd.ReactCurrentBatchConfig;function xc(t,r){if(t&&t.defaultProps){r=Ci({},r),t=t.defaultProps;for(var o in t)r[o]===void 0&&(r[o]=t[o]);return r}return r}var Iw=Nh(null),Aw=null,tg=null,N2=null;function k2(){N2=tg=Aw=null}function x2(t){var r=Iw.current;Jr(Iw),t._currentValue=r}function OD(t,r,o){for(;t!==null;){var c=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),t===o)break;t=t.return}}function hg(t,r){Aw=t,N2=tg=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&r&&(Uo=!0),t.firstContext=null)}function Za(t){var r=t._currentValue;if(N2!==t)if(t={context:t,memoizedValue:r,next:null},tg===null){if(Aw===null)throw Error(Ze(308));tg=t,Aw.dependencies={lanes:0,firstContext:t}}else tg=tg.next=t;return r}var Op=null;function P2(t){Op===null?Op=[t]:Op.push(t)}function uz(t,r,o,c){var d=r.interleaved;return d===null?(o.next=o,P2(r)):(o.next=d.next,d.next=o),r.interleaved=o,Pd(t,c)}function Pd(t,r){t.lanes|=r;var o=t.alternate;for(o!==null&&(o.lanes|=r),o=t,t=t.return;t!==null;)t.childLanes|=r,o=t.alternate,o!==null&&(o.childLanes|=r),o=t,t=t.return;return o.tag===3?o.stateNode:null}var Ku=!1;function D2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hz(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Id(t,r){return{eventTime:t,lane:r,tag:0,payload:null,callback:null,next:null}}function fh(t,r,o){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,Jn&2){var d=c.pending;return d===null?r.next=r:(r.next=d.next,d.next=r),c.pending=r,Pd(t,o)}return d=c.interleaved,d===null?(r.next=r,P2(c)):(r.next=d.next,d.next=r),c.interleaved=r,Pd(t,o)}function YC(t,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194240)!==0)){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,v2(t,o)}}function o8(t,r){var o=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var d=null,h=null;if(o=o.firstBaseUpdate,o!==null){do{var f={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};h===null?d=h=f:h=h.next=f,o=o.next}while(o!==null);h===null?d=h=r:h=h.next=r}else d=h=r;o={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:h,shared:c.shared,effects:c.effects},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=r:t.next=r,o.lastBaseUpdate=r}function Ow(t,r,o,c){var d=t.updateQueue;Ku=!1;var h=d.firstBaseUpdate,f=d.lastBaseUpdate,_=d.shared.pending;if(_!==null){d.shared.pending=null;var v=_,b=v.next;v.next=null,f===null?h=b:f.next=b,f=v;var A=t.alternate;A!==null&&(A=A.updateQueue,_=A.lastBaseUpdate,_!==f&&(_===null?A.firstBaseUpdate=b:_.next=b,A.lastBaseUpdate=v))}if(h!==null){var w=d.baseState;f=0,A=b=v=null,_=h;do{var x=_.lane,M=_.eventTime;if((c&x)===x){A!==null&&(A=A.next={eventTime:M,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var V=t,G=_;switch(x=r,M=o,G.tag){case 1:if(V=G.payload,typeof V=="function"){w=V.call(M,w,x);break e}w=V;break e;case 3:V.flags=V.flags&-65537|128;case 0:if(V=G.payload,x=typeof V=="function"?V.call(M,w,x):V,x==null)break e;w=Ci({},w,x);break e;case 2:Ku=!0}}_.callback!==null&&_.lane!==0&&(t.flags|=64,x=d.effects,x===null?d.effects=[_]:x.push(_))}else M={eventTime:M,lane:x,tag:_.tag,payload:_.payload,callback:_.callback,next:null},A===null?(b=A=M,v=w):A=A.next=M,f|=x;if(_=_.next,_===null){if(_=d.shared.pending,_===null)break;x=_,_=x.next,x.next=null,d.lastBaseUpdate=x,d.shared.pending=null}}while(!0);if(A===null&&(v=w),d.baseState=v,d.firstBaseUpdate=b,d.lastBaseUpdate=A,r=d.shared.interleaved,r!==null){d=r;do f|=d.lane,d=d.next;while(d!==r)}else h===null&&(d.shared.lanes=0);qp|=f,t.lanes=f,t.memoizedState=w}}function a8(t,r,o){if(t=r.effects,r.effects=null,t!==null)for(r=0;r<t.length;r++){var c=t[r],d=c.callback;if(d!==null){if(c.callback=null,c=o,typeof d!="function")throw Error(Ze(191,d));d.call(c)}}}var pz=new u7.Component().refs;function ND(t,r,o,c){r=t.memoizedState,o=o(c,r),o=o==null?r:Ci({},r,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var SR={isMounted:function(t){return(t=t._reactInternals)?rf(t)===t:!1},enqueueSetState:function(t,r,o){t=t._reactInternals;var c=ho(),d=gh(t),h=Id(c,d);h.payload=r,o!=null&&(h.callback=o),r=fh(t,h,d),r!==null&&(jc(r,t,d,c),YC(r,t,d))},enqueueReplaceState:function(t,r,o){t=t._reactInternals;var c=ho(),d=gh(t),h=Id(c,d);h.tag=1,h.payload=r,o!=null&&(h.callback=o),r=fh(t,h,d),r!==null&&(jc(r,t,d,c),YC(r,t,d))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var o=ho(),c=gh(t),d=Id(o,c);d.tag=2,r!=null&&(d.callback=r),r=fh(t,d,c),r!==null&&(jc(r,t,c,o),YC(r,t,c))}};function c8(t,r,o,c,d,h,f){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,h,f):r.prototype&&r.prototype.isPureReactComponent?!Ey(o,c)||!Ey(d,h):!0}function fz(t,r,o){var c=!1,d=bh,h=r.contextType;return typeof h=="object"&&h!==null?h=Za(h):(d=Vo(r)?zp:Ys.current,c=r.contextTypes,h=(c=c!=null)?Lg(t,d):bh),r=new r(o,h),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=SR,t.stateNode=r,r._reactInternals=t,c&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=d,t.__reactInternalMemoizedMaskedChildContext=h),r}function l8(t,r,o,c){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==t&&SR.enqueueReplaceState(r,r.state,null)}function kD(t,r,o,c){var d=t.stateNode;d.props=o,d.state=t.memoizedState,d.refs=pz,D2(t);var h=r.contextType;typeof h=="object"&&h!==null?d.context=Za(h):(h=Vo(r)?zp:Ys.current,d.context=Lg(t,h)),d.state=t.memoizedState,h=r.getDerivedStateFromProps,typeof h=="function"&&(ND(t,r,h,o),d.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(r=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),r!==d.state&&SR.enqueueReplaceState(d,d.state,null),Ow(t,o,d,c),d.state=t.memoizedState),typeof d.componentDidMount=="function"&&(t.flags|=4194308)}function wv(t,r,o){if(t=o.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(Ze(309));var c=o.stateNode}if(!c)throw Error(Ze(147,t));var d=c,h=""+t;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===h?r.ref:(r=function(f){var _=d.refs;_===pz&&(_=d.refs={}),f===null?delete _[h]:_[h]=f},r._stringRef=h,r)}if(typeof t!="string")throw Error(Ze(284));if(!o._owner)throw Error(Ze(290,t))}return t}function mC(t,r){throw t=Object.prototype.toString.call(r),Error(Ze(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}function d8(t){var r=t._init;return r(t._payload)}function mz(t){function r(F,B){if(t){var L=F.deletions;L===null?(F.deletions=[B],F.flags|=16):L.push(B)}}function o(F,B){if(!t)return null;for(;B!==null;)r(F,B),B=B.sibling;return null}function c(F,B){for(F=new Map;B!==null;)B.key!==null?F.set(B.key,B):F.set(B.index,B),B=B.sibling;return F}function d(F,B){return F=_h(F,B),F.index=0,F.sibling=null,F}function h(F,B,L){return F.index=L,t?(L=F.alternate,L!==null?(L=L.index,L<B?(F.flags|=2,B):L):(F.flags|=2,B)):(F.flags|=1048576,B)}function f(F){return t&&F.alternate===null&&(F.flags|=2),F}function _(F,B,L,X){return B===null||B.tag!==6?(B=nP(L,F.mode,X),B.return=F,B):(B=d(B,L),B.return=F,B)}function v(F,B,L,X){var ee=L.type;return ee===Km?A(F,B,L.props.children,X,L.key):B!==null&&(B.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===zu&&d8(ee)===B.type)?(X=d(B,L.props),X.ref=wv(F,B,L),X.return=F,X):(X=ew(L.type,L.key,L.props,null,F.mode,X),X.ref=wv(F,B,L),X.return=F,X)}function b(F,B,L,X){return B===null||B.tag!==4||B.stateNode.containerInfo!==L.containerInfo||B.stateNode.implementation!==L.implementation?(B=rP(L,F.mode,X),B.return=F,B):(B=d(B,L.children||[]),B.return=F,B)}function A(F,B,L,X,ee){return B===null||B.tag!==7?(B=Hp(L,F.mode,X,ee),B.return=F,B):(B=d(B,L),B.return=F,B)}function w(F,B,L){if(typeof B=="string"&&B!==""||typeof B=="number")return B=nP(""+B,F.mode,L),B.return=F,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case iC:return L=ew(B.type,B.key,B.props,null,F.mode,L),L.ref=wv(F,null,B),L.return=F,L;case zm:return B=rP(B,F.mode,L),B.return=F,B;case zu:var X=B._init;return w(F,X(B._payload),L)}if(jv(B)||yv(B))return B=Hp(B,F.mode,L,null),B.return=F,B;mC(F,B)}return null}function x(F,B,L,X){var ee=B!==null?B.key:null;if(typeof L=="string"&&L!==""||typeof L=="number")return ee!==null?null:_(F,B,""+L,X);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case iC:return L.key===ee?v(F,B,L,X):null;case zm:return L.key===ee?b(F,B,L,X):null;case zu:return ee=L._init,x(F,B,ee(L._payload),X)}if(jv(L)||yv(L))return ee!==null?null:A(F,B,L,X,null);mC(F,L)}return null}function M(F,B,L,X,ee){if(typeof X=="string"&&X!==""||typeof X=="number")return F=F.get(L)||null,_(B,F,""+X,ee);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case iC:return F=F.get(X.key===null?L:X.key)||null,v(B,F,X,ee);case zm:return F=F.get(X.key===null?L:X.key)||null,b(B,F,X,ee);case zu:var ce=X._init;return M(F,B,L,ce(X._payload),ee)}if(jv(X)||yv(X))return F=F.get(L)||null,A(B,F,X,ee,null);mC(B,X)}return null}function V(F,B,L,X){for(var ee=null,ce=null,ie=B,ne=B=0,fe=null;ie!==null&&ne<L.length;ne++){ie.index>ne?(fe=ie,ie=null):fe=ie.sibling;var oe=x(F,ie,L[ne],X);if(oe===null){ie===null&&(ie=fe);break}t&&ie&&oe.alternate===null&&r(F,ie),B=h(oe,B,ne),ce===null?ee=oe:ce.sibling=oe,ce=oe,ie=fe}if(ne===L.length)return o(F,ie),ui&&Tp(F,ne),ee;if(ie===null){for(;ne<L.length;ne++)ie=w(F,L[ne],X),ie!==null&&(B=h(ie,B,ne),ce===null?ee=ie:ce.sibling=ie,ce=ie);return ui&&Tp(F,ne),ee}for(ie=c(F,ie);ne<L.length;ne++)fe=M(ie,F,ne,L[ne],X),fe!==null&&(t&&fe.alternate!==null&&ie.delete(fe.key===null?ne:fe.key),B=h(fe,B,ne),ce===null?ee=fe:ce.sibling=fe,ce=fe);return t&&ie.forEach(function(ue){return r(F,ue)}),ui&&Tp(F,ne),ee}function G(F,B,L,X){var ee=yv(L);if(typeof ee!="function")throw Error(Ze(150));if(L=ee.call(L),L==null)throw Error(Ze(151));for(var ce=ee=null,ie=B,ne=B=0,fe=null,oe=L.next();ie!==null&&!oe.done;ne++,oe=L.next()){ie.index>ne?(fe=ie,ie=null):fe=ie.sibling;var ue=x(F,ie,oe.value,X);if(ue===null){ie===null&&(ie=fe);break}t&&ie&&ue.alternate===null&&r(F,ie),B=h(ue,B,ne),ce===null?ee=ue:ce.sibling=ue,ce=ue,ie=fe}if(oe.done)return o(F,ie),ui&&Tp(F,ne),ee;if(ie===null){for(;!oe.done;ne++,oe=L.next())oe=w(F,oe.value,X),oe!==null&&(B=h(oe,B,ne),ce===null?ee=oe:ce.sibling=oe,ce=oe);return ui&&Tp(F,ne),ee}for(ie=c(F,ie);!oe.done;ne++,oe=L.next())oe=M(ie,F,ne,oe.value,X),oe!==null&&(t&&oe.alternate!==null&&ie.delete(oe.key===null?ne:oe.key),B=h(oe,B,ne),ce===null?ee=oe:ce.sibling=oe,ce=oe);return t&&ie.forEach(function(Ne){return r(F,Ne)}),ui&&Tp(F,ne),ee}function H(F,B,L,X){if(typeof L=="object"&&L!==null&&L.type===Km&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case iC:e:{for(var ee=L.key,ce=B;ce!==null;){if(ce.key===ee){if(ee=L.type,ee===Km){if(ce.tag===7){o(F,ce.sibling),B=d(ce,L.props.children),B.return=F,F=B;break e}}else if(ce.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===zu&&d8(ee)===ce.type){o(F,ce.sibling),B=d(ce,L.props),B.ref=wv(F,ce,L),B.return=F,F=B;break e}o(F,ce);break}else r(F,ce);ce=ce.sibling}L.type===Km?(B=Hp(L.props.children,F.mode,X,L.key),B.return=F,F=B):(X=ew(L.type,L.key,L.props,null,F.mode,X),X.ref=wv(F,B,L),X.return=F,F=X)}return f(F);case zm:e:{for(ce=L.key;B!==null;){if(B.key===ce)if(B.tag===4&&B.stateNode.containerInfo===L.containerInfo&&B.stateNode.implementation===L.implementation){o(F,B.sibling),B=d(B,L.children||[]),B.return=F,F=B;break e}else{o(F,B);break}else r(F,B);B=B.sibling}B=rP(L,F.mode,X),B.return=F,F=B}return f(F);case zu:return ce=L._init,H(F,B,ce(L._payload),X)}if(jv(L))return V(F,B,L,X);if(yv(L))return G(F,B,L,X);mC(F,L)}return typeof L=="string"&&L!==""||typeof L=="number"?(L=""+L,B!==null&&B.tag===6?(o(F,B.sibling),B=d(B,L),B.return=F,F=B):(o(F,B),B=nP(L,F.mode,X),B.return=F,F=B),f(F)):o(F,B)}return H}var Ug=mz(!0),gz=mz(!1),l0={},xl=Nh(l0),by=Nh(l0),Ty=Nh(l0);function Np(t){if(t===l0)throw Error(Ze(174));return t}function L2(t,r){switch($r(Ty,r),$r(by,t),$r(xl,l0),t=r.nodeType,t){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:lD(null,"");break;default:t=t===8?r.parentNode:r,r=t.namespaceURI||null,t=t.tagName,r=lD(r,t)}Jr(xl),$r(xl,r)}function jg(){Jr(xl),Jr(by),Jr(Ty)}function _z(t){Np(Ty.current);var r=Np(xl.current),o=lD(r,t.type);r!==o&&($r(by,t),$r(xl,o))}function M2(t){by.current===t&&(Jr(xl),Jr(by))}var bi=Nh(0);function Nw(t){for(var r=t;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Xx=[];function U2(){for(var t=0;t<Xx.length;t++)Xx[t]._workInProgressVersionPrimary=null;Xx.length=0}var qC=Bd.ReactCurrentDispatcher,Jx=Bd.ReactCurrentBatchConfig,Yp=0,Ti=null,is=null,ms=null,kw=!1,Zv=!1,Cy=0,qde=0;function $s(){throw Error(Ze(321))}function j2(t,r){if(r===null)return!1;for(var o=0;o<r.length&&o<t.length;o++)if(!Vc(t[o],r[o]))return!1;return!0}function F2(t,r,o,c,d,h){if(Yp=h,Ti=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,qC.current=t===null||t.memoizedState===null?Zde:eue,t=o(c,d),Zv){h=0;do{if(Zv=!1,Cy=0,25<=h)throw Error(Ze(301));h+=1,ms=is=null,r.updateQueue=null,qC.current=tue,t=o(c,d)}while(Zv)}if(qC.current=xw,r=is!==null&&is.next!==null,Yp=0,ms=is=Ti=null,kw=!1,r)throw Error(Ze(300));return t}function V2(){var t=Cy!==0;return Cy=0,t}function Sl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ms===null?Ti.memoizedState=ms=t:ms=ms.next=t,ms}function ec(){if(is===null){var t=Ti.alternate;t=t!==null?t.memoizedState:null}else t=is.next;var r=ms===null?Ti.memoizedState:ms.next;if(r!==null)ms=r,is=t;else{if(t===null)throw Error(Ze(310));is=t,t={memoizedState:is.memoizedState,baseState:is.baseState,baseQueue:is.baseQueue,queue:is.queue,next:null},ms===null?Ti.memoizedState=ms=t:ms=ms.next=t}return ms}function wy(t,r){return typeof r=="function"?r(t):r}function Qx(t){var r=ec(),o=r.queue;if(o===null)throw Error(Ze(311));o.lastRenderedReducer=t;var c=is,d=c.baseQueue,h=o.pending;if(h!==null){if(d!==null){var f=d.next;d.next=h.next,h.next=f}c.baseQueue=d=h,o.pending=null}if(d!==null){h=d.next,c=c.baseState;var _=f=null,v=null,b=h;do{var A=b.lane;if((Yp&A)===A)v!==null&&(v=v.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),c=b.hasEagerState?b.eagerState:t(c,b.action);else{var w={lane:A,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};v===null?(_=v=w,f=c):v=v.next=w,Ti.lanes|=A,qp|=A}b=b.next}while(b!==null&&b!==h);v===null?f=c:v.next=_,Vc(c,r.memoizedState)||(Uo=!0),r.memoizedState=c,r.baseState=f,r.baseQueue=v,o.lastRenderedState=c}if(t=o.interleaved,t!==null){d=t;do h=d.lane,Ti.lanes|=h,qp|=h,d=d.next;while(d!==t)}else d===null&&(o.lanes=0);return[r.memoizedState,o.dispatch]}function Zx(t){var r=ec(),o=r.queue;if(o===null)throw Error(Ze(311));o.lastRenderedReducer=t;var c=o.dispatch,d=o.pending,h=r.memoizedState;if(d!==null){o.pending=null;var f=d=d.next;do h=t(h,f.action),f=f.next;while(f!==d);Vc(h,r.memoizedState)||(Uo=!0),r.memoizedState=h,r.baseQueue===null&&(r.baseState=h),o.lastRenderedState=h}return[h,c]}function Ez(){}function vz(t,r){var o=Ti,c=ec(),d=r(),h=!Vc(c.memoizedState,d);if(h&&(c.memoizedState=d,Uo=!0),c=c.queue,B2(bz.bind(null,o,c,t),[t]),c.getSnapshot!==r||h||ms!==null&&ms.memoizedState.tag&1){if(o.flags|=2048,Ry(9,Sz.bind(null,o,c,d,r),void 0,null),gs===null)throw Error(Ze(349));Yp&30||yz(o,r,d)}return d}function yz(t,r,o){t.flags|=16384,t={getSnapshot:r,value:o},r=Ti.updateQueue,r===null?(r={lastEffect:null,stores:null},Ti.updateQueue=r,r.stores=[t]):(o=r.stores,o===null?r.stores=[t]:o.push(t))}function Sz(t,r,o,c){r.value=o,r.getSnapshot=c,Tz(r)&&Cz(t)}function bz(t,r,o){return o(function(){Tz(r)&&Cz(t)})}function Tz(t){var r=t.getSnapshot;t=t.value;try{var o=r();return!Vc(t,o)}catch{return!0}}function Cz(t){var r=Pd(t,1);r!==null&&jc(r,t,1,-1)}function u8(t){var r=Sl();return typeof t=="function"&&(t=t()),r.memoizedState=r.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wy,lastRenderedState:t},r.queue=t,t=t.dispatch=Qde.bind(null,Ti,t),[r.memoizedState,t]}function Ry(t,r,o,c){return t={tag:t,create:r,destroy:o,deps:c,next:null},r=Ti.updateQueue,r===null?(r={lastEffect:null,stores:null},Ti.updateQueue=r,r.lastEffect=t.next=t):(o=r.lastEffect,o===null?r.lastEffect=t.next=t:(c=o.next,o.next=t,t.next=c,r.lastEffect=t)),t}function wz(){return ec().memoizedState}function XC(t,r,o,c){var d=Sl();Ti.flags|=t,d.memoizedState=Ry(1|r,o,void 0,c===void 0?null:c)}function bR(t,r,o,c){var d=ec();c=c===void 0?null:c;var h=void 0;if(is!==null){var f=is.memoizedState;if(h=f.destroy,c!==null&&j2(c,f.deps)){d.memoizedState=Ry(r,o,h,c);return}}Ti.flags|=t,d.memoizedState=Ry(1|r,o,h,c)}function h8(t,r){return XC(8390656,8,t,r)}function B2(t,r){return bR(2048,8,t,r)}function Rz(t,r){return bR(4,2,t,r)}function Iz(t,r){return bR(4,4,t,r)}function Az(t,r){if(typeof r=="function")return t=t(),r(t),function(){r(null)};if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function Oz(t,r,o){return o=o!=null?o.concat([t]):null,bR(4,4,Az.bind(null,r,t),o)}function W2(){}function Nz(t,r){var o=ec();r=r===void 0?null:r;var c=o.memoizedState;return c!==null&&r!==null&&j2(r,c[1])?c[0]:(o.memoizedState=[t,r],t)}function kz(t,r){var o=ec();r=r===void 0?null:r;var c=o.memoizedState;return c!==null&&r!==null&&j2(r,c[1])?c[0]:(t=t(),o.memoizedState=[t,r],t)}function xz(t,r,o){return Yp&21?(Vc(o,r)||(o=L7(),Ti.lanes|=o,qp|=o,t.baseState=!0),r):(t.baseState&&(t.baseState=!1,Uo=!0),t.memoizedState=o)}function Xde(t,r){var o=vr;vr=o!==0&&4>o?o:4,t(!0);var c=Jx.transition;Jx.transition={};try{t(!1),r()}finally{vr=o,Jx.transition=c}}function Pz(){return ec().memoizedState}function Jde(t,r,o){var c=gh(t);if(o={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null},Dz(t))Lz(r,o);else if(o=uz(t,r,o,c),o!==null){var d=ho();jc(o,t,c,d),Mz(o,r,c)}}function Qde(t,r,o){var c=gh(t),d={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null};if(Dz(t))Lz(r,d);else{var h=t.alternate;if(t.lanes===0&&(h===null||h.lanes===0)&&(h=r.lastRenderedReducer,h!==null))try{var f=r.lastRenderedState,_=h(f,o);if(d.hasEagerState=!0,d.eagerState=_,Vc(_,f)){var v=r.interleaved;v===null?(d.next=d,P2(r)):(d.next=v.next,v.next=d),r.interleaved=d;return}}catch{}finally{}o=uz(t,r,d,c),o!==null&&(d=ho(),jc(o,t,c,d),Mz(o,r,c))}}function Dz(t){var r=t.alternate;return t===Ti||r!==null&&r===Ti}function Lz(t,r){Zv=kw=!0;var o=t.pending;o===null?r.next=r:(r.next=o.next,o.next=r),t.pending=r}function Mz(t,r,o){if(o&4194240){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,v2(t,o)}}var xw={readContext:Za,useCallback:$s,useContext:$s,useEffect:$s,useImperativeHandle:$s,useInsertionEffect:$s,useLayoutEffect:$s,useMemo:$s,useReducer:$s,useRef:$s,useState:$s,useDebugValue:$s,useDeferredValue:$s,useTransition:$s,useMutableSource:$s,useSyncExternalStore:$s,useId:$s,unstable_isNewReconciler:!1},Zde={readContext:Za,useCallback:function(t,r){return Sl().memoizedState=[t,r===void 0?null:r],t},useContext:Za,useEffect:h8,useImperativeHandle:function(t,r,o){return o=o!=null?o.concat([t]):null,XC(4194308,4,Az.bind(null,r,t),o)},useLayoutEffect:function(t,r){return XC(4194308,4,t,r)},useInsertionEffect:function(t,r){return XC(4,2,t,r)},useMemo:function(t,r){var o=Sl();return r=r===void 0?null:r,t=t(),o.memoizedState=[t,r],t},useReducer:function(t,r,o){var c=Sl();return r=o!==void 0?o(r):r,c.memoizedState=c.baseState=r,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},c.queue=t,t=t.dispatch=Jde.bind(null,Ti,t),[c.memoizedState,t]},useRef:function(t){var r=Sl();return t={current:t},r.memoizedState=t},useState:u8,useDebugValue:W2,useDeferredValue:function(t){return Sl().memoizedState=t},useTransition:function(){var t=u8(!1),r=t[0];return t=Xde.bind(null,t[1]),Sl().memoizedState=t,[r,t]},useMutableSource:function(){},useSyncExternalStore:function(t,r,o){var c=Ti,d=Sl();if(ui){if(o===void 0)throw Error(Ze(407));o=o()}else{if(o=r(),gs===null)throw Error(Ze(349));Yp&30||yz(c,r,o)}d.memoizedState=o;var h={value:o,getSnapshot:r};return d.queue=h,h8(bz.bind(null,c,h,t),[t]),c.flags|=2048,Ry(9,Sz.bind(null,c,h,o,r),void 0,null),o},useId:function(){var t=Sl(),r=gs.identifierPrefix;if(ui){var o=Rd,c=wd;o=(c&~(1<<32-Uc(c)-1)).toString(32)+o,r=":"+r+"R"+o,o=Cy++,0<o&&(r+="H"+o.toString(32)),r+=":"}else o=qde++,r=":"+r+"r"+o.toString(32)+":";return t.memoizedState=r},unstable_isNewReconciler:!1},eue={readContext:Za,useCallback:Nz,useContext:Za,useEffect:B2,useImperativeHandle:Oz,useInsertionEffect:Rz,useLayoutEffect:Iz,useMemo:kz,useReducer:Qx,useRef:wz,useState:function(){return Qx(wy)},useDebugValue:W2,useDeferredValue:function(t){var r=ec();return xz(r,is.memoizedState,t)},useTransition:function(){var t=Qx(wy)[0],r=ec().memoizedState;return[t,r]},useMutableSource:Ez,useSyncExternalStore:vz,useId:Pz,unstable_isNewReconciler:!1},tue={readContext:Za,useCallback:Nz,useContext:Za,useEffect:B2,useImperativeHandle:Oz,useInsertionEffect:Rz,useLayoutEffect:Iz,useMemo:kz,useReducer:Zx,useRef:wz,useState:function(){return Zx(wy)},useDebugValue:W2,useDeferredValue:function(t){var r=ec();return is===null?r.memoizedState=t:xz(r,is.memoizedState,t)},useTransition:function(){var t=Zx(wy)[0],r=ec().memoizedState;return[t,r]},useMutableSource:Ez,useSyncExternalStore:vz,useId:Pz,unstable_isNewReconciler:!1};function Fg(t,r){try{var o="",c=r;do o+=Ole(c),c=c.return;while(c);var d=o}catch(h){d=`
Error generating stack: `+h.message+`
`+h.stack}return{value:t,source:r,stack:d,digest:null}}function eP(t,r,o){return{value:t,source:null,stack:o??null,digest:r??null}}function xD(t,r){try{console.error(r.value)}catch(o){setTimeout(function(){throw o})}}var nue=typeof WeakMap=="function"?WeakMap:Map;function Uz(t,r,o){o=Id(-1,o),o.tag=3,o.payload={element:null};var c=r.value;return o.callback=function(){Dw||(Dw=!0,WD=c),xD(t,r)},o}function jz(t,r,o){o=Id(-1,o),o.tag=3;var c=t.type.getDerivedStateFromError;if(typeof c=="function"){var d=r.value;o.payload=function(){return c(d)},o.callback=function(){xD(t,r)}}var h=t.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(o.callback=function(){xD(t,r),typeof c!="function"&&(mh===null?mh=new Set([this]):mh.add(this));var f=r.stack;this.componentDidCatch(r.value,{componentStack:f!==null?f:""})}),o}function p8(t,r,o){var c=t.pingCache;if(c===null){c=t.pingCache=new nue;var d=new Set;c.set(r,d)}else d=c.get(r),d===void 0&&(d=new Set,c.set(r,d));d.has(o)||(d.add(o),t=gue.bind(null,t,r,o),r.then(t,t))}function f8(t){do{var r;if((r=t.tag===13)&&(r=t.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return t;t=t.return}while(t!==null);return null}function m8(t,r,o,c,d){return t.mode&1?(t.flags|=65536,t.lanes=d,t):(t===r?t.flags|=65536:(t.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(r=Id(-1,1),r.tag=2,fh(o,r,1))),o.lanes|=1),t)}var rue=Bd.ReactCurrentOwner,Uo=!1;function lo(t,r,o,c){r.child=t===null?gz(r,null,o,c):Ug(r,t.child,o,c)}function g8(t,r,o,c,d){o=o.render;var h=r.ref;return hg(r,d),c=F2(t,r,o,c,h,d),o=V2(),t!==null&&!Uo?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~d,Dd(t,r,d)):(ui&&o&&I2(r),r.flags|=1,lo(t,r,c,d),r.child)}function _8(t,r,o,c,d){if(t===null){var h=o.type;return typeof h=="function"&&!X2(h)&&h.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(r.tag=15,r.type=h,Fz(t,r,h,c,d)):(t=ew(o.type,null,c,r,r.mode,d),t.ref=r.ref,t.return=r,r.child=t)}if(h=t.child,!(t.lanes&d)){var f=h.memoizedProps;if(o=o.compare,o=o!==null?o:Ey,o(f,c)&&t.ref===r.ref)return Dd(t,r,d)}return r.flags|=1,t=_h(h,c),t.ref=r.ref,t.return=r,r.child=t}function Fz(t,r,o,c,d){if(t!==null){var h=t.memoizedProps;if(Ey(h,c)&&t.ref===r.ref)if(Uo=!1,r.pendingProps=c=h,(t.lanes&d)!==0)t.flags&131072&&(Uo=!0);else return r.lanes=t.lanes,Dd(t,r,d)}return PD(t,r,o,c,d)}function Vz(t,r,o){var c=r.pendingProps,d=c.children,h=t!==null?t.memoizedState:null;if(c.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},$r(rg,oa),oa|=o;else{if(!(o&1073741824))return t=h!==null?h.baseLanes|o:o,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:t,cachePool:null,transitions:null},r.updateQueue=null,$r(rg,oa),oa|=t,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=h!==null?h.baseLanes:o,$r(rg,oa),oa|=c}else h!==null?(c=h.baseLanes|o,r.memoizedState=null):c=o,$r(rg,oa),oa|=c;return lo(t,r,d,o),r.child}function Bz(t,r){var o=r.ref;(t===null&&o!==null||t!==null&&t.ref!==o)&&(r.flags|=512,r.flags|=2097152)}function PD(t,r,o,c,d){var h=Vo(o)?zp:Ys.current;return h=Lg(r,h),hg(r,d),o=F2(t,r,o,c,h,d),c=V2(),t!==null&&!Uo?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~d,Dd(t,r,d)):(ui&&c&&I2(r),r.flags|=1,lo(t,r,o,d),r.child)}function E8(t,r,o,c,d){if(Vo(o)){var h=!0;Cw(r)}else h=!1;if(hg(r,d),r.stateNode===null)JC(t,r),fz(r,o,c),kD(r,o,c,d),c=!0;else if(t===null){var f=r.stateNode,_=r.memoizedProps;f.props=_;var v=f.context,b=o.contextType;typeof b=="object"&&b!==null?b=Za(b):(b=Vo(o)?zp:Ys.current,b=Lg(r,b));var A=o.getDerivedStateFromProps,w=typeof A=="function"||typeof f.getSnapshotBeforeUpdate=="function";w||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(_!==c||v!==b)&&l8(r,f,c,b),Ku=!1;var x=r.memoizedState;f.state=x,Ow(r,c,f,d),v=r.memoizedState,_!==c||x!==v||Fo.current||Ku?(typeof A=="function"&&(ND(r,o,A,c),v=r.memoizedState),(_=Ku||c8(r,o,_,c,x,v,b))?(w||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(r.flags|=4194308)):(typeof f.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=v),f.props=c,f.state=v,f.context=b,c=_):(typeof f.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{f=r.stateNode,hz(t,r),_=r.memoizedProps,b=r.type===r.elementType?_:xc(r.type,_),f.props=b,w=r.pendingProps,x=f.context,v=o.contextType,typeof v=="object"&&v!==null?v=Za(v):(v=Vo(o)?zp:Ys.current,v=Lg(r,v));var M=o.getDerivedStateFromProps;(A=typeof M=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(_!==w||x!==v)&&l8(r,f,c,v),Ku=!1,x=r.memoizedState,f.state=x,Ow(r,c,f,d);var V=r.memoizedState;_!==w||x!==V||Fo.current||Ku?(typeof M=="function"&&(ND(r,o,M,c),V=r.memoizedState),(b=Ku||c8(r,o,b,c,x,V,v)||!1)?(A||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,V,v),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,V,v)),typeof f.componentDidUpdate=="function"&&(r.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof f.componentDidUpdate!="function"||_===t.memoizedProps&&x===t.memoizedState||(r.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||_===t.memoizedProps&&x===t.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=V),f.props=c,f.state=V,f.context=v,c=b):(typeof f.componentDidUpdate!="function"||_===t.memoizedProps&&x===t.memoizedState||(r.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||_===t.memoizedProps&&x===t.memoizedState||(r.flags|=1024),c=!1)}return DD(t,r,o,c,h,d)}function DD(t,r,o,c,d,h){Bz(t,r);var f=(r.flags&128)!==0;if(!c&&!f)return d&&r8(r,o,!1),Dd(t,r,h);c=r.stateNode,rue.current=r;var _=f&&typeof o.getDerivedStateFromError!="function"?null:c.render();return r.flags|=1,t!==null&&f?(r.child=Ug(r,t.child,null,h),r.child=Ug(r,null,_,h)):lo(t,r,_,h),r.memoizedState=c.state,d&&r8(r,o,!0),r.child}function Wz(t){var r=t.stateNode;r.pendingContext?n8(t,r.pendingContext,r.pendingContext!==r.context):r.context&&n8(t,r.context,!1),L2(t,r.containerInfo)}function v8(t,r,o,c,d){return Mg(),O2(d),r.flags|=256,lo(t,r,o,c),r.child}var LD={dehydrated:null,treeContext:null,retryLane:0};function MD(t){return{baseLanes:t,cachePool:null,transitions:null}}function $z(t,r,o){var c=r.pendingProps,d=bi.current,h=!1,f=(r.flags&128)!==0,_;if((_=f)||(_=t!==null&&t.memoizedState===null?!1:(d&2)!==0),_?(h=!0,r.flags&=-129):(t===null||t.memoizedState!==null)&&(d|=1),$r(bi,d&1),t===null)return AD(r),t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(r.mode&1?t.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(f=c.children,t=c.fallback,h?(c=r.mode,h=r.child,f={mode:"hidden",children:f},!(c&1)&&h!==null?(h.childLanes=0,h.pendingProps=f):h=wR(f,c,0,null),t=Hp(t,c,o,null),h.return=r,t.return=r,h.sibling=t,r.child=h,r.child.memoizedState=MD(o),r.memoizedState=LD,t):$2(r,f));if(d=t.memoizedState,d!==null&&(_=d.dehydrated,_!==null))return iue(t,r,f,c,_,d,o);if(h){h=c.fallback,f=r.mode,d=t.child,_=d.sibling;var v={mode:"hidden",children:c.children};return!(f&1)&&r.child!==d?(c=r.child,c.childLanes=0,c.pendingProps=v,r.deletions=null):(c=_h(d,v),c.subtreeFlags=d.subtreeFlags&14680064),_!==null?h=_h(_,h):(h=Hp(h,f,o,null),h.flags|=2),h.return=r,c.return=r,c.sibling=h,r.child=c,c=h,h=r.child,f=t.child.memoizedState,f=f===null?MD(o):{baseLanes:f.baseLanes|o,cachePool:null,transitions:f.transitions},h.memoizedState=f,h.childLanes=t.childLanes&~o,r.memoizedState=LD,c}return h=t.child,t=h.sibling,c=_h(h,{mode:"visible",children:c.children}),!(r.mode&1)&&(c.lanes=o),c.return=r,c.sibling=null,t!==null&&(o=r.deletions,o===null?(r.deletions=[t],r.flags|=16):o.push(t)),r.child=c,r.memoizedState=null,c}function $2(t,r){return r=wR({mode:"visible",children:r},t.mode,0,null),r.return=t,t.child=r}function gC(t,r,o,c){return c!==null&&O2(c),Ug(r,t.child,null,o),t=$2(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function iue(t,r,o,c,d,h,f){if(o)return r.flags&256?(r.flags&=-257,c=eP(Error(Ze(422))),gC(t,r,f,c)):r.memoizedState!==null?(r.child=t.child,r.flags|=128,null):(h=c.fallback,d=r.mode,c=wR({mode:"visible",children:c.children},d,0,null),h=Hp(h,d,f,null),h.flags|=2,c.return=r,h.return=r,c.sibling=h,r.child=c,r.mode&1&&Ug(r,t.child,null,f),r.child.memoizedState=MD(f),r.memoizedState=LD,h);if(!(r.mode&1))return gC(t,r,f,null);if(d.data==="$!"){if(c=d.nextSibling&&d.nextSibling.dataset,c)var _=c.dgst;return c=_,h=Error(Ze(419)),c=eP(h,c,void 0),gC(t,r,f,c)}if(_=(f&t.childLanes)!==0,Uo||_){if(c=gs,c!==null){switch(f&-f){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(c.suspendedLanes|f)?0:d,d!==0&&d!==h.retryLane&&(h.retryLane=d,Pd(t,d),jc(c,t,d,-1))}return q2(),c=eP(Error(Ze(421))),gC(t,r,f,c)}return d.data==="$?"?(r.flags|=128,r.child=t.child,r=_ue.bind(null,t),d._reactRetry=r,null):(t=h.treeContext,da=ph(d.nextSibling),ua=r,ui=!0,Lc=null,t!==null&&(Ka[Ya++]=wd,Ka[Ya++]=Rd,Ka[Ya++]=Kp,wd=t.id,Rd=t.overflow,Kp=r),r=$2(r,c.children),r.flags|=4096,r)}function y8(t,r,o){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r),OD(t.return,r,o)}function tP(t,r,o,c,d){var h=t.memoizedState;h===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:d}:(h.isBackwards=r,h.rendering=null,h.renderingStartTime=0,h.last=c,h.tail=o,h.tailMode=d)}function Gz(t,r,o){var c=r.pendingProps,d=c.revealOrder,h=c.tail;if(lo(t,r,c.children,o),c=bi.current,c&2)c=c&1|2,r.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&y8(t,o,r);else if(t.tag===19)y8(t,o,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}c&=1}if($r(bi,c),!(r.mode&1))r.memoizedState=null;else switch(d){case"forwards":for(o=r.child,d=null;o!==null;)t=o.alternate,t!==null&&Nw(t)===null&&(d=o),o=o.sibling;o=d,o===null?(d=r.child,r.child=null):(d=o.sibling,o.sibling=null),tP(r,!1,d,o,h);break;case"backwards":for(o=null,d=r.child,r.child=null;d!==null;){if(t=d.alternate,t!==null&&Nw(t)===null){r.child=d;break}t=d.sibling,d.sibling=o,o=d,d=t}tP(r,!0,o,null,h);break;case"together":tP(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function JC(t,r){!(r.mode&1)&&t!==null&&(t.alternate=null,r.alternate=null,r.flags|=2)}function Dd(t,r,o){if(t!==null&&(r.dependencies=t.dependencies),qp|=r.lanes,!(o&r.childLanes))return null;if(t!==null&&r.child!==t.child)throw Error(Ze(153));if(r.child!==null){for(t=r.child,o=_h(t,t.pendingProps),r.child=o,o.return=r;t.sibling!==null;)t=t.sibling,o=o.sibling=_h(t,t.pendingProps),o.return=r;o.sibling=null}return r.child}function sue(t,r,o){switch(r.tag){case 3:Wz(r),Mg();break;case 5:_z(r);break;case 1:Vo(r.type)&&Cw(r);break;case 4:L2(r,r.stateNode.containerInfo);break;case 10:var c=r.type._context,d=r.memoizedProps.value;$r(Iw,c._currentValue),c._currentValue=d;break;case 13:if(c=r.memoizedState,c!==null)return c.dehydrated!==null?($r(bi,bi.current&1),r.flags|=128,null):o&r.child.childLanes?$z(t,r,o):($r(bi,bi.current&1),t=Dd(t,r,o),t!==null?t.sibling:null);$r(bi,bi.current&1);break;case 19:if(c=(o&r.childLanes)!==0,t.flags&128){if(c)return Gz(t,r,o);r.flags|=128}if(d=r.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),$r(bi,bi.current),c)break;return null;case 22:case 23:return r.lanes=0,Vz(t,r,o)}return Dd(t,r,o)}var Hz,UD,zz,Kz;Hz=function(t,r){for(var o=r.child;o!==null;){if(o.tag===5||o.tag===6)t.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};UD=function(){};zz=function(t,r,o,c){var d=t.memoizedProps;if(d!==c){t=r.stateNode,Np(xl.current);var h=null;switch(o){case"input":d=sD(t,d),c=sD(t,c),h=[];break;case"select":d=Ci({},d,{value:void 0}),c=Ci({},c,{value:void 0}),h=[];break;case"textarea":d=cD(t,d),c=cD(t,c),h=[];break;default:typeof d.onClick!="function"&&typeof c.onClick=="function"&&(t.onclick=bw)}dD(o,c);var f;o=null;for(b in d)if(!c.hasOwnProperty(b)&&d.hasOwnProperty(b)&&d[b]!=null)if(b==="style"){var _=d[b];for(f in _)_.hasOwnProperty(f)&&(o||(o={}),o[f]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(uy.hasOwnProperty(b)?h||(h=[]):(h=h||[]).push(b,null));for(b in c){var v=c[b];if(_=d!=null?d[b]:void 0,c.hasOwnProperty(b)&&v!==_&&(v!=null||_!=null))if(b==="style")if(_){for(f in _)!_.hasOwnProperty(f)||v&&v.hasOwnProperty(f)||(o||(o={}),o[f]="");for(f in v)v.hasOwnProperty(f)&&_[f]!==v[f]&&(o||(o={}),o[f]=v[f])}else o||(h||(h=[]),h.push(b,o)),o=v;else b==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,_=_?_.__html:void 0,v!=null&&_!==v&&(h=h||[]).push(b,v)):b==="children"?typeof v!="string"&&typeof v!="number"||(h=h||[]).push(b,""+v):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(uy.hasOwnProperty(b)?(v!=null&&b==="onScroll"&&qr("scroll",t),h||_===v||(h=[])):(h=h||[]).push(b,v))}o&&(h=h||[]).push("style",o);var b=h;(r.updateQueue=b)&&(r.flags|=4)}};Kz=function(t,r,o,c){o!==c&&(r.flags|=4)};function Rv(t,r){if(!ui)switch(t.tailMode){case"hidden":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Gs(t){var r=t.alternate!==null&&t.alternate.child===t.child,o=0,c=0;if(r)for(var d=t.child;d!==null;)o|=d.lanes|d.childLanes,c|=d.subtreeFlags&14680064,c|=d.flags&14680064,d.return=t,d=d.sibling;else for(d=t.child;d!==null;)o|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=t,d=d.sibling;return t.subtreeFlags|=c,t.childLanes=o,r}function oue(t,r,o){var c=r.pendingProps;switch(A2(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(r),null;case 1:return Vo(r.type)&&Tw(),Gs(r),null;case 3:return c=r.stateNode,jg(),Jr(Fo),Jr(Ys),U2(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(t===null||t.child===null)&&(fC(r)?r.flags|=4:t===null||t.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Lc!==null&&(HD(Lc),Lc=null))),UD(t,r),Gs(r),null;case 5:M2(r);var d=Np(Ty.current);if(o=r.type,t!==null&&r.stateNode!=null)zz(t,r,o,c,d),t.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!c){if(r.stateNode===null)throw Error(Ze(166));return Gs(r),null}if(t=Np(xl.current),fC(r)){c=r.stateNode,o=r.type;var h=r.memoizedProps;switch(c[Al]=r,c[Sy]=h,t=(r.mode&1)!==0,o){case"dialog":qr("cancel",c),qr("close",c);break;case"iframe":case"object":case"embed":qr("load",c);break;case"video":case"audio":for(d=0;d<Vv.length;d++)qr(Vv[d],c);break;case"source":qr("error",c);break;case"img":case"image":case"link":qr("error",c),qr("load",c);break;case"details":qr("toggle",c);break;case"input":OW(c,h),qr("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!h.multiple},qr("invalid",c);break;case"textarea":kW(c,h),qr("invalid",c)}dD(o,h),d=null;for(var f in h)if(h.hasOwnProperty(f)){var _=h[f];f==="children"?typeof _=="string"?c.textContent!==_&&(h.suppressHydrationWarning!==!0&&pC(c.textContent,_,t),d=["children",_]):typeof _=="number"&&c.textContent!==""+_&&(h.suppressHydrationWarning!==!0&&pC(c.textContent,_,t),d=["children",""+_]):uy.hasOwnProperty(f)&&_!=null&&f==="onScroll"&&qr("scroll",c)}switch(o){case"input":sC(c),NW(c,h,!0);break;case"textarea":sC(c),xW(c);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(c.onclick=bw)}c=d,r.updateQueue=c,c!==null&&(r.flags|=4)}else{f=d.nodeType===9?d:d.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=y7(o)),t==="http://www.w3.org/1999/xhtml"?o==="script"?(t=f.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof c.is=="string"?t=f.createElement(o,{is:c.is}):(t=f.createElement(o),o==="select"&&(f=t,c.multiple?f.multiple=!0:c.size&&(f.size=c.size))):t=f.createElementNS(t,o),t[Al]=r,t[Sy]=c,Hz(t,r,!1,!1),r.stateNode=t;e:{switch(f=uD(o,c),o){case"dialog":qr("cancel",t),qr("close",t),d=c;break;case"iframe":case"object":case"embed":qr("load",t),d=c;break;case"video":case"audio":for(d=0;d<Vv.length;d++)qr(Vv[d],t);d=c;break;case"source":qr("error",t),d=c;break;case"img":case"image":case"link":qr("error",t),qr("load",t),d=c;break;case"details":qr("toggle",t),d=c;break;case"input":OW(t,c),d=sD(t,c),qr("invalid",t);break;case"option":d=c;break;case"select":t._wrapperState={wasMultiple:!!c.multiple},d=Ci({},c,{value:void 0}),qr("invalid",t);break;case"textarea":kW(t,c),d=cD(t,c),qr("invalid",t);break;default:d=c}dD(o,d),_=d;for(h in _)if(_.hasOwnProperty(h)){var v=_[h];h==="style"?T7(t,v):h==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,v!=null&&S7(t,v)):h==="children"?typeof v=="string"?(o!=="textarea"||v!=="")&&hy(t,v):typeof v=="number"&&hy(t,""+v):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(uy.hasOwnProperty(h)?v!=null&&h==="onScroll"&&qr("scroll",t):v!=null&&p2(t,h,v,f))}switch(o){case"input":sC(t),NW(t,c,!1);break;case"textarea":sC(t),xW(t);break;case"option":c.value!=null&&t.setAttribute("value",""+Sh(c.value));break;case"select":t.multiple=!!c.multiple,h=c.value,h!=null?cg(t,!!c.multiple,h,!1):c.defaultValue!=null&&cg(t,!!c.multiple,c.defaultValue,!0);break;default:typeof d.onClick=="function"&&(t.onclick=bw)}switch(o){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Gs(r),null;case 6:if(t&&r.stateNode!=null)Kz(t,r,t.memoizedProps,c);else{if(typeof c!="string"&&r.stateNode===null)throw Error(Ze(166));if(o=Np(Ty.current),Np(xl.current),fC(r)){if(c=r.stateNode,o=r.memoizedProps,c[Al]=r,(h=c.nodeValue!==o)&&(t=ua,t!==null))switch(t.tag){case 3:pC(c.nodeValue,o,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&pC(c.nodeValue,o,(t.mode&1)!==0)}h&&(r.flags|=4)}else c=(o.nodeType===9?o:o.ownerDocument).createTextNode(c),c[Al]=r,r.stateNode=c}return Gs(r),null;case 13:if(Jr(bi),c=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ui&&da!==null&&r.mode&1&&!(r.flags&128))dz(),Mg(),r.flags|=98560,h=!1;else if(h=fC(r),c!==null&&c.dehydrated!==null){if(t===null){if(!h)throw Error(Ze(318));if(h=r.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(Ze(317));h[Al]=r}else Mg(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;Gs(r),h=!1}else Lc!==null&&(HD(Lc),Lc=null),h=!0;if(!h)return r.flags&65536?r:null}return r.flags&128?(r.lanes=o,r):(c=c!==null,c!==(t!==null&&t.memoizedState!==null)&&c&&(r.child.flags|=8192,r.mode&1&&(t===null||bi.current&1?os===0&&(os=3):q2())),r.updateQueue!==null&&(r.flags|=4),Gs(r),null);case 4:return jg(),UD(t,r),t===null&&vy(r.stateNode.containerInfo),Gs(r),null;case 10:return x2(r.type._context),Gs(r),null;case 17:return Vo(r.type)&&Tw(),Gs(r),null;case 19:if(Jr(bi),h=r.memoizedState,h===null)return Gs(r),null;if(c=(r.flags&128)!==0,f=h.rendering,f===null)if(c)Rv(h,!1);else{if(os!==0||t!==null&&t.flags&128)for(t=r.child;t!==null;){if(f=Nw(t),f!==null){for(r.flags|=128,Rv(h,!1),c=f.updateQueue,c!==null&&(r.updateQueue=c,r.flags|=4),r.subtreeFlags=0,c=o,o=r.child;o!==null;)h=o,t=c,h.flags&=14680066,f=h.alternate,f===null?(h.childLanes=0,h.lanes=t,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=f.childLanes,h.lanes=f.lanes,h.child=f.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=f.memoizedProps,h.memoizedState=f.memoizedState,h.updateQueue=f.updateQueue,h.type=f.type,t=f.dependencies,h.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),o=o.sibling;return $r(bi,bi.current&1|2),r.child}t=t.sibling}h.tail!==null&&Fi()>Vg&&(r.flags|=128,c=!0,Rv(h,!1),r.lanes=4194304)}else{if(!c)if(t=Nw(f),t!==null){if(r.flags|=128,c=!0,o=t.updateQueue,o!==null&&(r.updateQueue=o,r.flags|=4),Rv(h,!0),h.tail===null&&h.tailMode==="hidden"&&!f.alternate&&!ui)return Gs(r),null}else 2*Fi()-h.renderingStartTime>Vg&&o!==1073741824&&(r.flags|=128,c=!0,Rv(h,!1),r.lanes=4194304);h.isBackwards?(f.sibling=r.child,r.child=f):(o=h.last,o!==null?o.sibling=f:r.child=f,h.last=f)}return h.tail!==null?(r=h.tail,h.rendering=r,h.tail=r.sibling,h.renderingStartTime=Fi(),r.sibling=null,o=bi.current,$r(bi,c?o&1|2:o&1),r):(Gs(r),null);case 22:case 23:return Y2(),c=r.memoizedState!==null,t!==null&&t.memoizedState!==null!==c&&(r.flags|=8192),c&&r.mode&1?oa&1073741824&&(Gs(r),r.subtreeFlags&6&&(r.flags|=8192)):Gs(r),null;case 24:return null;case 25:return null}throw Error(Ze(156,r.tag))}function aue(t,r){switch(A2(r),r.tag){case 1:return Vo(r.type)&&Tw(),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return jg(),Jr(Fo),Jr(Ys),U2(),t=r.flags,t&65536&&!(t&128)?(r.flags=t&-65537|128,r):null;case 5:return M2(r),null;case 13:if(Jr(bi),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(Ze(340));Mg()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return Jr(bi),null;case 4:return jg(),null;case 10:return x2(r.type._context),null;case 22:case 23:return Y2(),null;case 24:return null;default:return null}}var _C=!1,Ks=!1,cue=typeof WeakSet=="function"?WeakSet:Set,vt=null;function ng(t,r){var o=t.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){Oi(t,r,c)}else o.current=null}function jD(t,r,o){try{o()}catch(c){Oi(t,r,c)}}var S8=!1;function lue(t,r){if(SD=vw,t=J7(),R2(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var d=c.anchorOffset,h=c.focusNode;c=c.focusOffset;try{o.nodeType,h.nodeType}catch{o=null;break e}var f=0,_=-1,v=-1,b=0,A=0,w=t,x=null;t:for(;;){for(var M;w!==o||d!==0&&w.nodeType!==3||(_=f+d),w!==h||c!==0&&w.nodeType!==3||(v=f+c),w.nodeType===3&&(f+=w.nodeValue.length),(M=w.firstChild)!==null;)x=w,w=M;for(;;){if(w===t)break t;if(x===o&&++b===d&&(_=f),x===h&&++A===c&&(v=f),(M=w.nextSibling)!==null)break;w=x,x=w.parentNode}w=M}o=_===-1||v===-1?null:{start:_,end:v}}else o=null}o=o||{start:0,end:0}}else o=null;for(bD={focusedElem:t,selectionRange:o},vw=!1,vt=r;vt!==null;)if(r=vt,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,vt=t;else for(;vt!==null;){r=vt;try{var V=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(V!==null){var G=V.memoizedProps,H=V.memoizedState,F=r.stateNode,B=F.getSnapshotBeforeUpdate(r.elementType===r.type?G:xc(r.type,G),H);F.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var L=r.stateNode.containerInfo;L.nodeType===1?L.textContent="":L.nodeType===9&&L.documentElement&&L.removeChild(L.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ze(163))}}catch(X){Oi(r,r.return,X)}if(t=r.sibling,t!==null){t.return=r.return,vt=t;break}vt=r.return}return V=S8,S8=!1,V}function ey(t,r,o){var c=r.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&t)===t){var h=d.destroy;d.destroy=void 0,h!==void 0&&jD(r,o,h)}d=d.next}while(d!==c)}}function TR(t,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var c=o.create;o.destroy=c()}o=o.next}while(o!==r)}}function FD(t){var r=t.ref;if(r!==null){var o=t.stateNode;switch(t.tag){case 5:t=o;break;default:t=o}typeof r=="function"?r(t):r.current=t}}function Yz(t){var r=t.alternate;r!==null&&(t.alternate=null,Yz(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&(delete r[Al],delete r[Sy],delete r[wD],delete r[Hde],delete r[zde])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qz(t){return t.tag===5||t.tag===3||t.tag===4}function b8(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qz(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function VD(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?o.nodeType===8?o.parentNode.insertBefore(t,r):o.insertBefore(t,r):(o.nodeType===8?(r=o.parentNode,r.insertBefore(t,o)):(r=o,r.appendChild(t)),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=bw));else if(c!==4&&(t=t.child,t!==null))for(VD(t,r,o),t=t.sibling;t!==null;)VD(t,r,o),t=t.sibling}function BD(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?o.insertBefore(t,r):o.appendChild(t);else if(c!==4&&(t=t.child,t!==null))for(BD(t,r,o),t=t.sibling;t!==null;)BD(t,r,o),t=t.sibling}var Cs=null,Dc=!1;function Vu(t,r,o){for(o=o.child;o!==null;)Xz(t,r,o),o=o.sibling}function Xz(t,r,o){if(kl&&typeof kl.onCommitFiberUnmount=="function")try{kl.onCommitFiberUnmount(mR,o)}catch{}switch(o.tag){case 5:Ks||ng(o,r);case 6:var c=Cs,d=Dc;Cs=null,Vu(t,r,o),Cs=c,Dc=d,Cs!==null&&(Dc?(t=Cs,o=o.stateNode,t.nodeType===8?t.parentNode.removeChild(o):t.removeChild(o)):Cs.removeChild(o.stateNode));break;case 18:Cs!==null&&(Dc?(t=Cs,o=o.stateNode,t.nodeType===8?Yx(t.parentNode,o):t.nodeType===1&&Yx(t,o),gy(t)):Yx(Cs,o.stateNode));break;case 4:c=Cs,d=Dc,Cs=o.stateNode.containerInfo,Dc=!0,Vu(t,r,o),Cs=c,Dc=d;break;case 0:case 11:case 14:case 15:if(!Ks&&(c=o.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){d=c=c.next;do{var h=d,f=h.destroy;h=h.tag,f!==void 0&&(h&2||h&4)&&jD(o,r,f),d=d.next}while(d!==c)}Vu(t,r,o);break;case 1:if(!Ks&&(ng(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=o.memoizedProps,c.state=o.memoizedState,c.componentWillUnmount()}catch(_){Oi(o,r,_)}Vu(t,r,o);break;case 21:Vu(t,r,o);break;case 22:o.mode&1?(Ks=(c=Ks)||o.memoizedState!==null,Vu(t,r,o),Ks=c):Vu(t,r,o);break;default:Vu(t,r,o)}}function T8(t){var r=t.updateQueue;if(r!==null){t.updateQueue=null;var o=t.stateNode;o===null&&(o=t.stateNode=new cue),r.forEach(function(c){var d=Eue.bind(null,t,c);o.has(c)||(o.add(c),c.then(d,d))})}}function Nc(t,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];try{var h=t,f=r,_=f;e:for(;_!==null;){switch(_.tag){case 5:Cs=_.stateNode,Dc=!1;break e;case 3:Cs=_.stateNode.containerInfo,Dc=!0;break e;case 4:Cs=_.stateNode.containerInfo,Dc=!0;break e}_=_.return}if(Cs===null)throw Error(Ze(160));Xz(h,f,d),Cs=null,Dc=!1;var v=d.alternate;v!==null&&(v.return=null),d.return=null}catch(b){Oi(d,r,b)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Jz(r,t),r=r.sibling}function Jz(t,r){var o=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Nc(r,t),yl(t),c&4){try{ey(3,t,t.return),TR(3,t)}catch(G){Oi(t,t.return,G)}try{ey(5,t,t.return)}catch(G){Oi(t,t.return,G)}}break;case 1:Nc(r,t),yl(t),c&512&&o!==null&&ng(o,o.return);break;case 5:if(Nc(r,t),yl(t),c&512&&o!==null&&ng(o,o.return),t.flags&32){var d=t.stateNode;try{hy(d,"")}catch(G){Oi(t,t.return,G)}}if(c&4&&(d=t.stateNode,d!=null)){var h=t.memoizedProps,f=o!==null?o.memoizedProps:h,_=t.type,v=t.updateQueue;if(t.updateQueue=null,v!==null)try{_==="input"&&h.type==="radio"&&h.name!=null&&E7(d,h),uD(_,f);var b=uD(_,h);for(f=0;f<v.length;f+=2){var A=v[f],w=v[f+1];A==="style"?T7(d,w):A==="dangerouslySetInnerHTML"?S7(d,w):A==="children"?hy(d,w):p2(d,A,w,b)}switch(_){case"input":oD(d,h);break;case"textarea":v7(d,h);break;case"select":var x=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!h.multiple;var M=h.value;M!=null?cg(d,!!h.multiple,M,!1):x!==!!h.multiple&&(h.defaultValue!=null?cg(d,!!h.multiple,h.defaultValue,!0):cg(d,!!h.multiple,h.multiple?[]:"",!1))}d[Sy]=h}catch(G){Oi(t,t.return,G)}}break;case 6:if(Nc(r,t),yl(t),c&4){if(t.stateNode===null)throw Error(Ze(162));d=t.stateNode,h=t.memoizedProps;try{d.nodeValue=h}catch(G){Oi(t,t.return,G)}}break;case 3:if(Nc(r,t),yl(t),c&4&&o!==null&&o.memoizedState.isDehydrated)try{gy(r.containerInfo)}catch(G){Oi(t,t.return,G)}break;case 4:Nc(r,t),yl(t);break;case 13:Nc(r,t),yl(t),d=t.child,d.flags&8192&&(h=d.memoizedState!==null,d.stateNode.isHidden=h,!h||d.alternate!==null&&d.alternate.memoizedState!==null||(z2=Fi())),c&4&&T8(t);break;case 22:if(A=o!==null&&o.memoizedState!==null,t.mode&1?(Ks=(b=Ks)||A,Nc(r,t),Ks=b):Nc(r,t),yl(t),c&8192){if(b=t.memoizedState!==null,(t.stateNode.isHidden=b)&&!A&&t.mode&1)for(vt=t,A=t.child;A!==null;){for(w=vt=A;vt!==null;){switch(x=vt,M=x.child,x.tag){case 0:case 11:case 14:case 15:ey(4,x,x.return);break;case 1:ng(x,x.return);var V=x.stateNode;if(typeof V.componentWillUnmount=="function"){c=x,o=x.return;try{r=c,V.props=r.memoizedProps,V.state=r.memoizedState,V.componentWillUnmount()}catch(G){Oi(c,o,G)}}break;case 5:ng(x,x.return);break;case 22:if(x.memoizedState!==null){w8(w);continue}}M!==null?(M.return=x,vt=M):w8(w)}A=A.sibling}e:for(A=null,w=t;;){if(w.tag===5){if(A===null){A=w;try{d=w.stateNode,b?(h=d.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(_=w.stateNode,v=w.memoizedProps.style,f=v!=null&&v.hasOwnProperty("display")?v.display:null,_.style.display=b7("display",f))}catch(G){Oi(t,t.return,G)}}}else if(w.tag===6){if(A===null)try{w.stateNode.nodeValue=b?"":w.memoizedProps}catch(G){Oi(t,t.return,G)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===t)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===t)break e;for(;w.sibling===null;){if(w.return===null||w.return===t)break e;A===w&&(A=null),w=w.return}A===w&&(A=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Nc(r,t),yl(t),c&4&&T8(t);break;case 21:break;default:Nc(r,t),yl(t)}}function yl(t){var r=t.flags;if(r&2){try{e:{for(var o=t.return;o!==null;){if(qz(o)){var c=o;break e}o=o.return}throw Error(Ze(160))}switch(c.tag){case 5:var d=c.stateNode;c.flags&32&&(hy(d,""),c.flags&=-33);var h=b8(t);BD(t,h,d);break;case 3:case 4:var f=c.stateNode.containerInfo,_=b8(t);VD(t,_,f);break;default:throw Error(Ze(161))}}catch(v){Oi(t,t.return,v)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function due(t,r,o){vt=t,Qz(t)}function Qz(t,r,o){for(var c=(t.mode&1)!==0;vt!==null;){var d=vt,h=d.child;if(d.tag===22&&c){var f=d.memoizedState!==null||_C;if(!f){var _=d.alternate,v=_!==null&&_.memoizedState!==null||Ks;_=_C;var b=Ks;if(_C=f,(Ks=v)&&!b)for(vt=d;vt!==null;)f=vt,v=f.child,f.tag===22&&f.memoizedState!==null?R8(d):v!==null?(v.return=f,vt=v):R8(d);for(;h!==null;)vt=h,Qz(h),h=h.sibling;vt=d,_C=_,Ks=b}C8(t)}else d.subtreeFlags&8772&&h!==null?(h.return=d,vt=h):C8(t)}}function C8(t){for(;vt!==null;){var r=vt;if(r.flags&8772){var o=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:Ks||TR(5,r);break;case 1:var c=r.stateNode;if(r.flags&4&&!Ks)if(o===null)c.componentDidMount();else{var d=r.elementType===r.type?o.memoizedProps:xc(r.type,o.memoizedProps);c.componentDidUpdate(d,o.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var h=r.updateQueue;h!==null&&a8(r,h,c);break;case 3:var f=r.updateQueue;if(f!==null){if(o=null,r.child!==null)switch(r.child.tag){case 5:o=r.child.stateNode;break;case 1:o=r.child.stateNode}a8(r,f,o)}break;case 5:var _=r.stateNode;if(o===null&&r.flags&4){o=_;var v=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":v.autoFocus&&o.focus();break;case"img":v.src&&(o.src=v.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var b=r.alternate;if(b!==null){var A=b.memoizedState;if(A!==null){var w=A.dehydrated;w!==null&&gy(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ze(163))}Ks||r.flags&512&&FD(r)}catch(x){Oi(r,r.return,x)}}if(r===t){vt=null;break}if(o=r.sibling,o!==null){o.return=r.return,vt=o;break}vt=r.return}}function w8(t){for(;vt!==null;){var r=vt;if(r===t){vt=null;break}var o=r.sibling;if(o!==null){o.return=r.return,vt=o;break}vt=r.return}}function R8(t){for(;vt!==null;){var r=vt;try{switch(r.tag){case 0:case 11:case 15:var o=r.return;try{TR(4,r)}catch(v){Oi(r,o,v)}break;case 1:var c=r.stateNode;if(typeof c.componentDidMount=="function"){var d=r.return;try{c.componentDidMount()}catch(v){Oi(r,d,v)}}var h=r.return;try{FD(r)}catch(v){Oi(r,h,v)}break;case 5:var f=r.return;try{FD(r)}catch(v){Oi(r,f,v)}}}catch(v){Oi(r,r.return,v)}if(r===t){vt=null;break}var _=r.sibling;if(_!==null){_.return=r.return,vt=_;break}vt=r.return}}var uue=Math.ceil,Pw=Bd.ReactCurrentDispatcher,G2=Bd.ReactCurrentOwner,Ja=Bd.ReactCurrentBatchConfig,Jn=0,gs=null,Zi=null,Rs=0,oa=0,rg=Nh(0),os=0,Iy=null,qp=0,CR=0,H2=0,ty=null,Mo=null,z2=0,Vg=1/0,Ed=null,Dw=!1,WD=null,mh=null,EC=!1,ah=null,Lw=0,ny=0,$D=null,QC=-1,ZC=0;function ho(){return Jn&6?Fi():QC!==-1?QC:QC=Fi()}function gh(t){return t.mode&1?Jn&2&&Rs!==0?Rs&-Rs:Yde.transition!==null?(ZC===0&&(ZC=L7()),ZC):(t=vr,t!==0||(t=window.event,t=t===void 0?16:W7(t.type)),t):1}function jc(t,r,o,c){if(50<ny)throw ny=0,$D=null,Error(Ze(185));o0(t,o,c),(!(Jn&2)||t!==gs)&&(t===gs&&(!(Jn&2)&&(CR|=o),os===4&&qu(t,Rs)),Bo(t,c),o===1&&Jn===0&&!(r.mode&1)&&(Vg=Fi()+500,yR&&kh()))}function Bo(t,r){var o=t.callbackNode;Yle(t,r);var c=Ew(t,t===gs?Rs:0);if(c===0)o!==null&&LW(o),t.callbackNode=null,t.callbackPriority=0;else if(r=c&-c,t.callbackPriority!==r){if(o!=null&&LW(o),r===1)t.tag===0?Kde(I8.bind(null,t)):az(I8.bind(null,t)),$de(function(){!(Jn&6)&&kh()}),o=null;else{switch(M7(c)){case 1:o=E2;break;case 4:o=P7;break;case 16:o=_w;break;case 536870912:o=D7;break;default:o=_w}o=o9(o,Zz.bind(null,t))}t.callbackPriority=r,t.callbackNode=o}}function Zz(t,r){if(QC=-1,ZC=0,Jn&6)throw Error(Ze(327));var o=t.callbackNode;if(pg()&&t.callbackNode!==o)return null;var c=Ew(t,t===gs?Rs:0);if(c===0)return null;if(c&30||c&t.expiredLanes||r)r=Mw(t,c);else{r=c;var d=Jn;Jn|=2;var h=t9();(gs!==t||Rs!==r)&&(Ed=null,Vg=Fi()+500,Gp(t,r));do try{fue();break}catch(_){e9(t,_)}while(!0);k2(),Pw.current=h,Jn=d,Zi!==null?r=0:(gs=null,Rs=0,r=os)}if(r!==0){if(r===2&&(d=gD(t),d!==0&&(c=d,r=GD(t,d))),r===1)throw o=Iy,Gp(t,0),qu(t,c),Bo(t,Fi()),o;if(r===6)qu(t,c);else{if(d=t.current.alternate,!(c&30)&&!hue(d)&&(r=Mw(t,c),r===2&&(h=gD(t),h!==0&&(c=h,r=GD(t,h))),r===1))throw o=Iy,Gp(t,0),qu(t,c),Bo(t,Fi()),o;switch(t.finishedWork=d,t.finishedLanes=c,r){case 0:case 1:throw Error(Ze(345));case 2:Cp(t,Mo,Ed);break;case 3:if(qu(t,c),(c&130023424)===c&&(r=z2+500-Fi(),10<r)){if(Ew(t,0)!==0)break;if(d=t.suspendedLanes,(d&c)!==c){ho(),t.pingedLanes|=t.suspendedLanes&d;break}t.timeoutHandle=CD(Cp.bind(null,t,Mo,Ed),r);break}Cp(t,Mo,Ed);break;case 4:if(qu(t,c),(c&4194240)===c)break;for(r=t.eventTimes,d=-1;0<c;){var f=31-Uc(c);h=1<<f,f=r[f],f>d&&(d=f),c&=~h}if(c=d,c=Fi()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*uue(c/1960))-c,10<c){t.timeoutHandle=CD(Cp.bind(null,t,Mo,Ed),c);break}Cp(t,Mo,Ed);break;case 5:Cp(t,Mo,Ed);break;default:throw Error(Ze(329))}}}return Bo(t,Fi()),t.callbackNode===o?Zz.bind(null,t):null}function GD(t,r){var o=ty;return t.current.memoizedState.isDehydrated&&(Gp(t,r).flags|=256),t=Mw(t,r),t!==2&&(r=Mo,Mo=o,r!==null&&HD(r)),t}function HD(t){Mo===null?Mo=t:Mo.push.apply(Mo,t)}function hue(t){for(var r=t;;){if(r.flags&16384){var o=r.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var c=0;c<o.length;c++){var d=o[c],h=d.getSnapshot;d=d.value;try{if(!Vc(h(),d))return!1}catch{return!1}}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function qu(t,r){for(r&=~H2,r&=~CR,t.suspendedLanes|=r,t.pingedLanes&=~r,t=t.expirationTimes;0<r;){var o=31-Uc(r),c=1<<o;t[o]=-1,r&=~c}}function I8(t){if(Jn&6)throw Error(Ze(327));pg();var r=Ew(t,0);if(!(r&1))return Bo(t,Fi()),null;var o=Mw(t,r);if(t.tag!==0&&o===2){var c=gD(t);c!==0&&(r=c,o=GD(t,c))}if(o===1)throw o=Iy,Gp(t,0),qu(t,r),Bo(t,Fi()),o;if(o===6)throw Error(Ze(345));return t.finishedWork=t.current.alternate,t.finishedLanes=r,Cp(t,Mo,Ed),Bo(t,Fi()),null}function K2(t,r){var o=Jn;Jn|=1;try{return t(r)}finally{Jn=o,Jn===0&&(Vg=Fi()+500,yR&&kh())}}function Xp(t){ah!==null&&ah.tag===0&&!(Jn&6)&&pg();var r=Jn;Jn|=1;var o=Ja.transition,c=vr;try{if(Ja.transition=null,vr=1,t)return t()}finally{vr=c,Ja.transition=o,Jn=r,!(Jn&6)&&kh()}}function Y2(){oa=rg.current,Jr(rg)}function Gp(t,r){t.finishedWork=null,t.finishedLanes=0;var o=t.timeoutHandle;if(o!==-1&&(t.timeoutHandle=-1,Wde(o)),Zi!==null)for(o=Zi.return;o!==null;){var c=o;switch(A2(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Tw();break;case 3:jg(),Jr(Fo),Jr(Ys),U2();break;case 5:M2(c);break;case 4:jg();break;case 13:Jr(bi);break;case 19:Jr(bi);break;case 10:x2(c.type._context);break;case 22:case 23:Y2()}o=o.return}if(gs=t,Zi=t=_h(t.current,null),Rs=oa=r,os=0,Iy=null,H2=CR=qp=0,Mo=ty=null,Op!==null){for(r=0;r<Op.length;r++)if(o=Op[r],c=o.interleaved,c!==null){o.interleaved=null;var d=c.next,h=o.pending;if(h!==null){var f=h.next;h.next=d,c.next=f}o.pending=c}Op=null}return t}function e9(t,r){do{var o=Zi;try{if(k2(),qC.current=xw,kw){for(var c=Ti.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}kw=!1}if(Yp=0,ms=is=Ti=null,Zv=!1,Cy=0,G2.current=null,o===null||o.return===null){os=1,Iy=r,Zi=null;break}e:{var h=t,f=o.return,_=o,v=r;if(r=Rs,_.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){var b=v,A=_,w=A.tag;if(!(A.mode&1)&&(w===0||w===11||w===15)){var x=A.alternate;x?(A.updateQueue=x.updateQueue,A.memoizedState=x.memoizedState,A.lanes=x.lanes):(A.updateQueue=null,A.memoizedState=null)}var M=f8(f);if(M!==null){M.flags&=-257,m8(M,f,_,h,r),M.mode&1&&p8(h,b,r),r=M,v=b;var V=r.updateQueue;if(V===null){var G=new Set;G.add(v),r.updateQueue=G}else V.add(v);break e}else{if(!(r&1)){p8(h,b,r),q2();break e}v=Error(Ze(426))}}else if(ui&&_.mode&1){var H=f8(f);if(H!==null){!(H.flags&65536)&&(H.flags|=256),m8(H,f,_,h,r),O2(Fg(v,_));break e}}h=v=Fg(v,_),os!==4&&(os=2),ty===null?ty=[h]:ty.push(h),h=f;do{switch(h.tag){case 3:h.flags|=65536,r&=-r,h.lanes|=r;var F=Uz(h,v,r);o8(h,F);break e;case 1:_=v;var B=h.type,L=h.stateNode;if(!(h.flags&128)&&(typeof B.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(mh===null||!mh.has(L)))){h.flags|=65536,r&=-r,h.lanes|=r;var X=jz(h,_,r);o8(h,X);break e}}h=h.return}while(h!==null)}r9(o)}catch(ee){r=ee,Zi===o&&o!==null&&(Zi=o=o.return);continue}break}while(!0)}function t9(){var t=Pw.current;return Pw.current=xw,t===null?xw:t}function q2(){(os===0||os===3||os===2)&&(os=4),gs===null||!(qp&268435455)&&!(CR&268435455)||qu(gs,Rs)}function Mw(t,r){var o=Jn;Jn|=2;var c=t9();(gs!==t||Rs!==r)&&(Ed=null,Gp(t,r));do try{pue();break}catch(d){e9(t,d)}while(!0);if(k2(),Jn=o,Pw.current=c,Zi!==null)throw Error(Ze(261));return gs=null,Rs=0,os}function pue(){for(;Zi!==null;)n9(Zi)}function fue(){for(;Zi!==null&&!Fle();)n9(Zi)}function n9(t){var r=s9(t.alternate,t,oa);t.memoizedProps=t.pendingProps,r===null?r9(t):Zi=r,G2.current=null}function r9(t){var r=t;do{var o=r.alternate;if(t=r.return,r.flags&32768){if(o=aue(o,r),o!==null){o.flags&=32767,Zi=o;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{os=6,Zi=null;return}}else if(o=oue(o,r,oa),o!==null){Zi=o;return}if(r=r.sibling,r!==null){Zi=r;return}Zi=r=t}while(r!==null);os===0&&(os=5)}function Cp(t,r,o){var c=vr,d=Ja.transition;try{Ja.transition=null,vr=1,mue(t,r,o,c)}finally{Ja.transition=d,vr=c}return null}function mue(t,r,o,c){do pg();while(ah!==null);if(Jn&6)throw Error(Ze(327));o=t.finishedWork;var d=t.finishedLanes;if(o===null)return null;if(t.finishedWork=null,t.finishedLanes=0,o===t.current)throw Error(Ze(177));t.callbackNode=null,t.callbackPriority=0;var h=o.lanes|o.childLanes;if(qle(t,h),t===gs&&(Zi=gs=null,Rs=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||EC||(EC=!0,o9(_w,function(){return pg(),null})),h=(o.flags&15990)!==0,o.subtreeFlags&15990||h){h=Ja.transition,Ja.transition=null;var f=vr;vr=1;var _=Jn;Jn|=4,G2.current=null,lue(t,o),Jz(o,t),Lde(bD),vw=!!SD,bD=SD=null,t.current=o,due(o),Vle(),Jn=_,vr=f,Ja.transition=h}else t.current=o;if(EC&&(EC=!1,ah=t,Lw=d),h=t.pendingLanes,h===0&&(mh=null),$le(o.stateNode),Bo(t,Fi()),r!==null)for(c=t.onRecoverableError,o=0;o<r.length;o++)d=r[o],c(d.value,{componentStack:d.stack,digest:d.digest});if(Dw)throw Dw=!1,t=WD,WD=null,t;return Lw&1&&t.tag!==0&&pg(),h=t.pendingLanes,h&1?t===$D?ny++:(ny=0,$D=t):ny=0,kh(),null}function pg(){if(ah!==null){var t=M7(Lw),r=Ja.transition,o=vr;try{if(Ja.transition=null,vr=16>t?16:t,ah===null)var c=!1;else{if(t=ah,ah=null,Lw=0,Jn&6)throw Error(Ze(331));var d=Jn;for(Jn|=4,vt=t.current;vt!==null;){var h=vt,f=h.child;if(vt.flags&16){var _=h.deletions;if(_!==null){for(var v=0;v<_.length;v++){var b=_[v];for(vt=b;vt!==null;){var A=vt;switch(A.tag){case 0:case 11:case 15:ey(8,A,h)}var w=A.child;if(w!==null)w.return=A,vt=w;else for(;vt!==null;){A=vt;var x=A.sibling,M=A.return;if(Yz(A),A===b){vt=null;break}if(x!==null){x.return=M,vt=x;break}vt=M}}}var V=h.alternate;if(V!==null){var G=V.child;if(G!==null){V.child=null;do{var H=G.sibling;G.sibling=null,G=H}while(G!==null)}}vt=h}}if(h.subtreeFlags&2064&&f!==null)f.return=h,vt=f;else e:for(;vt!==null;){if(h=vt,h.flags&2048)switch(h.tag){case 0:case 11:case 15:ey(9,h,h.return)}var F=h.sibling;if(F!==null){F.return=h.return,vt=F;break e}vt=h.return}}var B=t.current;for(vt=B;vt!==null;){f=vt;var L=f.child;if(f.subtreeFlags&2064&&L!==null)L.return=f,vt=L;else e:for(f=B;vt!==null;){if(_=vt,_.flags&2048)try{switch(_.tag){case 0:case 11:case 15:TR(9,_)}}catch(ee){Oi(_,_.return,ee)}if(_===f){vt=null;break e}var X=_.sibling;if(X!==null){X.return=_.return,vt=X;break e}vt=_.return}}if(Jn=d,kh(),kl&&typeof kl.onPostCommitFiberRoot=="function")try{kl.onPostCommitFiberRoot(mR,t)}catch{}c=!0}return c}finally{vr=o,Ja.transition=r}}return!1}function A8(t,r,o){r=Fg(o,r),r=Uz(t,r,1),t=fh(t,r,1),r=ho(),t!==null&&(o0(t,1,r),Bo(t,r))}function Oi(t,r,o){if(t.tag===3)A8(t,t,o);else for(;r!==null;){if(r.tag===3){A8(r,t,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(mh===null||!mh.has(c))){t=Fg(o,t),t=jz(r,t,1),r=fh(r,t,1),t=ho(),r!==null&&(o0(r,1,t),Bo(r,t));break}}r=r.return}}function gue(t,r,o){var c=t.pingCache;c!==null&&c.delete(r),r=ho(),t.pingedLanes|=t.suspendedLanes&o,gs===t&&(Rs&o)===o&&(os===4||os===3&&(Rs&130023424)===Rs&&500>Fi()-z2?Gp(t,0):H2|=o),Bo(t,r)}function i9(t,r){r===0&&(t.mode&1?(r=cC,cC<<=1,!(cC&130023424)&&(cC=4194304)):r=1);var o=ho();t=Pd(t,r),t!==null&&(o0(t,r,o),Bo(t,o))}function _ue(t){var r=t.memoizedState,o=0;r!==null&&(o=r.retryLane),i9(t,o)}function Eue(t,r){var o=0;switch(t.tag){case 13:var c=t.stateNode,d=t.memoizedState;d!==null&&(o=d.retryLane);break;case 19:c=t.stateNode;break;default:throw Error(Ze(314))}c!==null&&c.delete(r),i9(t,o)}var s9;s9=function(t,r,o){if(t!==null)if(t.memoizedProps!==r.pendingProps||Fo.current)Uo=!0;else{if(!(t.lanes&o)&&!(r.flags&128))return Uo=!1,sue(t,r,o);Uo=!!(t.flags&131072)}else Uo=!1,ui&&r.flags&1048576&&cz(r,Rw,r.index);switch(r.lanes=0,r.tag){case 2:var c=r.type;JC(t,r),t=r.pendingProps;var d=Lg(r,Ys.current);hg(r,o),d=F2(null,r,c,t,d,o);var h=V2();return r.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Vo(c)?(h=!0,Cw(r)):h=!1,r.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,D2(r),d.updater=SR,r.stateNode=d,d._reactInternals=r,kD(r,c,t,o),r=DD(null,r,c,!0,h,o)):(r.tag=0,ui&&h&&I2(r),lo(null,r,d,o),r=r.child),r;case 16:c=r.elementType;e:{switch(JC(t,r),t=r.pendingProps,d=c._init,c=d(c._payload),r.type=c,d=r.tag=yue(c),t=xc(c,t),d){case 0:r=PD(null,r,c,t,o);break e;case 1:r=E8(null,r,c,t,o);break e;case 11:r=g8(null,r,c,t,o);break e;case 14:r=_8(null,r,c,xc(c.type,t),o);break e}throw Error(Ze(306,c,""))}return r;case 0:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:xc(c,d),PD(t,r,c,d,o);case 1:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:xc(c,d),E8(t,r,c,d,o);case 3:e:{if(Wz(r),t===null)throw Error(Ze(387));c=r.pendingProps,h=r.memoizedState,d=h.element,hz(t,r),Ow(r,c,null,o);var f=r.memoizedState;if(c=f.element,h.isDehydrated)if(h={element:c,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},r.updateQueue.baseState=h,r.memoizedState=h,r.flags&256){d=Fg(Error(Ze(423)),r),r=v8(t,r,c,o,d);break e}else if(c!==d){d=Fg(Error(Ze(424)),r),r=v8(t,r,c,o,d);break e}else for(da=ph(r.stateNode.containerInfo.firstChild),ua=r,ui=!0,Lc=null,o=gz(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Mg(),c===d){r=Dd(t,r,o);break e}lo(t,r,c,o)}r=r.child}return r;case 5:return _z(r),t===null&&AD(r),c=r.type,d=r.pendingProps,h=t!==null?t.memoizedProps:null,f=d.children,TD(c,d)?f=null:h!==null&&TD(c,h)&&(r.flags|=32),Bz(t,r),lo(t,r,f,o),r.child;case 6:return t===null&&AD(r),null;case 13:return $z(t,r,o);case 4:return L2(r,r.stateNode.containerInfo),c=r.pendingProps,t===null?r.child=Ug(r,null,c,o):lo(t,r,c,o),r.child;case 11:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:xc(c,d),g8(t,r,c,d,o);case 7:return lo(t,r,r.pendingProps,o),r.child;case 8:return lo(t,r,r.pendingProps.children,o),r.child;case 12:return lo(t,r,r.pendingProps.children,o),r.child;case 10:e:{if(c=r.type._context,d=r.pendingProps,h=r.memoizedProps,f=d.value,$r(Iw,c._currentValue),c._currentValue=f,h!==null)if(Vc(h.value,f)){if(h.children===d.children&&!Fo.current){r=Dd(t,r,o);break e}}else for(h=r.child,h!==null&&(h.return=r);h!==null;){var _=h.dependencies;if(_!==null){f=h.child;for(var v=_.firstContext;v!==null;){if(v.context===c){if(h.tag===1){v=Id(-1,o&-o),v.tag=2;var b=h.updateQueue;if(b!==null){b=b.shared;var A=b.pending;A===null?v.next=v:(v.next=A.next,A.next=v),b.pending=v}}h.lanes|=o,v=h.alternate,v!==null&&(v.lanes|=o),OD(h.return,o,r),_.lanes|=o;break}v=v.next}}else if(h.tag===10)f=h.type===r.type?null:h.child;else if(h.tag===18){if(f=h.return,f===null)throw Error(Ze(341));f.lanes|=o,_=f.alternate,_!==null&&(_.lanes|=o),OD(f,o,r),f=h.sibling}else f=h.child;if(f!==null)f.return=h;else for(f=h;f!==null;){if(f===r){f=null;break}if(h=f.sibling,h!==null){h.return=f.return,f=h;break}f=f.return}h=f}lo(t,r,d.children,o),r=r.child}return r;case 9:return d=r.type,c=r.pendingProps.children,hg(r,o),d=Za(d),c=c(d),r.flags|=1,lo(t,r,c,o),r.child;case 14:return c=r.type,d=xc(c,r.pendingProps),d=xc(c.type,d),_8(t,r,c,d,o);case 15:return Fz(t,r,r.type,r.pendingProps,o);case 17:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:xc(c,d),JC(t,r),r.tag=1,Vo(c)?(t=!0,Cw(r)):t=!1,hg(r,o),fz(r,c,d),kD(r,c,d,o),DD(null,r,c,!0,t,o);case 19:return Gz(t,r,o);case 22:return Vz(t,r,o)}throw Error(Ze(156,r.tag))};function o9(t,r){return x7(t,r)}function vue(t,r,o,c){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xa(t,r,o,c){return new vue(t,r,o,c)}function X2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function yue(t){if(typeof t=="function")return X2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===m2)return 11;if(t===g2)return 14}return 2}function _h(t,r){var o=t.alternate;return o===null?(o=Xa(t.tag,r,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=r,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&14680064,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,r=t.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o}function ew(t,r,o,c,d,h){var f=2;if(c=t,typeof t=="function")X2(t)&&(f=1);else if(typeof t=="string")f=5;else e:switch(t){case Km:return Hp(o.children,d,h,r);case f2:f=8,d|=8;break;case tD:return t=Xa(12,o,r,d|2),t.elementType=tD,t.lanes=h,t;case nD:return t=Xa(13,o,r,d),t.elementType=nD,t.lanes=h,t;case rD:return t=Xa(19,o,r,d),t.elementType=rD,t.lanes=h,t;case m7:return wR(o,d,h,r);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case p7:f=10;break e;case f7:f=9;break e;case m2:f=11;break e;case g2:f=14;break e;case zu:f=16,c=null;break e}throw Error(Ze(130,t==null?t:typeof t,""))}return r=Xa(f,o,r,d),r.elementType=t,r.type=c,r.lanes=h,r}function Hp(t,r,o,c){return t=Xa(7,t,c,r),t.lanes=o,t}function wR(t,r,o,c){return t=Xa(22,t,c,r),t.elementType=m7,t.lanes=o,t.stateNode={isHidden:!1},t}function nP(t,r,o){return t=Xa(6,t,null,r),t.lanes=o,t}function rP(t,r,o){return r=Xa(4,t.children!==null?t.children:[],t.key,r),r.lanes=o,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}function Sue(t,r,o,c,d){this.tag=r,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ux(0),this.expirationTimes=Ux(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ux(0),this.identifierPrefix=c,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function J2(t,r,o,c,d,h,f,_,v){return t=new Sue(t,r,o,_,v),r===1?(r=1,h===!0&&(r|=8)):r=0,h=Xa(3,null,null,r),t.current=h,h.stateNode=t,h.memoizedState={element:c,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},D2(h),t}function bue(t,r,o){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zm,key:c==null?null:""+c,children:t,containerInfo:r,implementation:o}}function a9(t){if(!t)return bh;t=t._reactInternals;e:{if(rf(t)!==t||t.tag!==1)throw Error(Ze(170));var r=t;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Vo(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(Ze(171))}if(t.tag===1){var o=t.type;if(Vo(o))return oz(t,o,r)}return r}function c9(t,r,o,c,d,h,f,_,v){return t=J2(o,c,!0,t,d,h,f,_,v),t.context=a9(null),o=t.current,c=ho(),d=gh(o),h=Id(c,d),h.callback=r??null,fh(o,h,d),t.current.lanes=d,o0(t,d,c),Bo(t,c),t}function RR(t,r,o,c){var d=r.current,h=ho(),f=gh(d);return o=a9(o),r.context===null?r.context=o:r.pendingContext=o,r=Id(h,f),r.payload={element:t},c=c===void 0?null:c,c!==null&&(r.callback=c),t=fh(d,r,f),t!==null&&(jc(t,d,f,h),YC(t,d,f)),f}function Uw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function O8(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<r?o:r}}function Q2(t,r){O8(t,r),(t=t.alternate)&&O8(t,r)}function Tue(){return null}var l9=typeof reportError=="function"?reportError:function(t){console.error(t)};function Z2(t){this._internalRoot=t}IR.prototype.render=Z2.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(Ze(409));RR(t,r,null,null)};IR.prototype.unmount=Z2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;Xp(function(){RR(null,t,null,null)}),r[xd]=null}};function IR(t){this._internalRoot=t}IR.prototype.unstable_scheduleHydration=function(t){if(t){var r=F7();t={blockedOn:null,target:t,priority:r};for(var o=0;o<Yu.length&&r!==0&&r<Yu[o].priority;o++);Yu.splice(o,0,t),o===0&&B7(t)}};function eM(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function AR(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function N8(){}function Cue(t,r,o,c,d){if(d){if(typeof c=="function"){var h=c;c=function(){var b=Uw(f);h.call(b)}}var f=c9(r,c,t,0,null,!1,!1,"",N8);return t._reactRootContainer=f,t[xd]=f.current,vy(t.nodeType===8?t.parentNode:t),Xp(),f}for(;d=t.lastChild;)t.removeChild(d);if(typeof c=="function"){var _=c;c=function(){var b=Uw(v);_.call(b)}}var v=J2(t,0,!1,null,null,!1,!1,"",N8);return t._reactRootContainer=v,t[xd]=v.current,vy(t.nodeType===8?t.parentNode:t),Xp(function(){RR(r,v,o,c)}),v}function OR(t,r,o,c,d){var h=o._reactRootContainer;if(h){var f=h;if(typeof d=="function"){var _=d;d=function(){var v=Uw(f);_.call(v)}}RR(r,f,t,d)}else f=Cue(o,r,t,d,c);return Uw(f)}U7=function(t){switch(t.tag){case 3:var r=t.stateNode;if(r.current.memoizedState.isDehydrated){var o=Fv(r.pendingLanes);o!==0&&(v2(r,o|1),Bo(r,Fi()),!(Jn&6)&&(Vg=Fi()+500,kh()))}break;case 13:Xp(function(){var c=Pd(t,1);if(c!==null){var d=ho();jc(c,t,1,d)}}),Q2(t,1)}};y2=function(t){if(t.tag===13){var r=Pd(t,134217728);if(r!==null){var o=ho();jc(r,t,134217728,o)}Q2(t,134217728)}};j7=function(t){if(t.tag===13){var r=gh(t),o=Pd(t,r);if(o!==null){var c=ho();jc(o,t,r,c)}Q2(t,r)}};F7=function(){return vr};V7=function(t,r){var o=vr;try{return vr=t,r()}finally{vr=o}};pD=function(t,r,o){switch(r){case"input":if(oD(t,o),r=o.name,o.type==="radio"&&r!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==t&&c.form===t.form){var d=vR(c);if(!d)throw Error(Ze(90));_7(c),oD(c,d)}}}break;case"textarea":v7(t,o);break;case"select":r=o.value,r!=null&&cg(t,!!o.multiple,r,!1)}};R7=K2;I7=Xp;var wue={usingClientEntryPoint:!1,Events:[c0,Jm,vR,C7,w7,K2]},Iv={findFiberByHostInstance:Ap,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Rue={bundleType:Iv.bundleType,version:Iv.version,rendererPackageName:Iv.rendererPackageName,rendererConfig:Iv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bd.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=N7(t),t===null?null:t.stateNode},findFiberByHostInstance:Iv.findFiberByHostInstance||Tue,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vC.isDisabled&&vC.supportsFiber)try{mR=vC.inject(Rue),kl=vC}catch{}}ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wue;ma.createPortal=function(t,r){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!eM(r))throw Error(Ze(200));return bue(t,r,null,o)};ma.createRoot=function(t,r){if(!eM(t))throw Error(Ze(299));var o=!1,c="",d=l9;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(d=r.onRecoverableError)),r=J2(t,1,!1,null,null,o,!1,c,d),t[xd]=r.current,vy(t.nodeType===8?t.parentNode:t),new Z2(r)};ma.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(Ze(188)):(t=Object.keys(t).join(","),Error(Ze(268,t)));return t=N7(r),t=t===null?null:t.stateNode,t};ma.flushSync=function(t){return Xp(t)};ma.hydrate=function(t,r,o){if(!AR(r))throw Error(Ze(200));return OR(null,t,r,!0,o)};ma.hydrateRoot=function(t,r,o){if(!eM(t))throw Error(Ze(405));var c=o!=null&&o.hydratedSources||null,d=!1,h="",f=l9;if(o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(f=o.onRecoverableError)),r=c9(r,null,t,1,o??null,d,!1,h,f),t[xd]=r.current,vy(t),c)for(t=0;t<c.length;t++)o=c[t],d=o._getVersion,d=d(o._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[o,d]:r.mutableSourceEagerHydrationData.push(o,d);return new IR(r)};ma.render=function(t,r,o){if(!AR(r))throw Error(Ze(200));return OR(null,t,r,!1,o)};ma.unmountComponentAtNode=function(t){if(!AR(t))throw Error(Ze(40));return t._reactRootContainer?(Xp(function(){OR(null,null,t,!1,function(){t._reactRootContainer=null,t[xd]=null})}),!0):!1};ma.unstable_batchedUpdates=K2;ma.unstable_renderSubtreeIntoContainer=function(t,r,o,c){if(!AR(o))throw Error(Ze(200));if(t==null||t._reactInternals===void 0)throw Error(Ze(38));return OR(t,r,o,!1,c)};ma.version="18.2.0-next-9e3b772b8-20220608";function d9(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d9)}catch(t){console.error(t)}}d9(),c7.exports=ma;var NR=c7.exports;const yC=Yg(NR);var k8=NR;ZP.createRoot=k8.createRoot,ZP.hydrateRoot=k8.hydrateRoot;/**
 * @remix-run/router v1.15.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ay(){return Ay=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(t[c]=o[c])}return t},Ay.apply(this,arguments)}var ch;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ch||(ch={}));const x8="popstate";function Iue(t){t===void 0&&(t={});function r(c,d){let{pathname:h,search:f,hash:_}=c.location;return zD("",{pathname:h,search:f,hash:_},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function o(c,d){return typeof d=="string"?d:jw(d)}return Oue(r,o,null,t)}function _s(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function u9(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function Aue(){return Math.random().toString(36).substr(2,8)}function P8(t,r){return{usr:t.state,key:t.key,idx:r}}function zD(t,r,o,c){return o===void 0&&(o=null),Ay({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof r=="string"?Qg(r):r,{state:o,key:r&&r.key||c||Aue()})}function jw(t){let{pathname:r="/",search:o="",hash:c=""}=t;return o&&o!=="?"&&(r+=o.charAt(0)==="?"?o:"?"+o),c&&c!=="#"&&(r+=c.charAt(0)==="#"?c:"#"+c),r}function Qg(t){let r={};if(t){let o=t.indexOf("#");o>=0&&(r.hash=t.substr(o),t=t.substr(0,o));let c=t.indexOf("?");c>=0&&(r.search=t.substr(c),t=t.substr(0,c)),t&&(r.pathname=t)}return r}function Oue(t,r,o,c){c===void 0&&(c={});let{window:d=document.defaultView,v5Compat:h=!1}=c,f=d.history,_=ch.Pop,v=null,b=A();b==null&&(b=0,f.replaceState(Ay({},f.state,{idx:b}),""));function A(){return(f.state||{idx:null}).idx}function w(){_=ch.Pop;let H=A(),F=H==null?null:H-b;b=H,v&&v({action:_,location:G.location,delta:F})}function x(H,F){_=ch.Push;let B=zD(G.location,H,F);o&&o(B,H),b=A()+1;let L=P8(B,b),X=G.createHref(B);try{f.pushState(L,"",X)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;d.location.assign(X)}h&&v&&v({action:_,location:G.location,delta:1})}function M(H,F){_=ch.Replace;let B=zD(G.location,H,F);o&&o(B,H),b=A();let L=P8(B,b),X=G.createHref(B);f.replaceState(L,"",X),h&&v&&v({action:_,location:G.location,delta:0})}function V(H){let F=d.location.origin!=="null"?d.location.origin:d.location.href,B=typeof H=="string"?H:jw(H);return B=B.replace(/ $/,"%20"),_s(F,"No window.location.(origin|href) available to create URL for href: "+B),new URL(B,F)}let G={get action(){return _},get location(){return t(d,f)},listen(H){if(v)throw new Error("A history only accepts one active listener");return d.addEventListener(x8,w),v=H,()=>{d.removeEventListener(x8,w),v=null}},createHref(H){return r(d,H)},createURL:V,encodeLocation(H){let F=V(H);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:x,replace:M,go(H){return f.go(H)}};return G}var D8;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(D8||(D8={}));function Nue(t,r,o){o===void 0&&(o="/");let c=typeof r=="string"?Qg(r):r,d=tM(c.pathname||"/",o);if(d==null)return null;let h=h9(t);kue(h);let f=null;for(let _=0;f==null&&_<h.length;++_){let v=$ue(d);f=Vue(h[_],v)}return f}function h9(t,r,o,c){r===void 0&&(r=[]),o===void 0&&(o=[]),c===void 0&&(c="");let d=(h,f,_)=>{let v={relativePath:_===void 0?h.path||"":_,caseSensitive:h.caseSensitive===!0,childrenIndex:f,route:h};v.relativePath.startsWith("/")&&(_s(v.relativePath.startsWith(c),'Absolute route path "'+v.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),v.relativePath=v.relativePath.slice(c.length));let b=Eh([c,v.relativePath]),A=o.concat(v);h.children&&h.children.length>0&&(_s(h.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),h9(h.children,r,A,b)),!(h.path==null&&!h.index)&&r.push({path:b,score:jue(b,h.index),routesMeta:A})};return t.forEach((h,f)=>{var _;if(h.path===""||!((_=h.path)!=null&&_.includes("?")))d(h,f);else for(let v of p9(h.path))d(h,f,v)}),r}function p9(t){let r=t.split("/");if(r.length===0)return[];let[o,...c]=r,d=o.endsWith("?"),h=o.replace(/\?$/,"");if(c.length===0)return d?[h,""]:[h];let f=p9(c.join("/")),_=[];return _.push(...f.map(v=>v===""?h:[h,v].join("/"))),d&&_.push(...f),_.map(v=>t.startsWith("/")&&v===""?"/":v)}function kue(t){t.sort((r,o)=>r.score!==o.score?o.score-r.score:Fue(r.routesMeta.map(c=>c.childrenIndex),o.routesMeta.map(c=>c.childrenIndex)))}const xue=/^:[\w-]+$/,Pue=3,Due=2,Lue=1,Mue=10,Uue=-2,L8=t=>t==="*";function jue(t,r){let o=t.split("/"),c=o.length;return o.some(L8)&&(c+=Uue),r&&(c+=Due),o.filter(d=>!L8(d)).reduce((d,h)=>d+(xue.test(h)?Pue:h===""?Lue:Mue),c)}function Fue(t,r){return t.length===r.length&&t.slice(0,-1).every((c,d)=>c===r[d])?t[t.length-1]-r[r.length-1]:0}function Vue(t,r){let{routesMeta:o}=t,c={},d="/",h=[];for(let f=0;f<o.length;++f){let _=o[f],v=f===o.length-1,b=d==="/"?r:r.slice(d.length)||"/",A=Bue({path:_.relativePath,caseSensitive:_.caseSensitive,end:v},b);if(!A)return null;Object.assign(c,A.params);let w=_.route;h.push({params:c,pathname:Eh([d,A.pathname]),pathnameBase:Kue(Eh([d,A.pathnameBase])),route:w}),A.pathnameBase!=="/"&&(d=Eh([d,A.pathnameBase]))}return h}function Bue(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[o,c]=Wue(t.path,t.caseSensitive,t.end),d=r.match(o);if(!d)return null;let h=d[0],f=h.replace(/(.)\/+$/,"$1"),_=d.slice(1);return{params:c.reduce((b,A,w)=>{let{paramName:x,isOptional:M}=A;if(x==="*"){let G=_[w]||"";f=h.slice(0,h.length-G.length).replace(/(.)\/+$/,"$1")}const V=_[w];return M&&!V?b[x]=void 0:b[x]=(V||"").replace(/%2F/g,"/"),b},{}),pathname:h,pathnameBase:f,pattern:t}}function Wue(t,r,o){r===void 0&&(r=!1),o===void 0&&(o=!0),u9(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let c=[],d="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,_,v)=>(c.push({paramName:_,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(c.push({paramName:"*"}),d+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?d+="\\/*$":t!==""&&t!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,r?void 0:"i"),c]}function $ue(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return u9(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),t}}function tM(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let o=r.endsWith("/")?r.length-1:r.length,c=t.charAt(o);return c&&c!=="/"?null:t.slice(o)||"/"}function Gue(t,r){r===void 0&&(r="/");let{pathname:o,search:c="",hash:d=""}=typeof t=="string"?Qg(t):t;return{pathname:o?o.startsWith("/")?o:Hue(o,r):r,search:Yue(c),hash:que(d)}}function Hue(t,r){let o=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(d=>{d===".."?o.length>1&&o.pop():d!=="."&&o.push(d)}),o.length>1?o.join("/"):"/"}function iP(t,r,o,c){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zue(t){return t.filter((r,o)=>o===0||r.route.path&&r.route.path.length>0)}function nM(t,r){let o=zue(t);return r?o.map((c,d)=>d===t.length-1?c.pathname:c.pathnameBase):o.map(c=>c.pathnameBase)}function rM(t,r,o,c){c===void 0&&(c=!1);let d;typeof t=="string"?d=Qg(t):(d=Ay({},t),_s(!d.pathname||!d.pathname.includes("?"),iP("?","pathname","search",d)),_s(!d.pathname||!d.pathname.includes("#"),iP("#","pathname","hash",d)),_s(!d.search||!d.search.includes("#"),iP("#","search","hash",d)));let h=t===""||d.pathname==="",f=h?"/":d.pathname,_;if(f==null)_=o;else{let w=r.length-1;if(!c&&f.startsWith("..")){let x=f.split("/");for(;x[0]==="..";)x.shift(),w-=1;d.pathname=x.join("/")}_=w>=0?r[w]:"/"}let v=Gue(d,_),b=f&&f!=="/"&&f.endsWith("/"),A=(h||f===".")&&o.endsWith("/");return!v.pathname.endsWith("/")&&(b||A)&&(v.pathname+="/"),v}const Eh=t=>t.join("/").replace(/\/\/+/g,"/"),Kue=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Yue=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,que=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Xue(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const f9=["post","put","patch","delete"];new Set(f9);const Jue=["get",...f9];new Set(Jue);/**
 * React Router v6.22.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oy(){return Oy=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(t[c]=o[c])}return t},Oy.apply(this,arguments)}const iM=K.createContext(null),Que=K.createContext(null),xh=K.createContext(null),kR=K.createContext(null),Fl=K.createContext({outlet:null,matches:[],isDataRoute:!1}),m9=K.createContext(null);function Zue(t,r){let{relative:o}=r===void 0?{}:r;Zg()||_s(!1);let{basename:c,navigator:d}=K.useContext(xh),{hash:h,pathname:f,search:_}=_9(t,{relative:o}),v=f;return c!=="/"&&(v=f==="/"?c:Eh([c,f])),d.createHref({pathname:v,search:_,hash:h})}function Zg(){return K.useContext(kR)!=null}function sf(){return Zg()||_s(!1),K.useContext(kR).location}function g9(t){K.useContext(xh).static||K.useLayoutEffect(t)}function Wd(){let{isDataRoute:t}=K.useContext(Fl);return t?fhe():ehe()}function ehe(){Zg()||_s(!1);let t=K.useContext(iM),{basename:r,future:o,navigator:c}=K.useContext(xh),{matches:d}=K.useContext(Fl),{pathname:h}=sf(),f=JSON.stringify(nM(d,o.v7_relativeSplatPath)),_=K.useRef(!1);return g9(()=>{_.current=!0}),K.useCallback(function(b,A){if(A===void 0&&(A={}),!_.current)return;if(typeof b=="number"){c.go(b);return}let w=rM(b,JSON.parse(f),h,A.relative==="path");t==null&&r!=="/"&&(w.pathname=w.pathname==="/"?r:Eh([r,w.pathname])),(A.replace?c.replace:c.push)(w,A.state,A)},[r,c,f,h,t])}const the=K.createContext(null);function nhe(t){let r=K.useContext(Fl).outlet;return r&&K.createElement(the.Provider,{value:t},r)}function xR(){let{matches:t}=K.useContext(Fl),r=t[t.length-1];return r?r.params:{}}function _9(t,r){let{relative:o}=r===void 0?{}:r,{future:c}=K.useContext(xh),{matches:d}=K.useContext(Fl),{pathname:h}=sf(),f=JSON.stringify(nM(d,c.v7_relativeSplatPath));return K.useMemo(()=>rM(t,JSON.parse(f),h,o==="path"),[t,f,h,o])}function rhe(t,r){return ihe(t,r)}function ihe(t,r,o,c){Zg()||_s(!1);let{navigator:d}=K.useContext(xh),{matches:h}=K.useContext(Fl),f=h[h.length-1],_=f?f.params:{};f&&f.pathname;let v=f?f.pathnameBase:"/";f&&f.route;let b=sf(),A;if(r){var w;let H=typeof r=="string"?Qg(r):r;v==="/"||(w=H.pathname)!=null&&w.startsWith(v)||_s(!1),A=H}else A=b;let x=A.pathname||"/",M=x;if(v!=="/"){let H=v.replace(/^\//,"").split("/");M="/"+x.replace(/^\//,"").split("/").slice(H.length).join("/")}let V=Nue(t,{pathname:M}),G=lhe(V&&V.map(H=>Object.assign({},H,{params:Object.assign({},_,H.params),pathname:Eh([v,d.encodeLocation?d.encodeLocation(H.pathname).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?v:Eh([v,d.encodeLocation?d.encodeLocation(H.pathnameBase).pathname:H.pathnameBase])})),h,o,c);return r&&G?K.createElement(kR.Provider,{value:{location:Oy({pathname:"/",search:"",hash:"",state:null,key:"default"},A),navigationType:ch.Pop}},G):G}function she(){let t=phe(),r=Xue(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),o=t instanceof Error?t.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},r),o?K.createElement("pre",{style:d},o):null,null)}const ohe=K.createElement(she,null);class ahe extends K.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,o){return o.location!==r.location||o.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:o.error,location:o.location,revalidation:r.revalidation||o.revalidation}}componentDidCatch(r,o){console.error("React Router caught the following error during render",r,o)}render(){return this.state.error!==void 0?K.createElement(Fl.Provider,{value:this.props.routeContext},K.createElement(m9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function che(t){let{routeContext:r,match:o,children:c}=t,d=K.useContext(iM);return d&&d.static&&d.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=o.route.id),K.createElement(Fl.Provider,{value:r},c)}function lhe(t,r,o,c){var d;if(r===void 0&&(r=[]),o===void 0&&(o=null),c===void 0&&(c=null),t==null){var h;if((h=o)!=null&&h.errors)t=o.matches;else return null}let f=t,_=(d=o)==null?void 0:d.errors;if(_!=null){let A=f.findIndex(w=>w.route.id&&(_==null?void 0:_[w.route.id]));A>=0||_s(!1),f=f.slice(0,Math.min(f.length,A+1))}let v=!1,b=-1;if(o&&c&&c.v7_partialHydration)for(let A=0;A<f.length;A++){let w=f[A];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(b=A),w.route.id){let{loaderData:x,errors:M}=o,V=w.route.loader&&x[w.route.id]===void 0&&(!M||M[w.route.id]===void 0);if(w.route.lazy||V){v=!0,b>=0?f=f.slice(0,b+1):f=[f[0]];break}}}return f.reduceRight((A,w,x)=>{let M,V=!1,G=null,H=null;o&&(M=_&&w.route.id?_[w.route.id]:void 0,G=w.route.errorElement||ohe,v&&(b<0&&x===0?(mhe("route-fallback",!1),V=!0,H=null):b===x&&(V=!0,H=w.route.hydrateFallbackElement||null)));let F=r.concat(f.slice(0,x+1)),B=()=>{let L;return M?L=G:V?L=H:w.route.Component?L=K.createElement(w.route.Component,null):w.route.element?L=w.route.element:L=A,K.createElement(che,{match:w,routeContext:{outlet:A,matches:F,isDataRoute:o!=null},children:L})};return o&&(w.route.ErrorBoundary||w.route.errorElement||x===0)?K.createElement(ahe,{location:o.location,revalidation:o.revalidation,component:G,error:M,children:B(),routeContext:{outlet:null,matches:F,isDataRoute:!0}}):B()},null)}var E9=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(E9||{}),Fw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Fw||{});function dhe(t){let r=K.useContext(iM);return r||_s(!1),r}function uhe(t){let r=K.useContext(Que);return r||_s(!1),r}function hhe(t){let r=K.useContext(Fl);return r||_s(!1),r}function v9(t){let r=hhe(),o=r.matches[r.matches.length-1];return o.route.id||_s(!1),o.route.id}function phe(){var t;let r=K.useContext(m9),o=uhe(Fw.UseRouteError),c=v9(Fw.UseRouteError);return r!==void 0?r:(t=o.errors)==null?void 0:t[c]}function fhe(){let{router:t}=dhe(E9.UseNavigateStable),r=v9(Fw.UseNavigateStable),o=K.useRef(!1);return g9(()=>{o.current=!0}),K.useCallback(function(d,h){h===void 0&&(h={}),o.current&&(typeof d=="number"?t.navigate(d):t.navigate(d,Oy({fromRouteId:r},h)))},[t,r])}const M8={};function mhe(t,r,o){!r&&!M8[t]&&(M8[t]=!0)}function ghe(t){let{to:r,replace:o,state:c,relative:d}=t;Zg()||_s(!1);let{future:h,static:f}=K.useContext(xh),{matches:_}=K.useContext(Fl),{pathname:v}=sf(),b=Wd(),A=rM(r,nM(_,h.v7_relativeSplatPath),v,d==="path"),w=JSON.stringify(A);return K.useEffect(()=>b(JSON.parse(w),{replace:o,state:c,relative:d}),[b,w,d,o,c]),null}function sM(t){return nhe(t.context)}function _he(t){let{basename:r="/",children:o=null,location:c,navigationType:d=ch.Pop,navigator:h,static:f=!1,future:_}=t;Zg()&&_s(!1);let v=r.replace(/^\/*/,"/"),b=K.useMemo(()=>({basename:v,navigator:h,static:f,future:Oy({v7_relativeSplatPath:!1},_)}),[v,_,h,f]);typeof c=="string"&&(c=Qg(c));let{pathname:A="/",search:w="",hash:x="",state:M=null,key:V="default"}=c,G=K.useMemo(()=>{let H=tM(A,v);return H==null?null:{location:{pathname:H,search:w,hash:x,state:M,key:V},navigationType:d}},[v,A,w,x,M,V,d]);return G==null?null:K.createElement(xh.Provider,{value:b},K.createElement(kR.Provider,{children:o,value:G}))}new Promise(()=>{});/**
 * React Router DOM v6.22.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function KD(){return KD=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(t[c]=o[c])}return t},KD.apply(this,arguments)}function Ehe(t,r){if(t==null)return{};var o={},c=Object.keys(t),d,h;for(h=0;h<c.length;h++)d=c[h],!(r.indexOf(d)>=0)&&(o[d]=t[d]);return o}function vhe(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yhe(t,r){return t.button===0&&(!r||r==="_self")&&!vhe(t)}const She=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],bhe="6";try{window.__reactRouterVersion=bhe}catch{}const The="startTransition",U8=pw[The];function Che(t){let{basename:r,children:o,future:c,window:d}=t,h=K.useRef();h.current==null&&(h.current=Iue({window:d,v5Compat:!0}));let f=h.current,[_,v]=K.useState({action:f.action,location:f.location}),{v7_startTransition:b}=c||{},A=K.useCallback(w=>{b&&U8?U8(()=>v(w)):v(w)},[v,b]);return K.useLayoutEffect(()=>f.listen(A),[f,A]),K.createElement(_he,{basename:r,children:o,location:_.location,navigationType:_.action,navigator:f,future:c})}const whe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Rhe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sP=K.forwardRef(function(r,o){let{onClick:c,relative:d,reloadDocument:h,replace:f,state:_,target:v,to:b,preventScrollReset:A,unstable_viewTransition:w}=r,x=Ehe(r,She),{basename:M}=K.useContext(xh),V,G=!1;if(typeof b=="string"&&Rhe.test(b)&&(V=b,whe))try{let L=new URL(window.location.href),X=b.startsWith("//")?new URL(L.protocol+b):new URL(b),ee=tM(X.pathname,M);X.origin===L.origin&&ee!=null?b=ee+X.search+X.hash:G=!0}catch{}let H=Zue(b,{relative:d}),F=Ihe(b,{replace:f,state:_,target:v,preventScrollReset:A,relative:d,unstable_viewTransition:w});function B(L){c&&c(L),L.defaultPrevented||F(L)}return K.createElement("a",KD({},x,{href:V||H,onClick:G||h?c:B,ref:o,target:v}))});var j8;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(j8||(j8={}));var F8;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(F8||(F8={}));function Ihe(t,r){let{target:o,replace:c,state:d,preventScrollReset:h,relative:f,unstable_viewTransition:_}=r===void 0?{}:r,v=Wd(),b=sf(),A=_9(t,{relative:f});return K.useCallback(w=>{if(yhe(w,o)){w.preventDefault();let x=c!==void 0?c:jw(b)===jw(A);v(t,{replace:x,state:d,preventScrollReset:h,relative:f,unstable_viewTransition:_})}},[b,v,A,c,d,o,t,h,f,_])}var Ahe={prefix:"fas",iconName:"bars",icon:[448,512,["navicon"],"f0c9","M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"]},vh={prefix:"fas",iconName:"lock",icon:[448,512,[128274],"f023","M144 144v48H304V144c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192V144C80 64.5 144.5 0 224 0s144 64.5 144 144v48h16c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V256c0-35.3 28.7-64 64-64H80z"]},Ohe={prefix:"fas",iconName:"user-group",icon:[640,512,[128101,"user-friends"],"f500","M96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM0 482.3C0 383.8 79.8 304 178.3 304h91.4C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3zM609.3 512H471.4c5.4-9.4 8.6-20.3 8.6-32v-8c0-60.7-27.1-115.2-69.8-151.8c2.4-.1 4.7-.2 7.1-.2h61.4C567.8 320 640 392.2 640 481.3c0 17-13.8 30.7-30.7 30.7zM432 256c-31 0-59-12.6-79.3-32.9C372.4 196.5 384 163.6 384 128c0-26.8-6.6-52.1-18.3-74.3C384.3 40.1 407.2 32 432 32c61.9 0 112 50.1 112 112s-50.1 112-112 112z"]},y9={prefix:"fas",iconName:"camera-retro",icon:[512,512,[128247],"f083","M220.6 121.2L271.1 96 448 96v96H333.2c-21.9-15.1-48.5-24-77.2-24s-55.2 8.9-77.2 24H64V128H192c9.9 0 19.7-2.3 28.6-6.8zM0 128V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H271.1c-9.9 0-19.7 2.3-28.6 6.8L192 64H160V48c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16l0 16C28.7 64 0 92.7 0 128zM168 304a88 88 0 1 1 176 0 88 88 0 1 1 -176 0z"]},Nhe={prefix:"fas",iconName:"paperclip",icon:[448,512,[128206],"f0c6","M364.2 83.8c-24.4-24.4-64-24.4-88.4 0l-184 184c-42.1 42.1-42.1 110.3 0 152.4s110.3 42.1 152.4 0l152-152c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-152 152c-64 64-167.6 64-231.6 0s-64-167.6 0-231.6l184-184c46.3-46.3 121.3-46.3 167.6 0s46.3 121.3 0 167.6l-176 176c-28.6 28.6-75 28.6-103.6 0s-28.6-75 0-103.6l144-144c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-144 144c-6.7 6.7-6.7 17.7 0 24.4s17.7 6.7 24.4 0l176-176c24.4-24.4 24.4-64 0-88.4z"]},Vw={prefix:"fas",iconName:"mobile-screen",icon:[384,512,["mobile-android-alt"],"f3cf","M16 64C16 28.7 44.7 0 80 0H304c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H80c-35.3 0-64-28.7-64-64V64zM144 448c0 8.8 7.2 16 16 16h64c8.8 0 16-7.2 16-16s-7.2-16-16-16H160c-8.8 0-16 7.2-16 16zM304 64H80V384H304V64z"]},khe={prefix:"fas",iconName:"ellipsis",icon:[448,512,["ellipsis-h"],"f141","M8 256a56 56 0 1 1 112 0A56 56 0 1 1 8 256zm160 0a56 56 0 1 1 112 0 56 56 0 1 1 -112 0zm216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112z"]},xhe=khe,Phe={prefix:"fas",iconName:"magnifying-glass",icon:[512,512,[128269,"search"],"f002","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"]},Ny={prefix:"fas",iconName:"xmark",icon:[384,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"]};function V8(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);r&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),o.push.apply(o,c)}return o}function mt(t){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?V8(Object(o),!0).forEach(function(c){as(t,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):V8(Object(o)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(o,c))})}return t}function Bw(t){"@babel/helpers - typeof";return Bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Bw(t)}function Dhe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function B8(t,r){for(var o=0;o<r.length;o++){var c=r[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,c.key,c)}}function Lhe(t,r,o){return r&&B8(t.prototype,r),o&&B8(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function as(t,r,o){return r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function oM(t,r){return Uhe(t)||Fhe(t,r)||S9(t,r)||Bhe()}function d0(t){return Mhe(t)||jhe(t)||S9(t)||Vhe()}function Mhe(t){if(Array.isArray(t))return YD(t)}function Uhe(t){if(Array.isArray(t))return t}function jhe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Fhe(t,r){var o=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(o!=null){var c=[],d=!0,h=!1,f,_;try{for(o=o.call(t);!(d=(f=o.next()).done)&&(c.push(f.value),!(r&&c.length===r));d=!0);}catch(v){h=!0,_=v}finally{try{!d&&o.return!=null&&o.return()}finally{if(h)throw _}}return c}}function S9(t,r){if(t){if(typeof t=="string")return YD(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return YD(t,r)}}function YD(t,r){(r==null||r>t.length)&&(r=t.length);for(var o=0,c=new Array(r);o<r;o++)c[o]=t[o];return c}function Vhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var W8=function(){},aM={},b9={},T9=null,C9={mark:W8,measure:W8};try{typeof window<"u"&&(aM=window),typeof document<"u"&&(b9=document),typeof MutationObserver<"u"&&(T9=MutationObserver),typeof performance<"u"&&(C9=performance)}catch{}var Whe=aM.navigator||{},$8=Whe.userAgent,G8=$8===void 0?"":$8,Th=aM,Qr=b9,H8=T9,SC=C9;Th.document;var $d=!!Qr.documentElement&&!!Qr.head&&typeof Qr.addEventListener=="function"&&typeof Qr.createElement=="function",w9=~G8.indexOf("MSIE")||~G8.indexOf("Trident/"),bC,TC,CC,wC,RC,Ld="___FONT_AWESOME___",qD=16,R9="fa",I9="svg-inline--fa",Jp="data-fa-i2svg",XD="data-fa-pseudo-element",$he="data-fa-pseudo-element-pending",cM="data-prefix",lM="data-icon",z8="fontawesome-i2svg",Ghe="async",Hhe=["HTML","HEAD","STYLE","SCRIPT"],A9=function(){try{return!0}catch{return!1}}(),Xr="classic",Ni="sharp",dM=[Xr,Ni];function u0(t){return new Proxy(t,{get:function(o,c){return c in o?o[c]:o[Xr]}})}var ky=u0((bC={},as(bC,Xr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit",fakd:"kit","fa-kit":"kit","fa-kit-duotone":"kit"}),as(bC,Ni,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"}),bC)),xy=u0((TC={},as(TC,Xr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),as(TC,Ni,{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"}),TC)),Py=u0((CC={},as(CC,Xr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),as(CC,Ni,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"}),CC)),zhe=u0((wC={},as(wC,Xr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),as(wC,Ni,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"}),wC)),Khe=/fa(s|r|l|t|d|b|k|ss|sr|sl|st)?[\-\ ]/,O9="fa-layers-text",Yhe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,qhe=u0((RC={},as(RC,Xr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),as(RC,Ni,{900:"fass",400:"fasr",300:"fasl",100:"fast"}),RC)),N9=[1,2,3,4,5,6,7,8,9,10],Xhe=N9.concat([11,12,13,14,15,16,17,18,19,20]),Jhe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],kp={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Dy=new Set;Object.keys(xy[Xr]).map(Dy.add.bind(Dy));Object.keys(xy[Ni]).map(Dy.add.bind(Dy));var Qhe=[].concat(dM,d0(Dy),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",kp.GROUP,kp.SWAP_OPACITY,kp.PRIMARY,kp.SECONDARY]).concat(N9.map(function(t){return"".concat(t,"x")})).concat(Xhe.map(function(t){return"w-".concat(t)})),ry=Th.FontAwesomeConfig||{};function Zhe(t){var r=Qr.querySelector("script["+t+"]");if(r)return r.getAttribute(t)}function epe(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}if(Qr&&typeof Qr.querySelector=="function"){var tpe=[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];tpe.forEach(function(t){var r=oM(t,2),o=r[0],c=r[1],d=epe(Zhe(o));d!=null&&(ry[c]=d)})}var k9={styleDefault:"solid",familyDefault:"classic",cssPrefix:R9,replacementClass:I9,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};ry.familyPrefix&&(ry.cssPrefix=ry.familyPrefix);var Bg=mt(mt({},k9),ry);Bg.autoReplaceSvg||(Bg.observeMutations=!1);var Nt={};Object.keys(k9).forEach(function(t){Object.defineProperty(Nt,t,{enumerable:!0,set:function(o){Bg[t]=o,iy.forEach(function(c){return c(Nt)})},get:function(){return Bg[t]}})});Object.defineProperty(Nt,"familyPrefix",{enumerable:!0,set:function(r){Bg.cssPrefix=r,iy.forEach(function(o){return o(Nt)})},get:function(){return Bg.cssPrefix}});Th.FontAwesomeConfig=Nt;var iy=[];function npe(t){return iy.push(t),function(){iy.splice(iy.indexOf(t),1)}}var Bu=qD,Ol={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function rpe(t){if(!(!t||!$d)){var r=Qr.createElement("style");r.setAttribute("type","text/css"),r.innerHTML=t;for(var o=Qr.head.childNodes,c=null,d=o.length-1;d>-1;d--){var h=o[d],f=(h.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(f)>-1&&(c=h)}return Qr.head.insertBefore(r,c),t}}var ipe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Ly(){for(var t=12,r="";t-- >0;)r+=ipe[Math.random()*62|0];return r}function e_(t){for(var r=[],o=(t||[]).length>>>0;o--;)r[o]=t[o];return r}function uM(t){return t.classList?e_(t.classList):(t.getAttribute("class")||"").split(" ").filter(function(r){return r})}function x9(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function spe(t){return Object.keys(t||{}).reduce(function(r,o){return r+"".concat(o,'="').concat(x9(t[o]),'" ')},"").trim()}function PR(t){return Object.keys(t||{}).reduce(function(r,o){return r+"".concat(o,": ").concat(t[o].trim(),";")},"")}function hM(t){return t.size!==Ol.size||t.x!==Ol.x||t.y!==Ol.y||t.rotate!==Ol.rotate||t.flipX||t.flipY}function ope(t){var r=t.transform,o=t.containerWidth,c=t.iconWidth,d={transform:"translate(".concat(o/2," 256)")},h="translate(".concat(r.x*32,", ").concat(r.y*32,") "),f="scale(".concat(r.size/16*(r.flipX?-1:1),", ").concat(r.size/16*(r.flipY?-1:1),") "),_="rotate(".concat(r.rotate," 0 0)"),v={transform:"".concat(h," ").concat(f," ").concat(_)},b={transform:"translate(".concat(c/2*-1," -256)")};return{outer:d,inner:v,path:b}}function ape(t){var r=t.transform,o=t.width,c=o===void 0?qD:o,d=t.height,h=d===void 0?qD:d,f=t.startCentered,_=f===void 0?!1:f,v="";return _&&w9?v+="translate(".concat(r.x/Bu-c/2,"em, ").concat(r.y/Bu-h/2,"em) "):_?v+="translate(calc(-50% + ".concat(r.x/Bu,"em), calc(-50% + ").concat(r.y/Bu,"em)) "):v+="translate(".concat(r.x/Bu,"em, ").concat(r.y/Bu,"em) "),v+="scale(".concat(r.size/Bu*(r.flipX?-1:1),", ").concat(r.size/Bu*(r.flipY?-1:1),") "),v+="rotate(".concat(r.rotate,"deg) "),v}var cpe=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    -webkit-transition-delay: 0s;
            transition-delay: 0s;
    -webkit-transition-duration: 0s;
            transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function P9(){var t=R9,r=I9,o=Nt.cssPrefix,c=Nt.replacementClass,d=cpe;if(o!==t||c!==r){var h=new RegExp("\\.".concat(t,"\\-"),"g"),f=new RegExp("\\--".concat(t,"\\-"),"g"),_=new RegExp("\\.".concat(r),"g");d=d.replace(h,".".concat(o,"-")).replace(f,"--".concat(o,"-")).replace(_,".".concat(c))}return d}var K8=!1;function oP(){Nt.autoAddCss&&!K8&&(rpe(P9()),K8=!0)}var lpe={mixout:function(){return{dom:{css:P9,insertCss:oP}}},hooks:function(){return{beforeDOMElementCreation:function(){oP()},beforeI2svg:function(){oP()}}}},Md=Th||{};Md[Ld]||(Md[Ld]={});Md[Ld].styles||(Md[Ld].styles={});Md[Ld].hooks||(Md[Ld].hooks={});Md[Ld].shims||(Md[Ld].shims=[]);var Mc=Md[Ld],D9=[],dpe=function t(){Qr.removeEventListener("DOMContentLoaded",t),Ww=1,D9.map(function(r){return r()})},Ww=!1;$d&&(Ww=(Qr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Qr.readyState),Ww||Qr.addEventListener("DOMContentLoaded",dpe));function upe(t){$d&&(Ww?setTimeout(t,0):D9.push(t))}function h0(t){var r=t.tag,o=t.attributes,c=o===void 0?{}:o,d=t.children,h=d===void 0?[]:d;return typeof t=="string"?x9(t):"<".concat(r," ").concat(spe(c),">").concat(h.map(h0).join(""),"</").concat(r,">")}function Y8(t,r,o){if(t&&t[r]&&t[r][o])return{prefix:r,iconName:o,icon:t[r][o]}}var hpe=function(r,o){return function(c,d,h,f){return r.call(o,c,d,h,f)}},aP=function(r,o,c,d){var h=Object.keys(r),f=h.length,_=d!==void 0?hpe(o,d):o,v,b,A;for(c===void 0?(v=1,A=r[h[0]]):(v=0,A=c);v<f;v++)b=h[v],A=_(A,r[b],b,r);return A};function ppe(t){for(var r=[],o=0,c=t.length;o<c;){var d=t.charCodeAt(o++);if(d>=55296&&d<=56319&&o<c){var h=t.charCodeAt(o++);(h&64512)==56320?r.push(((d&1023)<<10)+(h&1023)+65536):(r.push(d),o--)}else r.push(d)}return r}function JD(t){var r=ppe(t);return r.length===1?r[0].toString(16):null}function fpe(t,r){var o=t.length,c=t.charCodeAt(r),d;return c>=55296&&c<=56319&&o>r+1&&(d=t.charCodeAt(r+1),d>=56320&&d<=57343)?(c-55296)*1024+d-56320+65536:c}function q8(t){return Object.keys(t).reduce(function(r,o){var c=t[o],d=!!c.icon;return d?r[c.iconName]=c.icon:r[o]=c,r},{})}function QD(t,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=o.skipHooks,d=c===void 0?!1:c,h=q8(r);typeof Mc.hooks.addPack=="function"&&!d?Mc.hooks.addPack(t,q8(r)):Mc.styles[t]=mt(mt({},Mc.styles[t]||{}),h),t==="fas"&&QD("fa",r)}var IC,AC,OC,ig=Mc.styles,mpe=Mc.shims,gpe=(IC={},as(IC,Xr,Object.values(Py[Xr])),as(IC,Ni,Object.values(Py[Ni])),IC),pM=null,L9={},M9={},U9={},j9={},F9={},_pe=(AC={},as(AC,Xr,Object.keys(ky[Xr])),as(AC,Ni,Object.keys(ky[Ni])),AC);function Epe(t){return~Qhe.indexOf(t)}function vpe(t,r){var o=r.split("-"),c=o[0],d=o.slice(1).join("-");return c===t&&d!==""&&!Epe(d)?d:null}var V9=function(){var r=function(h){return aP(ig,function(f,_,v){return f[v]=aP(_,h,{}),f},{})};L9=r(function(d,h,f){if(h[3]&&(d[h[3]]=f),h[2]){var _=h[2].filter(function(v){return typeof v=="number"});_.forEach(function(v){d[v.toString(16)]=f})}return d}),M9=r(function(d,h,f){if(d[f]=f,h[2]){var _=h[2].filter(function(v){return typeof v=="string"});_.forEach(function(v){d[v]=f})}return d}),F9=r(function(d,h,f){var _=h[2];return d[f]=f,_.forEach(function(v){d[v]=f}),d});var o="far"in ig||Nt.autoFetchSvg,c=aP(mpe,function(d,h){var f=h[0],_=h[1],v=h[2];return _==="far"&&!o&&(_="fas"),typeof f=="string"&&(d.names[f]={prefix:_,iconName:v}),typeof f=="number"&&(d.unicodes[f.toString(16)]={prefix:_,iconName:v}),d},{names:{},unicodes:{}});U9=c.names,j9=c.unicodes,pM=DR(Nt.styleDefault,{family:Nt.familyDefault})};npe(function(t){pM=DR(t.styleDefault,{family:Nt.familyDefault})});V9();function fM(t,r){return(L9[t]||{})[r]}function ype(t,r){return(M9[t]||{})[r]}function xp(t,r){return(F9[t]||{})[r]}function B9(t){return U9[t]||{prefix:null,iconName:null}}function Spe(t){var r=j9[t],o=fM("fas",t);return r||(o?{prefix:"fas",iconName:o}:null)||{prefix:null,iconName:null}}function Ch(){return pM}var mM=function(){return{prefix:null,iconName:null,rest:[]}};function DR(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.family,c=o===void 0?Xr:o,d=ky[c][t],h=xy[c][t]||xy[c][d],f=t in Mc.styles?t:null;return h||f||null}var X8=(OC={},as(OC,Xr,Object.keys(Py[Xr])),as(OC,Ni,Object.keys(Py[Ni])),OC);function LR(t){var r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=o.skipLookups,d=c===void 0?!1:c,h=(r={},as(r,Xr,"".concat(Nt.cssPrefix,"-").concat(Xr)),as(r,Ni,"".concat(Nt.cssPrefix,"-").concat(Ni)),r),f=null,_=Xr;(t.includes(h[Xr])||t.some(function(b){return X8[Xr].includes(b)}))&&(_=Xr),(t.includes(h[Ni])||t.some(function(b){return X8[Ni].includes(b)}))&&(_=Ni);var v=t.reduce(function(b,A){var w=vpe(Nt.cssPrefix,A);if(ig[A]?(A=gpe[_].includes(A)?zhe[_][A]:A,f=A,b.prefix=A):_pe[_].indexOf(A)>-1?(f=A,b.prefix=DR(A,{family:_})):w?b.iconName=w:A!==Nt.replacementClass&&A!==h[Xr]&&A!==h[Ni]&&b.rest.push(A),!d&&b.prefix&&b.iconName){var x=f==="fa"?B9(b.iconName):{},M=xp(b.prefix,b.iconName);x.prefix&&(f=null),b.iconName=x.iconName||M||b.iconName,b.prefix=x.prefix||b.prefix,b.prefix==="far"&&!ig.far&&ig.fas&&!Nt.autoFetchSvg&&(b.prefix="fas")}return b},mM());return(t.includes("fa-brands")||t.includes("fab"))&&(v.prefix="fab"),(t.includes("fa-duotone")||t.includes("fad"))&&(v.prefix="fad"),!v.prefix&&_===Ni&&(ig.fass||Nt.autoFetchSvg)&&(v.prefix="fass",v.iconName=xp(v.prefix,v.iconName)||v.iconName),(v.prefix==="fa"||f==="fa")&&(v.prefix=Ch()||"fas"),v}var bpe=function(){function t(){Dhe(this,t),this.definitions={}}return Lhe(t,[{key:"add",value:function(){for(var o=this,c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];var f=d.reduce(this._pullDefinitions,{});Object.keys(f).forEach(function(_){o.definitions[_]=mt(mt({},o.definitions[_]||{}),f[_]),QD(_,f[_]);var v=Py[Xr][_];v&&QD(v,f[_]),V9()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(o,c){var d=c.prefix&&c.iconName&&c.icon?{0:c}:c;return Object.keys(d).map(function(h){var f=d[h],_=f.prefix,v=f.iconName,b=f.icon,A=b[2];o[_]||(o[_]={}),A.length>0&&A.forEach(function(w){typeof w=="string"&&(o[_][w]=b)}),o[_][v]=b}),o}}]),t}(),J8=[],sg={},fg={},Tpe=Object.keys(fg);function Cpe(t,r){var o=r.mixoutsTo;return J8=t,sg={},Object.keys(fg).forEach(function(c){Tpe.indexOf(c)===-1&&delete fg[c]}),J8.forEach(function(c){var d=c.mixout?c.mixout():{};if(Object.keys(d).forEach(function(f){typeof d[f]=="function"&&(o[f]=d[f]),Bw(d[f])==="object"&&Object.keys(d[f]).forEach(function(_){o[f]||(o[f]={}),o[f][_]=d[f][_]})}),c.hooks){var h=c.hooks();Object.keys(h).forEach(function(f){sg[f]||(sg[f]=[]),sg[f].push(h[f])})}c.provides&&c.provides(fg)}),o}function ZD(t,r){for(var o=arguments.length,c=new Array(o>2?o-2:0),d=2;d<o;d++)c[d-2]=arguments[d];var h=sg[t]||[];return h.forEach(function(f){r=f.apply(null,[r].concat(c))}),r}function Qp(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),c=1;c<r;c++)o[c-1]=arguments[c];var d=sg[t]||[];d.forEach(function(h){h.apply(null,o)})}function Ud(){var t=arguments[0],r=Array.prototype.slice.call(arguments,1);return fg[t]?fg[t].apply(null,r):void 0}function eL(t){t.prefix==="fa"&&(t.prefix="fas");var r=t.iconName,o=t.prefix||Ch();if(r)return r=xp(o,r)||r,Y8(W9.definitions,o,r)||Y8(Mc.styles,o,r)}var W9=new bpe,wpe=function(){Nt.autoReplaceSvg=!1,Nt.observeMutations=!1,Qp("noAuto")},Rpe={i2svg:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return $d?(Qp("beforeI2svg",r),Ud("pseudoElements2svg",r),Ud("i2svg",r)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=r.autoReplaceSvgRoot;Nt.autoReplaceSvg===!1&&(Nt.autoReplaceSvg=!0),Nt.observeMutations=!0,upe(function(){Ape({autoReplaceSvgRoot:o}),Qp("watch",r)})}},Ipe={icon:function(r){if(r===null)return null;if(Bw(r)==="object"&&r.prefix&&r.iconName)return{prefix:r.prefix,iconName:xp(r.prefix,r.iconName)||r.iconName};if(Array.isArray(r)&&r.length===2){var o=r[1].indexOf("fa-")===0?r[1].slice(3):r[1],c=DR(r[0]);return{prefix:c,iconName:xp(c,o)||o}}if(typeof r=="string"&&(r.indexOf("".concat(Nt.cssPrefix,"-"))>-1||r.match(Khe))){var d=LR(r.split(" "),{skipLookups:!0});return{prefix:d.prefix||Ch(),iconName:xp(d.prefix,d.iconName)||d.iconName}}if(typeof r=="string"){var h=Ch();return{prefix:h,iconName:xp(h,r)||r}}}},_a={noAuto:wpe,config:Nt,dom:Rpe,parse:Ipe,library:W9,findIconDefinition:eL,toHtml:h0},Ape=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=r.autoReplaceSvgRoot,c=o===void 0?Qr:o;(Object.keys(Mc.styles).length>0||Nt.autoFetchSvg)&&$d&&Nt.autoReplaceSvg&&_a.dom.i2svg({node:c})};function MR(t,r){return Object.defineProperty(t,"abstract",{get:r}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(c){return h0(c)})}}),Object.defineProperty(t,"node",{get:function(){if($d){var c=Qr.createElement("div");return c.innerHTML=t.html,c.children}}}),t}function Ope(t){var r=t.children,o=t.main,c=t.mask,d=t.attributes,h=t.styles,f=t.transform;if(hM(f)&&o.found&&!c.found){var _=o.width,v=o.height,b={x:_/v/2,y:.5};d.style=PR(mt(mt({},h),{},{"transform-origin":"".concat(b.x+f.x/16,"em ").concat(b.y+f.y/16,"em")}))}return[{tag:"svg",attributes:d,children:r}]}function Npe(t){var r=t.prefix,o=t.iconName,c=t.children,d=t.attributes,h=t.symbol,f=h===!0?"".concat(r,"-").concat(Nt.cssPrefix,"-").concat(o):h;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:mt(mt({},d),{},{id:f}),children:c}]}]}function gM(t){var r=t.icons,o=r.main,c=r.mask,d=t.prefix,h=t.iconName,f=t.transform,_=t.symbol,v=t.title,b=t.maskId,A=t.titleId,w=t.extra,x=t.watchable,M=x===void 0?!1:x,V=c.found?c:o,G=V.width,H=V.height,F=d==="fak",B=[Nt.replacementClass,h?"".concat(Nt.cssPrefix,"-").concat(h):""].filter(function(fe){return w.classes.indexOf(fe)===-1}).filter(function(fe){return fe!==""||!!fe}).concat(w.classes).join(" "),L={children:[],attributes:mt(mt({},w.attributes),{},{"data-prefix":d,"data-icon":h,class:B,role:w.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(G," ").concat(H)})},X=F&&!~w.classes.indexOf("fa-fw")?{width:"".concat(G/H*16*.0625,"em")}:{};M&&(L.attributes[Jp]=""),v&&(L.children.push({tag:"title",attributes:{id:L.attributes["aria-labelledby"]||"title-".concat(A||Ly())},children:[v]}),delete L.attributes.title);var ee=mt(mt({},L),{},{prefix:d,iconName:h,main:o,mask:c,maskId:b,transform:f,symbol:_,styles:mt(mt({},X),w.styles)}),ce=c.found&&o.found?Ud("generateAbstractMask",ee)||{children:[],attributes:{}}:Ud("generateAbstractIcon",ee)||{children:[],attributes:{}},ie=ce.children,ne=ce.attributes;return ee.children=ie,ee.attributes=ne,_?Npe(ee):Ope(ee)}function Q8(t){var r=t.content,o=t.width,c=t.height,d=t.transform,h=t.title,f=t.extra,_=t.watchable,v=_===void 0?!1:_,b=mt(mt(mt({},f.attributes),h?{title:h}:{}),{},{class:f.classes.join(" ")});v&&(b[Jp]="");var A=mt({},f.styles);hM(d)&&(A.transform=ape({transform:d,startCentered:!0,width:o,height:c}),A["-webkit-transform"]=A.transform);var w=PR(A);w.length>0&&(b.style=w);var x=[];return x.push({tag:"span",attributes:b,children:[r]}),h&&x.push({tag:"span",attributes:{class:"sr-only"},children:[h]}),x}function kpe(t){var r=t.content,o=t.title,c=t.extra,d=mt(mt(mt({},c.attributes),o?{title:o}:{}),{},{class:c.classes.join(" ")}),h=PR(c.styles);h.length>0&&(d.style=h);var f=[];return f.push({tag:"span",attributes:d,children:[r]}),o&&f.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),f}var cP=Mc.styles;function tL(t){var r=t[0],o=t[1],c=t.slice(4),d=oM(c,1),h=d[0],f=null;return Array.isArray(h)?f={tag:"g",attributes:{class:"".concat(Nt.cssPrefix,"-").concat(kp.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Nt.cssPrefix,"-").concat(kp.SECONDARY),fill:"currentColor",d:h[0]}},{tag:"path",attributes:{class:"".concat(Nt.cssPrefix,"-").concat(kp.PRIMARY),fill:"currentColor",d:h[1]}}]}:f={tag:"path",attributes:{fill:"currentColor",d:h}},{found:!0,width:r,height:o,icon:f}}var xpe={found:!1,width:512,height:512};function Ppe(t,r){!A9&&!Nt.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(r,'" is missing.'))}function nL(t,r){var o=r;return r==="fa"&&Nt.styleDefault!==null&&(r=Ch()),new Promise(function(c,d){if(Ud("missingIconAbstract"),o==="fa"){var h=B9(t)||{};t=h.iconName||t,r=h.prefix||r}if(t&&r&&cP[r]&&cP[r][t]){var f=cP[r][t];return c(tL(f))}Ppe(t,r),c(mt(mt({},xpe),{},{icon:Nt.showMissingIcons&&t?Ud("missingIconAbstract")||{}:{}}))})}var Z8=function(){},rL=Nt.measurePerformance&&SC&&SC.mark&&SC.measure?SC:{mark:Z8,measure:Z8},Bv='FA "6.5.1"',Dpe=function(r){return rL.mark("".concat(Bv," ").concat(r," begins")),function(){return $9(r)}},$9=function(r){rL.mark("".concat(Bv," ").concat(r," ends")),rL.measure("".concat(Bv," ").concat(r),"".concat(Bv," ").concat(r," begins"),"".concat(Bv," ").concat(r," ends"))},_M={begin:Dpe,end:$9},tw=function(){};function e$(t){var r=t.getAttribute?t.getAttribute(Jp):null;return typeof r=="string"}function Lpe(t){var r=t.getAttribute?t.getAttribute(cM):null,o=t.getAttribute?t.getAttribute(lM):null;return r&&o}function Mpe(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(Nt.replacementClass)}function Upe(){if(Nt.autoReplaceSvg===!0)return nw.replace;var t=nw[Nt.autoReplaceSvg];return t||nw.replace}function jpe(t){return Qr.createElementNS("http://www.w3.org/2000/svg",t)}function Fpe(t){return Qr.createElement(t)}function G9(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.ceFn,c=o===void 0?t.tag==="svg"?jpe:Fpe:o;if(typeof t=="string")return Qr.createTextNode(t);var d=c(t.tag);Object.keys(t.attributes||[]).forEach(function(f){d.setAttribute(f,t.attributes[f])});var h=t.children||[];return h.forEach(function(f){d.appendChild(G9(f,{ceFn:c}))}),d}function Vpe(t){var r=" ".concat(t.outerHTML," ");return r="".concat(r,"Font Awesome fontawesome.com "),r}var nw={replace:function(r){var o=r[0];if(o.parentNode)if(r[1].forEach(function(d){o.parentNode.insertBefore(G9(d),o)}),o.getAttribute(Jp)===null&&Nt.keepOriginalSource){var c=Qr.createComment(Vpe(o));o.parentNode.replaceChild(c,o)}else o.remove()},nest:function(r){var o=r[0],c=r[1];if(~uM(o).indexOf(Nt.replacementClass))return nw.replace(r);var d=new RegExp("".concat(Nt.cssPrefix,"-.*"));if(delete c[0].attributes.id,c[0].attributes.class){var h=c[0].attributes.class.split(" ").reduce(function(_,v){return v===Nt.replacementClass||v.match(d)?_.toSvg.push(v):_.toNode.push(v),_},{toNode:[],toSvg:[]});c[0].attributes.class=h.toSvg.join(" "),h.toNode.length===0?o.removeAttribute("class"):o.setAttribute("class",h.toNode.join(" "))}var f=c.map(function(_){return h0(_)}).join(`
`);o.setAttribute(Jp,""),o.innerHTML=f}};function t$(t){t()}function H9(t,r){var o=typeof r=="function"?r:tw;if(t.length===0)o();else{var c=t$;Nt.mutateApproach===Ghe&&(c=Th.requestAnimationFrame||t$),c(function(){var d=Upe(),h=_M.begin("mutate");t.map(d),h(),o()})}}var EM=!1;function z9(){EM=!0}function iL(){EM=!1}var $w=null;function n$(t){if(H8&&Nt.observeMutations){var r=t.treeCallback,o=r===void 0?tw:r,c=t.nodeCallback,d=c===void 0?tw:c,h=t.pseudoElementsCallback,f=h===void 0?tw:h,_=t.observeMutationsRoot,v=_===void 0?Qr:_;$w=new H8(function(b){if(!EM){var A=Ch();e_(b).forEach(function(w){if(w.type==="childList"&&w.addedNodes.length>0&&!e$(w.addedNodes[0])&&(Nt.searchPseudoElements&&f(w.target),o(w.target)),w.type==="attributes"&&w.target.parentNode&&Nt.searchPseudoElements&&f(w.target.parentNode),w.type==="attributes"&&e$(w.target)&&~Jhe.indexOf(w.attributeName))if(w.attributeName==="class"&&Lpe(w.target)){var x=LR(uM(w.target)),M=x.prefix,V=x.iconName;w.target.setAttribute(cM,M||A),V&&w.target.setAttribute(lM,V)}else Mpe(w.target)&&d(w.target)})}}),$d&&$w.observe(v,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Bpe(){$w&&$w.disconnect()}function Wpe(t){var r=t.getAttribute("style"),o=[];return r&&(o=r.split(";").reduce(function(c,d){var h=d.split(":"),f=h[0],_=h.slice(1);return f&&_.length>0&&(c[f]=_.join(":").trim()),c},{})),o}function $pe(t){var r=t.getAttribute("data-prefix"),o=t.getAttribute("data-icon"),c=t.innerText!==void 0?t.innerText.trim():"",d=LR(uM(t));return d.prefix||(d.prefix=Ch()),r&&o&&(d.prefix=r,d.iconName=o),d.iconName&&d.prefix||(d.prefix&&c.length>0&&(d.iconName=ype(d.prefix,t.innerText)||fM(d.prefix,JD(t.innerText))),!d.iconName&&Nt.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(d.iconName=t.firstChild.data)),d}function Gpe(t){var r=e_(t.attributes).reduce(function(d,h){return d.name!=="class"&&d.name!=="style"&&(d[h.name]=h.value),d},{}),o=t.getAttribute("title"),c=t.getAttribute("data-fa-title-id");return Nt.autoA11y&&(o?r["aria-labelledby"]="".concat(Nt.replacementClass,"-title-").concat(c||Ly()):(r["aria-hidden"]="true",r.focusable="false")),r}function Hpe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Ol,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function r$(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},o=$pe(t),c=o.iconName,d=o.prefix,h=o.rest,f=Gpe(t),_=ZD("parseNodeAttributes",{},t),v=r.styleParser?Wpe(t):[];return mt({iconName:c,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:d,transform:Ol,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:h,styles:v,attributes:f}},_)}var zpe=Mc.styles;function K9(t){var r=Nt.autoReplaceSvg==="nest"?r$(t,{styleParser:!1}):r$(t);return~r.extra.classes.indexOf(O9)?Ud("generateLayersText",t,r):Ud("generateSvgReplacementMutation",t,r)}var wh=new Set;dM.map(function(t){wh.add("fa-".concat(t))});Object.keys(ky[Xr]).map(wh.add.bind(wh));Object.keys(ky[Ni]).map(wh.add.bind(wh));wh=d0(wh);function i$(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!$d)return Promise.resolve();var o=Qr.documentElement.classList,c=function(w){return o.add("".concat(z8,"-").concat(w))},d=function(w){return o.remove("".concat(z8,"-").concat(w))},h=Nt.autoFetchSvg?wh:dM.map(function(A){return"fa-".concat(A)}).concat(Object.keys(zpe));h.includes("fa")||h.push("fa");var f=[".".concat(O9,":not([").concat(Jp,"])")].concat(h.map(function(A){return".".concat(A,":not([").concat(Jp,"])")})).join(", ");if(f.length===0)return Promise.resolve();var _=[];try{_=e_(t.querySelectorAll(f))}catch{}if(_.length>0)c("pending"),d("complete");else return Promise.resolve();var v=_M.begin("onTree"),b=_.reduce(function(A,w){try{var x=K9(w);x&&A.push(x)}catch(M){A9||M.name==="MissingIcon"&&console.error(M)}return A},[]);return new Promise(function(A,w){Promise.all(b).then(function(x){H9(x,function(){c("active"),c("complete"),d("pending"),typeof r=="function"&&r(),v(),A()})}).catch(function(x){v(),w(x)})})}function Kpe(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;K9(t).then(function(o){o&&H9([o],r)})}function Ype(t){return function(r){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=(r||{}).icon?r:eL(r||{}),d=o.mask;return d&&(d=(d||{}).icon?d:eL(d||{})),t(c,mt(mt({},o),{},{mask:d}))}}var qpe=function(r){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=o.transform,d=c===void 0?Ol:c,h=o.symbol,f=h===void 0?!1:h,_=o.mask,v=_===void 0?null:_,b=o.maskId,A=b===void 0?null:b,w=o.title,x=w===void 0?null:w,M=o.titleId,V=M===void 0?null:M,G=o.classes,H=G===void 0?[]:G,F=o.attributes,B=F===void 0?{}:F,L=o.styles,X=L===void 0?{}:L;if(r){var ee=r.prefix,ce=r.iconName,ie=r.icon;return MR(mt({type:"icon"},r),function(){return Qp("beforeDOMElementCreation",{iconDefinition:r,params:o}),Nt.autoA11y&&(x?B["aria-labelledby"]="".concat(Nt.replacementClass,"-title-").concat(V||Ly()):(B["aria-hidden"]="true",B.focusable="false")),gM({icons:{main:tL(ie),mask:v?tL(v.icon):{found:!1,width:null,height:null,icon:{}}},prefix:ee,iconName:ce,transform:mt(mt({},Ol),d),symbol:f,title:x,maskId:A,titleId:V,extra:{attributes:B,styles:X,classes:H}})})}},Xpe={mixout:function(){return{icon:Ype(qpe)}},hooks:function(){return{mutationObserverCallbacks:function(o){return o.treeCallback=i$,o.nodeCallback=Kpe,o}}},provides:function(r){r.i2svg=function(o){var c=o.node,d=c===void 0?Qr:c,h=o.callback,f=h===void 0?function(){}:h;return i$(d,f)},r.generateSvgReplacementMutation=function(o,c){var d=c.iconName,h=c.title,f=c.titleId,_=c.prefix,v=c.transform,b=c.symbol,A=c.mask,w=c.maskId,x=c.extra;return new Promise(function(M,V){Promise.all([nL(d,_),A.iconName?nL(A.iconName,A.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(G){var H=oM(G,2),F=H[0],B=H[1];M([o,gM({icons:{main:F,mask:B},prefix:_,iconName:d,transform:v,symbol:b,maskId:w,title:h,titleId:f,extra:x,watchable:!0})])}).catch(V)})},r.generateAbstractIcon=function(o){var c=o.children,d=o.attributes,h=o.main,f=o.transform,_=o.styles,v=PR(_);v.length>0&&(d.style=v);var b;return hM(f)&&(b=Ud("generateAbstractTransformGrouping",{main:h,transform:f,containerWidth:h.width,iconWidth:h.width})),c.push(b||h.icon),{children:c,attributes:d}}}},Jpe={mixout:function(){return{layer:function(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=c.classes,h=d===void 0?[]:d;return MR({type:"layer"},function(){Qp("beforeDOMElementCreation",{assembler:o,params:c});var f=[];return o(function(_){Array.isArray(_)?_.map(function(v){f=f.concat(v.abstract)}):f=f.concat(_.abstract)}),[{tag:"span",attributes:{class:["".concat(Nt.cssPrefix,"-layers")].concat(d0(h)).join(" ")},children:f}]})}}}},Qpe={mixout:function(){return{counter:function(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=c.title,h=d===void 0?null:d,f=c.classes,_=f===void 0?[]:f,v=c.attributes,b=v===void 0?{}:v,A=c.styles,w=A===void 0?{}:A;return MR({type:"counter",content:o},function(){return Qp("beforeDOMElementCreation",{content:o,params:c}),kpe({content:o.toString(),title:h,extra:{attributes:b,styles:w,classes:["".concat(Nt.cssPrefix,"-layers-counter")].concat(d0(_))}})})}}}},Zpe={mixout:function(){return{text:function(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=c.transform,h=d===void 0?Ol:d,f=c.title,_=f===void 0?null:f,v=c.classes,b=v===void 0?[]:v,A=c.attributes,w=A===void 0?{}:A,x=c.styles,M=x===void 0?{}:x;return MR({type:"text",content:o},function(){return Qp("beforeDOMElementCreation",{content:o,params:c}),Q8({content:o,transform:mt(mt({},Ol),h),title:_,extra:{attributes:w,styles:M,classes:["".concat(Nt.cssPrefix,"-layers-text")].concat(d0(b))}})})}}},provides:function(r){r.generateLayersText=function(o,c){var d=c.title,h=c.transform,f=c.extra,_=null,v=null;if(w9){var b=parseInt(getComputedStyle(o).fontSize,10),A=o.getBoundingClientRect();_=A.width/b,v=A.height/b}return Nt.autoA11y&&!d&&(f.attributes["aria-hidden"]="true"),Promise.resolve([o,Q8({content:o.innerHTML,width:_,height:v,transform:h,title:d,extra:f,watchable:!0})])}}},efe=new RegExp('"',"ug"),s$=[1105920,1112319];function tfe(t){var r=t.replace(efe,""),o=fpe(r,0),c=o>=s$[0]&&o<=s$[1],d=r.length===2?r[0]===r[1]:!1;return{value:JD(d?r[0]:r),isSecondary:c||d}}function o$(t,r){var o="".concat($he).concat(r.replace(":","-"));return new Promise(function(c,d){if(t.getAttribute(o)!==null)return c();var h=e_(t.children),f=h.filter(function(ie){return ie.getAttribute(XD)===r})[0],_=Th.getComputedStyle(t,r),v=_.getPropertyValue("font-family").match(Yhe),b=_.getPropertyValue("font-weight"),A=_.getPropertyValue("content");if(f&&!v)return t.removeChild(f),c();if(v&&A!=="none"&&A!==""){var w=_.getPropertyValue("content"),x=~["Sharp"].indexOf(v[2])?Ni:Xr,M=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(v[2])?xy[x][v[2].toLowerCase()]:qhe[x][b],V=tfe(w),G=V.value,H=V.isSecondary,F=v[0].startsWith("FontAwesome"),B=fM(M,G),L=B;if(F){var X=Spe(G);X.iconName&&X.prefix&&(B=X.iconName,M=X.prefix)}if(B&&!H&&(!f||f.getAttribute(cM)!==M||f.getAttribute(lM)!==L)){t.setAttribute(o,L),f&&t.removeChild(f);var ee=Hpe(),ce=ee.extra;ce.attributes[XD]=r,nL(B,M).then(function(ie){var ne=gM(mt(mt({},ee),{},{icons:{main:ie,mask:mM()},prefix:M,iconName:L,extra:ce,watchable:!0})),fe=Qr.createElementNS("http://www.w3.org/2000/svg","svg");r==="::before"?t.insertBefore(fe,t.firstChild):t.appendChild(fe),fe.outerHTML=ne.map(function(oe){return h0(oe)}).join(`
`),t.removeAttribute(o),c()}).catch(d)}else c()}else c()})}function nfe(t){return Promise.all([o$(t,"::before"),o$(t,"::after")])}function rfe(t){return t.parentNode!==document.head&&!~Hhe.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(XD)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function a$(t){if($d)return new Promise(function(r,o){var c=e_(t.querySelectorAll("*")).filter(rfe).map(nfe),d=_M.begin("searchPseudoElements");z9(),Promise.all(c).then(function(){d(),iL(),r()}).catch(function(){d(),iL(),o()})})}var ife={hooks:function(){return{mutationObserverCallbacks:function(o){return o.pseudoElementsCallback=a$,o}}},provides:function(r){r.pseudoElements2svg=function(o){var c=o.node,d=c===void 0?Qr:c;Nt.searchPseudoElements&&a$(d)}}},c$=!1,sfe={mixout:function(){return{dom:{unwatch:function(){z9(),c$=!0}}}},hooks:function(){return{bootstrap:function(){n$(ZD("mutationObserverCallbacks",{}))},noAuto:function(){Bpe()},watch:function(o){var c=o.observeMutationsRoot;c$?iL():n$(ZD("mutationObserverCallbacks",{observeMutationsRoot:c}))}}}},l$=function(r){var o={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return r.toLowerCase().split(" ").reduce(function(c,d){var h=d.toLowerCase().split("-"),f=h[0],_=h.slice(1).join("-");if(f&&_==="h")return c.flipX=!0,c;if(f&&_==="v")return c.flipY=!0,c;if(_=parseFloat(_),isNaN(_))return c;switch(f){case"grow":c.size=c.size+_;break;case"shrink":c.size=c.size-_;break;case"left":c.x=c.x-_;break;case"right":c.x=c.x+_;break;case"up":c.y=c.y-_;break;case"down":c.y=c.y+_;break;case"rotate":c.rotate=c.rotate+_;break}return c},o)},ofe={mixout:function(){return{parse:{transform:function(o){return l$(o)}}}},hooks:function(){return{parseNodeAttributes:function(o,c){var d=c.getAttribute("data-fa-transform");return d&&(o.transform=l$(d)),o}}},provides:function(r){r.generateAbstractTransformGrouping=function(o){var c=o.main,d=o.transform,h=o.containerWidth,f=o.iconWidth,_={transform:"translate(".concat(h/2," 256)")},v="translate(".concat(d.x*32,", ").concat(d.y*32,") "),b="scale(".concat(d.size/16*(d.flipX?-1:1),", ").concat(d.size/16*(d.flipY?-1:1),") "),A="rotate(".concat(d.rotate," 0 0)"),w={transform:"".concat(v," ").concat(b," ").concat(A)},x={transform:"translate(".concat(f/2*-1," -256)")},M={outer:_,inner:w,path:x};return{tag:"g",attributes:mt({},M.outer),children:[{tag:"g",attributes:mt({},M.inner),children:[{tag:c.icon.tag,children:c.icon.children,attributes:mt(mt({},c.icon.attributes),M.path)}]}]}}}},lP={x:0,y:0,width:"100%",height:"100%"};function d$(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||r)&&(t.attributes.fill="black"),t}function afe(t){return t.tag==="g"?t.children:[t]}var cfe={hooks:function(){return{parseNodeAttributes:function(o,c){var d=c.getAttribute("data-fa-mask"),h=d?LR(d.split(" ").map(function(f){return f.trim()})):mM();return h.prefix||(h.prefix=Ch()),o.mask=h,o.maskId=c.getAttribute("data-fa-mask-id"),o}}},provides:function(r){r.generateAbstractMask=function(o){var c=o.children,d=o.attributes,h=o.main,f=o.mask,_=o.maskId,v=o.transform,b=h.width,A=h.icon,w=f.width,x=f.icon,M=ope({transform:v,containerWidth:w,iconWidth:b}),V={tag:"rect",attributes:mt(mt({},lP),{},{fill:"white"})},G=A.children?{children:A.children.map(d$)}:{},H={tag:"g",attributes:mt({},M.inner),children:[d$(mt({tag:A.tag,attributes:mt(mt({},A.attributes),M.path)},G))]},F={tag:"g",attributes:mt({},M.outer),children:[H]},B="mask-".concat(_||Ly()),L="clip-".concat(_||Ly()),X={tag:"mask",attributes:mt(mt({},lP),{},{id:B,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[V,F]},ee={tag:"defs",children:[{tag:"clipPath",attributes:{id:L},children:afe(x)},X]};return c.push(ee,{tag:"rect",attributes:mt({fill:"currentColor","clip-path":"url(#".concat(L,")"),mask:"url(#".concat(B,")")},lP)}),{children:c,attributes:d}}}},lfe={provides:function(r){var o=!1;Th.matchMedia&&(o=Th.matchMedia("(prefers-reduced-motion: reduce)").matches),r.missingIconAbstract=function(){var c=[],d={fill:"currentColor"},h={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};c.push({tag:"path",attributes:mt(mt({},d),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var f=mt(mt({},h),{},{attributeName:"opacity"}),_={tag:"circle",attributes:mt(mt({},d),{},{cx:"256",cy:"364",r:"28"}),children:[]};return o||_.children.push({tag:"animate",attributes:mt(mt({},h),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:mt(mt({},f),{},{values:"1;0;1;1;0;1;"})}),c.push(_),c.push({tag:"path",attributes:mt(mt({},d),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:o?[]:[{tag:"animate",attributes:mt(mt({},f),{},{values:"1;0;0;0;0;1;"})}]}),o||c.push({tag:"path",attributes:mt(mt({},d),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:mt(mt({},f),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:c}}}},dfe={hooks:function(){return{parseNodeAttributes:function(o,c){var d=c.getAttribute("data-fa-symbol"),h=d===null?!1:d===""?!0:d;return o.symbol=h,o}}}},ufe=[lpe,Xpe,Jpe,Qpe,Zpe,ife,sfe,ofe,cfe,lfe,dfe];Cpe(ufe,{mixoutsTo:_a});_a.noAuto;_a.config;_a.library;_a.dom;var sL=_a.parse;_a.findIconDefinition;_a.toHtml;var hfe=_a.icon;_a.layer;_a.text;_a.counter;var Y9={exports:{}},pfe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ffe=pfe,mfe=ffe;function q9(){}function X9(){}X9.resetWarningCache=q9;var gfe=function(){function t(c,d,h,f,_,v){if(v!==mfe){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}t.isRequired=t;function r(){return t}var o={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:X9,resetWarningCache:q9};return o.PropTypes=o,o};Y9.exports=gfe();var _fe=Y9.exports;const An=Yg(_fe);function u$(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);r&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),o.push.apply(o,c)}return o}function lh(t){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?u$(Object(o),!0).forEach(function(c){og(t,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):u$(Object(o)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(o,c))})}return t}function Gw(t){"@babel/helpers - typeof";return Gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Gw(t)}function og(t,r,o){return r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function Efe(t,r){if(t==null)return{};var o={},c=Object.keys(t),d,h;for(h=0;h<c.length;h++)d=c[h],!(r.indexOf(d)>=0)&&(o[d]=t[d]);return o}function vfe(t,r){if(t==null)return{};var o=Efe(t,r),c,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);for(d=0;d<h.length;d++)c=h[d],!(r.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(t,c)&&(o[c]=t[c])}return o}function oL(t){return yfe(t)||Sfe(t)||bfe(t)||Tfe()}function yfe(t){if(Array.isArray(t))return aL(t)}function Sfe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bfe(t,r){if(t){if(typeof t=="string")return aL(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return aL(t,r)}}function aL(t,r){(r==null||r>t.length)&&(r=t.length);for(var o=0,c=new Array(r);o<r;o++)c[o]=t[o];return c}function Tfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cfe(t){var r,o=t.beat,c=t.fade,d=t.beatFade,h=t.bounce,f=t.shake,_=t.flash,v=t.spin,b=t.spinPulse,A=t.spinReverse,w=t.pulse,x=t.fixedWidth,M=t.inverse,V=t.border,G=t.listItem,H=t.flip,F=t.size,B=t.rotation,L=t.pull,X=(r={"fa-beat":o,"fa-fade":c,"fa-beat-fade":d,"fa-bounce":h,"fa-shake":f,"fa-flash":_,"fa-spin":v,"fa-spin-reverse":A,"fa-spin-pulse":b,"fa-pulse":w,"fa-fw":x,"fa-inverse":M,"fa-border":V,"fa-li":G,"fa-flip":H===!0,"fa-flip-horizontal":H==="horizontal"||H==="both","fa-flip-vertical":H==="vertical"||H==="both"},og(r,"fa-".concat(F),typeof F<"u"&&F!==null),og(r,"fa-rotate-".concat(B),typeof B<"u"&&B!==null&&B!==0),og(r,"fa-pull-".concat(L),typeof L<"u"&&L!==null),og(r,"fa-swap-opacity",t.swapOpacity),r);return Object.keys(X).map(function(ee){return X[ee]?ee:null}).filter(function(ee){return ee})}function wfe(t){return t=t-0,t===t}function J9(t){return wfe(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(r,o){return o?o.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var Rfe=["style"];function Ife(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Afe(t){return t.split(";").map(function(r){return r.trim()}).filter(function(r){return r}).reduce(function(r,o){var c=o.indexOf(":"),d=J9(o.slice(0,c)),h=o.slice(c+1).trim();return d.startsWith("webkit")?r[Ife(d)]=h:r[d]=h,r},{})}function Q9(t,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof r=="string")return r;var c=(r.children||[]).map(function(v){return Q9(t,v)}),d=Object.keys(r.attributes||{}).reduce(function(v,b){var A=r.attributes[b];switch(b){case"class":v.attrs.className=A,delete r.attributes.class;break;case"style":v.attrs.style=Afe(A);break;default:b.indexOf("aria-")===0||b.indexOf("data-")===0?v.attrs[b.toLowerCase()]=A:v.attrs[J9(b)]=A}return v},{attrs:{}}),h=o.style,f=h===void 0?{}:h,_=vfe(o,Rfe);return d.attrs.style=lh(lh({},d.attrs.style),f),t.apply(void 0,[r.tag,lh(lh({},d.attrs),_)].concat(oL(c)))}var Z9=!1;try{Z9=!0}catch{}function Ofe(){if(!Z9&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function h$(t){if(t&&Gw(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(sL.icon)return sL.icon(t);if(t===null)return null;if(t&&Gw(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function dP(t,r){return Array.isArray(r)&&r.length>0||!Array.isArray(r)&&r?og({},t,r):{}}var Dn=gt.forwardRef(function(t,r){var o=t.icon,c=t.mask,d=t.symbol,h=t.className,f=t.title,_=t.titleId,v=t.maskId,b=h$(o),A=dP("classes",[].concat(oL(Cfe(t)),oL(h.split(" ")))),w=dP("transform",typeof t.transform=="string"?sL.transform(t.transform):t.transform),x=dP("mask",h$(c)),M=hfe(b,lh(lh(lh(lh({},A),w),x),{},{symbol:d,title:f,titleId:_,maskId:v}));if(!M)return Ofe("Could not find icon",b),null;var V=M.abstract,G={ref:r};return Object.keys(t).forEach(function(H){Dn.defaultProps.hasOwnProperty(H)||(G[H]=t[H])}),Nfe(V[0],G)});Dn.displayName="FontAwesomeIcon";Dn.propTypes={beat:An.bool,border:An.bool,beatFade:An.bool,bounce:An.bool,className:An.string,fade:An.bool,flash:An.bool,mask:An.oneOfType([An.object,An.array,An.string]),maskId:An.string,fixedWidth:An.bool,inverse:An.bool,flip:An.oneOf([!0,!1,"horizontal","vertical","both"]),icon:An.oneOfType([An.object,An.array,An.string]),listItem:An.bool,pull:An.oneOf(["right","left"]),pulse:An.bool,rotation:An.oneOf([0,90,180,270]),shake:An.bool,size:An.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:An.bool,spinPulse:An.bool,spinReverse:An.bool,symbol:An.oneOfType([An.bool,An.string]),title:An.string,titleId:An.string,transform:An.oneOfType([An.string,An.object]),swapOpacity:An.bool};Dn.defaultProps={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1};var Nfe=Q9.bind(null,gt.createElement),t_=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Wg=typeof window>"u"||"Deno"in globalThis;function Ga(){}function kfe(t,r){return typeof t=="function"?t(r):t}function cL(t){return typeof t=="number"&&t>=0&&t!==1/0}function eK(t,r){return Math.max(t+(r||0)-Date.now(),0)}function p$(t,r){const{type:o="all",exact:c,fetchStatus:d,predicate:h,queryKey:f,stale:_}=t;if(f){if(c){if(r.queryHash!==vM(f,r.options))return!1}else if(!My(r.queryKey,f))return!1}if(o!=="all"){const v=r.isActive();if(o==="active"&&!v||o==="inactive"&&v)return!1}return!(typeof _=="boolean"&&r.isStale()!==_||d&&d!==r.state.fetchStatus||h&&!h(r))}function f$(t,r){const{exact:o,status:c,predicate:d,mutationKey:h}=t;if(h){if(!r.options.mutationKey)return!1;if(o){if(Zp(r.options.mutationKey)!==Zp(h))return!1}else if(!My(r.options.mutationKey,h))return!1}return!(c&&r.state.status!==c||d&&!d(r))}function vM(t,r){return((r==null?void 0:r.queryKeyHashFn)||Zp)(t)}function Zp(t){return JSON.stringify(t,(r,o)=>lL(o)?Object.keys(o).sort().reduce((c,d)=>(c[d]=o[d],c),{}):o)}function My(t,r){return t===r?!0:typeof t!=typeof r?!1:t&&r&&typeof t=="object"&&typeof r=="object"?!Object.keys(r).some(o=>!My(t[o],r[o])):!1}function tK(t,r){if(t===r)return t;const o=m$(t)&&m$(r);if(o||lL(t)&&lL(r)){const c=o?t:Object.keys(t),d=c.length,h=o?r:Object.keys(r),f=h.length,_=o?[]:{};let v=0;for(let b=0;b<f;b++){const A=o?b:h[b];!o&&t[A]===void 0&&r[A]===void 0&&c.includes(A)?(_[A]=void 0,v++):(_[A]=tK(t[A],r[A]),_[A]===t[A]&&t[A]!==void 0&&v++)}return d===f&&v===d?t:_}return r}function Hw(t,r){if(!r||Object.keys(t).length!==Object.keys(r).length)return!1;for(const o in t)if(t[o]!==r[o])return!1;return!0}function m$(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function lL(t){if(!g$(t))return!1;const r=t.constructor;if(r===void 0)return!0;const o=r.prototype;return!(!g$(o)||!o.hasOwnProperty("isPrototypeOf"))}function g$(t){return Object.prototype.toString.call(t)==="[object Object]"}function xfe(t){return new Promise(r=>{setTimeout(r,t)})}function dL(t,r,o){return typeof o.structuralSharing=="function"?o.structuralSharing(t,r):o.structuralSharing!==!1?tK(t,r):r}function Pfe(t,r,o=0){const c=[...t,r];return o&&c.length>o?c.slice(1):c}function Dfe(t,r,o=0){const c=[r,...t];return o&&c.length>o?c.slice(0,-1):c}var yM=Symbol(),Mp,Qu,vg,WH,Lfe=(WH=class extends t_{constructor(){super();wt(this,Mp,void 0);wt(this,Qu,void 0);wt(this,vg,void 0);pt(this,vg,r=>{if(!Wg&&window.addEventListener){const o=()=>r();return window.addEventListener("visibilitychange",o,!1),()=>{window.removeEventListener("visibilitychange",o)}}})}onSubscribe(){Se(this,Qu)||this.setEventListener(Se(this,vg))}onUnsubscribe(){var r;this.hasListeners()||((r=Se(this,Qu))==null||r.call(this),pt(this,Qu,void 0))}setEventListener(r){var o;pt(this,vg,r),(o=Se(this,Qu))==null||o.call(this),pt(this,Qu,r(c=>{typeof c=="boolean"?this.setFocused(c):this.onFocus()}))}setFocused(r){Se(this,Mp)!==r&&(pt(this,Mp,r),this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(o=>{o(r)})}isFocused(){var r;return typeof Se(this,Mp)=="boolean"?Se(this,Mp):((r=globalThis.document)==null?void 0:r.visibilityState)!=="hidden"}},Mp=new WeakMap,Qu=new WeakMap,vg=new WeakMap,WH),SM=new Lfe,yg,Zu,Sg,$H,Mfe=($H=class extends t_{constructor(){super();wt(this,yg,!0);wt(this,Zu,void 0);wt(this,Sg,void 0);pt(this,Sg,r=>{if(!Wg&&window.addEventListener){const o=()=>r(!0),c=()=>r(!1);return window.addEventListener("online",o,!1),window.addEventListener("offline",c,!1),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",c)}}})}onSubscribe(){Se(this,Zu)||this.setEventListener(Se(this,Sg))}onUnsubscribe(){var r;this.hasListeners()||((r=Se(this,Zu))==null||r.call(this),pt(this,Zu,void 0))}setEventListener(r){var o;pt(this,Sg,r),(o=Se(this,Zu))==null||o.call(this),pt(this,Zu,r(this.setOnline.bind(this)))}setOnline(r){Se(this,yg)!==r&&(pt(this,yg,r),this.listeners.forEach(c=>{c(r)}))}isOnline(){return Se(this,yg)}},yg=new WeakMap,Zu=new WeakMap,Sg=new WeakMap,$H),zw=new Mfe;function Ufe(t){return Math.min(1e3*2**t,3e4)}function bM(t){return(t??"online")==="online"?zw.isOnline():!0}var nK=class{constructor(t){this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function uP(t){return t instanceof nK}function rK(t){let r=!1,o=0,c=!1,d,h,f;const _=new Promise((H,F)=>{h=H,f=F}),v=H=>{var F;c||(M(new nK(H)),(F=t.abort)==null||F.call(t))},b=()=>{r=!0},A=()=>{r=!1},w=()=>!SM.isFocused()||t.networkMode!=="always"&&!zw.isOnline(),x=H=>{var F;c||(c=!0,(F=t.onSuccess)==null||F.call(t,H),d==null||d(),h(H))},M=H=>{var F;c||(c=!0,(F=t.onError)==null||F.call(t,H),d==null||d(),f(H))},V=()=>new Promise(H=>{var F;d=B=>{const L=c||!w();return L&&H(B),L},(F=t.onPause)==null||F.call(t)}).then(()=>{var H;d=void 0,c||(H=t.onContinue)==null||H.call(t)}),G=()=>{if(c)return;let H;try{H=t.fn()}catch(F){H=Promise.reject(F)}Promise.resolve(H).then(x).catch(F=>{var ce;if(c)return;const B=t.retry??(Wg?0:3),L=t.retryDelay??Ufe,X=typeof L=="function"?L(o,F):L,ee=B===!0||typeof B=="number"&&o<B||typeof B=="function"&&B(o,F);if(r||!ee){M(F);return}o++,(ce=t.onFail)==null||ce.call(t,o,F),xfe(X).then(()=>{if(w())return V()}).then(()=>{r?M(F):G()})})};return bM(t.networkMode)?G():V().then(G),{promise:_,cancel:v,continue:()=>(d==null?void 0:d())?_:Promise.resolve(),cancelRetry:b,continueRetry:A}}function jfe(){let t=[],r=0,o=x=>{x()},c=x=>{x()},d=x=>setTimeout(x,0);const h=x=>{d=x},f=x=>{let M;r++;try{M=x()}finally{r--,r||b()}return M},_=x=>{r?t.push(x):d(()=>{o(x)})},v=x=>(...M)=>{_(()=>{x(...M)})},b=()=>{const x=t;t=[],x.length&&d(()=>{c(()=>{x.forEach(M=>{o(M)})})})};return{batch:f,batchCalls:v,schedule:_,setNotifyFunction:x=>{o=x},setBatchNotifyFunction:x=>{c=x},setScheduler:h}}var ss=jfe(),Up,GH,iK=(GH=class{constructor(){wt(this,Up,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),cL(this.gcTime)&&pt(this,Up,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Wg?1/0:5*60*1e3))}clearGcTimeout(){Se(this,Up)&&(clearTimeout(Se(this,Up)),pt(this,Up,void 0))}},Up=new WeakMap,GH),bg,Tg,Wa,ao,fs,zy,jp,Pc,_d,HH,Ffe=(HH=class extends iK{constructor(r){super();wt(this,Pc);wt(this,bg,void 0);wt(this,Tg,void 0);wt(this,Wa,void 0);wt(this,ao,void 0);wt(this,fs,void 0);wt(this,zy,void 0);wt(this,jp,void 0);pt(this,jp,!1),pt(this,zy,r.defaultOptions),this.setOptions(r.options),pt(this,fs,[]),pt(this,Wa,r.cache),this.queryKey=r.queryKey,this.queryHash=r.queryHash,pt(this,bg,r.state||Vfe(this.options)),this.state=Se(this,bg),this.scheduleGc()}get meta(){return this.options.meta}setOptions(r){this.options={...Se(this,zy),...r},this.updateGcTime(this.options.gcTime)}optionalRemove(){!Se(this,fs).length&&this.state.fetchStatus==="idle"&&Se(this,Wa).remove(this)}setData(r,o){const c=dL(this.state.data,r,this.options);return bn(this,Pc,_d).call(this,{data:c,type:"success",dataUpdatedAt:o==null?void 0:o.updatedAt,manual:o==null?void 0:o.manual}),c}setState(r,o){bn(this,Pc,_d).call(this,{type:"setState",state:r,setStateOptions:o})}cancel(r){var c,d;const o=(c=Se(this,ao))==null?void 0:c.promise;return(d=Se(this,ao))==null||d.cancel(r),o?o.then(Ga).catch(Ga):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Se(this,bg))}isActive(){return Se(this,fs).some(r=>r.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?Se(this,fs).some(r=>r.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(r=0){return this.state.isInvalidated||this.state.data===void 0||!eK(this.state.dataUpdatedAt,r)}onFocus(){var o;const r=Se(this,fs).find(c=>c.shouldFetchOnWindowFocus());r==null||r.refetch({cancelRefetch:!1}),(o=Se(this,ao))==null||o.continue()}onOnline(){var o;const r=Se(this,fs).find(c=>c.shouldFetchOnReconnect());r==null||r.refetch({cancelRefetch:!1}),(o=Se(this,ao))==null||o.continue()}addObserver(r){Se(this,fs).includes(r)||(Se(this,fs).push(r),this.clearGcTimeout(),Se(this,Wa).notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){Se(this,fs).includes(r)&&(pt(this,fs,Se(this,fs).filter(o=>o!==r)),Se(this,fs).length||(Se(this,ao)&&(Se(this,jp)?Se(this,ao).cancel({revert:!0}):Se(this,ao).cancelRetry()),this.scheduleGc()),Se(this,Wa).notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return Se(this,fs).length}invalidate(){this.state.isInvalidated||bn(this,Pc,_d).call(this,{type:"invalidate"})}fetch(r,o){var b,A,w;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(o!=null&&o.cancelRefetch))this.cancel({silent:!0});else if(Se(this,ao))return Se(this,ao).continueRetry(),Se(this,ao).promise}if(r&&this.setOptions(r),!this.options.queryFn){const x=Se(this,fs).find(M=>M.options.queryFn);x&&this.setOptions(x.options)}const c=new AbortController,d={queryKey:this.queryKey,meta:this.meta},h=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(pt(this,jp,!0),c.signal)})};h(d);const f=()=>!this.options.queryFn||this.options.queryFn===yM?Promise.reject(new Error(`Missing queryFn: '${this.options.queryHash}'`)):(pt(this,jp,!1),this.options.persister?this.options.persister(this.options.queryFn,d,this):this.options.queryFn(d)),_={fetchOptions:o,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:f};h(_),(b=this.options.behavior)==null||b.onFetch(_,this),pt(this,Tg,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((A=_.fetchOptions)==null?void 0:A.meta))&&bn(this,Pc,_d).call(this,{type:"fetch",meta:(w=_.fetchOptions)==null?void 0:w.meta});const v=x=>{var M,V,G,H;uP(x)&&x.silent||bn(this,Pc,_d).call(this,{type:"error",error:x}),uP(x)||((V=(M=Se(this,Wa).config).onError)==null||V.call(M,x,this),(H=(G=Se(this,Wa).config).onSettled)==null||H.call(G,this.state.data,x,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return pt(this,ao,rK({fn:_.fetchFn,abort:c.abort.bind(c),onSuccess:x=>{var M,V,G,H;if(x===void 0){v(new Error(`${this.queryHash} data is undefined`));return}this.setData(x),(V=(M=Se(this,Wa).config).onSuccess)==null||V.call(M,x,this),(H=(G=Se(this,Wa).config).onSettled)==null||H.call(G,x,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:v,onFail:(x,M)=>{bn(this,Pc,_d).call(this,{type:"failed",failureCount:x,error:M})},onPause:()=>{bn(this,Pc,_d).call(this,{type:"pause"})},onContinue:()=>{bn(this,Pc,_d).call(this,{type:"continue"})},retry:_.options.retry,retryDelay:_.options.retryDelay,networkMode:_.options.networkMode})),Se(this,ao).promise}},bg=new WeakMap,Tg=new WeakMap,Wa=new WeakMap,ao=new WeakMap,fs=new WeakMap,zy=new WeakMap,jp=new WeakMap,Pc=new WeakSet,_d=function(r){const o=c=>{switch(r.type){case"failed":return{...c,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...c,fetchStatus:"paused"};case"continue":return{...c,fetchStatus:"fetching"};case"fetch":return{...c,...sK(c.data,this.options),fetchMeta:r.meta??null};case"success":return{...c,data:r.data,dataUpdateCount:c.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const d=r.error;return uP(d)&&d.revert&&Se(this,Tg)?{...Se(this,Tg),fetchStatus:"idle"}:{...c,error:d,errorUpdateCount:c.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:c.fetchFailureCount+1,fetchFailureReason:d,fetchStatus:"idle",status:"error"};case"invalidate":return{...c,isInvalidated:!0};case"setState":return{...c,...r.state}}};this.state=o(this.state),ss.batch(()=>{Se(this,fs).forEach(c=>{c.onQueryUpdate()}),Se(this,Wa).notify({query:this,type:"updated",action:r})})},HH);function sK(t,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:bM(r.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Vfe(t){const r=typeof t.initialData=="function"?t.initialData():t.initialData,o=r!==void 0,c=o?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:o?c??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:o?"success":"pending",fetchStatus:"idle"}}var bl,zH,Bfe=(zH=class extends t_{constructor(r={}){super();wt(this,bl,void 0);this.config=r,pt(this,bl,new Map)}build(r,o,c){const d=o.queryKey,h=o.queryHash??vM(d,o);let f=this.get(h);return f||(f=new Ffe({cache:this,queryKey:d,queryHash:h,options:r.defaultQueryOptions(o),state:c,defaultOptions:r.getQueryDefaults(d)}),this.add(f)),f}add(r){Se(this,bl).has(r.queryHash)||(Se(this,bl).set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const o=Se(this,bl).get(r.queryHash);o&&(r.destroy(),o===r&&Se(this,bl).delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){ss.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return Se(this,bl).get(r)}getAll(){return[...Se(this,bl).values()]}find(r){const o={exact:!0,...r};return this.getAll().find(c=>p$(o,c))}findAll(r={}){const o=this.getAll();return Object.keys(r).length>0?o.filter(c=>p$(r,c)):o}notify(r){ss.batch(()=>{this.listeners.forEach(o=>{o(r)})})}onFocus(){ss.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){ss.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},bl=new WeakMap,zH),Tl,Ky,sa,Cg,Cl,Hu,KH,Wfe=(KH=class extends iK{constructor(r){super();wt(this,Cl);wt(this,Tl,void 0);wt(this,Ky,void 0);wt(this,sa,void 0);wt(this,Cg,void 0);this.mutationId=r.mutationId,pt(this,Ky,r.defaultOptions),pt(this,sa,r.mutationCache),pt(this,Tl,[]),this.state=r.state||oK(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options={...Se(this,Ky),...r},this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){Se(this,Tl).includes(r)||(Se(this,Tl).push(r),this.clearGcTimeout(),Se(this,sa).notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){pt(this,Tl,Se(this,Tl).filter(o=>o!==r)),this.scheduleGc(),Se(this,sa).notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){Se(this,Tl).length||(this.state.status==="pending"?this.scheduleGc():Se(this,sa).remove(this))}continue(){var r;return((r=Se(this,Cg))==null?void 0:r.continue())??this.execute(this.state.variables)}async execute(r){var d,h,f,_,v,b,A,w,x,M,V,G,H,F,B,L,X,ee,ce,ie;const o=()=>(pt(this,Cg,rK({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(ne,fe)=>{bn(this,Cl,Hu).call(this,{type:"failed",failureCount:ne,error:fe})},onPause:()=>{bn(this,Cl,Hu).call(this,{type:"pause"})},onContinue:()=>{bn(this,Cl,Hu).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode})),Se(this,Cg).promise),c=this.state.status==="pending";try{if(!c){bn(this,Cl,Hu).call(this,{type:"pending",variables:r}),await((h=(d=Se(this,sa).config).onMutate)==null?void 0:h.call(d,r,this));const fe=await((_=(f=this.options).onMutate)==null?void 0:_.call(f,r));fe!==this.state.context&&bn(this,Cl,Hu).call(this,{type:"pending",context:fe,variables:r})}const ne=await o();return await((b=(v=Se(this,sa).config).onSuccess)==null?void 0:b.call(v,ne,r,this.state.context,this)),await((w=(A=this.options).onSuccess)==null?void 0:w.call(A,ne,r,this.state.context)),await((M=(x=Se(this,sa).config).onSettled)==null?void 0:M.call(x,ne,null,this.state.variables,this.state.context,this)),await((G=(V=this.options).onSettled)==null?void 0:G.call(V,ne,null,r,this.state.context)),bn(this,Cl,Hu).call(this,{type:"success",data:ne}),ne}catch(ne){try{throw await((F=(H=Se(this,sa).config).onError)==null?void 0:F.call(H,ne,r,this.state.context,this)),await((L=(B=this.options).onError)==null?void 0:L.call(B,ne,r,this.state.context)),await((ee=(X=Se(this,sa).config).onSettled)==null?void 0:ee.call(X,void 0,ne,this.state.variables,this.state.context,this)),await((ie=(ce=this.options).onSettled)==null?void 0:ie.call(ce,void 0,ne,r,this.state.context)),ne}finally{bn(this,Cl,Hu).call(this,{type:"error",error:ne})}}}},Tl=new WeakMap,Ky=new WeakMap,sa=new WeakMap,Cg=new WeakMap,Cl=new WeakSet,Hu=function(r){const o=c=>{switch(r.type){case"failed":return{...c,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...c,isPaused:!0};case"continue":return{...c,isPaused:!1};case"pending":return{...c,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!bM(this.options.networkMode),status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...c,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...c,data:void 0,error:r.error,failureCount:c.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=o(this.state),ss.batch(()=>{Se(this,Tl).forEach(c=>{c.onMutationUpdate(r)}),Se(this,sa).notify({mutation:this,type:"updated",action:r})})},KH);function oK(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var $a,Yy,Fp,YH,$fe=(YH=class extends t_{constructor(r={}){super();wt(this,$a,void 0);wt(this,Yy,void 0);wt(this,Fp,void 0);this.config=r,pt(this,$a,[]),pt(this,Yy,0)}build(r,o,c){const d=new Wfe({mutationCache:this,mutationId:++nC(this,Yy)._,options:r.defaultMutationOptions(o),state:c});return this.add(d),d}add(r){Se(this,$a).push(r),this.notify({type:"added",mutation:r})}remove(r){pt(this,$a,Se(this,$a).filter(o=>o!==r)),this.notify({type:"removed",mutation:r})}clear(){ss.batch(()=>{Se(this,$a).forEach(r=>{this.remove(r)})})}getAll(){return Se(this,$a)}find(r){const o={exact:!0,...r};return Se(this,$a).find(c=>f$(o,c))}findAll(r={}){return Se(this,$a).filter(o=>f$(r,o))}notify(r){ss.batch(()=>{this.listeners.forEach(o=>{o(r)})})}resumePausedMutations(){return pt(this,Fp,(Se(this,Fp)??Promise.resolve()).then(()=>{const r=Se(this,$a).filter(o=>o.state.isPaused);return ss.batch(()=>r.reduce((o,c)=>o.then(()=>c.continue().catch(Ga)),Promise.resolve()))}).then(()=>{pt(this,Fp,void 0)})),Se(this,Fp)}},$a=new WeakMap,Yy=new WeakMap,Fp=new WeakMap,YH);function Gfe(t){return{onFetch:(r,o)=>{const c=async()=>{var V,G,H,F,B;const d=r.options,h=(H=(G=(V=r.fetchOptions)==null?void 0:V.meta)==null?void 0:G.fetchMore)==null?void 0:H.direction,f=((F=r.state.data)==null?void 0:F.pages)||[],_=((B=r.state.data)==null?void 0:B.pageParams)||[],v={pages:[],pageParams:[]};let b=!1;const A=L=>{Object.defineProperty(L,"signal",{enumerable:!0,get:()=>(r.signal.aborted?b=!0:r.signal.addEventListener("abort",()=>{b=!0}),r.signal)})},w=r.options.queryFn&&r.options.queryFn!==yM?r.options.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${r.options.queryHash}'`)),x=async(L,X,ee)=>{if(b)return Promise.reject();if(X==null&&L.pages.length)return Promise.resolve(L);const ce={queryKey:r.queryKey,pageParam:X,direction:ee?"backward":"forward",meta:r.options.meta};A(ce);const ie=await w(ce),{maxPages:ne}=r.options,fe=ee?Dfe:Pfe;return{pages:fe(L.pages,ie,ne),pageParams:fe(L.pageParams,X,ne)}};let M;if(h&&f.length){const L=h==="backward",X=L?Hfe:_$,ee={pages:f,pageParams:_},ce=X(d,ee);M=await x(ee,ce,L)}else{M=await x(v,_[0]??d.initialPageParam);const L=t??f.length;for(let X=1;X<L;X++){const ee=_$(d,M);M=await x(M,ee)}}return M};r.options.persister?r.fetchFn=()=>{var d,h;return(h=(d=r.options).persister)==null?void 0:h.call(d,c,{queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},o)}:r.fetchFn=c}}}function _$(t,{pages:r,pageParams:o}){const c=r.length-1;return t.getNextPageParam(r[c],r,o[c],o)}function Hfe(t,{pages:r,pageParams:o}){var c;return(c=t.getPreviousPageParam)==null?void 0:c.call(t,r[0],r,o[0],o)}var Ai,eh,th,wg,Rg,nh,Ig,Ag,qH,zfe=(qH=class{constructor(t={}){wt(this,Ai,void 0);wt(this,eh,void 0);wt(this,th,void 0);wt(this,wg,void 0);wt(this,Rg,void 0);wt(this,nh,void 0);wt(this,Ig,void 0);wt(this,Ag,void 0);pt(this,Ai,t.queryCache||new Bfe),pt(this,eh,t.mutationCache||new $fe),pt(this,th,t.defaultOptions||{}),pt(this,wg,new Map),pt(this,Rg,new Map),pt(this,nh,0)}mount(){nC(this,nh)._++,Se(this,nh)===1&&(pt(this,Ig,SM.subscribe(async t=>{t&&(await this.resumePausedMutations(),Se(this,Ai).onFocus())})),pt(this,Ag,zw.subscribe(async t=>{t&&(await this.resumePausedMutations(),Se(this,Ai).onOnline())})))}unmount(){var t,r;nC(this,nh)._--,Se(this,nh)===0&&((t=Se(this,Ig))==null||t.call(this),pt(this,Ig,void 0),(r=Se(this,Ag))==null||r.call(this),pt(this,Ag,void 0))}isFetching(t){return Se(this,Ai).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return Se(this,eh).findAll({...t,status:"pending"}).length}getQueryData(t){var o;const r=this.defaultQueryOptions({queryKey:t});return(o=Se(this,Ai).get(r.queryHash))==null?void 0:o.state.data}ensureQueryData(t){const r=this.getQueryData(t.queryKey);if(r===void 0)return this.fetchQuery(t);{const o=this.defaultQueryOptions(t),c=Se(this,Ai).build(this,o);return t.revalidateIfStale&&c.isStaleByTime(o.staleTime)&&this.prefetchQuery(o),Promise.resolve(r)}}getQueriesData(t){return Se(this,Ai).findAll(t).map(({queryKey:r,state:o})=>{const c=o.data;return[r,c]})}setQueryData(t,r,o){const c=this.defaultQueryOptions({queryKey:t}),d=Se(this,Ai).get(c.queryHash),h=d==null?void 0:d.state.data,f=kfe(r,h);if(f!==void 0)return Se(this,Ai).build(this,c).setData(f,{...o,manual:!0})}setQueriesData(t,r,o){return ss.batch(()=>Se(this,Ai).findAll(t).map(({queryKey:c})=>[c,this.setQueryData(c,r,o)]))}getQueryState(t){var o;const r=this.defaultQueryOptions({queryKey:t});return(o=Se(this,Ai).get(r.queryHash))==null?void 0:o.state}removeQueries(t){const r=Se(this,Ai);ss.batch(()=>{r.findAll(t).forEach(o=>{r.remove(o)})})}resetQueries(t,r){const o=Se(this,Ai),c={type:"active",...t};return ss.batch(()=>(o.findAll(t).forEach(d=>{d.reset()}),this.refetchQueries(c,r)))}cancelQueries(t={},r={}){const o={revert:!0,...r},c=ss.batch(()=>Se(this,Ai).findAll(t).map(d=>d.cancel(o)));return Promise.all(c).then(Ga).catch(Ga)}invalidateQueries(t={},r={}){return ss.batch(()=>{if(Se(this,Ai).findAll(t).forEach(c=>{c.invalidate()}),t.refetchType==="none")return Promise.resolve();const o={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(o,r)})}refetchQueries(t={},r){const o={...r,cancelRefetch:(r==null?void 0:r.cancelRefetch)??!0},c=ss.batch(()=>Se(this,Ai).findAll(t).filter(d=>!d.isDisabled()).map(d=>{let h=d.fetch(void 0,o);return o.throwOnError||(h=h.catch(Ga)),d.state.fetchStatus==="paused"?Promise.resolve():h}));return Promise.all(c).then(Ga)}fetchQuery(t){const r=this.defaultQueryOptions(t);r.retry===void 0&&(r.retry=!1);const o=Se(this,Ai).build(this,r);return o.isStaleByTime(r.staleTime)?o.fetch(r):Promise.resolve(o.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ga).catch(Ga)}fetchInfiniteQuery(t){return t.behavior=Gfe(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ga).catch(Ga)}resumePausedMutations(){return zw.isOnline()?Se(this,eh).resumePausedMutations():Promise.resolve()}getQueryCache(){return Se(this,Ai)}getMutationCache(){return Se(this,eh)}getDefaultOptions(){return Se(this,th)}setDefaultOptions(t){pt(this,th,t)}setQueryDefaults(t,r){Se(this,wg).set(Zp(t),{queryKey:t,defaultOptions:r})}getQueryDefaults(t){const r=[...Se(this,wg).values()];let o={};return r.forEach(c=>{My(t,c.queryKey)&&(o={...o,...c.defaultOptions})}),o}setMutationDefaults(t,r){Se(this,Rg).set(Zp(t),{mutationKey:t,defaultOptions:r})}getMutationDefaults(t){const r=[...Se(this,Rg).values()];let o={};return r.forEach(c=>{My(t,c.mutationKey)&&(o={...o,...c.defaultOptions})}),o}defaultQueryOptions(t){if(t._defaulted)return t;const r={...Se(this,th).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return r.queryHash||(r.queryHash=vM(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.enabled!==!0&&r.queryFn===yM&&(r.enabled=!1),r}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...Se(this,th).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){Se(this,Ai).clear(),Se(this,eh).clear()}},Ai=new WeakMap,eh=new WeakMap,th=new WeakMap,wg=new WeakMap,Rg=new WeakMap,nh=new WeakMap,Ig=new WeakMap,Ag=new WeakMap,qH),Do,Br,qy,co,Vp,Og,wl,Xy,Ng,kg,Bp,Wp,rh,xg,$p,Wv,Jy,uL,Qy,hL,Zy,pL,e0,fL,t0,mL,n0,gL,r0,_L,pR,aK,XH,Kfe=(XH=class extends t_{constructor(r,o){super();wt(this,$p);wt(this,Jy);wt(this,Qy);wt(this,Zy);wt(this,e0);wt(this,t0);wt(this,n0);wt(this,r0);wt(this,pR);wt(this,Do,void 0);wt(this,Br,void 0);wt(this,qy,void 0);wt(this,co,void 0);wt(this,Vp,void 0);wt(this,Og,void 0);wt(this,wl,void 0);wt(this,Xy,void 0);wt(this,Ng,void 0);wt(this,kg,void 0);wt(this,Bp,void 0);wt(this,Wp,void 0);wt(this,rh,void 0);wt(this,xg,new Set);this.options=o,pt(this,Do,r),pt(this,wl,null),this.bindMethods(),this.setOptions(o)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Se(this,Br).addObserver(this),E$(Se(this,Br),this.options)?bn(this,$p,Wv).call(this):this.updateResult(),bn(this,e0,fL).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return EL(Se(this,Br),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return EL(Se(this,Br),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,bn(this,t0,mL).call(this),bn(this,n0,gL).call(this),Se(this,Br).removeObserver(this)}setOptions(r,o){const c=this.options,d=Se(this,Br);if(this.options=Se(this,Do).defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");bn(this,r0,_L).call(this),Se(this,Br).setOptions(this.options),c._defaulted&&!Hw(this.options,c)&&Se(this,Do).getQueryCache().notify({type:"observerOptionsUpdated",query:Se(this,Br),observer:this});const h=this.hasListeners();h&&v$(Se(this,Br),d,this.options,c)&&bn(this,$p,Wv).call(this),this.updateResult(o),h&&(Se(this,Br)!==d||this.options.enabled!==c.enabled||this.options.staleTime!==c.staleTime)&&bn(this,Jy,uL).call(this);const f=bn(this,Qy,hL).call(this);h&&(Se(this,Br)!==d||this.options.enabled!==c.enabled||f!==Se(this,rh))&&bn(this,Zy,pL).call(this,f)}getOptimisticResult(r){const o=Se(this,Do).getQueryCache().build(Se(this,Do),r),c=this.createResult(o,r);return qfe(this,c)&&(pt(this,co,c),pt(this,Og,this.options),pt(this,Vp,Se(this,Br).state)),c}getCurrentResult(){return Se(this,co)}trackResult(r,o){const c={};return Object.keys(r).forEach(d=>{Object.defineProperty(c,d,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(d),o==null||o(d),r[d])})}),c}trackProp(r){Se(this,xg).add(r)}getCurrentQuery(){return Se(this,Br)}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const o=Se(this,Do).defaultQueryOptions(r),c=Se(this,Do).getQueryCache().build(Se(this,Do),o);return c.isFetchingOptimistic=!0,c.fetch().then(()=>this.createResult(c,o))}fetch(r){return bn(this,$p,Wv).call(this,{...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),Se(this,co)))}createResult(r,o){var ie;const c=Se(this,Br),d=this.options,h=Se(this,co),f=Se(this,Vp),_=Se(this,Og),b=r!==c?r.state:Se(this,qy),{state:A}=r;let w={...A},x=!1,M;if(o._optimisticResults){const ne=this.hasListeners(),fe=!ne&&E$(r,o),oe=ne&&v$(r,c,o,d);(fe||oe)&&(w={...w,...sK(A.data,r.options)}),o._optimisticResults==="isRestoring"&&(w.fetchStatus="idle")}let{error:V,errorUpdatedAt:G,status:H}=w;if(o.select&&w.data!==void 0)if(h&&w.data===(f==null?void 0:f.data)&&o.select===Se(this,Xy))M=Se(this,Ng);else try{pt(this,Xy,o.select),M=o.select(w.data),M=dL(h==null?void 0:h.data,M,o),pt(this,Ng,M),pt(this,wl,null)}catch(ne){pt(this,wl,ne)}else M=w.data;if(o.placeholderData!==void 0&&M===void 0&&H==="pending"){let ne;if(h!=null&&h.isPlaceholderData&&o.placeholderData===(_==null?void 0:_.placeholderData))ne=h.data;else if(ne=typeof o.placeholderData=="function"?o.placeholderData((ie=Se(this,kg))==null?void 0:ie.state.data,Se(this,kg)):o.placeholderData,o.select&&ne!==void 0)try{ne=o.select(ne),pt(this,wl,null)}catch(fe){pt(this,wl,fe)}ne!==void 0&&(H="success",M=dL(h==null?void 0:h.data,ne,o),x=!0)}Se(this,wl)&&(V=Se(this,wl),M=Se(this,Ng),G=Date.now(),H="error");const F=w.fetchStatus==="fetching",B=H==="pending",L=H==="error",X=B&&F,ee=M!==void 0;return{status:H,fetchStatus:w.fetchStatus,isPending:B,isSuccess:H==="success",isError:L,isInitialLoading:X,isLoading:X,data:M,dataUpdatedAt:w.dataUpdatedAt,error:V,errorUpdatedAt:G,failureCount:w.fetchFailureCount,failureReason:w.fetchFailureReason,errorUpdateCount:w.errorUpdateCount,isFetched:w.dataUpdateCount>0||w.errorUpdateCount>0,isFetchedAfterMount:w.dataUpdateCount>b.dataUpdateCount||w.errorUpdateCount>b.errorUpdateCount,isFetching:F,isRefetching:F&&!B,isLoadingError:L&&!ee,isPaused:w.fetchStatus==="paused",isPlaceholderData:x,isRefetchError:L&&ee,isStale:TM(r,o),refetch:this.refetch}}updateResult(r){const o=Se(this,co),c=this.createResult(Se(this,Br),this.options);if(pt(this,Vp,Se(this,Br).state),pt(this,Og,this.options),Se(this,Vp).data!==void 0&&pt(this,kg,Se(this,Br)),Hw(c,o))return;pt(this,co,c);const d={},h=()=>{if(!o)return!0;const{notifyOnChangeProps:f}=this.options,_=typeof f=="function"?f():f;if(_==="all"||!_&&!Se(this,xg).size)return!0;const v=new Set(_??Se(this,xg));return this.options.throwOnError&&v.add("error"),Object.keys(Se(this,co)).some(b=>{const A=b;return Se(this,co)[A]!==o[A]&&v.has(A)})};(r==null?void 0:r.listeners)!==!1&&h()&&(d.listeners=!0),bn(this,pR,aK).call(this,{...d,...r})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&bn(this,e0,fL).call(this)}},Do=new WeakMap,Br=new WeakMap,qy=new WeakMap,co=new WeakMap,Vp=new WeakMap,Og=new WeakMap,wl=new WeakMap,Xy=new WeakMap,Ng=new WeakMap,kg=new WeakMap,Bp=new WeakMap,Wp=new WeakMap,rh=new WeakMap,xg=new WeakMap,$p=new WeakSet,Wv=function(r){bn(this,r0,_L).call(this);let o=Se(this,Br).fetch(this.options,r);return r!=null&&r.throwOnError||(o=o.catch(Ga)),o},Jy=new WeakSet,uL=function(){if(bn(this,t0,mL).call(this),Wg||Se(this,co).isStale||!cL(this.options.staleTime))return;const o=eK(Se(this,co).dataUpdatedAt,this.options.staleTime)+1;pt(this,Bp,setTimeout(()=>{Se(this,co).isStale||this.updateResult()},o))},Qy=new WeakSet,hL=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Se(this,Br)):this.options.refetchInterval)??!1},Zy=new WeakSet,pL=function(r){bn(this,n0,gL).call(this),pt(this,rh,r),!(Wg||this.options.enabled===!1||!cL(Se(this,rh))||Se(this,rh)===0)&&pt(this,Wp,setInterval(()=>{(this.options.refetchIntervalInBackground||SM.isFocused())&&bn(this,$p,Wv).call(this)},Se(this,rh)))},e0=new WeakSet,fL=function(){bn(this,Jy,uL).call(this),bn(this,Zy,pL).call(this,bn(this,Qy,hL).call(this))},t0=new WeakSet,mL=function(){Se(this,Bp)&&(clearTimeout(Se(this,Bp)),pt(this,Bp,void 0))},n0=new WeakSet,gL=function(){Se(this,Wp)&&(clearInterval(Se(this,Wp)),pt(this,Wp,void 0))},r0=new WeakSet,_L=function(){const r=Se(this,Do).getQueryCache().build(Se(this,Do),this.options);if(r===Se(this,Br))return;const o=Se(this,Br);pt(this,Br,r),pt(this,qy,r.state),this.hasListeners()&&(o==null||o.removeObserver(this),r.addObserver(this))},pR=new WeakSet,aK=function(r){ss.batch(()=>{r.listeners&&this.listeners.forEach(o=>{o(Se(this,co))}),Se(this,Do).getQueryCache().notify({query:Se(this,Br),type:"observerResultsUpdated"})})},XH);function Yfe(t,r){return r.enabled!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&r.retryOnMount===!1)}function E$(t,r){return Yfe(t,r)||t.state.data!==void 0&&EL(t,r,r.refetchOnMount)}function EL(t,r,o){if(r.enabled!==!1){const c=typeof o=="function"?o(t):o;return c==="always"||c!==!1&&TM(t,r)}return!1}function v$(t,r,o,c){return(t!==r||c.enabled===!1)&&(!o.suspense||t.state.status!=="error")&&TM(t,o)}function TM(t,r){return r.enabled!==!1&&t.isStaleByTime(r.staleTime)}function qfe(t,r){return!Hw(t.getCurrentResult(),r)}var ih,sh,Lo,bd,Pg,rw,i0,vL,JH,Xfe=(JH=class extends t_{constructor(o,c){super();wt(this,Pg);wt(this,i0);wt(this,ih,void 0);wt(this,sh,void 0);wt(this,Lo,void 0);wt(this,bd,void 0);pt(this,ih,o),this.setOptions(c),this.bindMethods(),bn(this,Pg,rw).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(o){var d;const c=this.options;this.options=Se(this,ih).defaultMutationOptions(o),Hw(this.options,c)||Se(this,ih).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Se(this,Lo),observer:this}),c!=null&&c.mutationKey&&this.options.mutationKey&&Zp(c.mutationKey)!==Zp(this.options.mutationKey)?this.reset():((d=Se(this,Lo))==null?void 0:d.state.status)==="pending"&&Se(this,Lo).setOptions(this.options)}onUnsubscribe(){var o;this.hasListeners()||(o=Se(this,Lo))==null||o.removeObserver(this)}onMutationUpdate(o){bn(this,Pg,rw).call(this),bn(this,i0,vL).call(this,o)}getCurrentResult(){return Se(this,sh)}reset(){var o;(o=Se(this,Lo))==null||o.removeObserver(this),pt(this,Lo,void 0),bn(this,Pg,rw).call(this),bn(this,i0,vL).call(this)}mutate(o,c){var d;return pt(this,bd,c),(d=Se(this,Lo))==null||d.removeObserver(this),pt(this,Lo,Se(this,ih).getMutationCache().build(Se(this,ih),this.options)),Se(this,Lo).addObserver(this),Se(this,Lo).execute(o)}},ih=new WeakMap,sh=new WeakMap,Lo=new WeakMap,bd=new WeakMap,Pg=new WeakSet,rw=function(){var c;const o=((c=Se(this,Lo))==null?void 0:c.state)??oK();pt(this,sh,{...o,isPending:o.status==="pending",isSuccess:o.status==="success",isError:o.status==="error",isIdle:o.status==="idle",mutate:this.mutate,reset:this.reset})},i0=new WeakSet,vL=function(o){ss.batch(()=>{var c,d,h,f,_,v,b,A;if(Se(this,bd)&&this.hasListeners()){const w=Se(this,sh).variables,x=Se(this,sh).context;(o==null?void 0:o.type)==="success"?((d=(c=Se(this,bd)).onSuccess)==null||d.call(c,o.data,w,x),(f=(h=Se(this,bd)).onSettled)==null||f.call(h,o.data,null,w,x)):(o==null?void 0:o.type)==="error"&&((v=(_=Se(this,bd)).onError)==null||v.call(_,o.error,w,x),(A=(b=Se(this,bd)).onSettled)==null||A.call(b,void 0,o.error,w,x))}this.listeners.forEach(w=>{w(Se(this,sh))})})},JH),cK=K.createContext(void 0),Os=t=>{const r=K.useContext(cK);if(t)return t;if(!r)throw new Error("No QueryClient set, use QueryClientProvider to set one");return r},Jfe=({client:t,children:r})=>(K.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),T.jsx(cK.Provider,{value:t,children:r})),lK=K.createContext(!1),Qfe=()=>K.useContext(lK);lK.Provider;function Zfe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var eme=K.createContext(Zfe()),tme=()=>K.useContext(eme);function dK(t,r){return typeof t=="function"?t(...r):!!t}function nme(){}var rme=(t,r)=>{(t.suspense||t.throwOnError)&&(r.isReset()||(t.retryOnMount=!1))},ime=t=>{K.useEffect(()=>{t.clearReset()},[t])},sme=({result:t,errorResetBoundary:r,throwOnError:o,query:c})=>t.isError&&!r.isReset()&&!t.isFetching&&c&&dK(o,[t.error,c]),ome=t=>{t.suspense&&typeof t.staleTime!="number"&&(t.staleTime=1e3)},ame=(t,r)=>(t==null?void 0:t.suspense)&&r.isPending,cme=(t,r,o)=>r.fetchOptimistic(t).catch(()=>{o.clearReset()});function lme(t,r,o){const c=Os(o),d=Qfe(),h=tme(),f=c.defaultQueryOptions(t);f._optimisticResults=d?"isRestoring":"optimistic",ome(f),rme(f,h),ime(h);const[_]=K.useState(()=>new r(c,f)),v=_.getOptimisticResult(f);if(K.useSyncExternalStore(K.useCallback(b=>{const A=d?()=>{}:_.subscribe(ss.batchCalls(b));return _.updateResult(),A},[_,d]),()=>_.getCurrentResult(),()=>_.getCurrentResult()),K.useEffect(()=>{_.setOptions(f,{listeners:!1})},[f,_]),ame(f,v))throw cme(f,_,h);if(sme({result:v,errorResetBoundary:h,throwOnError:f.throwOnError,query:c.getQueryCache().get(f.queryHash)}))throw v.error;return f.notifyOnChangeProps?v:_.trackResult(v)}function yh(t,r){return lme(t,Kfe,r)}function ki(t,r){const o=Os(r),[c]=K.useState(()=>new Xfe(o,t));K.useEffect(()=>{c.setOptions(t)},[c,t]);const d=K.useSyncExternalStore(K.useCallback(f=>c.subscribe(ss.batchCalls(f)),[c]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),h=K.useCallback((f,_)=>{c.mutate(f,_).catch(nme)},[c]);if(d.error&&dK(c.options.throwOnError,[d.error]))throw d.error;return{...d,mutate:h,mutateAsync:d.mutate}}function uK(t,r){return function(){return t.apply(r,arguments)}}const{toString:dme}=Object.prototype,{getPrototypeOf:CM}=Object,UR=(t=>r=>{const o=dme.call(r);return t[o]||(t[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),Vl=t=>(t=t.toLowerCase(),r=>UR(r)===t),jR=t=>r=>typeof r===t,{isArray:n_}=Array,Uy=jR("undefined");function ume(t){return t!==null&&!Uy(t)&&t.constructor!==null&&!Uy(t.constructor)&&Qa(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const hK=Vl("ArrayBuffer");function hme(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&hK(t.buffer),r}const pme=jR("string"),Qa=jR("function"),pK=jR("number"),FR=t=>t!==null&&typeof t=="object",fme=t=>t===!0||t===!1,iw=t=>{if(UR(t)!=="object")return!1;const r=CM(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},mme=Vl("Date"),gme=Vl("File"),_me=Vl("Blob"),Eme=Vl("FileList"),vme=t=>FR(t)&&Qa(t.pipe),yme=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||Qa(t.append)&&((r=UR(t))==="formdata"||r==="object"&&Qa(t.toString)&&t.toString()==="[object FormData]"))},Sme=Vl("URLSearchParams"),bme=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function p0(t,r,{allOwnKeys:o=!1}={}){if(t===null||typeof t>"u")return;let c,d;if(typeof t!="object"&&(t=[t]),n_(t))for(c=0,d=t.length;c<d;c++)r.call(null,t[c],c,t);else{const h=o?Object.getOwnPropertyNames(t):Object.keys(t),f=h.length;let _;for(c=0;c<f;c++)_=h[c],r.call(null,t[_],_,t)}}function fK(t,r){r=r.toLowerCase();const o=Object.keys(t);let c=o.length,d;for(;c-- >0;)if(d=o[c],r===d.toLowerCase())return d;return null}const mK=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gK=t=>!Uy(t)&&t!==mK;function yL(){const{caseless:t}=gK(this)&&this||{},r={},o=(c,d)=>{const h=t&&fK(r,d)||d;iw(r[h])&&iw(c)?r[h]=yL(r[h],c):iw(c)?r[h]=yL({},c):n_(c)?r[h]=c.slice():r[h]=c};for(let c=0,d=arguments.length;c<d;c++)arguments[c]&&p0(arguments[c],o);return r}const Tme=(t,r,o,{allOwnKeys:c}={})=>(p0(r,(d,h)=>{o&&Qa(d)?t[h]=uK(d,o):t[h]=d},{allOwnKeys:c}),t),Cme=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),wme=(t,r,o,c)=>{t.prototype=Object.create(r.prototype,c),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),o&&Object.assign(t.prototype,o)},Rme=(t,r,o,c)=>{let d,h,f;const _={};if(r=r||{},t==null)return r;do{for(d=Object.getOwnPropertyNames(t),h=d.length;h-- >0;)f=d[h],(!c||c(f,t,r))&&!_[f]&&(r[f]=t[f],_[f]=!0);t=o!==!1&&CM(t)}while(t&&(!o||o(t,r))&&t!==Object.prototype);return r},Ime=(t,r,o)=>{t=String(t),(o===void 0||o>t.length)&&(o=t.length),o-=r.length;const c=t.indexOf(r,o);return c!==-1&&c===o},Ame=t=>{if(!t)return null;if(n_(t))return t;let r=t.length;if(!pK(r))return null;const o=new Array(r);for(;r-- >0;)o[r]=t[r];return o},Ome=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&CM(Uint8Array)),Nme=(t,r)=>{const c=(t&&t[Symbol.iterator]).call(t);let d;for(;(d=c.next())&&!d.done;){const h=d.value;r.call(t,h[0],h[1])}},kme=(t,r)=>{let o;const c=[];for(;(o=t.exec(r))!==null;)c.push(o);return c},xme=Vl("HTMLFormElement"),Pme=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,c,d){return c.toUpperCase()+d}),y$=(({hasOwnProperty:t})=>(r,o)=>t.call(r,o))(Object.prototype),Dme=Vl("RegExp"),_K=(t,r)=>{const o=Object.getOwnPropertyDescriptors(t),c={};p0(o,(d,h)=>{let f;(f=r(d,h,t))!==!1&&(c[h]=f||d)}),Object.defineProperties(t,c)},Lme=t=>{_K(t,(r,o)=>{if(Qa(t)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const c=t[o];if(Qa(c)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},Mme=(t,r)=>{const o={},c=d=>{d.forEach(h=>{o[h]=!0})};return n_(t)?c(t):c(String(t).split(r)),o},Ume=()=>{},jme=(t,r)=>(t=+t,Number.isFinite(t)?t:r),hP="abcdefghijklmnopqrstuvwxyz",S$="0123456789",EK={DIGIT:S$,ALPHA:hP,ALPHA_DIGIT:hP+hP.toUpperCase()+S$},Fme=(t=16,r=EK.ALPHA_DIGIT)=>{let o="";const{length:c}=r;for(;t--;)o+=r[Math.random()*c|0];return o};function Vme(t){return!!(t&&Qa(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const Bme=t=>{const r=new Array(10),o=(c,d)=>{if(FR(c)){if(r.indexOf(c)>=0)return;if(!("toJSON"in c)){r[d]=c;const h=n_(c)?[]:{};return p0(c,(f,_)=>{const v=o(f,d+1);!Uy(v)&&(h[_]=v)}),r[d]=void 0,h}}return c};return o(t,0)},Wme=Vl("AsyncFunction"),$me=t=>t&&(FR(t)||Qa(t))&&Qa(t.then)&&Qa(t.catch),He={isArray:n_,isArrayBuffer:hK,isBuffer:ume,isFormData:yme,isArrayBufferView:hme,isString:pme,isNumber:pK,isBoolean:fme,isObject:FR,isPlainObject:iw,isUndefined:Uy,isDate:mme,isFile:gme,isBlob:_me,isRegExp:Dme,isFunction:Qa,isStream:vme,isURLSearchParams:Sme,isTypedArray:Ome,isFileList:Eme,forEach:p0,merge:yL,extend:Tme,trim:bme,stripBOM:Cme,inherits:wme,toFlatObject:Rme,kindOf:UR,kindOfTest:Vl,endsWith:Ime,toArray:Ame,forEachEntry:Nme,matchAll:kme,isHTMLForm:xme,hasOwnProperty:y$,hasOwnProp:y$,reduceDescriptors:_K,freezeMethods:Lme,toObjectSet:Mme,toCamelCase:Pme,noop:Ume,toFiniteNumber:jme,findKey:fK,global:mK,isContextDefined:gK,ALPHABET:EK,generateString:Fme,isSpecCompliantForm:Vme,toJSONObject:Bme,isAsyncFn:Wme,isThenable:$me};function $n(t,r,o,c,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),o&&(this.config=o),c&&(this.request=c),d&&(this.response=d)}He.inherits($n,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:He.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const vK=$n.prototype,yK={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{yK[t]={value:t}});Object.defineProperties($n,yK);Object.defineProperty(vK,"isAxiosError",{value:!0});$n.from=(t,r,o,c,d,h)=>{const f=Object.create(vK);return He.toFlatObject(t,f,function(v){return v!==Error.prototype},_=>_!=="isAxiosError"),$n.call(f,t.message,r,o,c,d),f.cause=t,f.name=t.name,h&&Object.assign(f,h),f};const Gme=null;function SL(t){return He.isPlainObject(t)||He.isArray(t)}function SK(t){return He.endsWith(t,"[]")?t.slice(0,-2):t}function b$(t,r,o){return t?t.concat(r).map(function(d,h){return d=SK(d),!o&&h?"["+d+"]":d}).join(o?".":""):r}function Hme(t){return He.isArray(t)&&!t.some(SL)}const zme=He.toFlatObject(He,{},null,function(r){return/^is[A-Z]/.test(r)});function VR(t,r,o){if(!He.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,o=He.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(G,H){return!He.isUndefined(H[G])});const c=o.metaTokens,d=o.visitor||A,h=o.dots,f=o.indexes,v=(o.Blob||typeof Blob<"u"&&Blob)&&He.isSpecCompliantForm(r);if(!He.isFunction(d))throw new TypeError("visitor must be a function");function b(V){if(V===null)return"";if(He.isDate(V))return V.toISOString();if(!v&&He.isBlob(V))throw new $n("Blob is not supported. Use a Buffer instead.");return He.isArrayBuffer(V)||He.isTypedArray(V)?v&&typeof Blob=="function"?new Blob([V]):Buffer.from(V):V}function A(V,G,H){let F=V;if(V&&!H&&typeof V=="object"){if(He.endsWith(G,"{}"))G=c?G:G.slice(0,-2),V=JSON.stringify(V);else if(He.isArray(V)&&Hme(V)||(He.isFileList(V)||He.endsWith(G,"[]"))&&(F=He.toArray(V)))return G=SK(G),F.forEach(function(L,X){!(He.isUndefined(L)||L===null)&&r.append(f===!0?b$([G],X,h):f===null?G:G+"[]",b(L))}),!1}return SL(V)?!0:(r.append(b$(H,G,h),b(V)),!1)}const w=[],x=Object.assign(zme,{defaultVisitor:A,convertValue:b,isVisitable:SL});function M(V,G){if(!He.isUndefined(V)){if(w.indexOf(V)!==-1)throw Error("Circular reference detected in "+G.join("."));w.push(V),He.forEach(V,function(F,B){(!(He.isUndefined(F)||F===null)&&d.call(r,F,He.isString(B)?B.trim():B,G,x))===!0&&M(F,G?G.concat(B):[B])}),w.pop()}}if(!He.isObject(t))throw new TypeError("data must be an object");return M(t),r}function T$(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(c){return r[c]})}function wM(t,r){this._pairs=[],t&&VR(t,this,r)}const bK=wM.prototype;bK.append=function(r,o){this._pairs.push([r,o])};bK.toString=function(r){const o=r?function(c){return r.call(this,c,T$)}:T$;return this._pairs.map(function(d){return o(d[0])+"="+o(d[1])},"").join("&")};function Kme(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function TK(t,r,o){if(!r)return t;const c=o&&o.encode||Kme,d=o&&o.serialize;let h;if(d?h=d(r,o):h=He.isURLSearchParams(r)?r.toString():new wM(r,o).toString(c),h){const f=t.indexOf("#");f!==-1&&(t=t.slice(0,f)),t+=(t.indexOf("?")===-1?"?":"&")+h}return t}class C${constructor(){this.handlers=[]}use(r,o,c){return this.handlers.push({fulfilled:r,rejected:o,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){He.forEach(this.handlers,function(c){c!==null&&r(c)})}}const CK={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Yme=typeof URLSearchParams<"u"?URLSearchParams:wM,qme=typeof FormData<"u"?FormData:null,Xme=typeof Blob<"u"?Blob:null,Jme={isBrowser:!0,classes:{URLSearchParams:Yme,FormData:qme,Blob:Xme},protocols:["http","https","file","blob","url","data"]},wK=typeof window<"u"&&typeof document<"u",Qme=(t=>wK&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),Zme=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ege=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wK,hasStandardBrowserEnv:Qme,hasStandardBrowserWebWorkerEnv:Zme},Symbol.toStringTag,{value:"Module"})),Nl={...ege,...Jme};function tge(t,r){return VR(t,new Nl.classes.URLSearchParams,Object.assign({visitor:function(o,c,d,h){return Nl.isNode&&He.isBuffer(o)?(this.append(c,o.toString("base64")),!1):h.defaultVisitor.apply(this,arguments)}},r))}function nge(t){return He.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function rge(t){const r={},o=Object.keys(t);let c;const d=o.length;let h;for(c=0;c<d;c++)h=o[c],r[h]=t[h];return r}function RK(t){function r(o,c,d,h){let f=o[h++];if(f==="__proto__")return!0;const _=Number.isFinite(+f),v=h>=o.length;return f=!f&&He.isArray(d)?d.length:f,v?(He.hasOwnProp(d,f)?d[f]=[d[f],c]:d[f]=c,!_):((!d[f]||!He.isObject(d[f]))&&(d[f]=[]),r(o,c,d[f],h)&&He.isArray(d[f])&&(d[f]=rge(d[f])),!_)}if(He.isFormData(t)&&He.isFunction(t.entries)){const o={};return He.forEachEntry(t,(c,d)=>{r(nge(c),d,o,0)}),o}return null}function ige(t,r,o){if(He.isString(t))try{return(r||JSON.parse)(t),He.trim(t)}catch(c){if(c.name!=="SyntaxError")throw c}return(o||JSON.stringify)(t)}const RM={transitional:CK,adapter:["xhr","http"],transformRequest:[function(r,o){const c=o.getContentType()||"",d=c.indexOf("application/json")>-1,h=He.isObject(r);if(h&&He.isHTMLForm(r)&&(r=new FormData(r)),He.isFormData(r))return d?JSON.stringify(RK(r)):r;if(He.isArrayBuffer(r)||He.isBuffer(r)||He.isStream(r)||He.isFile(r)||He.isBlob(r))return r;if(He.isArrayBufferView(r))return r.buffer;if(He.isURLSearchParams(r))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let _;if(h){if(c.indexOf("application/x-www-form-urlencoded")>-1)return tge(r,this.formSerializer).toString();if((_=He.isFileList(r))||c.indexOf("multipart/form-data")>-1){const v=this.env&&this.env.FormData;return VR(_?{"files[]":r}:r,v&&new v,this.formSerializer)}}return h||d?(o.setContentType("application/json",!1),ige(r)):r}],transformResponse:[function(r){const o=this.transitional||RM.transitional,c=o&&o.forcedJSONParsing,d=this.responseType==="json";if(r&&He.isString(r)&&(c&&!this.responseType||d)){const f=!(o&&o.silentJSONParsing)&&d;try{return JSON.parse(r)}catch(_){if(f)throw _.name==="SyntaxError"?$n.from(_,$n.ERR_BAD_RESPONSE,this,null,this.response):_}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Nl.classes.FormData,Blob:Nl.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};He.forEach(["delete","get","head","post","put","patch"],t=>{RM.headers[t]={}});const IM=RM,sge=He.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),oge=t=>{const r={};let o,c,d;return t&&t.split(`
`).forEach(function(f){d=f.indexOf(":"),o=f.substring(0,d).trim().toLowerCase(),c=f.substring(d+1).trim(),!(!o||r[o]&&sge[o])&&(o==="set-cookie"?r[o]?r[o].push(c):r[o]=[c]:r[o]=r[o]?r[o]+", "+c:c)}),r},w$=Symbol("internals");function Av(t){return t&&String(t).trim().toLowerCase()}function sw(t){return t===!1||t==null?t:He.isArray(t)?t.map(sw):String(t)}function age(t){const r=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=o.exec(t);)r[c[1]]=c[2];return r}const cge=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function pP(t,r,o,c,d){if(He.isFunction(c))return c.call(this,r,o);if(d&&(r=o),!!He.isString(r)){if(He.isString(c))return r.indexOf(c)!==-1;if(He.isRegExp(c))return c.test(r)}}function lge(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,o,c)=>o.toUpperCase()+c)}function dge(t,r){const o=He.toCamelCase(" "+r);["get","set","has"].forEach(c=>{Object.defineProperty(t,c+o,{value:function(d,h,f){return this[c].call(this,r,d,h,f)},configurable:!0})})}class BR{constructor(r){r&&this.set(r)}set(r,o,c){const d=this;function h(_,v,b){const A=Av(v);if(!A)throw new Error("header name must be a non-empty string");const w=He.findKey(d,A);(!w||d[w]===void 0||b===!0||b===void 0&&d[w]!==!1)&&(d[w||v]=sw(_))}const f=(_,v)=>He.forEach(_,(b,A)=>h(b,A,v));return He.isPlainObject(r)||r instanceof this.constructor?f(r,o):He.isString(r)&&(r=r.trim())&&!cge(r)?f(oge(r),o):r!=null&&h(o,r,c),this}get(r,o){if(r=Av(r),r){const c=He.findKey(this,r);if(c){const d=this[c];if(!o)return d;if(o===!0)return age(d);if(He.isFunction(o))return o.call(this,d,c);if(He.isRegExp(o))return o.exec(d);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,o){if(r=Av(r),r){const c=He.findKey(this,r);return!!(c&&this[c]!==void 0&&(!o||pP(this,this[c],c,o)))}return!1}delete(r,o){const c=this;let d=!1;function h(f){if(f=Av(f),f){const _=He.findKey(c,f);_&&(!o||pP(c,c[_],_,o))&&(delete c[_],d=!0)}}return He.isArray(r)?r.forEach(h):h(r),d}clear(r){const o=Object.keys(this);let c=o.length,d=!1;for(;c--;){const h=o[c];(!r||pP(this,this[h],h,r,!0))&&(delete this[h],d=!0)}return d}normalize(r){const o=this,c={};return He.forEach(this,(d,h)=>{const f=He.findKey(c,h);if(f){o[f]=sw(d),delete o[h];return}const _=r?lge(h):String(h).trim();_!==h&&delete o[h],o[_]=sw(d),c[_]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const o=Object.create(null);return He.forEach(this,(c,d)=>{c!=null&&c!==!1&&(o[d]=r&&He.isArray(c)?c.join(", "):c)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,o])=>r+": "+o).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...o){const c=new this(r);return o.forEach(d=>c.set(d)),c}static accessor(r){const c=(this[w$]=this[w$]={accessors:{}}).accessors,d=this.prototype;function h(f){const _=Av(f);c[_]||(dge(d,f),c[_]=!0)}return He.isArray(r)?r.forEach(h):h(r),this}}BR.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);He.reduceDescriptors(BR.prototype,({value:t},r)=>{let o=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(c){this[o]=c}}});He.freezeMethods(BR);const Ad=BR;function fP(t,r){const o=this||IM,c=r||o,d=Ad.from(c.headers);let h=c.data;return He.forEach(t,function(_){h=_.call(o,h,d.normalize(),r?r.status:void 0)}),d.normalize(),h}function IK(t){return!!(t&&t.__CANCEL__)}function f0(t,r,o){$n.call(this,t??"canceled",$n.ERR_CANCELED,r,o),this.name="CanceledError"}He.inherits(f0,$n,{__CANCEL__:!0});function uge(t,r,o){const c=o.config.validateStatus;!o.status||!c||c(o.status)?t(o):r(new $n("Request failed with status code "+o.status,[$n.ERR_BAD_REQUEST,$n.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}const hge=Nl.hasStandardBrowserEnv?{write(t,r,o,c,d,h){const f=[t+"="+encodeURIComponent(r)];He.isNumber(o)&&f.push("expires="+new Date(o).toGMTString()),He.isString(c)&&f.push("path="+c),He.isString(d)&&f.push("domain="+d),h===!0&&f.push("secure"),document.cookie=f.join("; ")},read(t){const r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pge(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function fge(t,r){return r?t.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):t}function AK(t,r){return t&&!pge(r)?fge(t,r):r}const mge=Nl.hasStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");let c;function d(h){let f=h;return r&&(o.setAttribute("href",f),f=o.href),o.setAttribute("href",f),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:o.pathname.charAt(0)==="/"?o.pathname:"/"+o.pathname}}return c=d(window.location.href),function(f){const _=He.isString(f)?d(f):f;return _.protocol===c.protocol&&_.host===c.host}}():function(){return function(){return!0}}();function gge(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function _ge(t,r){t=t||10;const o=new Array(t),c=new Array(t);let d=0,h=0,f;return r=r!==void 0?r:1e3,function(v){const b=Date.now(),A=c[h];f||(f=b),o[d]=v,c[d]=b;let w=h,x=0;for(;w!==d;)x+=o[w++],w=w%t;if(d=(d+1)%t,d===h&&(h=(h+1)%t),b-f<r)return;const M=A&&b-A;return M?Math.round(x*1e3/M):void 0}}function R$(t,r){let o=0;const c=_ge(50,250);return d=>{const h=d.loaded,f=d.lengthComputable?d.total:void 0,_=h-o,v=c(_),b=h<=f;o=h;const A={loaded:h,total:f,progress:f?h/f:void 0,bytes:_,rate:v||void 0,estimated:v&&f&&b?(f-h)/v:void 0,event:d};A[r?"download":"upload"]=!0,t(A)}}const Ege=typeof XMLHttpRequest<"u",vge=Ege&&function(t){return new Promise(function(o,c){let d=t.data;const h=Ad.from(t.headers).normalize();let{responseType:f,withXSRFToken:_}=t,v;function b(){t.cancelToken&&t.cancelToken.unsubscribe(v),t.signal&&t.signal.removeEventListener("abort",v)}let A;if(He.isFormData(d)){if(Nl.hasStandardBrowserEnv||Nl.hasStandardBrowserWebWorkerEnv)h.setContentType(!1);else if((A=h.getContentType())!==!1){const[G,...H]=A?A.split(";").map(F=>F.trim()).filter(Boolean):[];h.setContentType([G||"multipart/form-data",...H].join("; "))}}let w=new XMLHttpRequest;if(t.auth){const G=t.auth.username||"",H=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";h.set("Authorization","Basic "+btoa(G+":"+H))}const x=AK(t.baseURL,t.url);w.open(t.method.toUpperCase(),TK(x,t.params,t.paramsSerializer),!0),w.timeout=t.timeout;function M(){if(!w)return;const G=Ad.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),F={data:!f||f==="text"||f==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:G,config:t,request:w};uge(function(L){o(L),b()},function(L){c(L),b()},F),w=null}if("onloadend"in w?w.onloadend=M:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(M)},w.onabort=function(){w&&(c(new $n("Request aborted",$n.ECONNABORTED,t,w)),w=null)},w.onerror=function(){c(new $n("Network Error",$n.ERR_NETWORK,t,w)),w=null},w.ontimeout=function(){let H=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const F=t.transitional||CK;t.timeoutErrorMessage&&(H=t.timeoutErrorMessage),c(new $n(H,F.clarifyTimeoutError?$n.ETIMEDOUT:$n.ECONNABORTED,t,w)),w=null},Nl.hasStandardBrowserEnv&&(_&&He.isFunction(_)&&(_=_(t)),_||_!==!1&&mge(x))){const G=t.xsrfHeaderName&&t.xsrfCookieName&&hge.read(t.xsrfCookieName);G&&h.set(t.xsrfHeaderName,G)}d===void 0&&h.setContentType(null),"setRequestHeader"in w&&He.forEach(h.toJSON(),function(H,F){w.setRequestHeader(F,H)}),He.isUndefined(t.withCredentials)||(w.withCredentials=!!t.withCredentials),f&&f!=="json"&&(w.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&w.addEventListener("progress",R$(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&w.upload&&w.upload.addEventListener("progress",R$(t.onUploadProgress)),(t.cancelToken||t.signal)&&(v=G=>{w&&(c(!G||G.type?new f0(null,t,w):G),w.abort(),w=null)},t.cancelToken&&t.cancelToken.subscribe(v),t.signal&&(t.signal.aborted?v():t.signal.addEventListener("abort",v)));const V=gge(x);if(V&&Nl.protocols.indexOf(V)===-1){c(new $n("Unsupported protocol "+V+":",$n.ERR_BAD_REQUEST,t));return}w.send(d||null)})},bL={http:Gme,xhr:vge};He.forEach(bL,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const I$=t=>`- ${t}`,yge=t=>He.isFunction(t)||t===null||t===!1,OK={getAdapter:t=>{t=He.isArray(t)?t:[t];const{length:r}=t;let o,c;const d={};for(let h=0;h<r;h++){o=t[h];let f;if(c=o,!yge(o)&&(c=bL[(f=String(o)).toLowerCase()],c===void 0))throw new $n(`Unknown adapter '${f}'`);if(c)break;d[f||"#"+h]=c}if(!c){const h=Object.entries(d).map(([_,v])=>`adapter ${_} `+(v===!1?"is not supported by the environment":"is not available in the build"));let f=r?h.length>1?`since :
`+h.map(I$).join(`
`):" "+I$(h[0]):"as no adapter specified";throw new $n("There is no suitable adapter to dispatch the request "+f,"ERR_NOT_SUPPORT")}return c},adapters:bL};function mP(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new f0(null,t)}function A$(t){return mP(t),t.headers=Ad.from(t.headers),t.data=fP.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),OK.getAdapter(t.adapter||IM.adapter)(t).then(function(c){return mP(t),c.data=fP.call(t,t.transformResponse,c),c.headers=Ad.from(c.headers),c},function(c){return IK(c)||(mP(t),c&&c.response&&(c.response.data=fP.call(t,t.transformResponse,c.response),c.response.headers=Ad.from(c.response.headers))),Promise.reject(c)})}const O$=t=>t instanceof Ad?{...t}:t;function $g(t,r){r=r||{};const o={};function c(b,A,w){return He.isPlainObject(b)&&He.isPlainObject(A)?He.merge.call({caseless:w},b,A):He.isPlainObject(A)?He.merge({},A):He.isArray(A)?A.slice():A}function d(b,A,w){if(He.isUndefined(A)){if(!He.isUndefined(b))return c(void 0,b,w)}else return c(b,A,w)}function h(b,A){if(!He.isUndefined(A))return c(void 0,A)}function f(b,A){if(He.isUndefined(A)){if(!He.isUndefined(b))return c(void 0,b)}else return c(void 0,A)}function _(b,A,w){if(w in r)return c(b,A);if(w in t)return c(void 0,b)}const v={url:h,method:h,data:h,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:_,headers:(b,A)=>d(O$(b),O$(A),!0)};return He.forEach(Object.keys(Object.assign({},t,r)),function(A){const w=v[A]||d,x=w(t[A],r[A],A);He.isUndefined(x)&&w!==_||(o[A]=x)}),o}const NK="1.6.8",AM={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{AM[t]=function(c){return typeof c===t||"a"+(r<1?"n ":" ")+t}});const N$={};AM.transitional=function(r,o,c){function d(h,f){return"[Axios v"+NK+"] Transitional option '"+h+"'"+f+(c?". "+c:"")}return(h,f,_)=>{if(r===!1)throw new $n(d(f," has been removed"+(o?" in "+o:"")),$n.ERR_DEPRECATED);return o&&!N$[f]&&(N$[f]=!0,console.warn(d(f," has been deprecated since v"+o+" and will be removed in the near future"))),r?r(h,f,_):!0}};function Sge(t,r,o){if(typeof t!="object")throw new $n("options must be an object",$n.ERR_BAD_OPTION_VALUE);const c=Object.keys(t);let d=c.length;for(;d-- >0;){const h=c[d],f=r[h];if(f){const _=t[h],v=_===void 0||f(_,h,t);if(v!==!0)throw new $n("option "+h+" must be "+v,$n.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new $n("Unknown option "+h,$n.ERR_BAD_OPTION)}}const TL={assertOptions:Sge,validators:AM},Wu=TL.validators;class Kw{constructor(r){this.defaults=r,this.interceptors={request:new C$,response:new C$}}async request(r,o){try{return await this._request(r,o)}catch(c){if(c instanceof Error){let d;Error.captureStackTrace?Error.captureStackTrace(d={}):d=new Error;const h=d.stack?d.stack.replace(/^.+\n/,""):"";c.stack?h&&!String(c.stack).endsWith(h.replace(/^.+\n.+\n/,""))&&(c.stack+=`
`+h):c.stack=h}throw c}}_request(r,o){typeof r=="string"?(o=o||{},o.url=r):o=r||{},o=$g(this.defaults,o);const{transitional:c,paramsSerializer:d,headers:h}=o;c!==void 0&&TL.assertOptions(c,{silentJSONParsing:Wu.transitional(Wu.boolean),forcedJSONParsing:Wu.transitional(Wu.boolean),clarifyTimeoutError:Wu.transitional(Wu.boolean)},!1),d!=null&&(He.isFunction(d)?o.paramsSerializer={serialize:d}:TL.assertOptions(d,{encode:Wu.function,serialize:Wu.function},!0)),o.method=(o.method||this.defaults.method||"get").toLowerCase();let f=h&&He.merge(h.common,h[o.method]);h&&He.forEach(["delete","get","head","post","put","patch","common"],V=>{delete h[V]}),o.headers=Ad.concat(f,h);const _=[];let v=!0;this.interceptors.request.forEach(function(G){typeof G.runWhen=="function"&&G.runWhen(o)===!1||(v=v&&G.synchronous,_.unshift(G.fulfilled,G.rejected))});const b=[];this.interceptors.response.forEach(function(G){b.push(G.fulfilled,G.rejected)});let A,w=0,x;if(!v){const V=[A$.bind(this),void 0];for(V.unshift.apply(V,_),V.push.apply(V,b),x=V.length,A=Promise.resolve(o);w<x;)A=A.then(V[w++],V[w++]);return A}x=_.length;let M=o;for(w=0;w<x;){const V=_[w++],G=_[w++];try{M=V(M)}catch(H){G.call(this,H);break}}try{A=A$.call(this,M)}catch(V){return Promise.reject(V)}for(w=0,x=b.length;w<x;)A=A.then(b[w++],b[w++]);return A}getUri(r){r=$g(this.defaults,r);const o=AK(r.baseURL,r.url);return TK(o,r.params,r.paramsSerializer)}}He.forEach(["delete","get","head","options"],function(r){Kw.prototype[r]=function(o,c){return this.request($g(c||{},{method:r,url:o,data:(c||{}).data}))}});He.forEach(["post","put","patch"],function(r){function o(c){return function(h,f,_){return this.request($g(_||{},{method:r,headers:c?{"Content-Type":"multipart/form-data"}:{},url:h,data:f}))}}Kw.prototype[r]=o(),Kw.prototype[r+"Form"]=o(!0)});const ow=Kw;class OM{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(h){o=h});const c=this;this.promise.then(d=>{if(!c._listeners)return;let h=c._listeners.length;for(;h-- >0;)c._listeners[h](d);c._listeners=null}),this.promise.then=d=>{let h;const f=new Promise(_=>{c.subscribe(_),h=_}).then(d);return f.cancel=function(){c.unsubscribe(h)},f},r(function(h,f,_){c.reason||(c.reason=new f0(h,f,_),o(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const o=this._listeners.indexOf(r);o!==-1&&this._listeners.splice(o,1)}static source(){let r;return{token:new OM(function(d){r=d}),cancel:r}}}const bge=OM;function Tge(t){return function(o){return t.apply(null,o)}}function Cge(t){return He.isObject(t)&&t.isAxiosError===!0}const CL={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(CL).forEach(([t,r])=>{CL[r]=t});const wge=CL;function kK(t){const r=new ow(t),o=uK(ow.prototype.request,r);return He.extend(o,ow.prototype,r,{allOwnKeys:!0}),He.extend(o,r,null,{allOwnKeys:!0}),o.create=function(d){return kK($g(t,d))},o}const hi=kK(IM);hi.Axios=ow;hi.CanceledError=f0;hi.CancelToken=bge;hi.isCancel=IK;hi.VERSION=NK;hi.toFormData=VR;hi.AxiosError=$n;hi.Cancel=hi.CanceledError;hi.all=function(r){return Promise.all(r)};hi.spread=Tge;hi.isAxiosError=Cge;hi.mergeConfig=$g;hi.AxiosHeaders=Ad;hi.formToJSON=t=>RK(He.isHTMLForm(t)?new FormData(t):t);hi.getAdapter=OK.getAdapter;hi.HttpStatusCode=wge;hi.default=hi;const Gn=hi.create({baseURL:"http://ec2-13-213-1-120.ap-southeast-1.compute.amazonaws.com:8080"});function Wr(t){return{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}}class xK{login(r){return Gn.post("/api/v1/auth/login",r)}getUser(r){return Gn.get("/api/v1/users/profile",Wr(r))}register(r,o){return Gn.post("/api/v1/auth/register",r,Wr(o))}}/*! js-cookie v3.0.5 | MIT */function NC(t){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var c in o)t[c]=o[c]}return t}var Rge={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function wL(t,r){function o(d,h,f){if(!(typeof document>"u")){f=NC({},r,f),typeof f.expires=="number"&&(f.expires=new Date(Date.now()+f.expires*864e5)),f.expires&&(f.expires=f.expires.toUTCString()),d=encodeURIComponent(d).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var _="";for(var v in f)f[v]&&(_+="; "+v,f[v]!==!0&&(_+="="+f[v].split(";")[0]));return document.cookie=d+"="+t.write(h,d)+_}}function c(d){if(!(typeof document>"u"||arguments.length&&!d)){for(var h=document.cookie?document.cookie.split("; "):[],f={},_=0;_<h.length;_++){var v=h[_].split("="),b=v.slice(1).join("=");try{var A=decodeURIComponent(v[0]);if(f[A]=t.read(b,A),d===A)break}catch{}}return d?f[d]:f}}return Object.create({set:o,get:c,remove:function(d,h){o(d,"",NC({},h,{expires:-1}))},withAttributes:function(d){return wL(this.converter,NC({},this.attributes,d))},withConverter:function(d){return wL(NC({},this.converter,d),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}var Hn=wL(Rge,{path:"/"}),PK={exports:{}};(function(t,r){(function(o,c){t.exports=c()})(nt,function(){return function(o){function c(h){if(d[h])return d[h].exports;var f=d[h]={i:h,l:!1,exports:{}};return o[h].call(f.exports,f,f.exports,c),f.l=!0,f.exports}var d={};return c.m=o,c.c=d,c.d=function(h,f,_){c.o(h,f)||Object.defineProperty(h,f,{configurable:!1,enumerable:!0,get:_})},c.n=function(h){var f=h&&h.__esModule?function(){return h.default}:function(){return h};return c.d(f,"a",f),f},c.o=function(h,f){return Object.prototype.hasOwnProperty.call(h,f)},c.p="",c(c.s=8)}([function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h="swal-button";c.CLASS_NAMES={MODAL:"swal-modal",OVERLAY:"swal-overlay",SHOW_MODAL:"swal-overlay--show-modal",MODAL_TITLE:"swal-title",MODAL_TEXT:"swal-text",ICON:"swal-icon",ICON_CUSTOM:"swal-icon--custom",CONTENT:"swal-content",FOOTER:"swal-footer",BUTTON_CONTAINER:"swal-button-container",BUTTON:h,CONFIRM_BUTTON:h+"--confirm",CANCEL_BUTTON:h+"--cancel",DANGER_BUTTON:h+"--danger",BUTTON_LOADING:h+"--loading",BUTTON_LOADER:h+"__loader"},c.default=c.CLASS_NAMES},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.getNode=function(h){var f="."+h;return document.querySelector(f)},c.stringToNode=function(h){var f=document.createElement("div");return f.innerHTML=h.trim(),f.firstChild},c.insertAfter=function(h,f){var _=f.nextSibling;f.parentNode.insertBefore(h,_)},c.removeNode=function(h){h.parentElement.removeChild(h)},c.throwErr=function(h){throw h=h.replace(/ +(?= )/g,""),"SweetAlert: "+(h=h.trim())},c.isPlainObject=function(h){if(Object.prototype.toString.call(h)!=="[object Object]")return!1;var f=Object.getPrototypeOf(h);return f===null||f===Object.prototype},c.ordinalSuffixOf=function(h){var f=h%10,_=h%100;return f===1&&_!==11?h+"st":f===2&&_!==12?h+"nd":f===3&&_!==13?h+"rd":h+"th"}},function(o,c,d){function h(x){for(var M in x)c.hasOwnProperty(M)||(c[M]=x[M])}Object.defineProperty(c,"__esModule",{value:!0}),h(d(25));var f=d(26);c.overlayMarkup=f.default,h(d(27)),h(d(28)),h(d(29));var _=d(0),v=_.default.MODAL_TITLE,b=_.default.MODAL_TEXT,A=_.default.ICON,w=_.default.FOOTER;c.iconMarkup=`
  <div class="`+A+'"></div>',c.titleMarkup=`
  <div class="`+v+`"></div>
`,c.textMarkup=`
  <div class="`+b+'"></div>',c.footerMarkup=`
  <div class="`+w+`"></div>
`},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1);c.CONFIRM_KEY="confirm",c.CANCEL_KEY="cancel";var f={visible:!0,text:null,value:null,className:"",closeModal:!0},_=Object.assign({},f,{visible:!1,text:"Cancel",value:null}),v=Object.assign({},f,{text:"OK",value:!0});c.defaultButtonList={cancel:_,confirm:v};var b=function(M){switch(M){case c.CONFIRM_KEY:return v;case c.CANCEL_KEY:return _;default:var V=M.charAt(0).toUpperCase()+M.slice(1);return Object.assign({},f,{text:V,value:M})}},A=function(M,V){var G=b(M);return V===!0?Object.assign({},G,{visible:!0}):typeof V=="string"?Object.assign({},G,{visible:!0,text:V}):h.isPlainObject(V)?Object.assign({visible:!0},G,V):Object.assign({},G,{visible:!1})},w=function(M){for(var V={},G=0,H=Object.keys(M);G<H.length;G++){var F=H[G],B=M[F],L=A(F,B);V[F]=L}return V.cancel||(V.cancel=_),V},x=function(M){var V={};switch(M.length){case 1:V[c.CANCEL_KEY]=Object.assign({},_,{visible:!1});break;case 2:V[c.CANCEL_KEY]=A(c.CANCEL_KEY,M[0]),V[c.CONFIRM_KEY]=A(c.CONFIRM_KEY,M[1]);break;default:h.throwErr("Invalid number of 'buttons' in array ("+M.length+`).
      If you want more than 2 buttons, you need to use an object!`)}return V};c.getButtonListOpts=function(M){var V=c.defaultButtonList;return typeof M=="string"?V[c.CONFIRM_KEY]=A(c.CONFIRM_KEY,M):Array.isArray(M)?V=x(M):h.isPlainObject(M)?V=w(M):M===!0?V=x([!0,!0]):M===!1?V=x([!1,!1]):M===void 0&&(V=c.defaultButtonList),V}},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1),f=d(2),_=d(0),v=_.default.MODAL,b=_.default.OVERLAY,A=d(30),w=d(31),x=d(32),M=d(33);c.injectElIntoModal=function(F){var B=h.getNode(v),L=h.stringToNode(F);return B.appendChild(L),L};var V=function(F){F.className=v,F.textContent=""},G=function(F,B){V(F);var L=B.className;L&&F.classList.add(L)};c.initModalContent=function(F){var B=h.getNode(v);G(B,F),A.default(F.icon),w.initTitle(F.title),w.initText(F.text),M.default(F.content),x.default(F.buttons,F.dangerMode)};var H=function(){var F=h.getNode(b),B=h.stringToNode(f.modalMarkup);F.appendChild(B)};c.default=H},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(3),f={isOpen:!1,promise:null,actions:{},timer:null},_=Object.assign({},f);c.resetState=function(){_=Object.assign({},f)},c.setActionValue=function(b){if(typeof b=="string")return v(h.CONFIRM_KEY,b);for(var A in b)v(A,b[A])};var v=function(b,A){_.actions[b]||(_.actions[b]={}),Object.assign(_.actions[b],{value:A})};c.setActionOptionsFor=function(b,A){var w=(A===void 0?{}:A).closeModal,x=w===void 0||w;Object.assign(_.actions[b],{closeModal:x})},c.default=_},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1),f=d(3),_=d(0),v=_.default.OVERLAY,b=_.default.SHOW_MODAL,A=_.default.BUTTON,w=_.default.BUTTON_LOADING,x=d(5);c.openModal=function(){h.getNode(v).classList.add(b),x.default.isOpen=!0};var M=function(){h.getNode(v).classList.remove(b),x.default.isOpen=!1};c.onAction=function(V){V===void 0&&(V=f.CANCEL_KEY);var G=x.default.actions[V],H=G.value;if(G.closeModal===!1){var F=A+"--"+V;h.getNode(F).classList.add(w)}else M();x.default.promise.resolve(H)},c.getState=function(){var V=Object.assign({},x.default);return delete V.promise,delete V.timer,V},c.stopLoading=function(){for(var V=document.querySelectorAll("."+A),G=0;G<V.length;G++)V[G].classList.remove(w)}},function(o,c){var d;d=function(){return this}();try{d=d||Function("return this")()||(0,eval)("this")}catch{typeof window=="object"&&(d=window)}o.exports=d},function(o,c,d){(function(h){o.exports=h.sweetAlert=d(9)}).call(c,d(7))},function(o,c,d){(function(h){o.exports=h.swal=d(10)}).call(c,d(7))},function(o,c,d){typeof window<"u"&&d(11),d(16);var h=d(23).default;o.exports=h},function(o,c,d){var h=d(12);typeof h=="string"&&(h=[[o.i,h,""]]);var f={insertAt:"top"};f.transform=void 0,d(14)(h,f),h.locals&&(o.exports=h.locals)},function(o,c,d){c=o.exports=d(13)(void 0),c.push([o.i,'.swal-icon--error{border-color:#f27474;-webkit-animation:animateErrorIcon .5s;animation:animateErrorIcon .5s}.swal-icon--error__x-mark{position:relative;display:block;-webkit-animation:animateXMark .5s;animation:animateXMark .5s}.swal-icon--error__line{position:absolute;height:5px;width:47px;background-color:#f27474;display:block;top:37px;border-radius:2px}.swal-icon--error__line--left{-webkit-transform:rotate(45deg);transform:rotate(45deg);left:17px}.swal-icon--error__line--right{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:16px}@-webkit-keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@-webkit-keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}@keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}.swal-icon--warning{border-color:#f8bb86;-webkit-animation:pulseWarning .75s infinite alternate;animation:pulseWarning .75s infinite alternate}.swal-icon--warning__body{width:5px;height:47px;top:10px;border-radius:2px;margin-left:-2px}.swal-icon--warning__body,.swal-icon--warning__dot{position:absolute;left:50%;background-color:#f8bb86}.swal-icon--warning__dot{width:7px;height:7px;border-radius:50%;margin-left:-4px;bottom:-11px}@-webkit-keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}@keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}.swal-icon--success{border-color:#a5dc86}.swal-icon--success:after,.swal-icon--success:before{content:"";border-radius:50%;position:absolute;width:60px;height:120px;background:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.swal-icon--success:before{border-radius:120px 0 0 120px;top:-7px;left:-33px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:60px 60px;transform-origin:60px 60px}.swal-icon--success:after{border-radius:0 120px 120px 0;top:-11px;left:30px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:0 60px;transform-origin:0 60px;-webkit-animation:rotatePlaceholder 4.25s ease-in;animation:rotatePlaceholder 4.25s ease-in}.swal-icon--success__ring{width:80px;height:80px;border:4px solid hsla(98,55%,69%,.2);border-radius:50%;box-sizing:content-box;position:absolute;left:-4px;top:-4px;z-index:2}.swal-icon--success__hide-corners{width:5px;height:90px;background-color:#fff;padding:1px;position:absolute;left:28px;top:8px;z-index:1;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.swal-icon--success__line{height:5px;background-color:#a5dc86;display:block;border-radius:2px;position:absolute;z-index:2}.swal-icon--success__line--tip{width:25px;left:14px;top:46px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation:animateSuccessTip .75s;animation:animateSuccessTip .75s}.swal-icon--success__line--long{width:47px;right:8px;top:38px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-animation:animateSuccessLong .75s;animation:animateSuccessLong .75s}@-webkit-keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@-webkit-keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@-webkit-keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}@keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}.swal-icon--info{border-color:#c9dae1}.swal-icon--info:before{width:5px;height:29px;bottom:17px;border-radius:2px;margin-left:-2px}.swal-icon--info:after,.swal-icon--info:before{content:"";position:absolute;left:50%;background-color:#c9dae1}.swal-icon--info:after{width:7px;height:7px;border-radius:50%;margin-left:-3px;top:19px}.swal-icon{width:80px;height:80px;border-width:4px;border-style:solid;border-radius:50%;padding:0;position:relative;box-sizing:content-box;margin:20px auto}.swal-icon:first-child{margin-top:32px}.swal-icon--custom{width:auto;height:auto;max-width:100%;border:none;border-radius:0}.swal-icon img{max-width:100%;max-height:100%}.swal-title{color:rgba(0,0,0,.65);font-weight:600;text-transform:none;position:relative;display:block;padding:13px 16px;font-size:27px;line-height:normal;text-align:center;margin-bottom:0}.swal-title:first-child{margin-top:26px}.swal-title:not(:first-child){padding-bottom:0}.swal-title:not(:last-child){margin-bottom:13px}.swal-text{font-size:16px;position:relative;float:none;line-height:normal;vertical-align:top;text-align:left;display:inline-block;margin:0;padding:0 10px;font-weight:400;color:rgba(0,0,0,.64);max-width:calc(100% - 20px);overflow-wrap:break-word;box-sizing:border-box}.swal-text:first-child{margin-top:45px}.swal-text:last-child{margin-bottom:45px}.swal-footer{text-align:right;padding-top:13px;margin-top:13px;padding:13px 16px;border-radius:inherit;border-top-left-radius:0;border-top-right-radius:0}.swal-button-container{margin:5px;display:inline-block;position:relative}.swal-button{background-color:#7cd1f9;color:#fff;border:none;box-shadow:none;border-radius:5px;font-weight:600;font-size:14px;padding:10px 24px;margin:0;cursor:pointer}.swal-button:not([disabled]):hover{background-color:#78cbf2}.swal-button:active{background-color:#70bce0}.swal-button:focus{outline:none;box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(43,114,165,.29)}.swal-button[disabled]{opacity:.5;cursor:default}.swal-button::-moz-focus-inner{border:0}.swal-button--cancel{color:#555;background-color:#efefef}.swal-button--cancel:not([disabled]):hover{background-color:#e8e8e8}.swal-button--cancel:active{background-color:#d7d7d7}.swal-button--cancel:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(116,136,150,.29)}.swal-button--danger{background-color:#e64942}.swal-button--danger:not([disabled]):hover{background-color:#df4740}.swal-button--danger:active{background-color:#cf423b}.swal-button--danger:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(165,43,43,.29)}.swal-content{padding:0 20px;margin-top:20px;font-size:medium}.swal-content:last-child{margin-bottom:20px}.swal-content__input,.swal-content__textarea{-webkit-appearance:none;background-color:#fff;border:none;font-size:14px;display:block;box-sizing:border-box;width:100%;border:1px solid rgba(0,0,0,.14);padding:10px 13px;border-radius:2px;transition:border-color .2s}.swal-content__input:focus,.swal-content__textarea:focus{outline:none;border-color:#6db8ff}.swal-content__textarea{resize:vertical}.swal-button--loading{color:transparent}.swal-button--loading~.swal-button__loader{opacity:1}.swal-button__loader{position:absolute;height:auto;width:43px;z-index:2;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center;pointer-events:none;opacity:0}.swal-button__loader div{display:inline-block;float:none;vertical-align:baseline;width:9px;height:9px;padding:0;border:none;margin:2px;opacity:.4;border-radius:7px;background-color:hsla(0,0%,100%,.9);transition:background .2s;-webkit-animation:swal-loading-anim 1s infinite;animation:swal-loading-anim 1s infinite}.swal-button__loader div:nth-child(3n+2){-webkit-animation-delay:.15s;animation-delay:.15s}.swal-button__loader div:nth-child(3n+3){-webkit-animation-delay:.3s;animation-delay:.3s}@-webkit-keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}@keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}.swal-overlay{position:fixed;top:0;bottom:0;left:0;right:0;text-align:center;font-size:0;overflow-y:auto;background-color:rgba(0,0,0,.4);z-index:10000;pointer-events:none;opacity:0;transition:opacity .3s}.swal-overlay:before{content:" ";display:inline-block;vertical-align:middle;height:100%}.swal-overlay--show-modal{opacity:1;pointer-events:auto}.swal-overlay--show-modal .swal-modal{opacity:1;pointer-events:auto;box-sizing:border-box;-webkit-animation:showSweetAlert .3s;animation:showSweetAlert .3s;will-change:transform}.swal-modal{width:478px;opacity:0;pointer-events:none;background-color:#fff;text-align:center;border-radius:5px;position:static;margin:20px auto;display:inline-block;vertical-align:middle;-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;z-index:10001;transition:opacity .2s,-webkit-transform .3s;transition:transform .3s,opacity .2s;transition:transform .3s,opacity .2s,-webkit-transform .3s}@media (max-width:500px){.swal-modal{width:calc(100% - 20px)}}@-webkit-keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}',""])},function(o,c){function d(f,_){var v=f[1]||"",b=f[3];if(!b)return v;if(_&&typeof btoa=="function"){var A=h(b);return[v].concat(b.sources.map(function(w){return"/*# sourceURL="+b.sourceRoot+w+" */"})).concat([A]).join(`
`)}return[v].join(`
`)}function h(f){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(f))))+" */"}o.exports=function(f){var _=[];return _.toString=function(){return this.map(function(v){var b=d(v,f);return v[2]?"@media "+v[2]+"{"+b+"}":b}).join("")},_.i=function(v,b){typeof v=="string"&&(v=[[null,v,""]]);for(var A={},w=0;w<this.length;w++){var x=this[w][0];typeof x=="number"&&(A[x]=!0)}for(w=0;w<v.length;w++){var M=v[w];typeof M[0]=="number"&&A[M[0]]||(b&&!M[2]?M[2]=b:b&&(M[2]="("+M[2]+") and ("+b+")"),_.push(M))}},_}},function(o,c,d){function h(ne,fe){for(var oe=0;oe<ne.length;oe++){var ue=ne[oe],Ne=H[ue.id];if(Ne){Ne.refs++;for(var Ee=0;Ee<Ne.parts.length;Ee++)Ne.parts[Ee](ue.parts[Ee]);for(;Ee<ue.parts.length;Ee++)Ne.parts.push(x(ue.parts[Ee],fe))}else{for(var we=[],Ee=0;Ee<ue.parts.length;Ee++)we.push(x(ue.parts[Ee],fe));H[ue.id]={id:ue.id,refs:1,parts:we}}}}function f(ne,fe){for(var oe=[],ue={},Ne=0;Ne<ne.length;Ne++){var Ee=ne[Ne],we=fe.base?Ee[0]+fe.base:Ee[0],Re=Ee[1],Pe=Ee[2],$e=Ee[3],Ce={css:Re,media:Pe,sourceMap:$e};ue[we]?ue[we].parts.push(Ce):oe.push(ue[we]={id:we,parts:[Ce]})}return oe}function _(ne,fe){var oe=B(ne.insertInto);if(!oe)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var ue=ee[ee.length-1];if(ne.insertAt==="top")ue?ue.nextSibling?oe.insertBefore(fe,ue.nextSibling):oe.appendChild(fe):oe.insertBefore(fe,oe.firstChild),ee.push(fe);else{if(ne.insertAt!=="bottom")throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");oe.appendChild(fe)}}function v(ne){if(ne.parentNode===null)return!1;ne.parentNode.removeChild(ne);var fe=ee.indexOf(ne);fe>=0&&ee.splice(fe,1)}function b(ne){var fe=document.createElement("style");return ne.attrs.type="text/css",w(fe,ne.attrs),_(ne,fe),fe}function A(ne){var fe=document.createElement("link");return ne.attrs.type="text/css",ne.attrs.rel="stylesheet",w(fe,ne.attrs),_(ne,fe),fe}function w(ne,fe){Object.keys(fe).forEach(function(oe){ne.setAttribute(oe,fe[oe])})}function x(ne,fe){var oe,ue,Ne,Ee;if(fe.transform&&ne.css){if(!(Ee=fe.transform(ne.css)))return function(){};ne.css=Ee}if(fe.singleton){var we=X++;oe=L||(L=b(fe)),ue=M.bind(null,oe,we,!1),Ne=M.bind(null,oe,we,!0)}else ne.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(oe=A(fe),ue=G.bind(null,oe,fe),Ne=function(){v(oe),oe.href&&URL.revokeObjectURL(oe.href)}):(oe=b(fe),ue=V.bind(null,oe),Ne=function(){v(oe)});return ue(ne),function(Re){if(Re){if(Re.css===ne.css&&Re.media===ne.media&&Re.sourceMap===ne.sourceMap)return;ue(ne=Re)}else Ne()}}function M(ne,fe,oe,ue){var Ne=oe?"":ue.css;if(ne.styleSheet)ne.styleSheet.cssText=ie(fe,Ne);else{var Ee=document.createTextNode(Ne),we=ne.childNodes;we[fe]&&ne.removeChild(we[fe]),we.length?ne.insertBefore(Ee,we[fe]):ne.appendChild(Ee)}}function V(ne,fe){var oe=fe.css,ue=fe.media;if(ue&&ne.setAttribute("media",ue),ne.styleSheet)ne.styleSheet.cssText=oe;else{for(;ne.firstChild;)ne.removeChild(ne.firstChild);ne.appendChild(document.createTextNode(oe))}}function G(ne,fe,oe){var ue=oe.css,Ne=oe.sourceMap,Ee=fe.convertToAbsoluteUrls===void 0&&Ne;(fe.convertToAbsoluteUrls||Ee)&&(ue=ce(ue)),Ne&&(ue+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(Ne))))+" */");var we=new Blob([ue],{type:"text/css"}),Re=ne.href;ne.href=URL.createObjectURL(we),Re&&URL.revokeObjectURL(Re)}var H={},F=function(ne){var fe;return function(){return fe===void 0&&(fe=ne.apply(this,arguments)),fe}}(function(){return window&&document&&document.all&&!window.atob}),B=function(ne){var fe={};return function(oe){return fe[oe]===void 0&&(fe[oe]=ne.call(this,oe)),fe[oe]}}(function(ne){return document.querySelector(ne)}),L=null,X=0,ee=[],ce=d(15);o.exports=function(ne,fe){if(typeof DEBUG<"u"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");fe=fe||{},fe.attrs=typeof fe.attrs=="object"?fe.attrs:{},fe.singleton||(fe.singleton=F()),fe.insertInto||(fe.insertInto="head"),fe.insertAt||(fe.insertAt="bottom");var oe=f(ne,fe);return h(oe,fe),function(ue){for(var Ne=[],Ee=0;Ee<oe.length;Ee++){var we=oe[Ee],Re=H[we.id];Re.refs--,Ne.push(Re)}ue&&h(f(ue,fe),fe);for(var Ee=0;Ee<Ne.length;Ee++){var Re=Ne[Ee];if(Re.refs===0){for(var Pe=0;Pe<Re.parts.length;Pe++)Re.parts[Pe]();delete H[Re.id]}}}};var ie=function(){var ne=[];return function(fe,oe){return ne[fe]=oe,ne.filter(Boolean).join(`
`)}}()},function(o,c){o.exports=function(d){var h=typeof window<"u"&&window.location;if(!h)throw new Error("fixUrls requires window.location");if(!d||typeof d!="string")return d;var f=h.protocol+"//"+h.host,_=f+h.pathname.replace(/\/[^\/]*$/,"/");return d.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(v,b){var A=b.trim().replace(/^"(.*)"$/,function(x,M){return M}).replace(/^'(.*)'$/,function(x,M){return M});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(A))return v;var w;return w=A.indexOf("//")===0?A:A.indexOf("/")===0?f+A:_+A.replace(/^\.\//,""),"url("+JSON.stringify(w)+")"})}},function(o,c,d){var h=d(17);typeof window>"u"||window.Promise||(window.Promise=h),d(21),String.prototype.includes||(String.prototype.includes=function(f,_){return typeof _!="number"&&(_=0),!(_+f.length>this.length)&&this.indexOf(f,_)!==-1}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(f,_){if(this==null)throw new TypeError('"this" is null or not defined');var v=Object(this),b=v.length>>>0;if(b===0)return!1;for(var A=0|_,w=Math.max(A>=0?A:b-Math.abs(A),0);w<b;){if(function(x,M){return x===M||typeof x=="number"&&typeof M=="number"&&isNaN(x)&&isNaN(M)}(v[w],f))return!0;w++}return!1}}),typeof window<"u"&&function(f){f.forEach(function(_){_.hasOwnProperty("remove")||Object.defineProperty(_,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype])},function(o,c,d){(function(h){(function(f){function _(){}function v(F,B){return function(){F.apply(B,arguments)}}function b(F){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof F!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],G(F,this)}function A(F,B){for(;F._state===3;)F=F._value;if(F._state===0)return void F._deferreds.push(B);F._handled=!0,b._immediateFn(function(){var L=F._state===1?B.onFulfilled:B.onRejected;if(L===null)return void(F._state===1?w:x)(B.promise,F._value);var X;try{X=L(F._value)}catch(ee){return void x(B.promise,ee)}w(B.promise,X)})}function w(F,B){try{if(B===F)throw new TypeError("A promise cannot be resolved with itself.");if(B&&(typeof B=="object"||typeof B=="function")){var L=B.then;if(B instanceof b)return F._state=3,F._value=B,void M(F);if(typeof L=="function")return void G(v(L,B),F)}F._state=1,F._value=B,M(F)}catch(X){x(F,X)}}function x(F,B){F._state=2,F._value=B,M(F)}function M(F){F._state===2&&F._deferreds.length===0&&b._immediateFn(function(){F._handled||b._unhandledRejectionFn(F._value)});for(var B=0,L=F._deferreds.length;B<L;B++)A(F,F._deferreds[B]);F._deferreds=null}function V(F,B,L){this.onFulfilled=typeof F=="function"?F:null,this.onRejected=typeof B=="function"?B:null,this.promise=L}function G(F,B){var L=!1;try{F(function(X){L||(L=!0,w(B,X))},function(X){L||(L=!0,x(B,X))})}catch(X){if(L)return;L=!0,x(B,X)}}var H=setTimeout;b.prototype.catch=function(F){return this.then(null,F)},b.prototype.then=function(F,B){var L=new this.constructor(_);return A(this,new V(F,B,L)),L},b.all=function(F){var B=Array.prototype.slice.call(F);return new b(function(L,X){function ee(ne,fe){try{if(fe&&(typeof fe=="object"||typeof fe=="function")){var oe=fe.then;if(typeof oe=="function")return void oe.call(fe,function(ue){ee(ne,ue)},X)}B[ne]=fe,--ce==0&&L(B)}catch(ue){X(ue)}}if(B.length===0)return L([]);for(var ce=B.length,ie=0;ie<B.length;ie++)ee(ie,B[ie])})},b.resolve=function(F){return F&&typeof F=="object"&&F.constructor===b?F:new b(function(B){B(F)})},b.reject=function(F){return new b(function(B,L){L(F)})},b.race=function(F){return new b(function(B,L){for(var X=0,ee=F.length;X<ee;X++)F[X].then(B,L)})},b._immediateFn=typeof h=="function"&&function(F){h(F)}||function(F){H(F,0)},b._unhandledRejectionFn=function(F){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",F)},b._setImmediateFn=function(F){b._immediateFn=F},b._setUnhandledRejectionFn=function(F){b._unhandledRejectionFn=F},o!==void 0&&o.exports?o.exports=b:f.Promise||(f.Promise=b)})(this)}).call(c,d(18).setImmediate)},function(o,c,d){function h(_,v){this._id=_,this._clearFn=v}var f=Function.prototype.apply;c.setTimeout=function(){return new h(f.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new h(f.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(_){_&&_.close()},h.prototype.unref=h.prototype.ref=function(){},h.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(_,v){clearTimeout(_._idleTimeoutId),_._idleTimeout=v},c.unenroll=function(_){clearTimeout(_._idleTimeoutId),_._idleTimeout=-1},c._unrefActive=c.active=function(_){clearTimeout(_._idleTimeoutId);var v=_._idleTimeout;v>=0&&(_._idleTimeoutId=setTimeout(function(){_._onTimeout&&_._onTimeout()},v))},d(19),c.setImmediate=setImmediate,c.clearImmediate=clearImmediate},function(o,c,d){(function(h,f){(function(_,v){function b(L){typeof L!="function"&&(L=new Function(""+L));for(var X=new Array(arguments.length-1),ee=0;ee<X.length;ee++)X[ee]=arguments[ee+1];var ce={callback:L,args:X};return G[V]=ce,M(V),V++}function A(L){delete G[L]}function w(L){var X=L.callback,ee=L.args;switch(ee.length){case 0:X();break;case 1:X(ee[0]);break;case 2:X(ee[0],ee[1]);break;case 3:X(ee[0],ee[1],ee[2]);break;default:X.apply(v,ee)}}function x(L){if(H)setTimeout(x,0,L);else{var X=G[L];if(X){H=!0;try{w(X)}finally{A(L),H=!1}}}}if(!_.setImmediate){var M,V=1,G={},H=!1,F=_.document,B=Object.getPrototypeOf&&Object.getPrototypeOf(_);B=B&&B.setTimeout?B:_,{}.toString.call(_.process)==="[object process]"?function(){M=function(L){f.nextTick(function(){x(L)})}}():function(){if(_.postMessage&&!_.importScripts){var L=!0,X=_.onmessage;return _.onmessage=function(){L=!1},_.postMessage("","*"),_.onmessage=X,L}}()?function(){var L="setImmediate$"+Math.random()+"$",X=function(ee){ee.source===_&&typeof ee.data=="string"&&ee.data.indexOf(L)===0&&x(+ee.data.slice(L.length))};_.addEventListener?_.addEventListener("message",X,!1):_.attachEvent("onmessage",X),M=function(ee){_.postMessage(L+ee,"*")}}():_.MessageChannel?function(){var L=new MessageChannel;L.port1.onmessage=function(X){x(X.data)},M=function(X){L.port2.postMessage(X)}}():F&&"onreadystatechange"in F.createElement("script")?function(){var L=F.documentElement;M=function(X){var ee=F.createElement("script");ee.onreadystatechange=function(){x(X),ee.onreadystatechange=null,L.removeChild(ee),ee=null},L.appendChild(ee)}}():function(){M=function(L){setTimeout(x,0,L)}}(),B.setImmediate=b,B.clearImmediate=A}})(typeof self>"u"?h===void 0?this:h:self)}).call(c,d(7),d(20))},function(o,c){function d(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function f(L){if(x===setTimeout)return setTimeout(L,0);if((x===d||!x)&&setTimeout)return x=setTimeout,setTimeout(L,0);try{return x(L,0)}catch{try{return x.call(null,L,0)}catch{return x.call(this,L,0)}}}function _(L){if(M===clearTimeout)return clearTimeout(L);if((M===h||!M)&&clearTimeout)return M=clearTimeout,clearTimeout(L);try{return M(L)}catch{try{return M.call(null,L)}catch{return M.call(this,L)}}}function v(){F&&G&&(F=!1,G.length?H=G.concat(H):B=-1,H.length&&b())}function b(){if(!F){var L=f(v);F=!0;for(var X=H.length;X;){for(G=H,H=[];++B<X;)G&&G[B].run();B=-1,X=H.length}G=null,F=!1,_(L)}}function A(L,X){this.fun=L,this.array=X}function w(){}var x,M,V=o.exports={};(function(){try{x=typeof setTimeout=="function"?setTimeout:d}catch{x=d}try{M=typeof clearTimeout=="function"?clearTimeout:h}catch{M=h}})();var G,H=[],F=!1,B=-1;V.nextTick=function(L){var X=new Array(arguments.length-1);if(arguments.length>1)for(var ee=1;ee<arguments.length;ee++)X[ee-1]=arguments[ee];H.push(new A(L,X)),H.length!==1||F||f(b)},A.prototype.run=function(){this.fun.apply(null,this.array)},V.title="browser",V.browser=!0,V.env={},V.argv=[],V.version="",V.versions={},V.on=w,V.addListener=w,V.once=w,V.off=w,V.removeListener=w,V.removeAllListeners=w,V.emit=w,V.prependListener=w,V.prependOnceListener=w,V.listeners=function(L){return[]},V.binding=function(L){throw new Error("process.binding is not supported")},V.cwd=function(){return"/"},V.chdir=function(L){throw new Error("process.chdir is not supported")},V.umask=function(){return 0}},function(o,c,d){d(22).polyfill()},function(o,c,d){function h(_,v){if(_==null)throw new TypeError("Cannot convert first argument to object");for(var b=Object(_),A=1;A<arguments.length;A++){var w=arguments[A];if(w!=null)for(var x=Object.keys(Object(w)),M=0,V=x.length;M<V;M++){var G=x[M],H=Object.getOwnPropertyDescriptor(w,G);H!==void 0&&H.enumerable&&(b[G]=w[G])}}return b}function f(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:h})}o.exports={assign:h,polyfill:f}},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(24),f=d(6),_=d(5),v=d(36),b=function(){for(var A=[],w=0;w<arguments.length;w++)A[w]=arguments[w];if(typeof window<"u"){var x=v.getOpts.apply(void 0,A);return new Promise(function(M,V){_.default.promise={resolve:M,reject:V},h.default(x),setTimeout(function(){f.openModal()})})}};b.close=f.onAction,b.getState=f.getState,b.setActionValue=_.setActionValue,b.stopLoading=f.stopLoading,b.setDefaults=v.setDefaults,c.default=b},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1),f=d(0),_=f.default.MODAL,v=d(4),b=d(34),A=d(35),w=d(1);c.init=function(x){h.getNode(_)||(document.body||w.throwErr("You can only use SweetAlert AFTER the DOM has loaded!"),b.default(),v.default()),v.initModalContent(x),A.default(x)},c.default=c.init},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(0),f=h.default.MODAL;c.modalMarkup=`
  <div class="`+f+'" role="dialog" aria-modal="true"></div>',c.default=c.modalMarkup},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(0),f=h.default.OVERLAY,_=`<div 
    class="`+f+`"
    tabIndex="-1">
  </div>`;c.default=_},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(0),f=h.default.ICON;c.errorIconMarkup=function(){var _=f+"--error",v=_+"__line";return`
    <div class="`+_+`__x-mark">
      <span class="`+v+" "+v+`--left"></span>
      <span class="`+v+" "+v+`--right"></span>
    </div>
  `},c.warningIconMarkup=function(){var _=f+"--warning";return`
    <span class="`+_+`__body">
      <span class="`+_+`__dot"></span>
    </span>
  `},c.successIconMarkup=function(){var _=f+"--success";return`
    <span class="`+_+"__line "+_+`__line--long"></span>
    <span class="`+_+"__line "+_+`__line--tip"></span>

    <div class="`+_+`__ring"></div>
    <div class="`+_+`__hide-corners"></div>
  `}},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(0),f=h.default.CONTENT;c.contentMarkup=`
  <div class="`+f+`">

  </div>
`},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(0),f=h.default.BUTTON_CONTAINER,_=h.default.BUTTON,v=h.default.BUTTON_LOADER;c.buttonMarkup=`
  <div class="`+f+`">

    <button
      class="`+_+`"
    ></button>

    <div class="`+v+`">
      <div></div>
      <div></div>
      <div></div>
    </div>

  </div>
`},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(4),f=d(2),_=d(0),v=_.default.ICON,b=_.default.ICON_CUSTOM,A=["error","warning","success","info"],w={error:f.errorIconMarkup(),warning:f.warningIconMarkup(),success:f.successIconMarkup()},x=function(G,H){var F=v+"--"+G;H.classList.add(F);var B=w[G];B&&(H.innerHTML=B)},M=function(G,H){H.classList.add(b);var F=document.createElement("img");F.src=G,H.appendChild(F)},V=function(G){if(G){var H=h.injectElIntoModal(f.iconMarkup);A.includes(G)?x(G,H):M(G,H)}};c.default=V},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(2),f=d(4),_=function(v){navigator.userAgent.includes("AppleWebKit")&&(v.style.display="none",v.offsetHeight,v.style.display="")};c.initTitle=function(v){if(v){var b=f.injectElIntoModal(h.titleMarkup);b.textContent=v,_(b)}},c.initText=function(v){if(v){var b=document.createDocumentFragment();v.split(`
`).forEach(function(w,x,M){b.appendChild(document.createTextNode(w)),x<M.length-1&&b.appendChild(document.createElement("br"))});var A=f.injectElIntoModal(h.textMarkup);A.appendChild(b),_(A)}}},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1),f=d(4),_=d(0),v=_.default.BUTTON,b=_.default.DANGER_BUTTON,A=d(3),w=d(2),x=d(6),M=d(5),V=function(H,F,B){var L=F.text,X=F.value,ee=F.className,ce=F.closeModal,ie=h.stringToNode(w.buttonMarkup),ne=ie.querySelector("."+v),fe=v+"--"+H;ne.classList.add(fe),ee&&(Array.isArray(ee)?ee:ee.split(" ")).filter(function(ue){return ue.length>0}).forEach(function(ue){ne.classList.add(ue)}),B&&H===A.CONFIRM_KEY&&ne.classList.add(b),ne.textContent=L;var oe={};return oe[H]=X,M.setActionValue(oe),M.setActionOptionsFor(H,{closeModal:ce}),ne.addEventListener("click",function(){return x.onAction(H)}),ie},G=function(H,F){var B=f.injectElIntoModal(w.footerMarkup);for(var L in H){var X=H[L],ee=V(L,X,F);X.visible&&B.appendChild(ee)}B.children.length===0&&B.remove()};c.default=G},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(3),f=d(4),_=d(2),v=d(5),b=d(6),A=d(0),w=A.default.CONTENT,x=function(G){G.addEventListener("input",function(H){var F=H.target,B=F.value;v.setActionValue(B)}),G.addEventListener("keyup",function(H){if(H.key==="Enter")return b.onAction(h.CONFIRM_KEY)}),setTimeout(function(){G.focus(),v.setActionValue("")},0)},M=function(G,H,F){var B=document.createElement(H),L=w+"__"+H;B.classList.add(L);for(var X in F){var ee=F[X];B[X]=ee}H==="input"&&x(B),G.appendChild(B)},V=function(G){if(G){var H=f.injectElIntoModal(_.contentMarkup),F=G.element,B=G.attributes;typeof F=="string"?M(H,F,B):H.appendChild(F)}};c.default=V},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1),f=d(2),_=function(){var v=h.stringToNode(f.overlayMarkup);document.body.appendChild(v)};c.default=_},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(5),f=d(6),_=d(1),v=d(3),b=d(0),A=b.default.MODAL,w=b.default.BUTTON,x=b.default.OVERLAY,M=function(ue){ue.preventDefault(),B()},V=function(ue){ue.preventDefault(),L()},G=function(ue){if(h.default.isOpen)switch(ue.key){case"Escape":return f.onAction(v.CANCEL_KEY)}},H=function(ue){if(h.default.isOpen)switch(ue.key){case"Tab":return M(ue)}},F=function(ue){if(h.default.isOpen)return ue.key==="Tab"&&ue.shiftKey?V(ue):void 0},B=function(){var ue=_.getNode(w);ue&&(ue.tabIndex=0,ue.focus())},L=function(){var ue=_.getNode(A),Ne=ue.querySelectorAll("."+w),Ee=Ne.length-1,we=Ne[Ee];we&&we.focus()},X=function(ue){ue[ue.length-1].addEventListener("keydown",H)},ee=function(ue){ue[0].addEventListener("keydown",F)},ce=function(){var ue=_.getNode(A),Ne=ue.querySelectorAll("."+w);Ne.length&&(X(Ne),ee(Ne))},ie=function(ue){if(_.getNode(x)===ue.target)return f.onAction(v.CANCEL_KEY)},ne=function(ue){var Ne=_.getNode(x);Ne.removeEventListener("click",ie),ue&&Ne.addEventListener("click",ie)},fe=function(ue){h.default.timer&&clearTimeout(h.default.timer),ue&&(h.default.timer=window.setTimeout(function(){return f.onAction(v.CANCEL_KEY)},ue))},oe=function(ue){ue.closeOnEsc?document.addEventListener("keyup",G):document.removeEventListener("keyup",G),ue.dangerMode?B():L(),ce(),ne(ue.closeOnClickOutside),fe(ue.timer)};c.default=oe},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1),f=d(3),_=d(37),v=d(38),b={title:null,text:null,icon:null,buttons:f.defaultButtonList,content:null,className:null,closeOnClickOutside:!0,closeOnEsc:!0,dangerMode:!1,timer:null},A=Object.assign({},b);c.setDefaults=function(F){A=Object.assign({},b,F)};var w=function(F){var B=F&&F.button,L=F&&F.buttons;return B!==void 0&&L!==void 0&&h.throwErr("Cannot set both 'button' and 'buttons' options!"),B!==void 0?{confirm:B}:L},x=function(F){return h.ordinalSuffixOf(F+1)},M=function(F,B){h.throwErr(x(B)+" argument ('"+F+"') is invalid")},V=function(F,B){var L=F+1,X=B[L];h.isPlainObject(X)||X===void 0||h.throwErr("Expected "+x(L)+" argument ('"+X+"') to be a plain object")},G=function(F,B){var L=F+1,X=B[L];X!==void 0&&h.throwErr("Unexpected "+x(L)+" argument ("+X+")")},H=function(F,B,L,X){var ee=typeof B,ce=ee==="string",ie=B instanceof Element;if(ce){if(L===0)return{text:B};if(L===1)return{text:B,title:X[0]};if(L===2)return V(L,X),{icon:B};M(B,L)}else{if(ie&&L===0)return V(L,X),{content:B};if(h.isPlainObject(B))return G(L,X),B;M(B,L)}};c.getOpts=function(){for(var F=[],B=0;B<arguments.length;B++)F[B]=arguments[B];var L={};F.forEach(function(ce,ie){var ne=H(0,ce,ie,F);Object.assign(L,ne)});var X=w(L);L.buttons=f.getButtonListOpts(X),delete L.button,L.content=_.getContentOpts(L.content);var ee=Object.assign({},b,A,L);return Object.keys(ee).forEach(function(ce){v.DEPRECATED_OPTS[ce]&&v.logDeprecation(ce)}),ee}},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0});var h=d(1),f={element:"input",attributes:{placeholder:""}};c.getContentOpts=function(_){var v={};return h.isPlainObject(_)?Object.assign(v,_):_ instanceof Element?{element:_}:_==="input"?f:null}},function(o,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.logDeprecation=function(h){var f=c.DEPRECATED_OPTS[h],_=f.onlyRename,v=f.replacement,b=f.subOption,A=f.link,w=_?"renamed":"deprecated",x='SweetAlert warning: "'+h+'" option has been '+w+".";v&&(x+=" Please use"+(b?' "'+b+'" in ':" ")+'"'+v+'" instead.');var M="https://sweetalert.js.org";x+=A?" More details: "+M+A:" More details: "+M+"/guides/#upgrading-from-1x",console.warn(x)},c.DEPRECATED_OPTS={type:{replacement:"icon",link:"/docs/#icon"},imageUrl:{replacement:"icon",link:"/docs/#icon"},customClass:{replacement:"className",onlyRename:!0,link:"/docs/#classname"},imageSize:{},showCancelButton:{replacement:"buttons",link:"/docs/#buttons"},showConfirmButton:{replacement:"button",link:"/docs/#button"},confirmButtonText:{replacement:"button",link:"/docs/#button"},confirmButtonColor:{},cancelButtonText:{replacement:"buttons",link:"/docs/#buttons"},closeOnConfirm:{replacement:"button",subOption:"closeModal",link:"/docs/#button"},closeOnCancel:{replacement:"buttons",subOption:"closeModal",link:"/docs/#buttons"},showLoaderOnConfirm:{replacement:"buttons"},animation:{},inputType:{replacement:"content",link:"/docs/#content"},inputValue:{replacement:"content",link:"/docs/#content"},inputPlaceholder:{replacement:"content",link:"/docs/#content"},html:{replacement:"content",link:"/docs/#content"},allowEscapeKey:{replacement:"closeOnEsc",onlyRename:!0,link:"/docs/#closeonesc"},allowClickOutside:{replacement:"closeOnClickOutside",onlyRename:!0,link:"/docs/#closeonclickoutside"}}}])})})(PK);var Ige=PK.exports;const St=Yg(Ige);class NM{sendOtp(r){return Gn.post("/api/v1/auth/password/forgot",{phone:r})}senOtpRegister(r){return Gn.post("/api/v1/verification/otp/sms/send",{phone:r})}verifyOtpRegister(r,o){return Gn.post("/api/v1/verification/otp/sms/validate",{phone:r,otp:o})}verifyOtp(r,o){return Gn.post("/api/v1/auth/password/reset/validate",{phone:r,otp:o})}changPass(r,o){return Gn.post("/api/v1/auth/password/reset",{token:r,password:o})}change(r){return Gn.post("/api/v1/auth/password/change",r)}}class Age{constructor(){this.error={birthdayRequired:"Ngày sinh không được để trống",birthday:"Tuổi phải lớn hơn 18",cppassword:"Xác nhận mật khẩu phải trùng với mật khẩu",cppasswordRequired:"Xác nhận mật khẩu không được để trống",phone:"Số điện thoại phải gồm 10 số và bắt đầu bằng 09, 03, 07, 08, 05",phoneRequired:"Số điện thoại không được để trống",email:"Email không hợp lệ",emailRequired:"Email không được để trống",password:"Mật khẩu phải chứa ít nhất một chữ hoa, một chữ thường, một số, một ký tự đặc biệt và từ 8-32 ký tự",passwordRequired:"Mật khẩu không được để trống",firstNameRequired:"Họ đệm không được để trống",lastNameRequired:"Tên không được để trống",genderRequired:"Giới tính không được để trống",address:"Địa chỉ không hợp lệ",number:"Số không hợp lệ",date:"Ngày không hợp lệ",time:"Thời gian không hợp lệ",url:"Url không hợp lệ",image:"Ảnh không hợp lệ"}}}class Oge{constructor(){this.regex={phone:/((09|03|07|08|05)+([0-9]{8})\b)/,email:/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/,password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@#$%^&+=])(?=\S+$).{8,32}$/,name:/^[a-zA-Z]{3,}$/,address:/^[a-zA-Z0-9]{3,}$/,number:/^[0-9]{1,}$/,date:/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/,time:/^[0-9]{2}:[0-9]{2}$/,url:/^(http|https):\/\/[^ "]+$/,image:/\.(jpeg|jpg|gif|png)$/}}}var k$={password:"*",cppassword:"*",phone:"*",email:"*",firstName:"*",lastName:"*",birthday:"*",image:"*",gender:"*"};const DK=()=>{const[t,r]=K.useState({phone:"*",password:"*",cppassword:"*",email:"*",firstName:"*",lastName:"*",birthday:"*",image:"*",gender:"*"});let o=new Age,c=new Oge;K.useEffect(()=>{},[t]);const d=new Date;return{handleBlur:({field:f,password:_,cppassword:v,phone:b,email:A,firstName:w,lastName:x,birthday:M,image:V,gender:G})=>{const H={...k$};if(f==="password"&&(_?c.regex.password.test(_)?H.password="*":H.password=o.error.password:H.password=o.error.passwordRequired),f==="phone"&&(b?c.regex.phone.test(b)?H.phone="*":H.phone=o.error.phone:H.phone=o.error.phoneRequired),f==="email"&&(A?c.regex.email.test(A)?H.email="*":H.email=o.error.email:H.email=o.error.emailRequired),f==="firstName"&&(w?H.firstName="*":H.firstName=o.error.firstNameRequired),f==="lastName"&&(x?H.lastName="*":H.lastName=o.error.lastNameRequired),f==="birthday"){const F=new Date(M),B=d.getFullYear()-F.getFullYear();M?B<18?H.birthday=o.error.birthday:H.birthday="*":H.birthday=o.error.birthdayRequired}f==="image"&&(V?H.image="*":H.image=o.error.imageRequired),f==="cppassword"&&(v?v!==_?H.cppassword=o.error.cppassword:H.cppassword="*":H.cppassword=o.error.cppasswordRequired),f==="gender"&&(G?H.gender="*":H.gender=o.error.genderRequired),k$={...H},r({...H})},errors:t}};function Nge(){const[t,r]=K.useState(!0),o=Wd(),[c,d]=K.useState(""),[h,f]=K.useState(""),[_,v]=K.useState(""),{errors:b,handleBlur:A}=DK(),w=()=>(A({field:"phone",phone:c}),A({field:"password",password:h}),b.phone==="*"&&b.password==="*");let x=new xK;const M=ki({mutationKey:["login"],mutationFn:()=>x.login({phone:c,password:h}).then(Ee=>{Ee.data&&(Hn.set("token",Ee.data.accessToken),Hn.set("phone",c),v(Ee.data.accessToken),d(c),V.mutate(),console.log("token",_)),console.log(""+c+h)}).catch(Ee=>{console.error(Ee)}),onError:Ee=>{Ee&&St({title:"Tên đăng nhập hoặc mật khẩu không chính xác",icon:"error"})}}),V=ki({mutationKey:["profilep"],mutationFn:()=>{const Ee=Hn.get("token");console.log("data token",Ee),x.getUser(Ee).then(we=>{we.data&&(Hn.set("profile",JSON.stringify(we.data)),o("/app"))})},onSuccess:Ee=>{Ee&&(console.log(Ee),o("/app"))},onSettled:(Ee,we)=>{Ee&&console.log("data:",Ee),we&&console.error("error:",we)},onError:Ee=>{console.error("Error:",Ee)}}),G=new NM,H=ki({mutationKey:["sendOtpRegister"],mutationFn:()=>{G.senOtpRegister(c).then(Ee=>{Ee.data&&(console.log("data",Ee.data),Ee.data.token&&Hn.set("token",Ee.data.token)),Ee.status===200?(St({title:"Thành công",text:"You have pressed the button!",icon:"success"}),ie(!ce)):St({title:"Error",text:"You have pressed the button!",icon:"error"})})},onSuccess:Ee=>{console.log("data",Ee)},onSettled:(Ee,we)=>{Ee?console.log("done",Ee):St({title:"Số điện thoại đã được đăng ký",text:"You have pressed the button!",icon:"error"}),console.log("error",we)},onError:Ee=>{console.error("err",Ee),St({title:"Error",text:"You have pressed the button!",icon:"error"})}}),F=ki({mutationKey:["verifyOtpRegister"],mutationFn:()=>{G.verifyOtpRegister(c,ne).then(Ee=>{Ee.data&&(console.log("data",Ee.data),Ee.data.accessToken&&Hn.set("token",Ee.data.accessToken)),Ee.status===200?(St({title:"Thành công",text:"You have pressed the button!",icon:"success"}),o("/auth/register/"+c)):St({title:"Error",text:"You have pressed the button!",icon:"error"}),Ee.error&&St({title:"Error",text:"You have pressed the button!",icon:"error"})})},onSuccess:Ee=>{console.log("data",Ee),Ee.token},onSettled:(Ee,we)=>{console.log("done",Ee),we&&St({title:"Error",text:"You have pressed the button!",icon:"error"})},onError:Ee=>{console.error("err",Ee),St({title:"Error",text:"You have pressed the button!",icon:"error"})}}),B=Ee=>{Ee.preventDefault(),w()?w()===!0&&w()&&M.mutate():St({title:"Nhập đúng và đủ thông tin",icon:"error"})},[L,X]=K.useState(!0),ee=()=>{X(!L)},[ce,ie]=K.useState(!0),[ne,fe]=K.useState("");K.useState(!1);const oe=()=>{H.mutate()},ue=()=>{ie(!ce)},Ne=()=>{F.mutate()};return T.jsxs("div",{className:"w-full",children:[T.jsx("div",{className:"absolute inset-0",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1280 654",preserveAspectRatio:"xMinYMin slice",children:[T.jsx("rect",{x:"1",y:"1",width:"1280",height:"654",fill:"#e8f3ff"}),T.jsx("path",{fill:"#e8f3ff",d:"M1181.68 655C1163.95 469.296 1031.95 86.8402 963 1H1279V655H1181.68Z"}),T.jsx("path",{fill:"#e8f3ff",d:"M1.5 142.5C52.5 267 131.5 487 172 653H1.5V142.5Z"}),T.jsx("path",{fill:"#aad6ff",d:"M519.5 1.5H685H964.5C1046 135 1167 469 1180 655.5H767.5C704.5 505.5 604.5 304.5 464 148.5L519.5 1.5Z"}),T.jsx("path",{fill:"#d0e4fc",d:"M1 144V1.5H519.5C456 189 322.5 475.5 220 652.5H171.5C138.5 509 51.5 262.5 1 144Z"})]})}),ce?T.jsxs("div",{className:"relative flex flex-col overflow-hidden",children:[T.jsxs("div",{className:"",children:[T.jsx("h1",{className:"text-center text-6xl text-blue-600 font-semibold p-3 mt-10",children:"Viet Chat"}),T.jsx("h2",{className:"text-center font-normal",children:"Đăng nhập tài khoản Viet chat"}),T.jsx("h2",{className:"text-center font-normal",children:"để kết nối với ứng dụng Viet Chat Web"})]}),T.jsx("div",{className:"w-full pb-6 mx-auto my-5 bg-white shadow-md lg:max-w-[400px]",children:t?T.jsxs(T.Fragment,{children:[T.jsxs("ul",{className:"flex border-b-2 py-3",children:[T.jsx("li",{className:"text-center flex-1 font-medium",children:"ĐĂNG NHẬP"}),T.jsx("span",{className:"font-thin text-slate-300",children:"|"}),T.jsx("li",{className:"text-center flex-1 font-thin",onClick:()=>r(!1),children:"ĐĂNG KÝ"})]}),T.jsxs("div",{className:"mt-2  px-6",children:[T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:Vw,className:"mx-3"}),T.jsxs("select",{className:"text-center mx-3",children:[T.jsx("option",{value:"",children:"+84"}),T.jsx("option",{value:"option1",children:"+1"}),T.jsx("option",{value:"option2",children:"+2"}),T.jsx("option",{value:"option3",children:"+3"})]}),T.jsx("input",{value:c,onBlur:()=>A({field:"phone",phone:c}),onChange:Ee=>d(Ee.target.value),placeholder:"Số điện thoại",className:"px-3"}),T.jsx("p",{style:{color:"red"},children:b.phone})]}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{value:h,type:L?"password":"text",onBlur:()=>A({field:"password",password:h}),onChange:Ee=>f(Ee.target.value),placeholder:"Mật khẩu",className:"mx-3 px-3"}),T.jsx("p",{style:{color:"red"},children:b.password})]}),T.jsx("div",{className:"mt-3",children:T.jsx("a",{className:"text-blue-700 text-sm",onClick:ee,children:L?"Hiện mật khẩu":"Ẩn mật khẩu"})}),T.jsx("div",{className:"mt-6",children:T.jsx("button",{className:"w-full py-2 tracking-wide text-white transition-colors duration-200 transform bg-tblue rounded-md",onClick:Ee=>B(Ee),children:"Đăng nhập với mật khẩu"})}),T.jsx("div",{className:"mt-4"})]}),T.jsx("p",{className:"mt-8 text-xs font-light text-center text-gray-700",children:T.jsx("a",{href:`/auth/forgot-password/${c||null}`,className:"font-medium text-black-100 hover:underline",children:"Quên mật khẩu?"})})]}):T.jsxs(T.Fragment,{children:[T.jsxs("ul",{className:"flex border-b-2 py-3",children:[T.jsx("li",{className:"text-center flex-1 font-thin",onClick:()=>r(!0),children:"ĐĂNG NHẬP"}),T.jsx("span",{className:"font-thin text-slate-300",children:"|"}),T.jsx("li",{className:"text-center flex-1 font-medium",children:"ĐĂNG KÝ"})]}),T.jsxs("div",{className:"mt-2  px-6",children:[T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:Vw,className:"mx-3"}),T.jsxs("select",{className:"text-center mx-3",children:[T.jsx("option",{value:"",children:"+84"}),T.jsx("option",{value:"option1",children:"+1"}),T.jsx("option",{value:"option2",children:"+2"}),T.jsx("option",{value:"option3",children:"+3"})]}),T.jsx("input",{onBlur:()=>A("phone"),value:c,onChange:Ee=>d(Ee.target.value),placeholder:"Số điện thoại",className:"px-3"}),T.jsx("p",{style:{color:"red"},children:b.phone})]}),T.jsx("div",{className:"mt-6",children:T.jsx("button",{className:"w-full py-2 tracking-wide text-white transition-colors duration-200 transform bg-tblue rounded-md",onClick:()=>oe(),children:"Xác nhận số điện thoại"})}),T.jsx("div",{className:"mt-4"})]})]})})]}):T.jsx("div",{className:"relative flex flex-col overflow-hidden",children:T.jsxs("div",{className:"w-full pb-6 mx-auto my-5 mt-40 py-5 bg-white shadow-md lg:max-w-[400px]",children:[T.jsx("p",{className:"text-center my-1 text-sm",children:"Mã kích hoạt đã được gửi đến số điện thoại:"}),T.jsx("p",{className:"text-center text-2xl text-blue-600 font-semibold",children:c}),T.jsx("div",{className:"mx-auto my-5 bg-white shadow-md lg:max-w-[180px]",children:T.jsx("input",{type:"number",min:"0",max:"999999",maxLength:"6",onChange:Ee=>fe(Ee.target.value),className:"text-center appearance-none bg-gray-50 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})}),T.jsx("div",{className:"flex justify-center",children:T.jsx("a",{className:"text-center text-blue-500 underline",children:"Nhận lại mã kích hoạt"})}),T.jsx("div",{className:"flex justify-center mt-5",children:T.jsx("button",{type:"button",className:`text-white  transition-colors duration-200 transform bg-tblue
                        font-medium rounded-lg text-sm py-2.5 text-center mx-1 px-20 mt-15 `,onClick:Ne,children:"Tiếp tục"})}),T.jsx("div",{className:"mt-5 ",children:T.jsx("a",{className:`text-sm p-2 ml-4 from-blue-500 
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br
                       hover:text-white
                        font-medium rounded-lg text-center mx-1`,href:"#",onClick:ue,children:"<< Quay lại"})})]})}),T.jsx("div",{className:"fixed bottom-10 w-full",children:T.jsxs("p",{className:"text-center text-blue-600 text-xs m-12",children:[T.jsx("a",{className:"font-semibold",href:"#",children:"Tiếng Việt"})," ",T.jsx("span",{children:" "}),T.jsx("a",{className:"font-thin",href:"#",children:"English "})]})})]})}var kM={prefix:"far",iconName:"address-book",icon:[512,512,[62138,"contact-book"],"f2b9","M384 48c8.8 0 16 7.2 16 16V448c0 8.8-7.2 16-16 16H96c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16H384zM96 0C60.7 0 32 28.7 32 64V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H96zM240 256a64 64 0 1 0 0-128 64 64 0 1 0 0 128zm-32 32c-44.2 0-80 35.8-80 80c0 8.8 7.2 16 16 16H336c8.8 0 16-7.2 16-16c0-44.2-35.8-80-80-80H208zM512 80c0-8.8-7.2-16-16-16s-16 7.2-16 16v64c0 8.8 7.2 16 16 16s16-7.2 16-16V80zM496 192c-8.8 0-16 7.2-16 16v64c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm16 144c0-8.8-7.2-16-16-16s-16 7.2-16 16v64c0 8.8 7.2 16 16 16s16-7.2 16-16V336z"]},LK={prefix:"far",iconName:"envelope-open",icon:[512,512,[62135],"f2b6","M255.4 48.2c.2-.1 .4-.2 .6-.2s.4 .1 .6 .2L460.6 194c2.1 1.5 3.4 3.9 3.4 6.5v13.6L291.5 355.7c-20.7 17-50.4 17-71.1 0L48 214.1V200.5c0-2.6 1.2-5 3.4-6.5L255.4 48.2zM48 276.2L190 392.8c38.4 31.5 93.7 31.5 132 0L464 276.2V456c0 4.4-3.6 8-8 8H56c-4.4 0-8-3.6-8-8V276.2zM256 0c-10.2 0-20.2 3.2-28.5 9.1L23.5 154.9C8.7 165.4 0 182.4 0 200.5V456c0 30.9 25.1 56 56 56H456c30.9 0 56-25.1 56-56V200.5c0-18.1-8.7-35.1-23.4-45.6L284.5 9.1C276.2 3.2 266.2 0 256 0z"]},kge={prefix:"far",iconName:"comment-dots",icon:[512,512,[128172,62075,"commenting"],"f4ad","M168.2 384.9c-15-5.4-31.7-3.1-44.6 6.4c-8.2 6-22.3 14.8-39.4 22.7c5.6-14.7 9.9-31.3 11.3-49.4c1-12.9-3.3-25.7-11.8-35.5C60.4 302.8 48 272 48 240c0-79.5 83.3-160 208-160s208 80.5 208 160s-83.3 160-208 160c-31.6 0-61.3-5.5-87.8-15.1zM26.3 423.8c-1.6 2.7-3.3 5.4-5.1 8.1l-.3 .5c-1.6 2.3-3.2 4.6-4.8 6.9c-3.5 4.7-7.3 9.3-11.3 13.5c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c5.1 0 10.2-.3 15.3-.8l.7-.1c4.4-.5 8.8-1.1 13.2-1.9c.8-.1 1.6-.3 2.4-.5c17.8-3.5 34.9-9.5 50.1-16.1c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9zM144 272a32 32 0 1 0 0-64 32 32 0 1 0 0 64zm144-32a32 32 0 1 0 -64 0 32 32 0 1 0 64 0zm80 32a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"]},x$={prefix:"far",iconName:"thumbs-up",icon:[512,512,[128077,61575],"f164","M323.8 34.8c-38.2-10.9-78.1 11.2-89 49.4l-5.7 20c-3.7 13-10.4 25-19.5 35l-51.3 56.4c-8.9 9.8-8.2 25 1.6 33.9s25 8.2 33.9-1.6l51.3-56.4c14.1-15.5 24.4-34 30.1-54.1l5.7-20c3.6-12.7 16.9-20.1 29.7-16.5s20.1 16.9 16.5 29.7l-5.7 20c-5.7 19.9-14.7 38.7-26.6 55.5c-5.2 7.3-5.8 16.9-1.7 24.9s12.3 13 21.3 13L448 224c8.8 0 16 7.2 16 16c0 6.8-4.3 12.7-10.4 15c-7.4 2.8-13 9-14.9 16.7s.1 15.8 5.3 21.7c2.5 2.8 4 6.5 4 10.6c0 7.8-5.6 14.3-13 15.7c-8.2 1.6-15.1 7.3-18 15.2s-1.6 16.7 3.6 23.3c2.1 2.7 3.4 6.1 3.4 9.9c0 6.7-4.2 12.6-10.2 14.9c-11.5 4.5-17.7 16.9-14.4 28.8c.4 1.3 .6 2.8 .6 4.3c0 8.8-7.2 16-16 16H286.5c-12.6 0-25-3.7-35.5-10.7l-61.7-41.1c-11-7.4-25.9-4.4-33.3 6.7s-4.4 25.9 6.7 33.3l61.7 41.1c18.4 12.3 40 18.8 62.1 18.8H384c34.7 0 62.9-27.6 64-62c14.6-11.7 24-29.7 24-50c0-4.5-.5-8.8-1.3-13c15.4-11.7 25.3-30.2 25.3-51c0-6.5-1-12.8-2.8-18.7C504.8 273.7 512 257.7 512 240c0-35.3-28.6-64-64-64l-92.3 0c4.7-10.4 8.7-21.2 11.8-32.2l5.7-20c10.9-38.2-11.2-78.1-49.4-89zM32 192c-17.7 0-32 14.3-32 32V448c0 17.7 14.3 32 32 32H96c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32H32z"]};const xge={black:"#000",white:"#fff"},jy=xge,Pge={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Mm=Pge,Dge={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Um=Dge,Lge={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},jm=Lge,Mge={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Fm=Mge,Uge={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Vm=Uge,jge={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Ov=jge,Fge={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Vge=Fge;function jd(t){let r="https://mui.com/production-error/?code="+t;for(let o=1;o<arguments.length;o+=1)r+="&args[]="+encodeURIComponent(arguments[o]);return"Minified MUI error #"+t+"; visit "+r+" for the full message."}const Bge=Object.freeze(Object.defineProperty({__proto__:null,default:jd},Symbol.toStringTag,{value:"Module"})),WR="$$material";function _e(){return _e=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(t[c]=o[c])}return t},_e.apply(this,arguments)}function jt(t,r){if(t==null)return{};var o={},c=Object.keys(t),d,h;for(h=0;h<c.length;h++)d=c[h],!(r.indexOf(d)>=0)&&(o[d]=t[d]);return o}function MK(t){var r=Object.create(null);return function(o){return r[o]===void 0&&(r[o]=t(o)),r[o]}}var Wge=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,$ge=MK(function(t){return Wge.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function Gge(t){if(t.sheet)return t.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===t)return document.styleSheets[r]}function Hge(t){var r=document.createElement("style");return r.setAttribute("data-emotion",t.key),t.nonce!==void 0&&r.setAttribute("nonce",t.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var zge=function(){function t(o){var c=this;this._insertTag=function(d){var h;c.tags.length===0?c.insertionPoint?h=c.insertionPoint.nextSibling:c.prepend?h=c.container.firstChild:h=c.before:h=c.tags[c.tags.length-1].nextSibling,c.container.insertBefore(d,h),c.tags.push(d)},this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var r=t.prototype;return r.hydrate=function(c){c.forEach(this._insertTag)},r.insert=function(c){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Hge(this));var d=this.tags[this.tags.length-1];if(this.isSpeedy){var h=Gge(d);try{h.insertRule(c,h.cssRules.length)}catch{}}else d.appendChild(document.createTextNode(c));this.ctr++},r.flush=function(){this.tags.forEach(function(c){return c.parentNode&&c.parentNode.removeChild(c)}),this.tags=[],this.ctr=0},t}(),Hs="-ms-",Yw="-moz-",or="-webkit-",UK="comm",xM="rule",PM="decl",Kge="@import",jK="@keyframes",Yge="@layer",qge=Math.abs,$R=String.fromCharCode,Xge=Object.assign;function Jge(t,r){return ws(t,0)^45?(((r<<2^ws(t,0))<<2^ws(t,1))<<2^ws(t,2))<<2^ws(t,3):0}function FK(t){return t.trim()}function Qge(t,r){return(t=r.exec(t))?t[0]:t}function ar(t,r,o){return t.replace(r,o)}function RL(t,r){return t.indexOf(r)}function ws(t,r){return t.charCodeAt(r)|0}function Fy(t,r,o){return t.slice(r,o)}function Rl(t){return t.length}function DM(t){return t.length}function kC(t,r){return r.push(t),t}function Zge(t,r){return t.map(r).join("")}var GR=1,Gg=1,VK=0,$o=0,Qi=0,r_="";function HR(t,r,o,c,d,h,f){return{value:t,root:r,parent:o,type:c,props:d,children:h,line:GR,column:Gg,length:f,return:""}}function Nv(t,r){return Xge(HR("",null,null,"",null,null,0),t,{length:-t.length},r)}function e_e(){return Qi}function t_e(){return Qi=$o>0?ws(r_,--$o):0,Gg--,Qi===10&&(Gg=1,GR--),Qi}function ha(){return Qi=$o<VK?ws(r_,$o++):0,Gg++,Qi===10&&(Gg=1,GR++),Qi}function Pl(){return ws(r_,$o)}function aw(){return $o}function m0(t,r){return Fy(r_,t,r)}function Vy(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function BK(t){return GR=Gg=1,VK=Rl(r_=t),$o=0,[]}function WK(t){return r_="",t}function cw(t){return FK(m0($o-1,IL(t===91?t+2:t===40?t+1:t)))}function n_e(t){for(;(Qi=Pl())&&Qi<33;)ha();return Vy(t)>2||Vy(Qi)>3?"":" "}function r_e(t,r){for(;--r&&ha()&&!(Qi<48||Qi>102||Qi>57&&Qi<65||Qi>70&&Qi<97););return m0(t,aw()+(r<6&&Pl()==32&&ha()==32))}function IL(t){for(;ha();)switch(Qi){case t:return $o;case 34:case 39:t!==34&&t!==39&&IL(Qi);break;case 40:t===41&&IL(t);break;case 92:ha();break}return $o}function i_e(t,r){for(;ha()&&t+Qi!==57;)if(t+Qi===84&&Pl()===47)break;return"/*"+m0(r,$o-1)+"*"+$R(t===47?t:ha())}function s_e(t){for(;!Vy(Pl());)ha();return m0(t,$o)}function o_e(t){return WK(lw("",null,null,null,[""],t=BK(t),0,[0],t))}function lw(t,r,o,c,d,h,f,_,v){for(var b=0,A=0,w=f,x=0,M=0,V=0,G=1,H=1,F=1,B=0,L="",X=d,ee=h,ce=c,ie=L;H;)switch(V=B,B=ha()){case 40:if(V!=108&&ws(ie,w-1)==58){RL(ie+=ar(cw(B),"&","&\f"),"&\f")!=-1&&(F=-1);break}case 34:case 39:case 91:ie+=cw(B);break;case 9:case 10:case 13:case 32:ie+=n_e(V);break;case 92:ie+=r_e(aw()-1,7);continue;case 47:switch(Pl()){case 42:case 47:kC(a_e(i_e(ha(),aw()),r,o),v);break;default:ie+="/"}break;case 123*G:_[b++]=Rl(ie)*F;case 125*G:case 59:case 0:switch(B){case 0:case 125:H=0;case 59+A:F==-1&&(ie=ar(ie,/\f/g,"")),M>0&&Rl(ie)-w&&kC(M>32?D$(ie+";",c,o,w-1):D$(ar(ie," ","")+";",c,o,w-2),v);break;case 59:ie+=";";default:if(kC(ce=P$(ie,r,o,b,A,d,_,L,X=[],ee=[],w),h),B===123)if(A===0)lw(ie,r,ce,ce,X,h,w,_,ee);else switch(x===99&&ws(ie,3)===110?100:x){case 100:case 108:case 109:case 115:lw(t,ce,ce,c&&kC(P$(t,ce,ce,0,0,d,_,L,d,X=[],w),ee),d,ee,w,_,c?X:ee);break;default:lw(ie,ce,ce,ce,[""],ee,0,_,ee)}}b=A=M=0,G=F=1,L=ie="",w=f;break;case 58:w=1+Rl(ie),M=V;default:if(G<1){if(B==123)--G;else if(B==125&&G++==0&&t_e()==125)continue}switch(ie+=$R(B),B*G){case 38:F=A>0?1:(ie+="\f",-1);break;case 44:_[b++]=(Rl(ie)-1)*F,F=1;break;case 64:Pl()===45&&(ie+=cw(ha())),x=Pl(),A=w=Rl(L=ie+=s_e(aw())),B++;break;case 45:V===45&&Rl(ie)==2&&(G=0)}}return h}function P$(t,r,o,c,d,h,f,_,v,b,A){for(var w=d-1,x=d===0?h:[""],M=DM(x),V=0,G=0,H=0;V<c;++V)for(var F=0,B=Fy(t,w+1,w=qge(G=f[V])),L=t;F<M;++F)(L=FK(G>0?x[F]+" "+B:ar(B,/&\f/g,x[F])))&&(v[H++]=L);return HR(t,r,o,d===0?xM:_,v,b,A)}function a_e(t,r,o){return HR(t,r,o,UK,$R(e_e()),Fy(t,2,-2),0)}function D$(t,r,o,c){return HR(t,r,o,PM,Fy(t,0,c),Fy(t,c+1,-1),c)}function mg(t,r){for(var o="",c=DM(t),d=0;d<c;d++)o+=r(t[d],d,t,r)||"";return o}function c_e(t,r,o,c){switch(t.type){case Yge:if(t.children.length)break;case Kge:case PM:return t.return=t.return||t.value;case UK:return"";case jK:return t.return=t.value+"{"+mg(t.children,c)+"}";case xM:t.value=t.props.join(",")}return Rl(o=mg(t.children,c))?t.return=t.value+"{"+o+"}":""}function l_e(t){var r=DM(t);return function(o,c,d,h){for(var f="",_=0;_<r;_++)f+=t[_](o,c,d,h)||"";return f}}function d_e(t){return function(r){r.root||(r=r.return)&&t(r)}}var u_e=function(r,o,c){for(var d=0,h=0;d=h,h=Pl(),d===38&&h===12&&(o[c]=1),!Vy(h);)ha();return m0(r,$o)},h_e=function(r,o){var c=-1,d=44;do switch(Vy(d)){case 0:d===38&&Pl()===12&&(o[c]=1),r[c]+=u_e($o-1,o,c);break;case 2:r[c]+=cw(d);break;case 4:if(d===44){r[++c]=Pl()===58?"&\f":"",o[c]=r[c].length;break}default:r[c]+=$R(d)}while(d=ha());return r},p_e=function(r,o){return WK(h_e(BK(r),o))},L$=new WeakMap,f_e=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var o=r.value,c=r.parent,d=r.column===c.column&&r.line===c.line;c.type!=="rule";)if(c=c.parent,!c)return;if(!(r.props.length===1&&o.charCodeAt(0)!==58&&!L$.get(c))&&!d){L$.set(r,!0);for(var h=[],f=p_e(o,h),_=c.props,v=0,b=0;v<f.length;v++)for(var A=0;A<_.length;A++,b++)r.props[b]=h[v]?f[v].replace(/&\f/g,_[A]):_[A]+" "+f[v]}}},m_e=function(r){if(r.type==="decl"){var o=r.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(r.return="",r.value="")}};function $K(t,r){switch(Jge(t,r)){case 5103:return or+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return or+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return or+t+Yw+t+Hs+t+t;case 6828:case 4268:return or+t+Hs+t+t;case 6165:return or+t+Hs+"flex-"+t+t;case 5187:return or+t+ar(t,/(\w+).+(:[^]+)/,or+"box-$1$2"+Hs+"flex-$1$2")+t;case 5443:return or+t+Hs+"flex-item-"+ar(t,/flex-|-self/,"")+t;case 4675:return or+t+Hs+"flex-line-pack"+ar(t,/align-content|flex-|-self/,"")+t;case 5548:return or+t+Hs+ar(t,"shrink","negative")+t;case 5292:return or+t+Hs+ar(t,"basis","preferred-size")+t;case 6060:return or+"box-"+ar(t,"-grow","")+or+t+Hs+ar(t,"grow","positive")+t;case 4554:return or+ar(t,/([^-])(transform)/g,"$1"+or+"$2")+t;case 6187:return ar(ar(ar(t,/(zoom-|grab)/,or+"$1"),/(image-set)/,or+"$1"),t,"")+t;case 5495:case 3959:return ar(t,/(image-set\([^]*)/,or+"$1$`$1");case 4968:return ar(ar(t,/(.+:)(flex-)?(.*)/,or+"box-pack:$3"+Hs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+or+t+t;case 4095:case 3583:case 4068:case 2532:return ar(t,/(.+)-inline(.+)/,or+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Rl(t)-1-r>6)switch(ws(t,r+1)){case 109:if(ws(t,r+4)!==45)break;case 102:return ar(t,/(.+:)(.+)-([^]+)/,"$1"+or+"$2-$3$1"+Yw+(ws(t,r+3)==108?"$3":"$2-$3"))+t;case 115:return~RL(t,"stretch")?$K(ar(t,"stretch","fill-available"),r)+t:t}break;case 4949:if(ws(t,r+1)!==115)break;case 6444:switch(ws(t,Rl(t)-3-(~RL(t,"!important")&&10))){case 107:return ar(t,":",":"+or)+t;case 101:return ar(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+or+(ws(t,14)===45?"inline-":"")+"box$3$1"+or+"$2$3$1"+Hs+"$2box$3")+t}break;case 5936:switch(ws(t,r+11)){case 114:return or+t+Hs+ar(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return or+t+Hs+ar(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return or+t+Hs+ar(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return or+t+Hs+t+t}return t}var g_e=function(r,o,c,d){if(r.length>-1&&!r.return)switch(r.type){case PM:r.return=$K(r.value,r.length);break;case jK:return mg([Nv(r,{value:ar(r.value,"@","@"+or)})],d);case xM:if(r.length)return Zge(r.props,function(h){switch(Qge(h,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return mg([Nv(r,{props:[ar(h,/:(read-\w+)/,":"+Yw+"$1")]})],d);case"::placeholder":return mg([Nv(r,{props:[ar(h,/:(plac\w+)/,":"+or+"input-$1")]}),Nv(r,{props:[ar(h,/:(plac\w+)/,":"+Yw+"$1")]}),Nv(r,{props:[ar(h,/:(plac\w+)/,Hs+"input-$1")]})],d)}return""})}},__e=[g_e],GK=function(r){var o=r.key;if(o==="css"){var c=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(c,function(G){var H=G.getAttribute("data-emotion");H.indexOf(" ")!==-1&&(document.head.appendChild(G),G.setAttribute("data-s",""))})}var d=r.stylisPlugins||__e,h={},f,_=[];f=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(G){for(var H=G.getAttribute("data-emotion").split(" "),F=1;F<H.length;F++)h[H[F]]=!0;_.push(G)});var v,b=[f_e,m_e];{var A,w=[c_e,d_e(function(G){A.insert(G)})],x=l_e(b.concat(d,w)),M=function(H){return mg(o_e(H),x)};v=function(H,F,B,L){A=B,M(H?H+"{"+F.styles+"}":F.styles),L&&(V.inserted[F.name]=!0)}}var V={key:o,sheet:new zge({key:o,container:f,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:h,registered:{},insert:v};return V.sheet.hydrate(_),V},HK={exports:{}},yr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vs=typeof Symbol=="function"&&Symbol.for,LM=vs?Symbol.for("react.element"):60103,MM=vs?Symbol.for("react.portal"):60106,zR=vs?Symbol.for("react.fragment"):60107,KR=vs?Symbol.for("react.strict_mode"):60108,YR=vs?Symbol.for("react.profiler"):60114,qR=vs?Symbol.for("react.provider"):60109,XR=vs?Symbol.for("react.context"):60110,UM=vs?Symbol.for("react.async_mode"):60111,JR=vs?Symbol.for("react.concurrent_mode"):60111,QR=vs?Symbol.for("react.forward_ref"):60112,ZR=vs?Symbol.for("react.suspense"):60113,E_e=vs?Symbol.for("react.suspense_list"):60120,eI=vs?Symbol.for("react.memo"):60115,tI=vs?Symbol.for("react.lazy"):60116,v_e=vs?Symbol.for("react.block"):60121,y_e=vs?Symbol.for("react.fundamental"):60117,S_e=vs?Symbol.for("react.responder"):60118,b_e=vs?Symbol.for("react.scope"):60119;function Ea(t){if(typeof t=="object"&&t!==null){var r=t.$$typeof;switch(r){case LM:switch(t=t.type,t){case UM:case JR:case zR:case YR:case KR:case ZR:return t;default:switch(t=t&&t.$$typeof,t){case XR:case QR:case tI:case eI:case qR:return t;default:return r}}case MM:return r}}}function zK(t){return Ea(t)===JR}yr.AsyncMode=UM;yr.ConcurrentMode=JR;yr.ContextConsumer=XR;yr.ContextProvider=qR;yr.Element=LM;yr.ForwardRef=QR;yr.Fragment=zR;yr.Lazy=tI;yr.Memo=eI;yr.Portal=MM;yr.Profiler=YR;yr.StrictMode=KR;yr.Suspense=ZR;yr.isAsyncMode=function(t){return zK(t)||Ea(t)===UM};yr.isConcurrentMode=zK;yr.isContextConsumer=function(t){return Ea(t)===XR};yr.isContextProvider=function(t){return Ea(t)===qR};yr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===LM};yr.isForwardRef=function(t){return Ea(t)===QR};yr.isFragment=function(t){return Ea(t)===zR};yr.isLazy=function(t){return Ea(t)===tI};yr.isMemo=function(t){return Ea(t)===eI};yr.isPortal=function(t){return Ea(t)===MM};yr.isProfiler=function(t){return Ea(t)===YR};yr.isStrictMode=function(t){return Ea(t)===KR};yr.isSuspense=function(t){return Ea(t)===ZR};yr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===zR||t===JR||t===YR||t===KR||t===ZR||t===E_e||typeof t=="object"&&t!==null&&(t.$$typeof===tI||t.$$typeof===eI||t.$$typeof===qR||t.$$typeof===XR||t.$$typeof===QR||t.$$typeof===y_e||t.$$typeof===S_e||t.$$typeof===b_e||t.$$typeof===v_e)};yr.typeOf=Ea;HK.exports=yr;var T_e=HK.exports,KK=T_e,C_e={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},w_e={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},YK={};YK[KK.ForwardRef]=C_e;YK[KK.Memo]=w_e;var R_e=!0;function I_e(t,r,o){var c="";return o.split(" ").forEach(function(d){t[d]!==void 0?r.push(t[d]+";"):c+=d+" "}),c}var qK=function(r,o,c){var d=r.key+"-"+o.name;(c===!1||R_e===!1)&&r.registered[d]===void 0&&(r.registered[d]=o.styles)},XK=function(r,o,c){qK(r,o,c);var d=r.key+"-"+o.name;if(r.inserted[o.name]===void 0){var h=o;do r.insert(o===h?"."+d:"",h,r.sheet,!0),h=h.next;while(h!==void 0)}};function A_e(t){for(var r=0,o,c=0,d=t.length;d>=4;++c,d-=4)o=t.charCodeAt(c)&255|(t.charCodeAt(++c)&255)<<8|(t.charCodeAt(++c)&255)<<16|(t.charCodeAt(++c)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,r=(o&65535)*1540483477+((o>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(d){case 3:r^=(t.charCodeAt(c+2)&255)<<16;case 2:r^=(t.charCodeAt(c+1)&255)<<8;case 1:r^=t.charCodeAt(c)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var O_e={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},N_e=/[A-Z]|^ms/g,k_e=/_EMO_([^_]+?)_([^]*?)_EMO_/g,JK=function(r){return r.charCodeAt(1)===45},M$=function(r){return r!=null&&typeof r!="boolean"},gP=MK(function(t){return JK(t)?t:t.replace(N_e,"-$&").toLowerCase()}),U$=function(r,o){switch(r){case"animation":case"animationName":if(typeof o=="string")return o.replace(k_e,function(c,d,h){return Il={name:d,styles:h,next:Il},d})}return O_e[r]!==1&&!JK(r)&&typeof o=="number"&&o!==0?o+"px":o};function By(t,r,o){if(o==null)return"";if(o.__emotion_styles!==void 0)return o;switch(typeof o){case"boolean":return"";case"object":{if(o.anim===1)return Il={name:o.name,styles:o.styles,next:Il},o.name;if(o.styles!==void 0){var c=o.next;if(c!==void 0)for(;c!==void 0;)Il={name:c.name,styles:c.styles,next:Il},c=c.next;var d=o.styles+";";return d}return x_e(t,r,o)}case"function":{if(t!==void 0){var h=Il,f=o(t);return Il=h,By(t,r,f)}break}}if(r==null)return o;var _=r[o];return _!==void 0?_:o}function x_e(t,r,o){var c="";if(Array.isArray(o))for(var d=0;d<o.length;d++)c+=By(t,r,o[d])+";";else for(var h in o){var f=o[h];if(typeof f!="object")r!=null&&r[f]!==void 0?c+=h+"{"+r[f]+"}":M$(f)&&(c+=gP(h)+":"+U$(h,f)+";");else if(Array.isArray(f)&&typeof f[0]=="string"&&(r==null||r[f[0]]===void 0))for(var _=0;_<f.length;_++)M$(f[_])&&(c+=gP(h)+":"+U$(h,f[_])+";");else{var v=By(t,r,f);switch(h){case"animation":case"animationName":{c+=gP(h)+":"+v+";";break}default:c+=h+"{"+v+"}"}}}return c}var j$=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Il,jM=function(r,o,c){if(r.length===1&&typeof r[0]=="object"&&r[0]!==null&&r[0].styles!==void 0)return r[0];var d=!0,h="";Il=void 0;var f=r[0];f==null||f.raw===void 0?(d=!1,h+=By(c,o,f)):h+=f[0];for(var _=1;_<r.length;_++)h+=By(c,o,r[_]),d&&(h+=f[_]);j$.lastIndex=0;for(var v="",b;(b=j$.exec(h))!==null;)v+="-"+b[1];var A=A_e(h)+v;return{name:A,styles:h,next:Il}},P_e=function(r){return r()},QK=pw.useInsertionEffect?pw.useInsertionEffect:!1,D_e=QK||P_e,F$=QK||K.useLayoutEffect,ZK=K.createContext(typeof HTMLElement<"u"?GK({key:"css"}):null),L_e=ZK.Provider,eY=function(r){return K.forwardRef(function(o,c){var d=K.useContext(ZK);return r(o,d,c)})},nI=K.createContext({}),_P={exports:{}},V$;function tY(){return V$||(V$=1,function(t){function r(){return t.exports=r=Object.assign?Object.assign.bind():function(o){for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(o[h]=d[h])}return o},t.exports.__esModule=!0,t.exports.default=t.exports,r.apply(this,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(_P)),_P.exports}tY();var M_e=eY(function(t,r){var o=t.styles,c=jM([o],void 0,K.useContext(nI)),d=K.useRef();return F$(function(){var h=r.key+"-global",f=new r.sheet.constructor({key:h,nonce:r.sheet.nonce,container:r.sheet.container,speedy:r.sheet.isSpeedy}),_=!1,v=document.querySelector('style[data-emotion="'+h+" "+c.name+'"]');return r.sheet.tags.length&&(f.before=r.sheet.tags[0]),v!==null&&(_=!0,v.setAttribute("data-emotion",h),f.hydrate([v])),d.current=[f,_],function(){f.flush()}},[r]),F$(function(){var h=d.current,f=h[0],_=h[1];if(_){h[1]=!1;return}if(c.next!==void 0&&XK(r,c.next,!0),f.tags.length){var v=f.tags[f.tags.length-1].nextElementSibling;f.before=v,f.flush()}r.insert("",c,f,!1)},[r,c.name]),null});function qw(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return jM(r)}var i_=function(){var r=qw.apply(void 0,arguments),o="animation-"+r.name;return{name:o,styles:"@keyframes "+o+"{"+r.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},U_e=$ge,j_e=function(r){return r!=="theme"},B$=function(r){return typeof r=="string"&&r.charCodeAt(0)>96?U_e:j_e},W$=function(r,o,c){var d;if(o){var h=o.shouldForwardProp;d=r.__emotion_forwardProp&&h?function(f){return r.__emotion_forwardProp(f)&&h(f)}:h}return typeof d!="function"&&c&&(d=r.__emotion_forwardProp),d},F_e=function(r){var o=r.cache,c=r.serialized,d=r.isStringTag;return qK(o,c,d),D_e(function(){return XK(o,c,d)}),null},V_e=function t(r,o){var c=r.__emotion_real===r,d=c&&r.__emotion_base||r,h,f;o!==void 0&&(h=o.label,f=o.target);var _=W$(r,o,c),v=_||B$(d),b=!v("as");return function(){var A=arguments,w=c&&r.__emotion_styles!==void 0?r.__emotion_styles.slice(0):[];if(h!==void 0&&w.push("label:"+h+";"),A[0]==null||A[0].raw===void 0)w.push.apply(w,A);else{w.push(A[0][0]);for(var x=A.length,M=1;M<x;M++)w.push(A[M],A[0][M])}var V=eY(function(G,H,F){var B=b&&G.as||d,L="",X=[],ee=G;if(G.theme==null){ee={};for(var ce in G)ee[ce]=G[ce];ee.theme=K.useContext(nI)}typeof G.className=="string"?L=I_e(H.registered,X,G.className):G.className!=null&&(L=G.className+" ");var ie=jM(w.concat(X),H.registered,ee);L+=H.key+"-"+ie.name,f!==void 0&&(L+=" "+f);var ne=b&&_===void 0?B$(B):v,fe={};for(var oe in G)b&&oe==="as"||ne(oe)&&(fe[oe]=G[oe]);return fe.className=L,fe.ref=F,K.createElement(K.Fragment,null,K.createElement(F_e,{cache:H,serialized:ie,isStringTag:typeof B=="string"}),K.createElement(B,fe))});return V.displayName=h!==void 0?h:"Styled("+(typeof d=="string"?d:d.displayName||d.name||"Component")+")",V.defaultProps=r.defaultProps,V.__emotion_real=V,V.__emotion_base=d,V.__emotion_styles=w,V.__emotion_forwardProp=_,Object.defineProperty(V,"toString",{value:function(){return"."+f}}),V.withComponent=function(G,H){return t(G,_e({},o,H,{shouldForwardProp:W$(V,H,!0)})).apply(void 0,w)},V}},B_e=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],AL=V_e.bind();B_e.forEach(function(t){AL[t]=AL(t)});let OL;typeof document=="object"&&(OL=GK({key:"css",prepend:!0}));function W_e(t){const{injectFirst:r,children:o}=t;return r&&OL?T.jsx(L_e,{value:OL,children:o}):o}function $_e(t){return t==null||Object.keys(t).length===0}function nY(t){const{styles:r,defaultTheme:o={}}=t,c=typeof r=="function"?d=>r($_e(d)?o:d):r;return T.jsx(M_e,{styles:c})}function G_e(t,r){return AL(t,r)}const H_e=(t,r)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=r(t.__emotion_styles))},z_e=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:nY,StyledEngineProvider:W_e,ThemeContext:nI,css:qw,default:G_e,internal_processStyles:H_e,keyframes:i_},Symbol.toStringTag,{value:"Module"}));function Xu(t){if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function rY(t){if(!Xu(t))return t;const r={};return Object.keys(t).forEach(o=>{r[o]=rY(t[o])}),r}function pa(t,r,o={clone:!0}){const c=o.clone?_e({},t):t;return Xu(t)&&Xu(r)&&Object.keys(r).forEach(d=>{d!=="__proto__"&&(Xu(r[d])&&d in t&&Xu(t[d])?c[d]=pa(t[d],r[d],o):o.clone?c[d]=Xu(r[d])?rY(r[d]):r[d]:c[d]=r[d])}),c}const K_e=Object.freeze(Object.defineProperty({__proto__:null,default:pa,isPlainObject:Xu},Symbol.toStringTag,{value:"Module"})),Y_e=["values","unit","step"],q_e=t=>{const r=Object.keys(t).map(o=>({key:o,val:t[o]}))||[];return r.sort((o,c)=>o.val-c.val),r.reduce((o,c)=>_e({},o,{[c.key]:c.val}),{})};function iY(t){const{values:r={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:o="px",step:c=5}=t,d=jt(t,Y_e),h=q_e(r),f=Object.keys(h);function _(x){return`@media (min-width:${typeof r[x]=="number"?r[x]:x}${o})`}function v(x){return`@media (max-width:${(typeof r[x]=="number"?r[x]:x)-c/100}${o})`}function b(x,M){const V=f.indexOf(M);return`@media (min-width:${typeof r[x]=="number"?r[x]:x}${o}) and (max-width:${(V!==-1&&typeof r[f[V]]=="number"?r[f[V]]:M)-c/100}${o})`}function A(x){return f.indexOf(x)+1<f.length?b(x,f[f.indexOf(x)+1]):_(x)}function w(x){const M=f.indexOf(x);return M===0?_(f[1]):M===f.length-1?v(f[M]):b(x,f[f.indexOf(x)+1]).replace("@media","@media not all and")}return _e({keys:f,values:h,up:_,down:v,between:b,only:A,not:w,unit:o},d)}const X_e={borderRadius:4},J_e=X_e;function sy(t,r){return r?pa(t,r,{clone:!1}):t}const FM={xs:0,sm:600,md:900,lg:1200,xl:1536},$$={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${FM[t]}px)`};function Fd(t,r,o){const c=t.theme||{};if(Array.isArray(r)){const h=c.breakpoints||$$;return r.reduce((f,_,v)=>(f[h.up(h.keys[v])]=o(r[v]),f),{})}if(typeof r=="object"){const h=c.breakpoints||$$;return Object.keys(r).reduce((f,_)=>{if(Object.keys(h.values||FM).indexOf(_)!==-1){const v=h.up(_);f[v]=o(r[_],_)}else{const v=_;f[v]=r[v]}return f},{})}return o(r)}function Q_e(t={}){var r;return((r=t.keys)==null?void 0:r.reduce((c,d)=>{const h=t.up(d);return c[h]={},c},{}))||{}}function Z_e(t,r){return t.reduce((o,c)=>{const d=o[c];return(!d||Object.keys(d).length===0)&&delete o[c],o},r)}function Gt(t){if(typeof t!="string")throw new Error(jd(7));return t.charAt(0).toUpperCase()+t.slice(1)}const eEe=Object.freeze(Object.defineProperty({__proto__:null,default:Gt},Symbol.toStringTag,{value:"Module"}));function rI(t,r,o=!0){if(!r||typeof r!="string")return null;if(t&&t.vars&&o){const c=`vars.${r}`.split(".").reduce((d,h)=>d&&d[h]?d[h]:null,t);if(c!=null)return c}return r.split(".").reduce((c,d)=>c&&c[d]!=null?c[d]:null,t)}function Xw(t,r,o,c=o){let d;return typeof t=="function"?d=t(o):Array.isArray(t)?d=t[o]||c:d=rI(t,o)||c,r&&(d=r(d,c,t)),d}function Vi(t){const{prop:r,cssProperty:o=t.prop,themeKey:c,transform:d}=t,h=f=>{if(f[r]==null)return null;const _=f[r],v=f.theme,b=rI(v,c)||{};return Fd(f,_,w=>{let x=Xw(b,d,w);return w===x&&typeof w=="string"&&(x=Xw(b,d,`${r}${w==="default"?"":Gt(w)}`,w)),o===!1?x:{[o]:x}})};return h.propTypes={},h.filterProps=[r],h}function tEe(t){const r={};return o=>(r[o]===void 0&&(r[o]=t(o)),r[o])}const nEe={m:"margin",p:"padding"},rEe={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},G$={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},iEe=tEe(t=>{if(t.length>2)if(G$[t])t=G$[t];else return[t];const[r,o]=t.split(""),c=nEe[r],d=rEe[o]||"";return Array.isArray(d)?d.map(h=>c+h):[c+d]}),VM=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],BM=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...VM,...BM];function g0(t,r,o,c){var d;const h=(d=rI(t,r,!1))!=null?d:o;return typeof h=="number"?f=>typeof f=="string"?f:h*f:Array.isArray(h)?f=>typeof f=="string"?f:h[f]:typeof h=="function"?h:()=>{}}function sY(t){return g0(t,"spacing",8)}function _0(t,r){if(typeof r=="string"||r==null)return r;const o=Math.abs(r),c=t(o);return r>=0?c:typeof c=="number"?-c:`-${c}`}function sEe(t,r){return o=>t.reduce((c,d)=>(c[d]=_0(r,o),c),{})}function oEe(t,r,o,c){if(r.indexOf(o)===-1)return null;const d=iEe(o),h=sEe(d,c),f=t[o];return Fd(t,f,h)}function oY(t,r){const o=sY(t.theme);return Object.keys(t).map(c=>oEe(t,r,c,o)).reduce(sy,{})}function Ri(t){return oY(t,VM)}Ri.propTypes={};Ri.filterProps=VM;function Ii(t){return oY(t,BM)}Ii.propTypes={};Ii.filterProps=BM;function aEe(t=8){if(t.mui)return t;const r=sY({spacing:t}),o=(...c)=>(c.length===0?[1]:c).map(h=>{const f=r(h);return typeof f=="number"?`${f}px`:f}).join(" ");return o.mui=!0,o}function iI(...t){const r=t.reduce((c,d)=>(d.filterProps.forEach(h=>{c[h]=d}),c),{}),o=c=>Object.keys(c).reduce((d,h)=>r[h]?sy(d,r[h](c)):d,{});return o.propTypes={},o.filterProps=t.reduce((c,d)=>c.concat(d.filterProps),[]),o}function qa(t){return typeof t!="number"?t:`${t}px solid`}function rc(t,r){return Vi({prop:t,themeKey:"borders",transform:r})}const cEe=rc("border",qa),lEe=rc("borderTop",qa),dEe=rc("borderRight",qa),uEe=rc("borderBottom",qa),hEe=rc("borderLeft",qa),pEe=rc("borderColor"),fEe=rc("borderTopColor"),mEe=rc("borderRightColor"),gEe=rc("borderBottomColor"),_Ee=rc("borderLeftColor"),EEe=rc("outline",qa),vEe=rc("outlineColor"),sI=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const r=g0(t.theme,"shape.borderRadius",4),o=c=>({borderRadius:_0(r,c)});return Fd(t,t.borderRadius,o)}return null};sI.propTypes={};sI.filterProps=["borderRadius"];iI(cEe,lEe,dEe,uEe,hEe,pEe,fEe,mEe,gEe,_Ee,sI,EEe,vEe);const oI=t=>{if(t.gap!==void 0&&t.gap!==null){const r=g0(t.theme,"spacing",8),o=c=>({gap:_0(r,c)});return Fd(t,t.gap,o)}return null};oI.propTypes={};oI.filterProps=["gap"];const aI=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const r=g0(t.theme,"spacing",8),o=c=>({columnGap:_0(r,c)});return Fd(t,t.columnGap,o)}return null};aI.propTypes={};aI.filterProps=["columnGap"];const cI=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const r=g0(t.theme,"spacing",8),o=c=>({rowGap:_0(r,c)});return Fd(t,t.rowGap,o)}return null};cI.propTypes={};cI.filterProps=["rowGap"];const yEe=Vi({prop:"gridColumn"}),SEe=Vi({prop:"gridRow"}),bEe=Vi({prop:"gridAutoFlow"}),TEe=Vi({prop:"gridAutoColumns"}),CEe=Vi({prop:"gridAutoRows"}),wEe=Vi({prop:"gridTemplateColumns"}),REe=Vi({prop:"gridTemplateRows"}),IEe=Vi({prop:"gridTemplateAreas"}),AEe=Vi({prop:"gridArea"});iI(oI,aI,cI,yEe,SEe,bEe,TEe,CEe,wEe,REe,IEe,AEe);function gg(t,r){return r==="grey"?r:t}const OEe=Vi({prop:"color",themeKey:"palette",transform:gg}),NEe=Vi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:gg}),kEe=Vi({prop:"backgroundColor",themeKey:"palette",transform:gg});iI(OEe,NEe,kEe);function la(t){return t<=1&&t!==0?`${t*100}%`:t}const xEe=Vi({prop:"width",transform:la}),WM=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const r=o=>{var c,d;const h=((c=t.theme)==null||(c=c.breakpoints)==null||(c=c.values)==null?void 0:c[o])||FM[o];return h?((d=t.theme)==null||(d=d.breakpoints)==null?void 0:d.unit)!=="px"?{maxWidth:`${h}${t.theme.breakpoints.unit}`}:{maxWidth:h}:{maxWidth:la(o)}};return Fd(t,t.maxWidth,r)}return null};WM.filterProps=["maxWidth"];const PEe=Vi({prop:"minWidth",transform:la}),DEe=Vi({prop:"height",transform:la}),LEe=Vi({prop:"maxHeight",transform:la}),MEe=Vi({prop:"minHeight",transform:la});Vi({prop:"size",cssProperty:"width",transform:la});Vi({prop:"size",cssProperty:"height",transform:la});const UEe=Vi({prop:"boxSizing"});iI(xEe,WM,PEe,DEe,LEe,MEe,UEe);const jEe={border:{themeKey:"borders",transform:qa},borderTop:{themeKey:"borders",transform:qa},borderRight:{themeKey:"borders",transform:qa},borderBottom:{themeKey:"borders",transform:qa},borderLeft:{themeKey:"borders",transform:qa},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:qa},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:sI},color:{themeKey:"palette",transform:gg},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:gg},backgroundColor:{themeKey:"palette",transform:gg},p:{style:Ii},pt:{style:Ii},pr:{style:Ii},pb:{style:Ii},pl:{style:Ii},px:{style:Ii},py:{style:Ii},padding:{style:Ii},paddingTop:{style:Ii},paddingRight:{style:Ii},paddingBottom:{style:Ii},paddingLeft:{style:Ii},paddingX:{style:Ii},paddingY:{style:Ii},paddingInline:{style:Ii},paddingInlineStart:{style:Ii},paddingInlineEnd:{style:Ii},paddingBlock:{style:Ii},paddingBlockStart:{style:Ii},paddingBlockEnd:{style:Ii},m:{style:Ri},mt:{style:Ri},mr:{style:Ri},mb:{style:Ri},ml:{style:Ri},mx:{style:Ri},my:{style:Ri},margin:{style:Ri},marginTop:{style:Ri},marginRight:{style:Ri},marginBottom:{style:Ri},marginLeft:{style:Ri},marginX:{style:Ri},marginY:{style:Ri},marginInline:{style:Ri},marginInlineStart:{style:Ri},marginInlineEnd:{style:Ri},marginBlock:{style:Ri},marginBlockStart:{style:Ri},marginBlockEnd:{style:Ri},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:oI},rowGap:{style:cI},columnGap:{style:aI},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:la},maxWidth:{style:WM},minWidth:{transform:la},height:{transform:la},maxHeight:{transform:la},minHeight:{transform:la},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},E0=jEe;function FEe(...t){const r=t.reduce((c,d)=>c.concat(Object.keys(d)),[]),o=new Set(r);return t.every(c=>o.size===Object.keys(c).length)}function VEe(t,r){return typeof t=="function"?t(r):t}function aY(){function t(o,c,d,h){const f={[o]:c,theme:d},_=h[o];if(!_)return{[o]:c};const{cssProperty:v=o,themeKey:b,transform:A,style:w}=_;if(c==null)return null;if(b==="typography"&&c==="inherit")return{[o]:c};const x=rI(d,b)||{};return w?w(f):Fd(f,c,V=>{let G=Xw(x,A,V);return V===G&&typeof V=="string"&&(G=Xw(x,A,`${o}${V==="default"?"":Gt(V)}`,V)),v===!1?G:{[v]:G}})}function r(o){var c;const{sx:d,theme:h={}}=o||{};if(!d)return null;const f=(c=h.unstable_sxConfig)!=null?c:E0;function _(v){let b=v;if(typeof v=="function")b=v(h);else if(typeof v!="object")return v;if(!b)return null;const A=Q_e(h.breakpoints),w=Object.keys(A);let x=A;return Object.keys(b).forEach(M=>{const V=VEe(b[M],h);if(V!=null)if(typeof V=="object")if(f[M])x=sy(x,t(M,V,h,f));else{const G=Fd({theme:h},V,H=>({[M]:H}));FEe(G,V)?x[M]=r({sx:V,theme:h}):x=sy(x,G)}else x=sy(x,t(M,V,h,f))}),Z_e(w,x)}return Array.isArray(d)?d.map(_):_(d)}return r}const lI=aY();lI.filterProps=["sx"];function cY(t,r){const o=this;return o.vars&&typeof o.getColorSchemeSelector=="function"?{[o.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:r}:o.palette.mode===t?r:{}}const BEe=["breakpoints","palette","spacing","shape"];function $M(t={},...r){const{breakpoints:o={},palette:c={},spacing:d,shape:h={}}=t,f=jt(t,BEe),_=iY(o),v=aEe(d);let b=pa({breakpoints:_,direction:"ltr",components:{},palette:_e({mode:"light"},c),spacing:v,shape:_e({},J_e,h)},f);return b.applyStyles=cY,b=r.reduce((A,w)=>pa(A,w),b),b.unstable_sxConfig=_e({},E0,f==null?void 0:f.unstable_sxConfig),b.unstable_sx=function(w){return lI({sx:w,theme:this})},b}const WEe=Object.freeze(Object.defineProperty({__proto__:null,default:$M,private_createBreakpoints:iY,unstable_applyStyles:cY},Symbol.toStringTag,{value:"Module"}));function $Ee(t){return Object.keys(t).length===0}function GEe(t=null){const r=K.useContext(nI);return!r||$Ee(r)?t:r}const HEe=$M();function GM(t=HEe){return GEe(t)}function zEe({styles:t,themeId:r,defaultTheme:o={}}){const c=GM(o),d=typeof t=="function"?t(r&&c[r]||c):t;return T.jsx(nY,{styles:d})}const KEe=["sx"],YEe=t=>{var r,o;const c={systemProps:{},otherProps:{}},d=(r=t==null||(o=t.theme)==null?void 0:o.unstable_sxConfig)!=null?r:E0;return Object.keys(t).forEach(h=>{d[h]?c.systemProps[h]=t[h]:c.otherProps[h]=t[h]}),c};function lY(t){const{sx:r}=t,o=jt(t,KEe),{systemProps:c,otherProps:d}=YEe(o);let h;return Array.isArray(r)?h=[c,...r]:typeof r=="function"?h=(...f)=>{const _=r(...f);return Xu(_)?_e({},c,_):c}:h=_e({},c,r),_e({},d,{sx:h})}const qEe=Object.freeze(Object.defineProperty({__proto__:null,default:lI,extendSxProp:lY,unstable_createStyleFunctionSx:aY,unstable_defaultSxConfig:E0},Symbol.toStringTag,{value:"Module"})),H$=t=>t,XEe=()=>{let t=H$;return{configure(r){t=r},generate(r){return t(r)},reset(){t=H$}}},dY=XEe();function uY(t){var r,o,c="";if(typeof t=="string"||typeof t=="number")c+=t;else if(typeof t=="object")if(Array.isArray(t)){var d=t.length;for(r=0;r<d;r++)t[r]&&(o=uY(t[r]))&&(c&&(c+=" "),c+=o)}else for(o in t)t[o]&&(c&&(c+=" "),c+=o);return c}function Wt(){for(var t,r,o=0,c="",d=arguments.length;o<d;o++)(t=arguments[o])&&(r=uY(t))&&(c&&(c+=" "),c+=r);return c}const JEe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function zn(t,r,o="Mui"){const c=JEe[r];return c?`${o}-${c}`:`${dY.generate(t)}-${r}`}function Vn(t,r,o="Mui"){const c={};return r.forEach(d=>{c[d]=zn(t,d,o)}),c}var hY={exports:{}},Sr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HM=Symbol.for("react.element"),zM=Symbol.for("react.portal"),dI=Symbol.for("react.fragment"),uI=Symbol.for("react.strict_mode"),hI=Symbol.for("react.profiler"),pI=Symbol.for("react.provider"),fI=Symbol.for("react.context"),QEe=Symbol.for("react.server_context"),mI=Symbol.for("react.forward_ref"),gI=Symbol.for("react.suspense"),_I=Symbol.for("react.suspense_list"),EI=Symbol.for("react.memo"),vI=Symbol.for("react.lazy"),ZEe=Symbol.for("react.offscreen"),pY;pY=Symbol.for("react.module.reference");function ic(t){if(typeof t=="object"&&t!==null){var r=t.$$typeof;switch(r){case HM:switch(t=t.type,t){case dI:case hI:case uI:case gI:case _I:return t;default:switch(t=t&&t.$$typeof,t){case QEe:case fI:case mI:case vI:case EI:case pI:return t;default:return r}}case zM:return r}}}Sr.ContextConsumer=fI;Sr.ContextProvider=pI;Sr.Element=HM;Sr.ForwardRef=mI;Sr.Fragment=dI;Sr.Lazy=vI;Sr.Memo=EI;Sr.Portal=zM;Sr.Profiler=hI;Sr.StrictMode=uI;Sr.Suspense=gI;Sr.SuspenseList=_I;Sr.isAsyncMode=function(){return!1};Sr.isConcurrentMode=function(){return!1};Sr.isContextConsumer=function(t){return ic(t)===fI};Sr.isContextProvider=function(t){return ic(t)===pI};Sr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===HM};Sr.isForwardRef=function(t){return ic(t)===mI};Sr.isFragment=function(t){return ic(t)===dI};Sr.isLazy=function(t){return ic(t)===vI};Sr.isMemo=function(t){return ic(t)===EI};Sr.isPortal=function(t){return ic(t)===zM};Sr.isProfiler=function(t){return ic(t)===hI};Sr.isStrictMode=function(t){return ic(t)===uI};Sr.isSuspense=function(t){return ic(t)===gI};Sr.isSuspenseList=function(t){return ic(t)===_I};Sr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===dI||t===hI||t===uI||t===gI||t===_I||t===ZEe||typeof t=="object"&&t!==null&&(t.$$typeof===vI||t.$$typeof===EI||t.$$typeof===pI||t.$$typeof===fI||t.$$typeof===mI||t.$$typeof===pY||t.getModuleId!==void 0)};Sr.typeOf=ic;hY.exports=Sr;var z$=hY.exports;const eve=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function fY(t){const r=`${t}`.match(eve);return r&&r[1]||""}function mY(t,r=""){return t.displayName||t.name||fY(t)||r}function K$(t,r,o){const c=mY(r);return t.displayName||(c!==""?`${o}(${c})`:o)}function tve(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return mY(t,"Component");if(typeof t=="object")switch(t.$$typeof){case z$.ForwardRef:return K$(t,t.render,"ForwardRef");case z$.Memo:return K$(t,t.type,"memo");default:return}}}const nve=Object.freeze(Object.defineProperty({__proto__:null,default:tve,getFunctionName:fY},Symbol.toStringTag,{value:"Module"}));function KM(t,r){const o=_e({},r);return Object.keys(t).forEach(c=>{if(c.toString().match(/^(components|slots)$/))o[c]=_e({},t[c],o[c]);else if(c.toString().match(/^(componentsProps|slotProps)$/)){const d=t[c]||{},h=r[c];o[c]={},!h||!Object.keys(h)?o[c]=d:!d||!Object.keys(d)?o[c]=h:(o[c]=_e({},h),Object.keys(d).forEach(f=>{o[c][f]=KM(d[f],h[f])}))}else o[c]===void 0&&(o[c]=t[c])}),o}function rve(t){const{theme:r,name:o,props:c}=t;return!r||!r.components||!r.components[o]||!r.components[o].defaultProps?c:KM(r.components[o].defaultProps,c)}function ive({props:t,name:r,defaultTheme:o,themeId:c}){let d=GM(o);return c&&(d=d[c]||d),rve({theme:d,name:r,props:t})}const Ml=typeof window<"u"?K.useLayoutEffect:K.useEffect;function gY(t,r=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER){return Math.max(r,Math.min(t,o))}const sve=Object.freeze(Object.defineProperty({__proto__:null,default:gY},Symbol.toStringTag,{value:"Module"}));function ove(t,r=0,o=1){return gY(t,r,o)}function ave(t){t=t.slice(1);const r=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let o=t.match(r);return o&&o[0].length===1&&(o=o.map(c=>c+c)),o?`rgb${o.length===4?"a":""}(${o.map((c,d)=>d<3?parseInt(c,16):Math.round(parseInt(c,16)/255*1e3)/1e3).join(", ")})`:""}function _Y(t){if(t.type)return t;if(t.charAt(0)==="#")return _Y(ave(t));const r=t.indexOf("("),o=t.substring(0,r);if(["rgb","rgba","hsl","hsla","color"].indexOf(o)===-1)throw new Error(jd(9,t));let c=t.substring(r+1,t.length-1),d;if(o==="color"){if(c=c.split(" "),d=c.shift(),c.length===4&&c[3].charAt(0)==="/"&&(c[3]=c[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(d)===-1)throw new Error(jd(10,d))}else c=c.split(",");return c=c.map(h=>parseFloat(h)),{type:o,values:c,colorSpace:d}}function cve(t){const{type:r,colorSpace:o}=t;let{values:c}=t;return r.indexOf("rgb")!==-1?c=c.map((d,h)=>h<3?parseInt(d,10):d):r.indexOf("hsl")!==-1&&(c[1]=`${c[1]}%`,c[2]=`${c[2]}%`),r.indexOf("color")!==-1?c=`${o} ${c.join(" ")}`:c=`${c.join(", ")}`,`${r}(${c})`}function lve(t,r){return t=_Y(t),r=ove(r),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${r}`:t.values[3]=r,cve(t)}function NL(...t){return t.reduce((r,o)=>o==null?r:function(...d){r.apply(this,d),o.apply(this,d)},()=>{})}function YM(t,r=166){let o;function c(...d){const h=()=>{t.apply(this,d)};clearTimeout(o),o=setTimeout(h,r)}return c.clear=()=>{clearTimeout(o)},c}function dve(t,r){return()=>null}function dw(t,r){var o,c;return K.isValidElement(t)&&r.indexOf((o=t.type.muiName)!=null?o:(c=t.type)==null||(c=c._payload)==null||(c=c.value)==null?void 0:c.muiName)!==-1}function Wo(t){return t&&t.ownerDocument||document}function Rh(t){return Wo(t).defaultView||window}function uve(t,r){return()=>null}function Jw(t,r){typeof t=="function"?t(r):t&&(t.current=r)}let Y$=0;function hve(t){const[r,o]=K.useState(t),c=t||r;return K.useEffect(()=>{r==null&&(Y$+=1,o(`mui-${Y$}`))},[r]),c}const q$=pw.useId;function yI(t){if(q$!==void 0){const r=q$();return t??r}return hve(t)}function pve(t,r,o,c,d){return null}function kL({controlled:t,default:r,name:o,state:c="value"}){const{current:d}=K.useRef(t!==void 0),[h,f]=K.useState(r),_=d?t:h,v=K.useCallback(b=>{d||f(b)},[]);return[_,v]}function Pp(t){const r=K.useRef(t);return Ml(()=>{r.current=t}),K.useRef((...o)=>(0,r.current)(...o)).current}function Es(...t){return K.useMemo(()=>t.every(r=>r==null)?null:r=>{t.forEach(o=>{Jw(o,r)})},t)}const X$={};function fve(t,r){const o=K.useRef(X$);return o.current===X$&&(o.current=t(r)),o}const mve=[];function gve(t){K.useEffect(t,mve)}class SI{constructor(){this.currentId=0,this.clear=()=>{this.currentId!==0&&(clearTimeout(this.currentId),this.currentId=0)},this.disposeEffect=()=>this.clear}static create(){return new SI}start(r,o){this.clear(),this.currentId=setTimeout(()=>{this.currentId=0,o()},r)}}function EY(){const t=fve(SI.create).current;return gve(t.disposeEffect),t}let bI=!0,xL=!1;const _ve=new SI,Eve={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function vve(t){const{type:r,tagName:o}=t;return!!(o==="INPUT"&&Eve[r]&&!t.readOnly||o==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function yve(t){t.metaKey||t.altKey||t.ctrlKey||(bI=!0)}function EP(){bI=!1}function Sve(){this.visibilityState==="hidden"&&xL&&(bI=!0)}function bve(t){t.addEventListener("keydown",yve,!0),t.addEventListener("mousedown",EP,!0),t.addEventListener("pointerdown",EP,!0),t.addEventListener("touchstart",EP,!0),t.addEventListener("visibilitychange",Sve,!0)}function Tve(t){const{target:r}=t;try{return r.matches(":focus-visible")}catch{}return bI||vve(r)}function vY(){const t=K.useCallback(d=>{d!=null&&bve(d.ownerDocument)},[]),r=K.useRef(!1);function o(){return r.current?(xL=!0,_ve.start(100,()=>{xL=!1}),r.current=!1,!0):!1}function c(d){return Tve(d)?(r.current=!0,!0):!1}return{isFocusVisibleRef:r,onFocus:c,onBlur:o,ref:t}}function yY(t){const r=t.documentElement.clientWidth;return Math.abs(window.innerWidth-r)}const SY=t=>{const r=K.useRef({});return K.useEffect(()=>{r.current=t}),r.current};function Qn(t,r,o=void 0){const c={};return Object.keys(t).forEach(d=>{c[d]=t[d].reduce((h,f)=>{if(f){const _=r(f);_!==""&&h.push(_),o&&o[f]&&h.push(o[f])}return h},[]).join(" ")}),c}function Cve(t,r){return _e({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},r)}var Bi={},bY={exports:{}};(function(t){function r(o){return o&&o.__esModule?o:{default:o}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(bY);var qM=bY.exports;const wve=Vd(Bge),Rve=Vd(sve);var TY=qM;Object.defineProperty(Bi,"__esModule",{value:!0});var jo=Bi.alpha=IY;Bi.blend=Fve;Bi.colorChannel=void 0;var Ive=Bi.darken=JM;Bi.decomposeColor=tc;Bi.emphasize=jve;var Ave=Bi.getContrastRatio=Dve;Bi.getLuminance=Qw;Bi.hexToRgb=CY;Bi.hslToRgb=RY;var Ove=Bi.lighten=QM;Bi.private_safeAlpha=Lve;Bi.private_safeColorChannel=void 0;Bi.private_safeDarken=Mve;Bi.private_safeEmphasize=AY;Bi.private_safeLighten=Uve;Bi.recomposeColor=s_;Bi.rgbToHex=Pve;var J$=TY(wve),Nve=TY(Rve);function XM(t,r=0,o=1){return(0,Nve.default)(t,r,o)}function CY(t){t=t.slice(1);const r=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let o=t.match(r);return o&&o[0].length===1&&(o=o.map(c=>c+c)),o?`rgb${o.length===4?"a":""}(${o.map((c,d)=>d<3?parseInt(c,16):Math.round(parseInt(c,16)/255*1e3)/1e3).join(", ")})`:""}function kve(t){const r=t.toString(16);return r.length===1?`0${r}`:r}function tc(t){if(t.type)return t;if(t.charAt(0)==="#")return tc(CY(t));const r=t.indexOf("("),o=t.substring(0,r);if(["rgb","rgba","hsl","hsla","color"].indexOf(o)===-1)throw new Error((0,J$.default)(9,t));let c=t.substring(r+1,t.length-1),d;if(o==="color"){if(c=c.split(" "),d=c.shift(),c.length===4&&c[3].charAt(0)==="/"&&(c[3]=c[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(d)===-1)throw new Error((0,J$.default)(10,d))}else c=c.split(",");return c=c.map(h=>parseFloat(h)),{type:o,values:c,colorSpace:d}}const wY=t=>{const r=tc(t);return r.values.slice(0,3).map((o,c)=>r.type.indexOf("hsl")!==-1&&c!==0?`${o}%`:o).join(" ")};Bi.colorChannel=wY;const xve=(t,r)=>{try{return wY(t)}catch{return t}};Bi.private_safeColorChannel=xve;function s_(t){const{type:r,colorSpace:o}=t;let{values:c}=t;return r.indexOf("rgb")!==-1?c=c.map((d,h)=>h<3?parseInt(d,10):d):r.indexOf("hsl")!==-1&&(c[1]=`${c[1]}%`,c[2]=`${c[2]}%`),r.indexOf("color")!==-1?c=`${o} ${c.join(" ")}`:c=`${c.join(", ")}`,`${r}(${c})`}function Pve(t){if(t.indexOf("#")===0)return t;const{values:r}=tc(t);return`#${r.map((o,c)=>kve(c===3?Math.round(255*o):o)).join("")}`}function RY(t){t=tc(t);const{values:r}=t,o=r[0],c=r[1]/100,d=r[2]/100,h=c*Math.min(d,1-d),f=(b,A=(b+o/30)%12)=>d-h*Math.max(Math.min(A-3,9-A,1),-1);let _="rgb";const v=[Math.round(f(0)*255),Math.round(f(8)*255),Math.round(f(4)*255)];return t.type==="hsla"&&(_+="a",v.push(r[3])),s_({type:_,values:v})}function Qw(t){t=tc(t);let r=t.type==="hsl"||t.type==="hsla"?tc(RY(t)).values:t.values;return r=r.map(o=>(t.type!=="color"&&(o/=255),o<=.03928?o/12.92:((o+.055)/1.055)**2.4)),Number((.2126*r[0]+.7152*r[1]+.0722*r[2]).toFixed(3))}function Dve(t,r){const o=Qw(t),c=Qw(r);return(Math.max(o,c)+.05)/(Math.min(o,c)+.05)}function IY(t,r){return t=tc(t),r=XM(r),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${r}`:t.values[3]=r,s_(t)}function Lve(t,r,o){try{return IY(t,r)}catch{return t}}function JM(t,r){if(t=tc(t),r=XM(r),t.type.indexOf("hsl")!==-1)t.values[2]*=1-r;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let o=0;o<3;o+=1)t.values[o]*=1-r;return s_(t)}function Mve(t,r,o){try{return JM(t,r)}catch{return t}}function QM(t,r){if(t=tc(t),r=XM(r),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*r;else if(t.type.indexOf("rgb")!==-1)for(let o=0;o<3;o+=1)t.values[o]+=(255-t.values[o])*r;else if(t.type.indexOf("color")!==-1)for(let o=0;o<3;o+=1)t.values[o]+=(1-t.values[o])*r;return s_(t)}function Uve(t,r,o){try{return QM(t,r)}catch{return t}}function jve(t,r=.15){return Qw(t)>.5?JM(t,r):QM(t,r)}function AY(t,r,o){try{return AY(t,r)}catch{return t}}function Fve(t,r,o,c=1){const d=(v,b)=>Math.round((v**(1/c)*(1-o)+b**(1/c)*o)**c),h=tc(t),f=tc(r),_=[d(h.values[0],f.values[0]),d(h.values[1],f.values[1]),d(h.values[2],f.values[2])];return s_({type:"rgb",values:_})}const Vve=["mode","contrastThreshold","tonalOffset"],Q$={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:jy.white,default:jy.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},vP={text:{primary:jy.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:jy.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Z$(t,r,o,c){const d=c.light||c,h=c.dark||c*1.5;t[r]||(t.hasOwnProperty(o)?t[r]=t[o]:r==="light"?t.light=Ove(t.main,d):r==="dark"&&(t.dark=Ive(t.main,h)))}function Bve(t="light"){return t==="dark"?{main:jm[200],light:jm[50],dark:jm[400]}:{main:jm[700],light:jm[400],dark:jm[800]}}function Wve(t="light"){return t==="dark"?{main:Um[200],light:Um[50],dark:Um[400]}:{main:Um[500],light:Um[300],dark:Um[700]}}function $ve(t="light"){return t==="dark"?{main:Mm[500],light:Mm[300],dark:Mm[700]}:{main:Mm[700],light:Mm[400],dark:Mm[800]}}function Gve(t="light"){return t==="dark"?{main:Fm[400],light:Fm[300],dark:Fm[700]}:{main:Fm[700],light:Fm[500],dark:Fm[900]}}function Hve(t="light"){return t==="dark"?{main:Vm[400],light:Vm[300],dark:Vm[700]}:{main:Vm[800],light:Vm[500],dark:Vm[900]}}function zve(t="light"){return t==="dark"?{main:Ov[400],light:Ov[300],dark:Ov[700]}:{main:"#ed6c02",light:Ov[500],dark:Ov[900]}}function Kve(t){const{mode:r="light",contrastThreshold:o=3,tonalOffset:c=.2}=t,d=jt(t,Vve),h=t.primary||Bve(r),f=t.secondary||Wve(r),_=t.error||$ve(r),v=t.info||Gve(r),b=t.success||Hve(r),A=t.warning||zve(r);function w(G){return Ave(G,vP.text.primary)>=o?vP.text.primary:Q$.text.primary}const x=({color:G,name:H,mainShade:F=500,lightShade:B=300,darkShade:L=700})=>{if(G=_e({},G),!G.main&&G[F]&&(G.main=G[F]),!G.hasOwnProperty("main"))throw new Error(jd(11,H?` (${H})`:"",F));if(typeof G.main!="string")throw new Error(jd(12,H?` (${H})`:"",JSON.stringify(G.main)));return Z$(G,"light",B,c),Z$(G,"dark",L,c),G.contrastText||(G.contrastText=w(G.main)),G},M={dark:vP,light:Q$};return pa(_e({common:_e({},jy),mode:r,primary:x({color:h,name:"primary"}),secondary:x({color:f,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:x({color:_,name:"error"}),warning:x({color:A,name:"warning"}),info:x({color:v,name:"info"}),success:x({color:b,name:"success"}),grey:Vge,contrastThreshold:o,getContrastText:w,augmentColor:x,tonalOffset:c},M[r]),d)}const Yve=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function qve(t){return Math.round(t*1e5)/1e5}const eG={textTransform:"uppercase"},tG='"Roboto", "Helvetica", "Arial", sans-serif';function Xve(t,r){const o=typeof r=="function"?r(t):r,{fontFamily:c=tG,fontSize:d=14,fontWeightLight:h=300,fontWeightRegular:f=400,fontWeightMedium:_=500,fontWeightBold:v=700,htmlFontSize:b=16,allVariants:A,pxToRem:w}=o,x=jt(o,Yve),M=d/14,V=w||(F=>`${F/b*M}rem`),G=(F,B,L,X,ee)=>_e({fontFamily:c,fontWeight:F,fontSize:V(B),lineHeight:L},c===tG?{letterSpacing:`${qve(X/B)}em`}:{},ee,A),H={h1:G(h,96,1.167,-1.5),h2:G(h,60,1.2,-.5),h3:G(f,48,1.167,0),h4:G(f,34,1.235,.25),h5:G(f,24,1.334,0),h6:G(_,20,1.6,.15),subtitle1:G(f,16,1.75,.15),subtitle2:G(_,14,1.57,.1),body1:G(f,16,1.5,.15),body2:G(f,14,1.43,.15),button:G(_,14,1.75,.4,eG),caption:G(f,12,1.66,.4),overline:G(f,12,2.66,1,eG),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return pa(_e({htmlFontSize:b,pxToRem:V,fontFamily:c,fontSize:d,fontWeightLight:h,fontWeightRegular:f,fontWeightMedium:_,fontWeightBold:v},H),x,{clone:!1})}const Jve=.2,Qve=.14,Zve=.12;function li(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Jve})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Qve})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Zve})`].join(",")}const eye=["none",li(0,2,1,-1,0,1,1,0,0,1,3,0),li(0,3,1,-2,0,2,2,0,0,1,5,0),li(0,3,3,-2,0,3,4,0,0,1,8,0),li(0,2,4,-1,0,4,5,0,0,1,10,0),li(0,3,5,-1,0,5,8,0,0,1,14,0),li(0,3,5,-1,0,6,10,0,0,1,18,0),li(0,4,5,-2,0,7,10,1,0,2,16,1),li(0,5,5,-3,0,8,10,1,0,3,14,2),li(0,5,6,-3,0,9,12,1,0,3,16,2),li(0,6,6,-3,0,10,14,1,0,4,18,3),li(0,6,7,-4,0,11,15,1,0,4,20,3),li(0,7,8,-4,0,12,17,2,0,5,22,4),li(0,7,8,-4,0,13,19,2,0,5,24,4),li(0,7,9,-4,0,14,21,2,0,5,26,4),li(0,8,9,-5,0,15,22,2,0,6,28,5),li(0,8,10,-5,0,16,24,2,0,6,30,5),li(0,8,11,-5,0,17,26,2,0,6,32,5),li(0,9,11,-5,0,18,28,2,0,7,34,6),li(0,9,12,-6,0,19,29,2,0,7,36,6),li(0,10,13,-6,0,20,31,3,0,8,38,7),li(0,10,13,-6,0,21,33,3,0,8,40,7),li(0,10,14,-6,0,22,35,3,0,8,42,7),li(0,11,14,-7,0,23,36,3,0,9,44,8),li(0,11,15,-7,0,24,38,3,0,9,46,8)],tye=["duration","easing","delay"],nye={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},rye={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function nG(t){return`${Math.round(t)}ms`}function iye(t){if(!t)return 0;const r=t/36;return Math.round((4+15*r**.25+r/5)*10)}function sye(t){const r=_e({},nye,t.easing),o=_e({},rye,t.duration);return _e({getAutoHeightDuration:iye,create:(d=["all"],h={})=>{const{duration:f=o.standard,easing:_=r.easeInOut,delay:v=0}=h;return jt(h,tye),(Array.isArray(d)?d:[d]).map(b=>`${b} ${typeof f=="string"?f:nG(f)} ${_} ${typeof v=="string"?v:nG(v)}`).join(",")}},t,{easing:r,duration:o})}const oye={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},aye=oye,cye=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function lye(t={},...r){const{mixins:o={},palette:c={},transitions:d={},typography:h={}}=t,f=jt(t,cye);if(t.vars)throw new Error(jd(18));const _=Kve(c),v=$M(t);let b=pa(v,{mixins:Cve(v.breakpoints,o),palette:_,shadows:eye.slice(),typography:Xve(_,h),transitions:sye(d),zIndex:_e({},aye)});return b=pa(b,f),b=r.reduce((A,w)=>pa(A,w),b),b.unstable_sxConfig=_e({},E0,f==null?void 0:f.unstable_sxConfig),b.unstable_sx=function(w){return lI({sx:w,theme:this})},b}function dye(t){return String(t).match(/[\d.\-+]*\s*(.*)/)[1]||""}function uye(t){return parseFloat(t)}const hye=lye(),TI=hye;function CI(){const t=GM(TI);return t[WR]||t}function Zn({props:t,name:r}){return ive({props:t,name:r,defaultTheme:TI,themeId:WR})}var v0={},yP={exports:{}},rG;function pye(){return rG||(rG=1,function(t){function r(o,c){if(o==null)return{};var d={},h=Object.keys(o),f,_;for(_=0;_<h.length;_++)f=h[_],!(c.indexOf(f)>=0)&&(d[f]=o[f]);return d}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(yP)),yP.exports}const fye=Vd(z_e),mye=Vd(K_e),gye=Vd(eEe),_ye=Vd(nve),Eye=Vd(WEe),vye=Vd(qEe);var o_=qM;Object.defineProperty(v0,"__esModule",{value:!0});var yye=v0.default=Pye,OY=v0.shouldForwardProp=uw;v0.systemDefaultTheme=void 0;var Ha=o_(tY()),PL=o_(pye()),iG=Iye(fye),Sye=mye;o_(gye);o_(_ye);var bye=o_(Eye),Tye=o_(vye);const Cye=["ownerState"],wye=["variants"],Rye=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function NY(t){if(typeof WeakMap!="function")return null;var r=new WeakMap,o=new WeakMap;return(NY=function(c){return c?o:r})(t)}function Iye(t,r){if(!r&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var o=NY(r);if(o&&o.has(t))return o.get(t);var c={__proto__:null},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in t)if(h!=="default"&&Object.prototype.hasOwnProperty.call(t,h)){var f=d?Object.getOwnPropertyDescriptor(t,h):null;f&&(f.get||f.set)?Object.defineProperty(c,h,f):c[h]=t[h]}return c.default=t,o&&o.set(t,c),c}function Aye(t){return Object.keys(t).length===0}function Oye(t){return typeof t=="string"&&t.charCodeAt(0)>96}function uw(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Nye=v0.systemDefaultTheme=(0,bye.default)(),kye=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function xC({defaultTheme:t,theme:r,themeId:o}){return Aye(r)?t:r[o]||r}function xye(t){return t?(r,o)=>o[t]:null}function hw(t,r){let{ownerState:o}=r,c=(0,PL.default)(r,Cye);const d=typeof t=="function"?t((0,Ha.default)({ownerState:o},c)):t;if(Array.isArray(d))return d.flatMap(h=>hw(h,(0,Ha.default)({ownerState:o},c)));if(d&&typeof d=="object"&&Array.isArray(d.variants)){const{variants:h=[]}=d;let _=(0,PL.default)(d,wye);return h.forEach(v=>{let b=!0;typeof v.props=="function"?b=v.props((0,Ha.default)({ownerState:o},c,o)):Object.keys(v.props).forEach(A=>{(o==null?void 0:o[A])!==v.props[A]&&c[A]!==v.props[A]&&(b=!1)}),b&&(Array.isArray(_)||(_=[_]),_.push(typeof v.style=="function"?v.style((0,Ha.default)({ownerState:o},c,o)):v.style))}),_}return d}function Pye(t={}){const{themeId:r,defaultTheme:o=Nye,rootShouldForwardProp:c=uw,slotShouldForwardProp:d=uw}=t,h=f=>(0,Tye.default)((0,Ha.default)({},f,{theme:xC((0,Ha.default)({},f,{defaultTheme:o,themeId:r}))}));return h.__mui_systemSx=!0,(f,_={})=>{(0,iG.internal_processStyles)(f,ee=>ee.filter(ce=>!(ce!=null&&ce.__mui_systemSx)));const{name:v,slot:b,skipVariantsResolver:A,skipSx:w,overridesResolver:x=xye(kye(b))}=_,M=(0,PL.default)(_,Rye),V=A!==void 0?A:b&&b!=="Root"&&b!=="root"||!1,G=w||!1;let H,F=uw;b==="Root"||b==="root"?F=c:b?F=d:Oye(f)&&(F=void 0);const B=(0,iG.default)(f,(0,Ha.default)({shouldForwardProp:F,label:H},M)),L=ee=>typeof ee=="function"&&ee.__emotion_real!==ee||(0,Sye.isPlainObject)(ee)?ce=>hw(ee,(0,Ha.default)({},ce,{theme:xC({theme:ce.theme,defaultTheme:o,themeId:r})})):ee,X=(ee,...ce)=>{let ie=L(ee);const ne=ce?ce.map(L):[];v&&x&&ne.push(ue=>{const Ne=xC((0,Ha.default)({},ue,{defaultTheme:o,themeId:r}));if(!Ne.components||!Ne.components[v]||!Ne.components[v].styleOverrides)return null;const Ee=Ne.components[v].styleOverrides,we={};return Object.entries(Ee).forEach(([Re,Pe])=>{we[Re]=hw(Pe,(0,Ha.default)({},ue,{theme:Ne}))}),x(ue,we)}),v&&!V&&ne.push(ue=>{var Ne;const Ee=xC((0,Ha.default)({},ue,{defaultTheme:o,themeId:r})),we=Ee==null||(Ne=Ee.components)==null||(Ne=Ne[v])==null?void 0:Ne.variants;return hw({variants:we},(0,Ha.default)({},ue,{theme:Ee}))}),G||ne.push(h);const fe=ne.length-ce.length;if(Array.isArray(ee)&&fe>0){const ue=new Array(fe).fill("");ie=[...ee,...ue],ie.raw=[...ee.raw,...ue]}const oe=B(ie,...ne);return f.muiName&&(oe.muiName=f.muiName),oe};return B.withConfig&&(X.withConfig=B.withConfig),X}}const Go=t=>OY(t)&&t!=="classes",Dye=OY,Rt=yye({themeId:WR,defaultTheme:TI,rootShouldForwardProp:Go}),sG=t=>{let r;return t<1?r=5.11916*t**2:r=4.5*Math.log(t+1)+2,(r/100).toFixed(2)};function Lye(t){return zn("MuiSvgIcon",t)}Vn("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Mye=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Uye=t=>{const{color:r,fontSize:o,classes:c}=t,d={root:["root",r!=="inherit"&&`color${Gt(r)}`,`fontSize${Gt(o)}`]};return Qn(d,Lye,c)},jye=Rt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.color!=="inherit"&&r[`color${Gt(o.color)}`],r[`fontSize${Gt(o.fontSize)}`]]}})(({theme:t,ownerState:r})=>{var o,c,d,h,f,_,v,b,A,w,x,M,V;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:r.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(o=t.transitions)==null||(c=o.create)==null?void 0:c.call(o,"fill",{duration:(d=t.transitions)==null||(d=d.duration)==null?void 0:d.shorter}),fontSize:{inherit:"inherit",small:((h=t.typography)==null||(f=h.pxToRem)==null?void 0:f.call(h,20))||"1.25rem",medium:((_=t.typography)==null||(v=_.pxToRem)==null?void 0:v.call(_,24))||"1.5rem",large:((b=t.typography)==null||(A=b.pxToRem)==null?void 0:A.call(b,35))||"2.1875rem"}[r.fontSize],color:(w=(x=(t.vars||t).palette)==null||(x=x[r.color])==null?void 0:x.main)!=null?w:{action:(M=(t.vars||t).palette)==null||(M=M.action)==null?void 0:M.active,disabled:(V=(t.vars||t).palette)==null||(V=V.action)==null?void 0:V.disabled,inherit:void 0}[r.color]}}),DL=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiSvgIcon"}),{children:d,className:h,color:f="inherit",component:_="svg",fontSize:v="medium",htmlColor:b,inheritViewBox:A=!1,titleAccess:w,viewBox:x="0 0 24 24"}=c,M=jt(c,Mye),V=K.isValidElement(d)&&d.type==="svg",G=_e({},c,{color:f,component:_,fontSize:v,instanceFontSize:r.fontSize,inheritViewBox:A,viewBox:x,hasSvgAsChild:V}),H={};A||(H.viewBox=x);const F=Uye(G);return T.jsxs(jye,_e({as:_,className:Wt(F.root,h),focusable:"false",color:b,"aria-hidden":w?void 0:!0,role:w?"img":void 0,ref:o},H,M,V&&d.props,{ownerState:G,children:[V?d.props.children:d,w?T.jsx("title",{children:w}):null]}))});DL.muiName="SvgIcon";function wI(t,r){function o(c,d){return T.jsx(DL,_e({"data-testid":`${r}Icon`,ref:d},c,{children:t}))}return o.muiName=DL.muiName,K.memo(K.forwardRef(o))}const Fye={configure:t=>{dY.configure(t)}},Vye=Object.freeze(Object.defineProperty({__proto__:null,capitalize:Gt,createChainedFunction:NL,createSvgIcon:wI,debounce:YM,deprecatedPropType:dve,isMuiElement:dw,ownerDocument:Wo,ownerWindow:Rh,requirePropFactory:uve,setRef:Jw,unstable_ClassNameGenerator:Fye,unstable_useEnhancedEffect:Ml,unstable_useId:yI,unsupportedProp:pve,useControlled:kL,useEventCallback:Pp,useForkRef:Es,useIsFocusVisible:vY},Symbol.toStringTag,{value:"Module"}));var Ir={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZM=Symbol.for("react.element"),eU=Symbol.for("react.portal"),RI=Symbol.for("react.fragment"),II=Symbol.for("react.strict_mode"),AI=Symbol.for("react.profiler"),OI=Symbol.for("react.provider"),NI=Symbol.for("react.context"),Bye=Symbol.for("react.server_context"),kI=Symbol.for("react.forward_ref"),xI=Symbol.for("react.suspense"),PI=Symbol.for("react.suspense_list"),DI=Symbol.for("react.memo"),LI=Symbol.for("react.lazy"),Wye=Symbol.for("react.offscreen"),kY;kY=Symbol.for("react.module.reference");function sc(t){if(typeof t=="object"&&t!==null){var r=t.$$typeof;switch(r){case ZM:switch(t=t.type,t){case RI:case AI:case II:case xI:case PI:return t;default:switch(t=t&&t.$$typeof,t){case Bye:case NI:case kI:case LI:case DI:case OI:return t;default:return r}}case eU:return r}}}Ir.ContextConsumer=NI;Ir.ContextProvider=OI;Ir.Element=ZM;Ir.ForwardRef=kI;Ir.Fragment=RI;Ir.Lazy=LI;Ir.Memo=DI;Ir.Portal=eU;Ir.Profiler=AI;Ir.StrictMode=II;Ir.Suspense=xI;Ir.SuspenseList=PI;Ir.isAsyncMode=function(){return!1};Ir.isConcurrentMode=function(){return!1};Ir.isContextConsumer=function(t){return sc(t)===NI};Ir.isContextProvider=function(t){return sc(t)===OI};Ir.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===ZM};Ir.isForwardRef=function(t){return sc(t)===kI};Ir.isFragment=function(t){return sc(t)===RI};Ir.isLazy=function(t){return sc(t)===LI};Ir.isMemo=function(t){return sc(t)===DI};Ir.isPortal=function(t){return sc(t)===eU};Ir.isProfiler=function(t){return sc(t)===AI};Ir.isStrictMode=function(t){return sc(t)===II};Ir.isSuspense=function(t){return sc(t)===xI};Ir.isSuspenseList=function(t){return sc(t)===PI};Ir.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===RI||t===AI||t===II||t===xI||t===PI||t===Wye||typeof t=="object"&&t!==null&&(t.$$typeof===LI||t.$$typeof===DI||t.$$typeof===OI||t.$$typeof===NI||t.$$typeof===kI||t.$$typeof===kY||t.getModuleId!==void 0)};Ir.typeOf=sc;function LL(t,r){return LL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,d){return c.__proto__=d,c},LL(t,r)}function xY(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,LL(t,r)}const oG={disabled:!1},Zw=gt.createContext(null);var $ye=function(r){return r.scrollTop},$v="unmounted",wp="exited",Rp="entering",Wm="entered",ML="exiting",Gd=function(t){xY(r,t);function r(c,d){var h;h=t.call(this,c,d)||this;var f=d,_=f&&!f.isMounting?c.enter:c.appear,v;return h.appearStatus=null,c.in?_?(v=wp,h.appearStatus=Rp):v=Wm:c.unmountOnExit||c.mountOnEnter?v=$v:v=wp,h.state={status:v},h.nextCallback=null,h}r.getDerivedStateFromProps=function(d,h){var f=d.in;return f&&h.status===$v?{status:wp}:null};var o=r.prototype;return o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(d){var h=null;if(d!==this.props){var f=this.state.status;this.props.in?f!==Rp&&f!==Wm&&(h=Rp):(f===Rp||f===Wm)&&(h=ML)}this.updateStatus(!1,h)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var d=this.props.timeout,h,f,_;return h=f=_=d,d!=null&&typeof d!="number"&&(h=d.exit,f=d.enter,_=d.appear!==void 0?d.appear:f),{exit:h,enter:f,appear:_}},o.updateStatus=function(d,h){if(d===void 0&&(d=!1),h!==null)if(this.cancelNextCallback(),h===Rp){if(this.props.unmountOnExit||this.props.mountOnEnter){var f=this.props.nodeRef?this.props.nodeRef.current:yC.findDOMNode(this);f&&$ye(f)}this.performEnter(d)}else this.performExit();else this.props.unmountOnExit&&this.state.status===wp&&this.setState({status:$v})},o.performEnter=function(d){var h=this,f=this.props.enter,_=this.context?this.context.isMounting:d,v=this.props.nodeRef?[_]:[yC.findDOMNode(this),_],b=v[0],A=v[1],w=this.getTimeouts(),x=_?w.appear:w.enter;if(!d&&!f||oG.disabled){this.safeSetState({status:Wm},function(){h.props.onEntered(b)});return}this.props.onEnter(b,A),this.safeSetState({status:Rp},function(){h.props.onEntering(b,A),h.onTransitionEnd(x,function(){h.safeSetState({status:Wm},function(){h.props.onEntered(b,A)})})})},o.performExit=function(){var d=this,h=this.props.exit,f=this.getTimeouts(),_=this.props.nodeRef?void 0:yC.findDOMNode(this);if(!h||oG.disabled){this.safeSetState({status:wp},function(){d.props.onExited(_)});return}this.props.onExit(_),this.safeSetState({status:ML},function(){d.props.onExiting(_),d.onTransitionEnd(f.exit,function(){d.safeSetState({status:wp},function(){d.props.onExited(_)})})})},o.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(d,h){h=this.setNextCallback(h),this.setState(d,h)},o.setNextCallback=function(d){var h=this,f=!0;return this.nextCallback=function(_){f&&(f=!1,h.nextCallback=null,d(_))},this.nextCallback.cancel=function(){f=!1},this.nextCallback},o.onTransitionEnd=function(d,h){this.setNextCallback(h);var f=this.props.nodeRef?this.props.nodeRef.current:yC.findDOMNode(this),_=d==null&&!this.props.addEndListener;if(!f||_){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var v=this.props.nodeRef?[this.nextCallback]:[f,this.nextCallback],b=v[0],A=v[1];this.props.addEndListener(b,A)}d!=null&&setTimeout(this.nextCallback,d)},o.render=function(){var d=this.state.status;if(d===$v)return null;var h=this.props,f=h.children;h.in,h.mountOnEnter,h.unmountOnExit,h.appear,h.enter,h.exit,h.timeout,h.addEndListener,h.onEnter,h.onEntering,h.onEntered,h.onExit,h.onExiting,h.onExited,h.nodeRef;var _=jt(h,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return gt.createElement(Zw.Provider,{value:null},typeof f=="function"?f(d,_):gt.cloneElement(gt.Children.only(f),_))},r}(gt.Component);Gd.contextType=Zw;Gd.propTypes={};function Bm(){}Gd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Bm,onEntering:Bm,onEntered:Bm,onExit:Bm,onExiting:Bm,onExited:Bm};Gd.UNMOUNTED=$v;Gd.EXITED=wp;Gd.ENTERING=Rp;Gd.ENTERED=Wm;Gd.EXITING=ML;const PY=Gd;function Gye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tU(t,r){var o=function(h){return r&&K.isValidElement(h)?r(h):h},c=Object.create(null);return t&&K.Children.map(t,function(d){return d}).forEach(function(d){c[d.key]=o(d)}),c}function Hye(t,r){t=t||{},r=r||{};function o(A){return A in r?r[A]:t[A]}var c=Object.create(null),d=[];for(var h in t)h in r?d.length&&(c[h]=d,d=[]):d.push(h);var f,_={};for(var v in r){if(c[v])for(f=0;f<c[v].length;f++){var b=c[v][f];_[c[v][f]]=o(b)}_[v]=o(v)}for(f=0;f<d.length;f++)_[d[f]]=o(d[f]);return _}function Dp(t,r,o){return o[r]!=null?o[r]:t.props[r]}function zye(t,r){return tU(t.children,function(o){return K.cloneElement(o,{onExited:r.bind(null,o),in:!0,appear:Dp(o,"appear",t),enter:Dp(o,"enter",t),exit:Dp(o,"exit",t)})})}function Kye(t,r,o){var c=tU(t.children),d=Hye(r,c);return Object.keys(d).forEach(function(h){var f=d[h];if(K.isValidElement(f)){var _=h in r,v=h in c,b=r[h],A=K.isValidElement(b)&&!b.props.in;v&&(!_||A)?d[h]=K.cloneElement(f,{onExited:o.bind(null,f),in:!0,exit:Dp(f,"exit",t),enter:Dp(f,"enter",t)}):!v&&_&&!A?d[h]=K.cloneElement(f,{in:!1}):v&&_&&K.isValidElement(b)&&(d[h]=K.cloneElement(f,{onExited:o.bind(null,f),in:b.props.in,exit:Dp(f,"exit",t),enter:Dp(f,"enter",t)}))}}),d}var Yye=Object.values||function(t){return Object.keys(t).map(function(r){return t[r]})},qye={component:"div",childFactory:function(r){return r}},nU=function(t){xY(r,t);function r(c,d){var h;h=t.call(this,c,d)||this;var f=h.handleExited.bind(Gye(h));return h.state={contextValue:{isMounting:!0},handleExited:f,firstRender:!0},h}var o=r.prototype;return o.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},o.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(d,h){var f=h.children,_=h.handleExited,v=h.firstRender;return{children:v?zye(d,_):Kye(d,f,_),firstRender:!1}},o.handleExited=function(d,h){var f=tU(this.props.children);d.key in f||(d.props.onExited&&d.props.onExited(h),this.mounted&&this.setState(function(_){var v=_e({},_.children);return delete v[d.key],{children:v}}))},o.render=function(){var d=this.props,h=d.component,f=d.childFactory,_=jt(d,["component","childFactory"]),v=this.state.contextValue,b=Yye(this.state.children).map(f);return delete _.appear,delete _.enter,delete _.exit,h===null?gt.createElement(Zw.Provider,{value:v},b):gt.createElement(Zw.Provider,{value:v},gt.createElement(h,_,b))},r}(gt.Component);nU.propTypes={};nU.defaultProps=qye;const Xye=nU,DY=t=>t.scrollTop;function eR(t,r){var o,c;const{timeout:d,easing:h,style:f={}}=t;return{duration:(o=f.transitionDuration)!=null?o:typeof d=="number"?d:d[r.mode]||0,easing:(c=f.transitionTimingFunction)!=null?c:typeof h=="object"?h[r.mode]:h,delay:f.transitionDelay}}function Jye(t){return zn("MuiPaper",t)}Vn("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Qye=["className","component","elevation","square","variant"],Zye=t=>{const{square:r,elevation:o,variant:c,classes:d}=t,h={root:["root",c,!r&&"rounded",c==="elevation"&&`elevation${o}`]};return Qn(h,Jye,d)},e0e=Rt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,r[o.variant],!o.square&&r.rounded,o.variant==="elevation"&&r[`elevation${o.elevation}`]]}})(({theme:t,ownerState:r})=>{var o;return _e({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!r.square&&{borderRadius:t.shape.borderRadius},r.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},r.variant==="elevation"&&_e({boxShadow:(t.vars||t).shadows[r.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${jo("#fff",sG(r.elevation))}, ${jo("#fff",sG(r.elevation))})`},t.vars&&{backgroundImage:(o=t.vars.overlays)==null?void 0:o[r.elevation]}))}),t0e=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiPaper"}),{className:d,component:h="div",elevation:f=1,square:_=!1,variant:v="elevation"}=c,b=jt(c,Qye),A=_e({},c,{component:h,elevation:f,square:_,variant:v}),w=Zye(A);return T.jsx(e0e,_e({as:h,ownerState:A,className:Wt(w.root,d),ref:o},b))}),rU=t0e;function tR(t){return typeof t=="string"}function LY(t,r,o){return t===void 0||tR(t)?r:_e({},r,{ownerState:_e({},r.ownerState,o)})}function MY(t,r=[]){if(t===void 0)return{};const o={};return Object.keys(t).filter(c=>c.match(/^on[A-Z]/)&&typeof t[c]=="function"&&!r.includes(c)).forEach(c=>{o[c]=t[c]}),o}function UY(t,r,o){return typeof t=="function"?t(r,o):t}function aG(t){if(t===void 0)return{};const r={};return Object.keys(t).filter(o=>!(o.match(/^on[A-Z]/)&&typeof t[o]=="function")).forEach(o=>{r[o]=t[o]}),r}function jY(t){const{getSlotProps:r,additionalProps:o,externalSlotProps:c,externalForwardedProps:d,className:h}=t;if(!r){const M=Wt(o==null?void 0:o.className,h,d==null?void 0:d.className,c==null?void 0:c.className),V=_e({},o==null?void 0:o.style,d==null?void 0:d.style,c==null?void 0:c.style),G=_e({},o,d,c);return M.length>0&&(G.className=M),Object.keys(V).length>0&&(G.style=V),{props:G,internalRef:void 0}}const f=MY(_e({},d,c)),_=aG(c),v=aG(d),b=r(f),A=Wt(b==null?void 0:b.className,o==null?void 0:o.className,h,d==null?void 0:d.className,c==null?void 0:c.className),w=_e({},b==null?void 0:b.style,o==null?void 0:o.style,d==null?void 0:d.style,c==null?void 0:c.style),x=_e({},b,o,v,_);return A.length>0&&(x.className=A),Object.keys(w).length>0&&(x.style=w),{props:x,internalRef:b.ref}}const n0e=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Ih(t){var r;const{elementType:o,externalSlotProps:c,ownerState:d,skipResolvingSlotProps:h=!1}=t,f=jt(t,n0e),_=h?{}:UY(c,d),{props:v,internalRef:b}=jY(_e({},f,{externalSlotProps:_})),A=Es(b,_==null?void 0:_.ref,(r=t.additionalProps)==null?void 0:r.ref);return LY(o,_e({},v,{ref:A}),d)}const r0e=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],i0e=["component","slots","slotProps"],s0e=["component"];function o0e(t,r){const{className:o,elementType:c,ownerState:d,externalForwardedProps:h,getSlotOwnerState:f,internalForwardedProps:_}=r,v=jt(r,r0e),{component:b,slots:A={[t]:void 0},slotProps:w={[t]:void 0}}=h,x=jt(h,i0e),M=A[t]||c,V=UY(w[t],d),G=jY(_e({className:o},v,{externalForwardedProps:t==="root"?x:void 0,externalSlotProps:V})),{props:{component:H},internalRef:F}=G,B=jt(G.props,s0e),L=Es(F,V==null?void 0:V.ref,r.ref),X=f?f(B):{},ee=_e({},d,X),ce=t==="root"?H||b:H,ie=LY(M,_e({},t==="root"&&!b&&!A[t]&&_,t!=="root"&&!A[t]&&_,B,ce&&{as:ce},{ref:L}),ee);return Object.keys(X).forEach(ne=>{delete ie[ne]}),[M,ie]}function a0e(t){const{className:r,classes:o,pulsate:c=!1,rippleX:d,rippleY:h,rippleSize:f,in:_,onExited:v,timeout:b}=t,[A,w]=K.useState(!1),x=Wt(r,o.ripple,o.rippleVisible,c&&o.ripplePulsate),M={width:f,height:f,top:-(f/2)+h,left:-(f/2)+d},V=Wt(o.child,A&&o.childLeaving,c&&o.childPulsate);return!_&&!A&&w(!0),K.useEffect(()=>{if(!_&&v!=null){const G=setTimeout(v,b);return()=>{clearTimeout(G)}}},[v,_,b]),T.jsx("span",{className:x,style:M,children:T.jsx("span",{className:V})})}const za=Vn("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),c0e=["center","classes","className"];let MI=t=>t,cG,lG,dG,uG;const UL=550,l0e=80,d0e=i_(cG||(cG=MI`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),u0e=i_(lG||(lG=MI`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),h0e=i_(dG||(dG=MI`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),p0e=Rt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),f0e=Rt(a0e,{name:"MuiTouchRipple",slot:"Ripple"})(uG||(uG=MI`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),za.rippleVisible,d0e,UL,({theme:t})=>t.transitions.easing.easeInOut,za.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,za.child,za.childLeaving,u0e,UL,({theme:t})=>t.transitions.easing.easeInOut,za.childPulsate,h0e,({theme:t})=>t.transitions.easing.easeInOut),m0e=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiTouchRipple"}),{center:d=!1,classes:h={},className:f}=c,_=jt(c,c0e),[v,b]=K.useState([]),A=K.useRef(0),w=K.useRef(null);K.useEffect(()=>{w.current&&(w.current(),w.current=null)},[v]);const x=K.useRef(!1),M=EY(),V=K.useRef(null),G=K.useRef(null),H=K.useCallback(X=>{const{pulsate:ee,rippleX:ce,rippleY:ie,rippleSize:ne,cb:fe}=X;b(oe=>[...oe,T.jsx(f0e,{classes:{ripple:Wt(h.ripple,za.ripple),rippleVisible:Wt(h.rippleVisible,za.rippleVisible),ripplePulsate:Wt(h.ripplePulsate,za.ripplePulsate),child:Wt(h.child,za.child),childLeaving:Wt(h.childLeaving,za.childLeaving),childPulsate:Wt(h.childPulsate,za.childPulsate)},timeout:UL,pulsate:ee,rippleX:ce,rippleY:ie,rippleSize:ne},A.current)]),A.current+=1,w.current=fe},[h]),F=K.useCallback((X={},ee={},ce=()=>{})=>{const{pulsate:ie=!1,center:ne=d||ee.pulsate,fakeElement:fe=!1}=ee;if((X==null?void 0:X.type)==="mousedown"&&x.current){x.current=!1;return}(X==null?void 0:X.type)==="touchstart"&&(x.current=!0);const oe=fe?null:G.current,ue=oe?oe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ne,Ee,we;if(ne||X===void 0||X.clientX===0&&X.clientY===0||!X.clientX&&!X.touches)Ne=Math.round(ue.width/2),Ee=Math.round(ue.height/2);else{const{clientX:Re,clientY:Pe}=X.touches&&X.touches.length>0?X.touches[0]:X;Ne=Math.round(Re-ue.left),Ee=Math.round(Pe-ue.top)}if(ne)we=Math.sqrt((2*ue.width**2+ue.height**2)/3),we%2===0&&(we+=1);else{const Re=Math.max(Math.abs((oe?oe.clientWidth:0)-Ne),Ne)*2+2,Pe=Math.max(Math.abs((oe?oe.clientHeight:0)-Ee),Ee)*2+2;we=Math.sqrt(Re**2+Pe**2)}X!=null&&X.touches?V.current===null&&(V.current=()=>{H({pulsate:ie,rippleX:Ne,rippleY:Ee,rippleSize:we,cb:ce})},M.start(l0e,()=>{V.current&&(V.current(),V.current=null)})):H({pulsate:ie,rippleX:Ne,rippleY:Ee,rippleSize:we,cb:ce})},[d,H,M]),B=K.useCallback(()=>{F({},{pulsate:!0})},[F]),L=K.useCallback((X,ee)=>{if(M.clear(),(X==null?void 0:X.type)==="touchend"&&V.current){V.current(),V.current=null,M.start(0,()=>{L(X,ee)});return}V.current=null,b(ce=>ce.length>0?ce.slice(1):ce),w.current=ee},[M]);return K.useImperativeHandle(o,()=>({pulsate:B,start:F,stop:L}),[B,F,L]),T.jsx(p0e,_e({className:Wt(za.root,h.root,f),ref:G},_,{children:T.jsx(Xye,{component:null,exit:!0,children:v})}))}),g0e=m0e;function _0e(t){return zn("MuiButtonBase",t)}const E0e=Vn("MuiButtonBase",["root","disabled","focusVisible"]),v0e=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],y0e=t=>{const{disabled:r,focusVisible:o,focusVisibleClassName:c,classes:d}=t,f=Qn({root:["root",r&&"disabled",o&&"focusVisible"]},_0e,d);return o&&c&&(f.root+=` ${c}`),f},S0e=Rt("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,r)=>r.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${E0e.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),b0e=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiButtonBase"}),{action:d,centerRipple:h=!1,children:f,className:_,component:v="button",disabled:b=!1,disableRipple:A=!1,disableTouchRipple:w=!1,focusRipple:x=!1,LinkComponent:M="a",onBlur:V,onClick:G,onContextMenu:H,onDragLeave:F,onFocus:B,onFocusVisible:L,onKeyDown:X,onKeyUp:ee,onMouseDown:ce,onMouseLeave:ie,onMouseUp:ne,onTouchEnd:fe,onTouchMove:oe,onTouchStart:ue,tabIndex:Ne=0,TouchRippleProps:Ee,touchRippleRef:we,type:Re}=c,Pe=jt(c,v0e),$e=K.useRef(null),Ce=K.useRef(null),Fe=Es(Ce,we),{isFocusVisibleRef:Ye,onFocus:Mt,onBlur:yt,ref:Xt}=vY(),[Ue,Be]=K.useState(!1);b&&Ue&&Be(!1),K.useImperativeHandle(d,()=>({focusVisible:()=>{Be(!0),$e.current.focus()}}),[]);const[at,Jt]=K.useState(!1);K.useEffect(()=>{Jt(!0)},[]);const un=at&&!A&&!b;K.useEffect(()=>{Ue&&x&&!A&&at&&Ce.current.pulsate()},[A,x,Ue,at]);function Ut(It,ot,tn=w){return Pp($i=>(ot&&ot($i),!tn&&Ce.current&&Ce.current[It]($i),!0))}const Gr=Ut("start",ce),sn=Ut("stop",H),hn=Ut("stop",F),Ht=Ut("stop",ne),on=Ut("stop",It=>{Ue&&It.preventDefault(),ie&&ie(It)}),rt=Ut("start",ue),_n=Ut("stop",fe),Kn=Ut("stop",oe),En=Ut("stop",It=>{yt(It),Ye.current===!1&&Be(!1),V&&V(It)},!1),fi=Pp(It=>{$e.current||($e.current=It.currentTarget),Mt(It),Ye.current===!0&&(Be(!0),L&&L(It)),B&&B(It)}),fr=()=>{const It=$e.current;return v&&v!=="button"&&!(It.tagName==="A"&&It.href)},Ft=K.useRef(!1),mr=Pp(It=>{x&&!Ft.current&&Ue&&Ce.current&&It.key===" "&&(Ft.current=!0,Ce.current.stop(It,()=>{Ce.current.start(It)})),It.target===It.currentTarget&&fr()&&It.key===" "&&It.preventDefault(),X&&X(It),It.target===It.currentTarget&&fr()&&It.key==="Enter"&&!b&&(It.preventDefault(),G&&G(It))}),Hr=Pp(It=>{x&&It.key===" "&&Ce.current&&Ue&&!It.defaultPrevented&&(Ft.current=!1,Ce.current.stop(It,()=>{Ce.current.pulsate(It)})),ee&&ee(It),G&&It.target===It.currentTarget&&fr()&&It.key===" "&&!It.defaultPrevented&&G(It)});let Mn=v;Mn==="button"&&(Pe.href||Pe.to)&&(Mn=M);const Wi={};Mn==="button"?(Wi.type=Re===void 0?"button":Re,Wi.disabled=b):(!Pe.href&&!Pe.to&&(Wi.role="button"),b&&(Wi["aria-disabled"]=b));const lr=Es(o,Xt,$e),Yn=_e({},c,{centerRipple:h,component:v,disabled:b,disableRipple:A,disableTouchRipple:w,focusRipple:x,tabIndex:Ne,focusVisible:Ue}),an=y0e(Yn);return T.jsxs(S0e,_e({as:Mn,className:Wt(an.root,_),ownerState:Yn,onBlur:En,onClick:G,onContextMenu:sn,onFocus:fi,onKeyDown:mr,onKeyUp:Hr,onMouseDown:Gr,onMouseLeave:on,onMouseUp:Ht,onDragLeave:hn,onTouchEnd:_n,onTouchMove:Kn,onTouchStart:rt,ref:lr,tabIndex:b?-1:Ne,type:Re},Wi,Pe,{children:[f,un?T.jsx(g0e,_e({ref:Fe,center:h},Ee)):null]}))}),iU=b0e;function T0e(t){const{badgeContent:r,invisible:o=!1,max:c=99,showZero:d=!1}=t,h=SY({badgeContent:r,max:c});let f=o;o===!1&&r===0&&!d&&(f=!0);const{badgeContent:_,max:v=c}=f?h:t,b=_&&Number(_)>v?`${v}+`:_;return{badgeContent:_,invisible:f,max:v,displayValue:b}}const C0e=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function w0e(t){const r=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(r)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:r}function R0e(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const r=c=>t.ownerDocument.querySelector(`input[type="radio"]${c}`);let o=r(`[name="${t.name}"]:checked`);return o||(o=r(`[name="${t.name}"]`)),o!==t}function I0e(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||R0e(t))}function A0e(t){const r=[],o=[];return Array.from(t.querySelectorAll(C0e)).forEach((c,d)=>{const h=w0e(c);h===-1||!I0e(c)||(h===0?r.push(c):o.push({documentOrder:d,tabIndex:h,node:c}))}),o.sort((c,d)=>c.tabIndex===d.tabIndex?c.documentOrder-d.documentOrder:c.tabIndex-d.tabIndex).map(c=>c.node).concat(r)}function O0e(){return!0}function N0e(t){const{children:r,disableAutoFocus:o=!1,disableEnforceFocus:c=!1,disableRestoreFocus:d=!1,getTabbable:h=A0e,isEnabled:f=O0e,open:_}=t,v=K.useRef(!1),b=K.useRef(null),A=K.useRef(null),w=K.useRef(null),x=K.useRef(null),M=K.useRef(!1),V=K.useRef(null),G=Es(r.ref,V),H=K.useRef(null);K.useEffect(()=>{!_||!V.current||(M.current=!o)},[o,_]),K.useEffect(()=>{if(!_||!V.current)return;const L=Wo(V.current);return V.current.contains(L.activeElement)||(V.current.hasAttribute("tabIndex")||V.current.setAttribute("tabIndex","-1"),M.current&&V.current.focus()),()=>{d||(w.current&&w.current.focus&&(v.current=!0,w.current.focus()),w.current=null)}},[_]),K.useEffect(()=>{if(!_||!V.current)return;const L=Wo(V.current),X=ie=>{H.current=ie,!(c||!f()||ie.key!=="Tab")&&L.activeElement===V.current&&ie.shiftKey&&(v.current=!0,A.current&&A.current.focus())},ee=()=>{const ie=V.current;if(ie===null)return;if(!L.hasFocus()||!f()||v.current){v.current=!1;return}if(ie.contains(L.activeElement)||c&&L.activeElement!==b.current&&L.activeElement!==A.current)return;if(L.activeElement!==x.current)x.current=null;else if(x.current!==null)return;if(!M.current)return;let ne=[];if((L.activeElement===b.current||L.activeElement===A.current)&&(ne=h(V.current)),ne.length>0){var fe,oe;const ue=!!((fe=H.current)!=null&&fe.shiftKey&&((oe=H.current)==null?void 0:oe.key)==="Tab"),Ne=ne[0],Ee=ne[ne.length-1];typeof Ne!="string"&&typeof Ee!="string"&&(ue?Ee.focus():Ne.focus())}else ie.focus()};L.addEventListener("focusin",ee),L.addEventListener("keydown",X,!0);const ce=setInterval(()=>{L.activeElement&&L.activeElement.tagName==="BODY"&&ee()},50);return()=>{clearInterval(ce),L.removeEventListener("focusin",ee),L.removeEventListener("keydown",X,!0)}},[o,c,d,f,_,h]);const F=L=>{w.current===null&&(w.current=L.relatedTarget),M.current=!0,x.current=L.target;const X=r.props.onFocus;X&&X(L)},B=L=>{w.current===null&&(w.current=L.relatedTarget),M.current=!0};return T.jsxs(K.Fragment,{children:[T.jsx("div",{tabIndex:_?0:-1,onFocus:B,ref:b,"data-testid":"sentinelStart"}),K.cloneElement(r,{ref:G,onFocus:F}),T.jsx("div",{tabIndex:_?0:-1,onFocus:B,ref:A,"data-testid":"sentinelEnd"})]})}function k0e(t){return typeof t=="function"?t():t}const x0e=K.forwardRef(function(r,o){const{children:c,container:d,disablePortal:h=!1}=r,[f,_]=K.useState(null),v=Es(K.isValidElement(c)?c.ref:null,o);if(Ml(()=>{h||_(k0e(d)||document.body)},[d,h]),Ml(()=>{if(f&&!h)return Jw(o,f),()=>{Jw(o,null)}},[o,f,h]),h){if(K.isValidElement(c)){const b={ref:v};return K.cloneElement(c,b)}return T.jsx(K.Fragment,{children:c})}return T.jsx(K.Fragment,{children:f&&NR.createPortal(c,f)})});function P0e(t){const r=Wo(t);return r.body===t?Rh(t).innerWidth>r.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function oy(t,r){r?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function hG(t){return parseInt(Rh(t).getComputedStyle(t).paddingRight,10)||0}function D0e(t){const o=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,c=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return o||c}function pG(t,r,o,c,d){const h=[r,o,...c];[].forEach.call(t.children,f=>{const _=h.indexOf(f)===-1,v=!D0e(f);_&&v&&oy(f,d)})}function SP(t,r){let o=-1;return t.some((c,d)=>r(c)?(o=d,!0):!1),o}function L0e(t,r){const o=[],c=t.container;if(!r.disableScrollLock){if(P0e(c)){const f=yY(Wo(c));o.push({value:c.style.paddingRight,property:"padding-right",el:c}),c.style.paddingRight=`${hG(c)+f}px`;const _=Wo(c).querySelectorAll(".mui-fixed");[].forEach.call(_,v=>{o.push({value:v.style.paddingRight,property:"padding-right",el:v}),v.style.paddingRight=`${hG(v)+f}px`})}let h;if(c.parentNode instanceof DocumentFragment)h=Wo(c).body;else{const f=c.parentElement,_=Rh(c);h=(f==null?void 0:f.nodeName)==="HTML"&&_.getComputedStyle(f).overflowY==="scroll"?f:c}o.push({value:h.style.overflow,property:"overflow",el:h},{value:h.style.overflowX,property:"overflow-x",el:h},{value:h.style.overflowY,property:"overflow-y",el:h}),h.style.overflow="hidden"}return()=>{o.forEach(({value:h,el:f,property:_})=>{h?f.style.setProperty(_,h):f.style.removeProperty(_)})}}function M0e(t){const r=[];return[].forEach.call(t.children,o=>{o.getAttribute("aria-hidden")==="true"&&r.push(o)}),r}class U0e{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(r,o){let c=this.modals.indexOf(r);if(c!==-1)return c;c=this.modals.length,this.modals.push(r),r.modalRef&&oy(r.modalRef,!1);const d=M0e(o);pG(o,r.mount,r.modalRef,d,!0);const h=SP(this.containers,f=>f.container===o);return h!==-1?(this.containers[h].modals.push(r),c):(this.containers.push({modals:[r],container:o,restore:null,hiddenSiblings:d}),c)}mount(r,o){const c=SP(this.containers,h=>h.modals.indexOf(r)!==-1),d=this.containers[c];d.restore||(d.restore=L0e(d,o))}remove(r,o=!0){const c=this.modals.indexOf(r);if(c===-1)return c;const d=SP(this.containers,f=>f.modals.indexOf(r)!==-1),h=this.containers[d];if(h.modals.splice(h.modals.indexOf(r),1),this.modals.splice(c,1),h.modals.length===0)h.restore&&h.restore(),r.modalRef&&oy(r.modalRef,o),pG(h.container,r.mount,r.modalRef,h.hiddenSiblings,!1),this.containers.splice(d,1);else{const f=h.modals[h.modals.length-1];f.modalRef&&oy(f.modalRef,!1)}return c}isTopModal(r){return this.modals.length>0&&this.modals[this.modals.length-1]===r}}function j0e(t){return typeof t=="function"?t():t}function F0e(t){return t?t.props.hasOwnProperty("in"):!1}const V0e=new U0e;function B0e(t){const{container:r,disableEscapeKeyDown:o=!1,disableScrollLock:c=!1,manager:d=V0e,closeAfterTransition:h=!1,onTransitionEnter:f,onTransitionExited:_,children:v,onClose:b,open:A,rootRef:w}=t,x=K.useRef({}),M=K.useRef(null),V=K.useRef(null),G=Es(V,w),[H,F]=K.useState(!A),B=F0e(v);let L=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(L=!1);const X=()=>Wo(M.current),ee=()=>(x.current.modalRef=V.current,x.current.mount=M.current,x.current),ce=()=>{d.mount(ee(),{disableScrollLock:c}),V.current&&(V.current.scrollTop=0)},ie=Pp(()=>{const Pe=j0e(r)||X().body;d.add(ee(),Pe),V.current&&ce()}),ne=K.useCallback(()=>d.isTopModal(ee()),[d]),fe=Pp(Pe=>{M.current=Pe,Pe&&(A&&ne()?ce():V.current&&oy(V.current,L))}),oe=K.useCallback(()=>{d.remove(ee(),L)},[L,d]);K.useEffect(()=>()=>{oe()},[oe]),K.useEffect(()=>{A?ie():(!B||!h)&&oe()},[A,oe,B,h,ie]);const ue=Pe=>$e=>{var Ce;(Ce=Pe.onKeyDown)==null||Ce.call(Pe,$e),!($e.key!=="Escape"||$e.which===229||!ne())&&(o||($e.stopPropagation(),b&&b($e,"escapeKeyDown")))},Ne=Pe=>$e=>{var Ce;(Ce=Pe.onClick)==null||Ce.call(Pe,$e),$e.target===$e.currentTarget&&b&&b($e,"backdropClick")};return{getRootProps:(Pe={})=>{const $e=MY(t);delete $e.onTransitionEnter,delete $e.onTransitionExited;const Ce=_e({},$e,Pe);return _e({role:"presentation"},Ce,{onKeyDown:ue(Ce),ref:G})},getBackdropProps:(Pe={})=>{const $e=Pe;return _e({"aria-hidden":!0},$e,{onClick:Ne($e),open:A})},getTransitionProps:()=>{const Pe=()=>{F(!1),f&&f()},$e=()=>{F(!0),_&&_(),h&&oe()};return{onEnter:NL(Pe,v==null?void 0:v.props.onEnter),onExited:NL($e,v==null?void 0:v.props.onExited)}},rootRef:G,portalRef:fe,isTopModal:ne,exited:H,hasTransition:B}}const W0e=["onChange","maxRows","minRows","style","value"];function PC(t){return parseInt(t,10)||0}const $0e={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function G0e(t){return t==null||Object.keys(t).length===0||t.outerHeightStyle===0&&!t.overflowing}const H0e=K.forwardRef(function(r,o){const{onChange:c,maxRows:d,minRows:h=1,style:f,value:_}=r,v=jt(r,W0e),{current:b}=K.useRef(_!=null),A=K.useRef(null),w=Es(o,A),x=K.useRef(null),M=K.useCallback(()=>{const H=A.current,B=Rh(H).getComputedStyle(H);if(B.width==="0px")return{outerHeightStyle:0,overflowing:!1};const L=x.current;L.style.width=B.width,L.value=H.value||r.placeholder||"x",L.value.slice(-1)===`
`&&(L.value+=" ");const X=B.boxSizing,ee=PC(B.paddingBottom)+PC(B.paddingTop),ce=PC(B.borderBottomWidth)+PC(B.borderTopWidth),ie=L.scrollHeight;L.value="x";const ne=L.scrollHeight;let fe=ie;h&&(fe=Math.max(Number(h)*ne,fe)),d&&(fe=Math.min(Number(d)*ne,fe)),fe=Math.max(fe,ne);const oe=fe+(X==="border-box"?ee+ce:0),ue=Math.abs(fe-ie)<=1;return{outerHeightStyle:oe,overflowing:ue}},[d,h,r.placeholder]),V=K.useCallback(()=>{const H=M();if(G0e(H))return;const F=A.current;F.style.height=`${H.outerHeightStyle}px`,F.style.overflow=H.overflowing?"hidden":""},[M]);Ml(()=>{const H=()=>{V()};let F;const B=YM(H),L=A.current,X=Rh(L);X.addEventListener("resize",B);let ee;return typeof ResizeObserver<"u"&&(ee=new ResizeObserver(H),ee.observe(L)),()=>{B.clear(),cancelAnimationFrame(F),X.removeEventListener("resize",B),ee&&ee.disconnect()}},[M,V]),Ml(()=>{V()});const G=H=>{b||V(),c&&c(H)};return T.jsxs(K.Fragment,{children:[T.jsx("textarea",_e({value:_,onChange:G,ref:w,rows:h},v)),T.jsx("textarea",{"aria-hidden":!0,className:r.className,readOnly:!0,ref:x,tabIndex:-1,style:_e({},$0e.shadow,f,{paddingTop:0,paddingBottom:0})})]})});function z0e(t){return zn("MuiTypography",t)}Vn("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const K0e=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Y0e=t=>{const{align:r,gutterBottom:o,noWrap:c,paragraph:d,variant:h,classes:f}=t,_={root:["root",h,t.align!=="inherit"&&`align${Gt(r)}`,o&&"gutterBottom",c&&"noWrap",d&&"paragraph"]};return Qn(_,z0e,f)},q0e=Rt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.variant&&r[o.variant],o.align!=="inherit"&&r[`align${Gt(o.align)}`],o.noWrap&&r.noWrap,o.gutterBottom&&r.gutterBottom,o.paragraph&&r.paragraph]}})(({theme:t,ownerState:r})=>_e({margin:0},r.variant==="inherit"&&{font:"inherit"},r.variant!=="inherit"&&t.typography[r.variant],r.align!=="inherit"&&{textAlign:r.align},r.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r.gutterBottom&&{marginBottom:"0.35em"},r.paragraph&&{marginBottom:16})),fG={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},X0e={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},J0e=t=>X0e[t]||t,Q0e=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiTypography"}),d=J0e(c.color),h=lY(_e({},c,{color:d})),{align:f="inherit",className:_,component:v,gutterBottom:b=!1,noWrap:A=!1,paragraph:w=!1,variant:x="body1",variantMapping:M=fG}=h,V=jt(h,K0e),G=_e({},h,{align:f,color:d,className:_,component:v,gutterBottom:b,noWrap:A,paragraph:w,variant:x,variantMapping:M}),H=v||(w?"p":M[x]||fG[x])||"span",F=Y0e(G);return T.jsx(q0e,_e({as:H,ref:o,ownerState:G,className:Wt(F.root,_)},V))}),ag=Q0e;function a_({props:t,states:r,muiFormControl:o}){return r.reduce((c,d)=>(c[d]=t[d],o&&typeof t[d]>"u"&&(c[d]=o[d]),c),{})}const Z0e=K.createContext(void 0),sU=Z0e;function c_(){return K.useContext(sU)}function eSe(t){return T.jsx(zEe,_e({},t,{defaultTheme:TI,themeId:WR}))}function mG(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function nR(t,r=!1){return t&&(mG(t.value)&&t.value!==""||r&&mG(t.defaultValue)&&t.defaultValue!=="")}function tSe(t){return t.startAdornment}function nSe(t){return zn("MuiInputBase",t)}const rSe=Vn("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Hg=rSe,iSe=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],UI=(t,r)=>{const{ownerState:o}=t;return[r.root,o.formControl&&r.formControl,o.startAdornment&&r.adornedStart,o.endAdornment&&r.adornedEnd,o.error&&r.error,o.size==="small"&&r.sizeSmall,o.multiline&&r.multiline,o.color&&r[`color${Gt(o.color)}`],o.fullWidth&&r.fullWidth,o.hiddenLabel&&r.hiddenLabel]},jI=(t,r)=>{const{ownerState:o}=t;return[r.input,o.size==="small"&&r.inputSizeSmall,o.multiline&&r.inputMultiline,o.type==="search"&&r.inputTypeSearch,o.startAdornment&&r.inputAdornedStart,o.endAdornment&&r.inputAdornedEnd,o.hiddenLabel&&r.inputHiddenLabel]},sSe=t=>{const{classes:r,color:o,disabled:c,error:d,endAdornment:h,focused:f,formControl:_,fullWidth:v,hiddenLabel:b,multiline:A,readOnly:w,size:x,startAdornment:M,type:V}=t,G={root:["root",`color${Gt(o)}`,c&&"disabled",d&&"error",v&&"fullWidth",f&&"focused",_&&"formControl",x&&x!=="medium"&&`size${Gt(x)}`,A&&"multiline",M&&"adornedStart",h&&"adornedEnd",b&&"hiddenLabel",w&&"readOnly"],input:["input",c&&"disabled",V==="search"&&"inputTypeSearch",A&&"inputMultiline",x==="small"&&"inputSizeSmall",b&&"inputHiddenLabel",M&&"inputAdornedStart",h&&"inputAdornedEnd",w&&"readOnly"]};return Qn(G,nSe,r)},FI=Rt("div",{name:"MuiInputBase",slot:"Root",overridesResolver:UI})(({theme:t,ownerState:r})=>_e({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Hg.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},r.multiline&&_e({padding:"4px 0 5px"},r.size==="small"&&{paddingTop:1}),r.fullWidth&&{width:"100%"})),VI=Rt("input",{name:"MuiInputBase",slot:"Input",overridesResolver:jI})(({theme:t,ownerState:r})=>{const o=t.palette.mode==="light",c=_e({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:o?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),d={opacity:"0 !important"},h=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:o?.42:.5};return _e({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":c,"&::-moz-placeholder":c,"&:-ms-input-placeholder":c,"&::-ms-input-placeholder":c,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Hg.formControl} &`]:{"&::-webkit-input-placeholder":d,"&::-moz-placeholder":d,"&:-ms-input-placeholder":d,"&::-ms-input-placeholder":d,"&:focus::-webkit-input-placeholder":h,"&:focus::-moz-placeholder":h,"&:focus:-ms-input-placeholder":h,"&:focus::-ms-input-placeholder":h},[`&.${Hg.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},r.size==="small"&&{paddingTop:1},r.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},r.type==="search"&&{MozAppearance:"textfield"})}),oSe=T.jsx(eSe,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),aSe=K.forwardRef(function(r,o){var c;const d=Zn({props:r,name:"MuiInputBase"}),{"aria-describedby":h,autoComplete:f,autoFocus:_,className:v,components:b={},componentsProps:A={},defaultValue:w,disabled:x,disableInjectingGlobalStyles:M,endAdornment:V,fullWidth:G=!1,id:H,inputComponent:F="input",inputProps:B={},inputRef:L,maxRows:X,minRows:ee,multiline:ce=!1,name:ie,onBlur:ne,onChange:fe,onClick:oe,onFocus:ue,onKeyDown:Ne,onKeyUp:Ee,placeholder:we,readOnly:Re,renderSuffix:Pe,rows:$e,slotProps:Ce={},slots:Fe={},startAdornment:Ye,type:Mt="text",value:yt}=d,Xt=jt(d,iSe),Ue=B.value!=null?B.value:yt,{current:Be}=K.useRef(Ue!=null),at=K.useRef(),Jt=K.useCallback(an=>{},[]),un=Es(at,L,B.ref,Jt),[Ut,Gr]=K.useState(!1),sn=c_(),hn=a_({props:d,muiFormControl:sn,states:["color","disabled","error","hiddenLabel","size","required","filled"]});hn.focused=sn?sn.focused:Ut,K.useEffect(()=>{!sn&&x&&Ut&&(Gr(!1),ne&&ne())},[sn,x,Ut,ne]);const Ht=sn&&sn.onFilled,on=sn&&sn.onEmpty,rt=K.useCallback(an=>{nR(an)?Ht&&Ht():on&&on()},[Ht,on]);Ml(()=>{Be&&rt({value:Ue})},[Ue,rt,Be]);const _n=an=>{if(hn.disabled){an.stopPropagation();return}ue&&ue(an),B.onFocus&&B.onFocus(an),sn&&sn.onFocus?sn.onFocus(an):Gr(!0)},Kn=an=>{ne&&ne(an),B.onBlur&&B.onBlur(an),sn&&sn.onBlur?sn.onBlur(an):Gr(!1)},En=(an,...It)=>{if(!Be){const ot=an.target||at.current;if(ot==null)throw new Error(jd(1));rt({value:ot.value})}B.onChange&&B.onChange(an,...It),fe&&fe(an,...It)};K.useEffect(()=>{rt(at.current)},[]);const fi=an=>{at.current&&an.currentTarget===an.target&&at.current.focus(),oe&&oe(an)};let fr=F,Ft=B;ce&&fr==="input"&&($e?Ft=_e({type:void 0,minRows:$e,maxRows:$e},Ft):Ft=_e({type:void 0,maxRows:X,minRows:ee},Ft),fr=H0e);const mr=an=>{rt(an.animationName==="mui-auto-fill-cancel"?at.current:{value:"x"})};K.useEffect(()=>{sn&&sn.setAdornedStart(!!Ye)},[sn,Ye]);const Hr=_e({},d,{color:hn.color||"primary",disabled:hn.disabled,endAdornment:V,error:hn.error,focused:hn.focused,formControl:sn,fullWidth:G,hiddenLabel:hn.hiddenLabel,multiline:ce,size:hn.size,startAdornment:Ye,type:Mt}),Mn=sSe(Hr),Wi=Fe.root||b.Root||FI,lr=Ce.root||A.root||{},Yn=Fe.input||b.Input||VI;return Ft=_e({},Ft,(c=Ce.input)!=null?c:A.input),T.jsxs(K.Fragment,{children:[!M&&oSe,T.jsxs(Wi,_e({},lr,!tR(Wi)&&{ownerState:_e({},Hr,lr.ownerState)},{ref:o,onClick:fi},Xt,{className:Wt(Mn.root,lr.className,v,Re&&"MuiInputBase-readOnly"),children:[Ye,T.jsx(sU.Provider,{value:null,children:T.jsx(Yn,_e({ownerState:Hr,"aria-invalid":hn.error,"aria-describedby":h,autoComplete:f,autoFocus:_,defaultValue:w,disabled:hn.disabled,id:H,onAnimationStart:mr,name:ie,placeholder:we,readOnly:Re,required:hn.required,rows:$e,value:Ue,onKeyDown:Ne,onKeyUp:Ee,type:Mt},Ft,!tR(Yn)&&{as:fr,ownerState:_e({},Hr,Ft.ownerState)},{ref:un,className:Wt(Mn.input,Ft.className,Re&&"MuiInputBase-readOnly"),onBlur:Kn,onChange:En,onFocus:_n}))}),V,Pe?Pe(_e({},hn,{startAdornment:Ye})):null]}))]})}),oU=aSe;function cSe(t){return zn("MuiInput",t)}const lSe=_e({},Hg,Vn("MuiInput",["root","underline","input"])),kv=lSe;function dSe(t){return zn("MuiOutlinedInput",t)}const uSe=_e({},Hg,Vn("MuiOutlinedInput",["root","notchedOutline","input"])),$u=uSe;function hSe(t){return zn("MuiFilledInput",t)}const pSe=_e({},Hg,Vn("MuiFilledInput",["root","underline","input"])),bp=pSe,fSe=wI(T.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),mSe=wI(T.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function gSe(t){return zn("MuiAvatar",t)}Vn("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const _Se=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],ESe=t=>{const{classes:r,variant:o,colorDefault:c}=t;return Qn({root:["root",o,c&&"colorDefault"],img:["img"],fallback:["fallback"]},gSe,r)},vSe=Rt("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,r[o.variant],o.colorDefault&&r.colorDefault]}})(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:_e({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:_e({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]})),ySe=Rt("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,r)=>r.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),SSe=Rt(mSe,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,r)=>r.fallback})({width:"75%",height:"75%"});function bSe({crossOrigin:t,referrerPolicy:r,src:o,srcSet:c}){const[d,h]=K.useState(!1);return K.useEffect(()=>{if(!o&&!c)return;h(!1);let f=!0;const _=new Image;return _.onload=()=>{f&&h("loaded")},_.onerror=()=>{f&&h("error")},_.crossOrigin=t,_.referrerPolicy=r,_.src=o,c&&(_.srcset=c),()=>{f=!1}},[t,r,o,c]),d}const TSe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiAvatar"}),{alt:d,children:h,className:f,component:_="div",slots:v={},slotProps:b={},imgProps:A,sizes:w,src:x,srcSet:M,variant:V="circular"}=c,G=jt(c,_Se);let H=null;const F=bSe(_e({},A,{src:x,srcSet:M})),B=x||M,L=B&&F!=="error",X=_e({},c,{colorDefault:!L,component:_,variant:V}),ee=ESe(X),[ce,ie]=o0e("img",{className:ee.img,elementType:ySe,externalForwardedProps:{slots:v,slotProps:{img:_e({},A,b.img)}},additionalProps:{alt:d,src:x,srcSet:M,sizes:w},ownerState:X});return L?H=T.jsx(ce,_e({},ie)):h||h===0?H=h:B&&d?H=d[0]:H=T.jsx(SSe,{ownerState:X,className:ee.fallback}),T.jsx(vSe,_e({as:_,ownerState:X,className:Wt(ee.root,f),ref:o},G,{children:H}))}),pi=TSe,CSe=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],wSe={entering:{opacity:1},entered:{opacity:1}},RSe=K.forwardRef(function(r,o){const c=CI(),d={enter:c.transitions.duration.enteringScreen,exit:c.transitions.duration.leavingScreen},{addEndListener:h,appear:f=!0,children:_,easing:v,in:b,onEnter:A,onEntered:w,onEntering:x,onExit:M,onExited:V,onExiting:G,style:H,timeout:F=d,TransitionComponent:B=PY}=r,L=jt(r,CSe),X=K.useRef(null),ee=Es(X,_.ref,o),ce=we=>Re=>{if(we){const Pe=X.current;Re===void 0?we(Pe):we(Pe,Re)}},ie=ce(x),ne=ce((we,Re)=>{DY(we);const Pe=eR({style:H,timeout:F,easing:v},{mode:"enter"});we.style.webkitTransition=c.transitions.create("opacity",Pe),we.style.transition=c.transitions.create("opacity",Pe),A&&A(we,Re)}),fe=ce(w),oe=ce(G),ue=ce(we=>{const Re=eR({style:H,timeout:F,easing:v},{mode:"exit"});we.style.webkitTransition=c.transitions.create("opacity",Re),we.style.transition=c.transitions.create("opacity",Re),M&&M(we)}),Ne=ce(V),Ee=we=>{h&&h(X.current,we)};return T.jsx(B,_e({appear:f,in:b,nodeRef:X,onEnter:ne,onEntered:fe,onEntering:ie,onExit:ue,onExited:Ne,onExiting:oe,addEndListener:Ee,timeout:F},L,{children:(we,Re)=>K.cloneElement(_,_e({style:_e({opacity:0,visibility:we==="exited"&&!b?"hidden":void 0},wSe[we],H,_.props.style),ref:ee},Re))}))}),aU=RSe;function ISe(t){return zn("MuiBackdrop",t)}Vn("MuiBackdrop",["root","invisible"]);const ASe=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],OSe=t=>{const{classes:r,invisible:o}=t;return Qn({root:["root",o&&"invisible"]},ISe,r)},NSe=Rt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.invisible&&r.invisible]}})(({ownerState:t})=>_e({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),kSe=K.forwardRef(function(r,o){var c,d,h;const f=Zn({props:r,name:"MuiBackdrop"}),{children:_,className:v,component:b="div",components:A={},componentsProps:w={},invisible:x=!1,open:M,slotProps:V={},slots:G={},TransitionComponent:H=aU,transitionDuration:F}=f,B=jt(f,ASe),L=_e({},f,{component:b,invisible:x}),X=OSe(L),ee=(c=V.root)!=null?c:w.root;return T.jsx(H,_e({in:M,timeout:F},B,{children:T.jsx(NSe,_e({"aria-hidden":!0},ee,{as:(d=(h=G.root)!=null?h:A.Root)!=null?d:b,className:Wt(X.root,v,ee==null?void 0:ee.className),ownerState:_e({},L,ee==null?void 0:ee.ownerState),classes:X,ref:o,children:_}))}))}),FY=kSe;function xSe(t){return Zn}function PSe(t){return zn("MuiBadge",t)}const DSe=Vn("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),Gu=DSe,LSe=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],bP=10,TP=4,MSe=xSe(),USe=t=>{const{color:r,anchorOrigin:o,invisible:c,overlap:d,variant:h,classes:f={}}=t,_={root:["root"],badge:["badge",h,c&&"invisible",`anchorOrigin${Gt(o.vertical)}${Gt(o.horizontal)}`,`anchorOrigin${Gt(o.vertical)}${Gt(o.horizontal)}${Gt(d)}`,`overlap${Gt(d)}`,r!=="default"&&`color${Gt(r)}`]};return Qn(_,PSe,f)},jSe=Rt("span",{name:"MuiBadge",slot:"Root",overridesResolver:(t,r)=>r.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),FSe=Rt("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.badge,r[o.variant],r[`anchorOrigin${Gt(o.anchorOrigin.vertical)}${Gt(o.anchorOrigin.horizontal)}${Gt(o.overlap)}`],o.color!=="default"&&r[`color${Gt(o.color)}`],o.invisible&&r.invisible]}})(({theme:t})=>{var r;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:bP*2,lineHeight:1,padding:"0 6px",height:bP*2,borderRadius:bP,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.keys(((r=t.vars)!=null?r:t).palette).filter(o=>{var c,d;return((c=t.vars)!=null?c:t).palette[o].main&&((d=t.vars)!=null?d:t).palette[o].contrastText}).map(o=>({props:{color:o},style:{backgroundColor:(t.vars||t).palette[o].main,color:(t.vars||t).palette[o].contrastText}})),{props:{variant:"dot"},style:{borderRadius:TP,height:TP*2,minWidth:TP*2,padding:0}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Gu.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]}}),VSe=K.forwardRef(function(r,o){var c,d,h,f,_,v;const b=MSe({props:r,name:"MuiBadge"}),{anchorOrigin:A={vertical:"top",horizontal:"right"},className:w,component:x,components:M={},componentsProps:V={},children:G,overlap:H="rectangular",color:F="default",invisible:B=!1,max:L=99,badgeContent:X,slots:ee,slotProps:ce,showZero:ie=!1,variant:ne="standard"}=b,fe=jt(b,LSe),{badgeContent:oe,invisible:ue,max:Ne,displayValue:Ee}=T0e({max:L,invisible:B,badgeContent:X,showZero:ie}),we=SY({anchorOrigin:A,color:F,overlap:H,variant:ne,badgeContent:X}),Re=ue||oe==null&&ne!=="dot",{color:Pe=F,overlap:$e=H,anchorOrigin:Ce=A,variant:Fe=ne}=Re?we:b,Ye=Fe!=="dot"?Ee:void 0,Mt=_e({},b,{badgeContent:oe,invisible:Re,max:Ne,displayValue:Ye,showZero:ie,anchorOrigin:Ce,color:Pe,overlap:$e,variant:Fe}),yt=USe(Mt),Xt=(c=(d=ee==null?void 0:ee.root)!=null?d:M.Root)!=null?c:jSe,Ue=(h=(f=ee==null?void 0:ee.badge)!=null?f:M.Badge)!=null?h:FSe,Be=(_=ce==null?void 0:ce.root)!=null?_:V.root,at=(v=ce==null?void 0:ce.badge)!=null?v:V.badge,Jt=Ih({elementType:Xt,externalSlotProps:Be,externalForwardedProps:fe,additionalProps:{ref:o,as:x},ownerState:Mt,className:Wt(Be==null?void 0:Be.className,yt.root,w)}),un=Ih({elementType:Ue,externalSlotProps:at,ownerState:Mt,className:Wt(yt.badge,at==null?void 0:at.className)});return T.jsxs(Xt,_e({},Jt,{children:[G,T.jsx(Ue,_e({},un,{children:Ye}))]}))}),BSe=VSe;function WSe(t){return zn("MuiButton",t)}const $Se=Vn("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),DC=$Se,GSe=K.createContext({}),HSe=GSe,zSe=K.createContext(void 0),KSe=zSe,YSe=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],qSe=t=>{const{color:r,disableElevation:o,fullWidth:c,size:d,variant:h,classes:f}=t,_={root:["root",h,`${h}${Gt(r)}`,`size${Gt(d)}`,`${h}Size${Gt(d)}`,r==="inherit"&&"colorInherit",o&&"disableElevation",c&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${Gt(d)}`],endIcon:["endIcon",`iconSize${Gt(d)}`]},v=Qn(_,WSe,f);return _e({},f,v)},VY=t=>_e({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),XSe=Rt(iU,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,r[o.variant],r[`${o.variant}${Gt(o.color)}`],r[`size${Gt(o.size)}`],r[`${o.variant}Size${Gt(o.size)}`],o.color==="inherit"&&r.colorInherit,o.disableElevation&&r.disableElevation,o.fullWidth&&r.fullWidth]}})(({theme:t,ownerState:r})=>{var o,c;const d=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],h=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return _e({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":_e({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:jo(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},r.variant==="text"&&r.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[r.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:jo(t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},r.variant==="outlined"&&r.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[r.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[r.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:jo(t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},r.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:h,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},r.variant==="contained"&&r.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[r.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[r.color].main}}),"&:active":_e({},r.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${DC.focusVisible}`]:_e({},r.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${DC.disabled}`]:_e({color:(t.vars||t).palette.action.disabled},r.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},r.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},r.variant==="text"&&{padding:"6px 8px"},r.variant==="text"&&r.color!=="inherit"&&{color:(t.vars||t).palette[r.color].main},r.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},r.variant==="outlined"&&r.color!=="inherit"&&{color:(t.vars||t).palette[r.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[r.color].mainChannel} / 0.5)`:`1px solid ${jo(t.palette[r.color].main,.5)}`},r.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(o=(c=t.palette).getContrastText)==null?void 0:o.call(c,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:d,boxShadow:(t.vars||t).shadows[2]},r.variant==="contained"&&r.color!=="inherit"&&{color:(t.vars||t).palette[r.color].contrastText,backgroundColor:(t.vars||t).palette[r.color].main},r.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},r.size==="small"&&r.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},r.size==="large"&&r.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},r.size==="small"&&r.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},r.size==="large"&&r.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},r.size==="small"&&r.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},r.size==="large"&&r.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},r.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${DC.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${DC.disabled}`]:{boxShadow:"none"}}),JSe=Rt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.startIcon,r[`iconSize${Gt(o.size)}`]]}})(({ownerState:t})=>_e({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},VY(t))),QSe=Rt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.endIcon,r[`iconSize${Gt(o.size)}`]]}})(({ownerState:t})=>_e({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},VY(t))),ZSe=K.forwardRef(function(r,o){const c=K.useContext(HSe),d=K.useContext(KSe),h=KM(c,r),f=Zn({props:h,name:"MuiButton"}),{children:_,color:v="primary",component:b="button",className:A,disabled:w=!1,disableElevation:x=!1,disableFocusRipple:M=!1,endIcon:V,focusVisibleClassName:G,fullWidth:H=!1,size:F="medium",startIcon:B,type:L,variant:X="text"}=f,ee=jt(f,YSe),ce=_e({},f,{color:v,component:b,disabled:w,disableElevation:x,disableFocusRipple:M,fullWidth:H,size:F,type:L,variant:X}),ie=qSe(ce),ne=B&&T.jsx(JSe,{className:ie.startIcon,ownerState:ce,children:B}),fe=V&&T.jsx(QSe,{className:ie.endIcon,ownerState:ce,children:V}),oe=d||"";return T.jsxs(XSe,_e({ownerState:ce,className:Wt(c.className,ie.root,A,oe),component:b,disabled:w,focusRipple:!M,focusVisibleClassName:Wt(ie.focusVisible,G),ref:o,type:L},ee,{classes:ie,children:[ne,_,fe]}))}),Gv=ZSe;function ebe(t){return zn("MuiModal",t)}Vn("MuiModal",["root","hidden","backdrop"]);const tbe=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],nbe=t=>{const{open:r,exited:o,classes:c}=t;return Qn({root:["root",!r&&o&&"hidden"],backdrop:["backdrop"]},ebe,c)},rbe=Rt("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,!o.open&&o.exited&&r.hidden]}})(({theme:t,ownerState:r})=>_e({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!r.open&&r.exited&&{visibility:"hidden"})),ibe=Rt(FY,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,r)=>r.backdrop})({zIndex:-1}),sbe=K.forwardRef(function(r,o){var c,d,h,f,_,v;const b=Zn({name:"MuiModal",props:r}),{BackdropComponent:A=ibe,BackdropProps:w,className:x,closeAfterTransition:M=!1,children:V,container:G,component:H,components:F={},componentsProps:B={},disableAutoFocus:L=!1,disableEnforceFocus:X=!1,disableEscapeKeyDown:ee=!1,disablePortal:ce=!1,disableRestoreFocus:ie=!1,disableScrollLock:ne=!1,hideBackdrop:fe=!1,keepMounted:oe=!1,onBackdropClick:ue,open:Ne,slotProps:Ee,slots:we}=b,Re=jt(b,tbe),Pe=_e({},b,{closeAfterTransition:M,disableAutoFocus:L,disableEnforceFocus:X,disableEscapeKeyDown:ee,disablePortal:ce,disableRestoreFocus:ie,disableScrollLock:ne,hideBackdrop:fe,keepMounted:oe}),{getRootProps:$e,getBackdropProps:Ce,getTransitionProps:Fe,portalRef:Ye,isTopModal:Mt,exited:yt,hasTransition:Xt}=B0e(_e({},Pe,{rootRef:o})),Ue=_e({},Pe,{exited:yt}),Be=nbe(Ue),at={};if(V.props.tabIndex===void 0&&(at.tabIndex="-1"),Xt){const{onEnter:Ht,onExited:on}=Fe();at.onEnter=Ht,at.onExited=on}const Jt=(c=(d=we==null?void 0:we.root)!=null?d:F.Root)!=null?c:rbe,un=(h=(f=we==null?void 0:we.backdrop)!=null?f:F.Backdrop)!=null?h:A,Ut=(_=Ee==null?void 0:Ee.root)!=null?_:B.root,Gr=(v=Ee==null?void 0:Ee.backdrop)!=null?v:B.backdrop,sn=Ih({elementType:Jt,externalSlotProps:Ut,externalForwardedProps:Re,getSlotProps:$e,additionalProps:{ref:o,as:H},ownerState:Ue,className:Wt(x,Ut==null?void 0:Ut.className,Be==null?void 0:Be.root,!Ue.open&&Ue.exited&&(Be==null?void 0:Be.hidden))}),hn=Ih({elementType:un,externalSlotProps:Gr,additionalProps:w,getSlotProps:Ht=>Ce(_e({},Ht,{onClick:on=>{ue&&ue(on),Ht!=null&&Ht.onClick&&Ht.onClick(on)}})),className:Wt(Gr==null?void 0:Gr.className,w==null?void 0:w.className,Be==null?void 0:Be.backdrop),ownerState:Ue});return!oe&&!Ne&&(!Xt||yt)?null:T.jsx(x0e,{ref:Ye,container:G,disablePortal:ce,children:T.jsxs(Jt,_e({},sn,{children:[!fe&&A?T.jsx(un,_e({},hn)):null,T.jsx(N0e,{disableEnforceFocus:X,disableAutoFocus:L,disableRestoreFocus:ie,isEnabled:Mt,open:Ne,children:K.cloneElement(V,at)})]}))})}),BY=sbe;function obe(t){return zn("MuiDialog",t)}const abe=Vn("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),CP=abe,cbe=K.createContext({}),WY=cbe,lbe=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],dbe=Rt(FY,{name:"MuiDialog",slot:"Backdrop",overrides:(t,r)=>r.backdrop})({zIndex:-1}),ube=t=>{const{classes:r,scroll:o,maxWidth:c,fullWidth:d,fullScreen:h}=t,f={root:["root"],container:["container",`scroll${Gt(o)}`],paper:["paper",`paperScroll${Gt(o)}`,`paperWidth${Gt(String(c))}`,d&&"paperFullWidth",h&&"paperFullScreen"]};return Qn(f,obe,r)},hbe=Rt(BY,{name:"MuiDialog",slot:"Root",overridesResolver:(t,r)=>r.root})({"@media print":{position:"absolute !important"}}),pbe=Rt("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.container,r[`scroll${Gt(o.scroll)}`]]}})(({ownerState:t})=>_e({height:"100%","@media print":{height:"auto"},outline:0},t.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},t.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),fbe=Rt(rU,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.paper,r[`scrollPaper${Gt(o.scroll)}`],r[`paperWidth${Gt(String(o.maxWidth))}`],o.fullWidth&&r.paperFullWidth,o.fullScreen&&r.paperFullScreen]}})(({theme:t,ownerState:r})=>_e({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},r.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},r.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!r.maxWidth&&{maxWidth:"calc(100% - 64px)"},r.maxWidth==="xs"&&{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${CP.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},r.maxWidth&&r.maxWidth!=="xs"&&{maxWidth:`${t.breakpoints.values[r.maxWidth]}${t.breakpoints.unit}`,[`&.${CP.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[r.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},r.fullWidth&&{width:"calc(100% - 64px)"},r.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${CP.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),mbe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiDialog"}),d=CI(),h={enter:d.transitions.duration.enteringScreen,exit:d.transitions.duration.leavingScreen},{"aria-describedby":f,"aria-labelledby":_,BackdropComponent:v,BackdropProps:b,children:A,className:w,disableEscapeKeyDown:x=!1,fullScreen:M=!1,fullWidth:V=!1,maxWidth:G="sm",onBackdropClick:H,onClose:F,open:B,PaperComponent:L=rU,PaperProps:X={},scroll:ee="paper",TransitionComponent:ce=aU,transitionDuration:ie=h,TransitionProps:ne}=c,fe=jt(c,lbe),oe=_e({},c,{disableEscapeKeyDown:x,fullScreen:M,fullWidth:V,maxWidth:G,scroll:ee}),ue=ube(oe),Ne=K.useRef(),Ee=$e=>{Ne.current=$e.target===$e.currentTarget},we=$e=>{Ne.current&&(Ne.current=null,H&&H($e),F&&F($e,"backdropClick"))},Re=yI(_),Pe=K.useMemo(()=>({titleId:Re}),[Re]);return T.jsx(hbe,_e({className:Wt(ue.root,w),closeAfterTransition:!0,components:{Backdrop:dbe},componentsProps:{backdrop:_e({transitionDuration:ie,as:v},b)},disableEscapeKeyDown:x,onClose:F,open:B,ref:o,onClick:we,ownerState:oe},fe,{children:T.jsx(ce,_e({appear:!0,in:B,timeout:ie,role:"presentation"},ne,{children:T.jsx(pbe,{className:Wt(ue.container),onMouseDown:Ee,ownerState:oe,children:T.jsx(fbe,_e({as:L,elevation:24,role:"dialog","aria-describedby":f,"aria-labelledby":Re},X,{className:Wt(ue.paper,X.className),ownerState:oe,children:T.jsx(WY.Provider,{value:Pe,children:A})}))})}))}))}),gbe=mbe;function _be(t){return zn("MuiDialogActions",t)}Vn("MuiDialogActions",["root","spacing"]);const Ebe=["className","disableSpacing"],vbe=t=>{const{classes:r,disableSpacing:o}=t;return Qn({root:["root",!o&&"spacing"]},_be,r)},ybe=Rt("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,!o.disableSpacing&&r.spacing]}})(({ownerState:t})=>_e({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Sbe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiDialogActions"}),{className:d,disableSpacing:h=!1}=c,f=jt(c,Ebe),_=_e({},c,{disableSpacing:h}),v=vbe(_);return T.jsx(ybe,_e({className:Wt(v.root,d),ownerState:_,ref:o},f))}),bbe=Sbe;function Tbe(t){return zn("MuiDialogContent",t)}Vn("MuiDialogContent",["root","dividers"]);function Cbe(t){return zn("MuiDialogTitle",t)}const wbe=Vn("MuiDialogTitle",["root"]),Rbe=wbe,Ibe=["className","dividers"],Abe=t=>{const{classes:r,dividers:o}=t;return Qn({root:["root",o&&"dividers"]},Tbe,r)},Obe=Rt("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.dividers&&r.dividers]}})(({theme:t,ownerState:r})=>_e({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},r.dividers?{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}:{[`.${Rbe.root} + &`]:{paddingTop:0}})),Nbe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiDialogContent"}),{className:d,dividers:h=!1}=c,f=jt(c,Ibe),_=_e({},c,{dividers:h}),v=Abe(_);return T.jsx(Obe,_e({className:Wt(v.root,d),ownerState:_,ref:o},f))}),kbe=Nbe;function xbe(t){return zn("MuiDialogContentText",t)}Vn("MuiDialogContentText",["root"]);const Pbe=["children","className"],Dbe=t=>{const{classes:r}=t,c=Qn({root:["root"]},xbe,r);return _e({},r,c)},Lbe=Rt(ag,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(t,r)=>r.root})({}),Mbe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiDialogContentText"}),{className:d}=c,h=jt(c,Pbe),f=Dbe(h);return T.jsx(Lbe,_e({component:"p",variant:"body1",color:"text.secondary",ref:o,ownerState:h,className:Wt(f.root,d)},c,{classes:f}))}),gG=Mbe,Ube=["className","id"],jbe=t=>{const{classes:r}=t;return Qn({root:["root"]},Cbe,r)},Fbe=Rt(ag,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(t,r)=>r.root})({padding:"16px 24px",flex:"0 0 auto"}),Vbe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiDialogTitle"}),{className:d,id:h}=c,f=jt(c,Ube),_=c,v=jbe(_),{titleId:b=h}=K.useContext(WY);return T.jsx(Fbe,_e({component:"h2",className:Wt(v.root,d),ownerState:_,ref:o,variant:"h6",id:h??b},f))}),Bbe=Vbe,Wbe=Vn("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),_G=Wbe,$be=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Gbe=t=>{const{classes:r,disableUnderline:o}=t,d=Qn({root:["root",!o&&"underline"],input:["input"]},hSe,r);return _e({},r,d)},Hbe=Rt(FI,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[...UI(t,r),!o.disableUnderline&&r.underline]}})(({theme:t,ownerState:r})=>{var o;const c=t.palette.mode==="light",d=c?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",h=c?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",f=c?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",_=c?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return _e({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:h,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:f,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:h}},[`&.${bp.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:h},[`&.${bp.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:_}},!r.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(o=(t.vars||t).palette[r.color||"primary"])==null?void 0:o.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${bp.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${bp.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:d}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${bp.disabled}, .${bp.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${bp.disabled}:before`]:{borderBottomStyle:"dotted"}},r.startAdornment&&{paddingLeft:12},r.endAdornment&&{paddingRight:12},r.multiline&&_e({padding:"25px 12px 8px"},r.size==="small"&&{paddingTop:21,paddingBottom:4},r.hiddenLabel&&{paddingTop:16,paddingBottom:17},r.hiddenLabel&&r.size==="small"&&{paddingTop:8,paddingBottom:9}))}),zbe=Rt(VI,{name:"MuiFilledInput",slot:"Input",overridesResolver:jI})(({theme:t,ownerState:r})=>_e({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},r.size==="small"&&{paddingTop:21,paddingBottom:4},r.hiddenLabel&&{paddingTop:16,paddingBottom:17},r.startAdornment&&{paddingLeft:0},r.endAdornment&&{paddingRight:0},r.hiddenLabel&&r.size==="small"&&{paddingTop:8,paddingBottom:9},r.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),$Y=K.forwardRef(function(r,o){var c,d,h,f;const _=Zn({props:r,name:"MuiFilledInput"}),{components:v={},componentsProps:b,fullWidth:A=!1,inputComponent:w="input",multiline:x=!1,slotProps:M,slots:V={},type:G="text"}=_,H=jt(_,$be),F=_e({},_,{fullWidth:A,inputComponent:w,multiline:x,type:G}),B=Gbe(_),L={root:{ownerState:F},input:{ownerState:F}},X=M??b?pa(L,M??b):L,ee=(c=(d=V.root)!=null?d:v.Root)!=null?c:Hbe,ce=(h=(f=V.input)!=null?f:v.Input)!=null?h:zbe;return T.jsx(oU,_e({slots:{root:ee,input:ce},componentsProps:X,fullWidth:A,inputComponent:w,multiline:x,ref:o,type:G},H,{classes:B}))});$Y.muiName="Input";const GY=$Y;function Kbe(t){return zn("MuiFormControl",t)}Vn("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Ybe=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],qbe=t=>{const{classes:r,margin:o,fullWidth:c}=t,d={root:["root",o!=="none"&&`margin${Gt(o)}`,c&&"fullWidth"]};return Qn(d,Kbe,r)},Xbe=Rt("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},r)=>_e({},r.root,r[`margin${Gt(t.margin)}`],t.fullWidth&&r.fullWidth)})(({ownerState:t})=>_e({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),Jbe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiFormControl"}),{children:d,className:h,color:f="primary",component:_="div",disabled:v=!1,error:b=!1,focused:A,fullWidth:w=!1,hiddenLabel:x=!1,margin:M="none",required:V=!1,size:G="medium",variant:H="outlined"}=c,F=jt(c,Ybe),B=_e({},c,{color:f,component:_,disabled:v,error:b,fullWidth:w,hiddenLabel:x,margin:M,required:V,size:G,variant:H}),L=qbe(B),[X,ee]=K.useState(()=>{let Ee=!1;return d&&K.Children.forEach(d,we=>{if(!dw(we,["Input","Select"]))return;const Re=dw(we,["Select"])?we.props.input:we;Re&&tSe(Re.props)&&(Ee=!0)}),Ee}),[ce,ie]=K.useState(()=>{let Ee=!1;return d&&K.Children.forEach(d,we=>{dw(we,["Input","Select"])&&(nR(we.props,!0)||nR(we.props.inputProps,!0))&&(Ee=!0)}),Ee}),[ne,fe]=K.useState(!1);v&&ne&&fe(!1);const oe=A!==void 0&&!v?A:ne;let ue;const Ne=K.useMemo(()=>({adornedStart:X,setAdornedStart:ee,color:f,disabled:v,error:b,filled:ce,focused:oe,fullWidth:w,hiddenLabel:x,size:G,onBlur:()=>{fe(!1)},onEmpty:()=>{ie(!1)},onFilled:()=>{ie(!0)},onFocus:()=>{fe(!0)},registerEffect:ue,required:V,variant:H}),[X,f,v,b,ce,oe,w,x,ue,V,G,H]);return T.jsx(sU.Provider,{value:Ne,children:T.jsx(Xbe,_e({as:_,ownerState:B,className:Wt(L.root,h),ref:o},F,{children:d}))})}),Qbe=Jbe;function Zbe(t){return zn("MuiFormHelperText",t)}const eTe=Vn("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),EG=eTe;var vG;const tTe=["children","className","component","disabled","error","filled","focused","margin","required","variant"],nTe=t=>{const{classes:r,contained:o,size:c,disabled:d,error:h,filled:f,focused:_,required:v}=t,b={root:["root",d&&"disabled",h&&"error",c&&`size${Gt(c)}`,o&&"contained",_&&"focused",f&&"filled",v&&"required"]};return Qn(b,Zbe,r)},rTe=Rt("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.size&&r[`size${Gt(o.size)}`],o.contained&&r.contained,o.filled&&r.filled]}})(({theme:t,ownerState:r})=>_e({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${EG.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${EG.error}`]:{color:(t.vars||t).palette.error.main}},r.size==="small"&&{marginTop:4},r.contained&&{marginLeft:14,marginRight:14})),iTe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiFormHelperText"}),{children:d,className:h,component:f="p"}=c,_=jt(c,tTe),v=c_(),b=a_({props:c,muiFormControl:v,states:["variant","size","disabled","error","filled","focused","required"]}),A=_e({},c,{component:f,contained:b.variant==="filled"||b.variant==="outlined",variant:b.variant,size:b.size,disabled:b.disabled,error:b.error,filled:b.filled,focused:b.focused,required:b.required}),w=nTe(A);return T.jsx(rTe,_e({as:f,ownerState:A,className:Wt(w.root,h),ref:o},_,{children:d===" "?vG||(vG=T.jsx("span",{className:"notranslate",children:"​"})):d}))}),sTe=iTe;function oTe(t){return zn("MuiFormLabel",t)}const aTe=Vn("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),ay=aTe,cTe=["children","className","color","component","disabled","error","filled","focused","required"],lTe=t=>{const{classes:r,color:o,focused:c,disabled:d,error:h,filled:f,required:_}=t,v={root:["root",`color${Gt(o)}`,d&&"disabled",h&&"error",f&&"filled",c&&"focused",_&&"required"],asterisk:["asterisk",h&&"error"]};return Qn(v,oTe,r)},dTe=Rt("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},r)=>_e({},r.root,t.color==="secondary"&&r.colorSecondary,t.filled&&r.filled)})(({theme:t,ownerState:r})=>_e({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${ay.focused}`]:{color:(t.vars||t).palette[r.color].main},[`&.${ay.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${ay.error}`]:{color:(t.vars||t).palette.error.main}})),uTe=Rt("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,r)=>r.asterisk})(({theme:t})=>({[`&.${ay.error}`]:{color:(t.vars||t).palette.error.main}})),hTe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiFormLabel"}),{children:d,className:h,component:f="label"}=c,_=jt(c,cTe),v=c_(),b=a_({props:c,muiFormControl:v,states:["color","required","focused","disabled","error","filled"]}),A=_e({},c,{color:b.color||"primary",component:f,disabled:b.disabled,error:b.error,filled:b.filled,focused:b.focused,required:b.required}),w=lTe(A);return T.jsxs(dTe,_e({as:f,ownerState:A,className:Wt(w.root,h),ref:o},_,{children:[d,b.required&&T.jsxs(uTe,{ownerState:A,"aria-hidden":!0,className:w.asterisk,children:[" ","*"]})]}))}),pTe=hTe,fTe=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function jL(t){return`scale(${t}, ${t**2})`}const mTe={entering:{opacity:1,transform:jL(1)},entered:{opacity:1,transform:"none"}},wP=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),HY=K.forwardRef(function(r,o){const{addEndListener:c,appear:d=!0,children:h,easing:f,in:_,onEnter:v,onEntered:b,onEntering:A,onExit:w,onExited:x,onExiting:M,style:V,timeout:G="auto",TransitionComponent:H=PY}=r,F=jt(r,fTe),B=EY(),L=K.useRef(),X=CI(),ee=K.useRef(null),ce=Es(ee,h.ref,o),ie=Re=>Pe=>{if(Re){const $e=ee.current;Pe===void 0?Re($e):Re($e,Pe)}},ne=ie(A),fe=ie((Re,Pe)=>{DY(Re);const{duration:$e,delay:Ce,easing:Fe}=eR({style:V,timeout:G,easing:f},{mode:"enter"});let Ye;G==="auto"?(Ye=X.transitions.getAutoHeightDuration(Re.clientHeight),L.current=Ye):Ye=$e,Re.style.transition=[X.transitions.create("opacity",{duration:Ye,delay:Ce}),X.transitions.create("transform",{duration:wP?Ye:Ye*.666,delay:Ce,easing:Fe})].join(","),v&&v(Re,Pe)}),oe=ie(b),ue=ie(M),Ne=ie(Re=>{const{duration:Pe,delay:$e,easing:Ce}=eR({style:V,timeout:G,easing:f},{mode:"exit"});let Fe;G==="auto"?(Fe=X.transitions.getAutoHeightDuration(Re.clientHeight),L.current=Fe):Fe=Pe,Re.style.transition=[X.transitions.create("opacity",{duration:Fe,delay:$e}),X.transitions.create("transform",{duration:wP?Fe:Fe*.666,delay:wP?$e:$e||Fe*.333,easing:Ce})].join(","),Re.style.opacity=0,Re.style.transform=jL(.75),w&&w(Re)}),Ee=ie(x),we=Re=>{G==="auto"&&B.start(L.current||0,Re),c&&c(ee.current,Re)};return T.jsx(H,_e({appear:d,in:_,nodeRef:ee,onEnter:fe,onEntered:oe,onEntering:ne,onExit:Ne,onExited:Ee,onExiting:ue,addEndListener:we,timeout:G==="auto"?null:G},F,{children:(Re,Pe)=>K.cloneElement(h,_e({style:_e({opacity:0,transform:jL(.75),visibility:Re==="exited"&&!_?"hidden":void 0},mTe[Re],V,h.props.style),ref:ce},Pe))}))});HY.muiSupportAuto=!0;const gTe=HY,_Te=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],ETe=t=>{const{classes:r,disableUnderline:o}=t,d=Qn({root:["root",!o&&"underline"],input:["input"]},cSe,r);return _e({},r,d)},vTe=Rt(FI,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[...UI(t,r),!o.disableUnderline&&r.underline]}})(({theme:t,ownerState:r})=>{let c=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(c=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),_e({position:"relative"},r.formControl&&{"label + &":{marginTop:16}},!r.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[r.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${kv.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${kv.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${c}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${kv.disabled}, .${kv.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${c}`}},[`&.${kv.disabled}:before`]:{borderBottomStyle:"dotted"}})}),yTe=Rt(VI,{name:"MuiInput",slot:"Input",overridesResolver:jI})({}),zY=K.forwardRef(function(r,o){var c,d,h,f;const _=Zn({props:r,name:"MuiInput"}),{disableUnderline:v,components:b={},componentsProps:A,fullWidth:w=!1,inputComponent:x="input",multiline:M=!1,slotProps:V,slots:G={},type:H="text"}=_,F=jt(_,_Te),B=ETe(_),X={root:{ownerState:{disableUnderline:v}}},ee=V??A?pa(V??A,X):X,ce=(c=(d=G.root)!=null?d:b.Root)!=null?c:vTe,ie=(h=(f=G.input)!=null?f:b.Input)!=null?h:yTe;return T.jsx(oU,_e({slots:{root:ce,input:ie},slotProps:ee,fullWidth:w,inputComponent:x,multiline:M,ref:o,type:H},F,{classes:B}))});zY.muiName="Input";const KY=zY;function STe(t){return zn("MuiInputLabel",t)}Vn("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const bTe=["disableAnimation","margin","shrink","variant","className"],TTe=t=>{const{classes:r,formControl:o,size:c,shrink:d,disableAnimation:h,variant:f,required:_}=t,v={root:["root",o&&"formControl",!h&&"animated",d&&"shrink",c&&c!=="normal"&&`size${Gt(c)}`,f],asterisk:[_&&"asterisk"]},b=Qn(v,STe,r);return _e({},r,b)},CTe=Rt(pTe,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[{[`& .${ay.asterisk}`]:r.asterisk},r.root,o.formControl&&r.formControl,o.size==="small"&&r.sizeSmall,o.shrink&&r.shrink,!o.disableAnimation&&r.animated,o.focused&&r.focused,r[o.variant]]}})(({theme:t,ownerState:r})=>_e({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},r.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},r.size==="small"&&{transform:"translate(0, 17px) scale(1)"},r.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!r.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},r.variant==="filled"&&_e({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},r.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},r.shrink&&_e({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},r.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),r.variant==="outlined"&&_e({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},r.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},r.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),wTe=K.forwardRef(function(r,o){const c=Zn({name:"MuiInputLabel",props:r}),{disableAnimation:d=!1,shrink:h,className:f}=c,_=jt(c,bTe),v=c_();let b=h;typeof b>"u"&&v&&(b=v.filled||v.focused||v.adornedStart);const A=a_({props:c,muiFormControl:v,states:["size","variant","required","focused"]}),w=_e({},c,{disableAnimation:d,formControl:v,shrink:b,size:A.size,variant:A.variant,required:A.required,focused:A.focused}),x=TTe(w);return T.jsx(CTe,_e({"data-shrink":b,ownerState:w,ref:o,className:Wt(x.root,f)},_,{classes:x}))}),RTe=wTe,ITe=K.createContext({}),ef=ITe;function ATe(t){return zn("MuiList",t)}Vn("MuiList",["root","padding","dense","subheader"]);const OTe=["children","className","component","dense","disablePadding","subheader"],NTe=t=>{const{classes:r,disablePadding:o,dense:c,subheader:d}=t;return Qn({root:["root",!o&&"padding",c&&"dense",d&&"subheader"]},ATe,r)},kTe=Rt("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,!o.disablePadding&&r.padding,o.dense&&r.dense,o.subheader&&r.subheader]}})(({ownerState:t})=>_e({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),xTe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiList"}),{children:d,className:h,component:f="ul",dense:_=!1,disablePadding:v=!1,subheader:b}=c,A=jt(c,OTe),w=K.useMemo(()=>({dense:_}),[_]),x=_e({},c,{component:f,dense:_,disablePadding:v}),M=NTe(x);return T.jsx(ef.Provider,{value:w,children:T.jsxs(kTe,_e({as:f,className:Wt(M.root,h),ref:o,ownerState:x},A,{children:[b,d]}))})}),YY=xTe;function PTe(t){return zn("MuiListItemButton",t)}const DTe=Vn("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),xv=DTe,LTe=["alignItems","autoFocus","component","children","dense","disableGutters","divider","focusVisibleClassName","selected","className"],MTe=(t,r)=>{const{ownerState:o}=t;return[r.root,o.dense&&r.dense,o.alignItems==="flex-start"&&r.alignItemsFlexStart,o.divider&&r.divider,!o.disableGutters&&r.gutters]},UTe=t=>{const{alignItems:r,classes:o,dense:c,disabled:d,disableGutters:h,divider:f,selected:_}=t,b=Qn({root:["root",c&&"dense",!h&&"gutters",f&&"divider",d&&"disabled",r==="flex-start"&&"alignItemsFlexStart",_&&"selected"]},PTe,o);return _e({},o,b)},jTe=Rt(iU,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:MTe})(({theme:t,ownerState:r})=>_e({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${xv.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:jo(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${xv.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:jo(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${xv.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:jo(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:jo(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${xv.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${xv.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},r.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},r.alignItems==="flex-start"&&{alignItems:"flex-start"},!r.disableGutters&&{paddingLeft:16,paddingRight:16},r.dense&&{paddingTop:4,paddingBottom:4})),FTe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiListItemButton"}),{alignItems:d="center",autoFocus:h=!1,component:f="div",children:_,dense:v=!1,disableGutters:b=!1,divider:A=!1,focusVisibleClassName:w,selected:x=!1,className:M}=c,V=jt(c,LTe),G=K.useContext(ef),H=K.useMemo(()=>({dense:v||G.dense||!1,alignItems:d,disableGutters:b}),[d,G.dense,v,b]),F=K.useRef(null);Ml(()=>{h&&F.current&&F.current.focus()},[h]);const B=_e({},c,{alignItems:d,dense:H.dense,disableGutters:b,divider:A,selected:x}),L=UTe(B),X=Es(F,o);return T.jsx(ef.Provider,{value:H,children:T.jsx(jTe,_e({ref:X,href:V.href||V.to,component:(V.href||V.to)&&f==="div"?"button":f,focusVisibleClassName:Wt(L.focusVisible,w),ownerState:B,className:Wt(L.root,M)},V,{classes:L,children:_}))})}),RP=FTe;function VTe(t){return zn("MuiListItemIcon",t)}const BTe=Vn("MuiListItemIcon",["root","alignItemsFlexStart"]),yG=BTe,WTe=["className"],$Te=t=>{const{alignItems:r,classes:o}=t;return Qn({root:["root",r==="flex-start"&&"alignItemsFlexStart"]},VTe,o)},GTe=Rt("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.alignItems==="flex-start"&&r.alignItemsFlexStart]}})(({theme:t,ownerState:r})=>_e({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex"},r.alignItems==="flex-start"&&{marginTop:8})),HTe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiListItemIcon"}),{className:d}=c,h=jt(c,WTe),f=K.useContext(ef),_=_e({},c,{alignItems:f.alignItems}),v=$Te(_);return T.jsx(GTe,_e({className:Wt(v.root,d),ownerState:_,ref:o},h))}),IP=HTe;function zTe(t){return zn("MuiListItemText",t)}const KTe=Vn("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),rR=KTe,YTe=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],qTe=t=>{const{classes:r,inset:o,primary:c,secondary:d,dense:h}=t;return Qn({root:["root",o&&"inset",h&&"dense",c&&d&&"multiline"],primary:["primary"],secondary:["secondary"]},zTe,r)},XTe=Rt("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[{[`& .${rR.primary}`]:r.primary},{[`& .${rR.secondary}`]:r.secondary},r.root,o.inset&&r.inset,o.primary&&o.secondary&&r.multiline,o.dense&&r.dense]}})(({ownerState:t})=>_e({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},t.primary&&t.secondary&&{marginTop:6,marginBottom:6},t.inset&&{paddingLeft:56})),JTe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiListItemText"}),{children:d,className:h,disableTypography:f=!1,inset:_=!1,primary:v,primaryTypographyProps:b,secondary:A,secondaryTypographyProps:w}=c,x=jt(c,YTe),{dense:M}=K.useContext(ef);let V=v??d,G=A;const H=_e({},c,{disableTypography:f,inset:_,primary:!!V,secondary:!!G,dense:M}),F=qTe(H);return V!=null&&V.type!==ag&&!f&&(V=T.jsx(ag,_e({variant:M?"body2":"body1",className:F.primary,component:b!=null&&b.variant?void 0:"span",display:"block"},b,{children:V}))),G!=null&&G.type!==ag&&!f&&(G=T.jsx(ag,_e({variant:"body2",className:F.secondary,color:"text.secondary",display:"block"},w,{children:G}))),T.jsxs(XTe,_e({className:Wt(F.root,h),ownerState:H,ref:o},x,{children:[V,G]}))}),AP=JTe,QTe=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function OP(t,r,o){return t===r?t.firstChild:r&&r.nextElementSibling?r.nextElementSibling:o?null:t.firstChild}function SG(t,r,o){return t===r?o?t.firstChild:t.lastChild:r&&r.previousElementSibling?r.previousElementSibling:o?null:t.lastChild}function qY(t,r){if(r===void 0)return!0;let o=t.innerText;return o===void 0&&(o=t.textContent),o=o.trim().toLowerCase(),o.length===0?!1:r.repeating?o[0]===r.keys[0]:o.indexOf(r.keys.join(""))===0}function Pv(t,r,o,c,d,h){let f=!1,_=d(t,r,r?o:!1);for(;_;){if(_===t.firstChild){if(f)return!1;f=!0}const v=c?!1:_.disabled||_.getAttribute("aria-disabled")==="true";if(!_.hasAttribute("tabindex")||!qY(_,h)||v)_=d(t,_,o);else return _.focus(),!0}return!1}const ZTe=K.forwardRef(function(r,o){const{actions:c,autoFocus:d=!1,autoFocusItem:h=!1,children:f,className:_,disabledItemsFocusable:v=!1,disableListWrap:b=!1,onKeyDown:A,variant:w="selectedMenu"}=r,x=jt(r,QTe),M=K.useRef(null),V=K.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Ml(()=>{d&&M.current.focus()},[d]),K.useImperativeHandle(c,()=>({adjustStyleForScrollbar:(L,X)=>{const ee=!M.current.style.width;if(L.clientHeight<M.current.clientHeight&&ee){const ce=`${yY(Wo(L))}px`;M.current.style[X.direction==="rtl"?"paddingLeft":"paddingRight"]=ce,M.current.style.width=`calc(100% + ${ce})`}return M.current}}),[]);const G=L=>{const X=M.current,ee=L.key,ce=Wo(X).activeElement;if(ee==="ArrowDown")L.preventDefault(),Pv(X,ce,b,v,OP);else if(ee==="ArrowUp")L.preventDefault(),Pv(X,ce,b,v,SG);else if(ee==="Home")L.preventDefault(),Pv(X,null,b,v,OP);else if(ee==="End")L.preventDefault(),Pv(X,null,b,v,SG);else if(ee.length===1){const ie=V.current,ne=ee.toLowerCase(),fe=performance.now();ie.keys.length>0&&(fe-ie.lastTime>500?(ie.keys=[],ie.repeating=!0,ie.previousKeyMatched=!0):ie.repeating&&ne!==ie.keys[0]&&(ie.repeating=!1)),ie.lastTime=fe,ie.keys.push(ne);const oe=ce&&!ie.repeating&&qY(ce,ie);ie.previousKeyMatched&&(oe||Pv(X,ce,!1,v,OP,ie))?L.preventDefault():ie.previousKeyMatched=!1}A&&A(L)},H=Es(M,o);let F=-1;K.Children.forEach(f,(L,X)=>{if(!K.isValidElement(L)){F===X&&(F+=1,F>=f.length&&(F=-1));return}L.props.disabled||(w==="selectedMenu"&&L.props.selected||F===-1)&&(F=X),F===X&&(L.props.disabled||L.props.muiSkipListHighlight||L.type.muiSkipListHighlight)&&(F+=1,F>=f.length&&(F=-1))});const B=K.Children.map(f,(L,X)=>{if(X===F){const ee={};return h&&(ee.autoFocus=!0),L.props.tabIndex===void 0&&w==="selectedMenu"&&(ee.tabIndex=0),K.cloneElement(L,ee)}return L});return T.jsx(YY,_e({role:"menu",ref:H,className:_,onKeyDown:G,tabIndex:d?0:-1},x,{children:B}))}),eCe=ZTe;function tCe(t){return zn("MuiPopover",t)}Vn("MuiPopover",["root","paper"]);const nCe=["onEntering"],rCe=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],iCe=["slotProps"];function bG(t,r){let o=0;return typeof r=="number"?o=r:r==="center"?o=t.height/2:r==="bottom"&&(o=t.height),o}function TG(t,r){let o=0;return typeof r=="number"?o=r:r==="center"?o=t.width/2:r==="right"&&(o=t.width),o}function CG(t){return[t.horizontal,t.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function NP(t){return typeof t=="function"?t():t}const sCe=t=>{const{classes:r}=t;return Qn({root:["root"],paper:["paper"]},tCe,r)},oCe=Rt(BY,{name:"MuiPopover",slot:"Root",overridesResolver:(t,r)=>r.root})({}),XY=Rt(rU,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,r)=>r.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),aCe=K.forwardRef(function(r,o){var c,d,h;const f=Zn({props:r,name:"MuiPopover"}),{action:_,anchorEl:v,anchorOrigin:b={vertical:"top",horizontal:"left"},anchorPosition:A,anchorReference:w="anchorEl",children:x,className:M,container:V,elevation:G=8,marginThreshold:H=16,open:F,PaperProps:B={},slots:L,slotProps:X,transformOrigin:ee={vertical:"top",horizontal:"left"},TransitionComponent:ce=gTe,transitionDuration:ie="auto",TransitionProps:{onEntering:ne}={},disableScrollLock:fe=!1}=f,oe=jt(f.TransitionProps,nCe),ue=jt(f,rCe),Ne=(c=X==null?void 0:X.paper)!=null?c:B,Ee=K.useRef(),we=Es(Ee,Ne.ref),Re=_e({},f,{anchorOrigin:b,anchorReference:w,elevation:G,marginThreshold:H,externalPaperSlotProps:Ne,transformOrigin:ee,TransitionComponent:ce,transitionDuration:ie,TransitionProps:oe}),Pe=sCe(Re),$e=K.useCallback(()=>{if(w==="anchorPosition")return A;const Ht=NP(v),rt=(Ht&&Ht.nodeType===1?Ht:Wo(Ee.current).body).getBoundingClientRect();return{top:rt.top+bG(rt,b.vertical),left:rt.left+TG(rt,b.horizontal)}},[v,b.horizontal,b.vertical,A,w]),Ce=K.useCallback(Ht=>({vertical:bG(Ht,ee.vertical),horizontal:TG(Ht,ee.horizontal)}),[ee.horizontal,ee.vertical]),Fe=K.useCallback(Ht=>{const on={width:Ht.offsetWidth,height:Ht.offsetHeight},rt=Ce(on);if(w==="none")return{top:null,left:null,transformOrigin:CG(rt)};const _n=$e();let Kn=_n.top-rt.vertical,En=_n.left-rt.horizontal;const fi=Kn+on.height,fr=En+on.width,Ft=Rh(NP(v)),mr=Ft.innerHeight-H,Hr=Ft.innerWidth-H;if(H!==null&&Kn<H){const Mn=Kn-H;Kn-=Mn,rt.vertical+=Mn}else if(H!==null&&fi>mr){const Mn=fi-mr;Kn-=Mn,rt.vertical+=Mn}if(H!==null&&En<H){const Mn=En-H;En-=Mn,rt.horizontal+=Mn}else if(fr>Hr){const Mn=fr-Hr;En-=Mn,rt.horizontal+=Mn}return{top:`${Math.round(Kn)}px`,left:`${Math.round(En)}px`,transformOrigin:CG(rt)}},[v,w,$e,Ce,H]),[Ye,Mt]=K.useState(F),yt=K.useCallback(()=>{const Ht=Ee.current;if(!Ht)return;const on=Fe(Ht);on.top!==null&&(Ht.style.top=on.top),on.left!==null&&(Ht.style.left=on.left),Ht.style.transformOrigin=on.transformOrigin,Mt(!0)},[Fe]);K.useEffect(()=>(fe&&window.addEventListener("scroll",yt),()=>window.removeEventListener("scroll",yt)),[v,fe,yt]);const Xt=(Ht,on)=>{ne&&ne(Ht,on),yt()},Ue=()=>{Mt(!1)};K.useEffect(()=>{F&&yt()}),K.useImperativeHandle(_,()=>F?{updatePosition:()=>{yt()}}:null,[F,yt]),K.useEffect(()=>{if(!F)return;const Ht=YM(()=>{yt()}),on=Rh(v);return on.addEventListener("resize",Ht),()=>{Ht.clear(),on.removeEventListener("resize",Ht)}},[v,F,yt]);let Be=ie;ie==="auto"&&!ce.muiSupportAuto&&(Be=void 0);const at=V||(v?Wo(NP(v)).body:void 0),Jt=(d=L==null?void 0:L.root)!=null?d:oCe,un=(h=L==null?void 0:L.paper)!=null?h:XY,Ut=Ih({elementType:un,externalSlotProps:_e({},Ne,{style:Ye?Ne.style:_e({},Ne.style,{opacity:0})}),additionalProps:{elevation:G,ref:we},ownerState:Re,className:Wt(Pe.paper,Ne==null?void 0:Ne.className)}),Gr=Ih({elementType:Jt,externalSlotProps:(X==null?void 0:X.root)||{},externalForwardedProps:ue,additionalProps:{ref:o,slotProps:{backdrop:{invisible:!0}},container:at,open:F},ownerState:Re,className:Wt(Pe.root,M)}),{slotProps:sn}=Gr,hn=jt(Gr,iCe);return T.jsx(Jt,_e({},hn,!tR(Jt)&&{slotProps:sn,disableScrollLock:fe},{children:T.jsx(ce,_e({appear:!0,in:F,onEntering:Xt,onExited:Ue,timeout:Be},oe,{children:T.jsx(un,_e({},Ut,{children:x}))}))}))}),cCe=aCe;function lCe(t){return zn("MuiMenu",t)}Vn("MuiMenu",["root","paper","list"]);const dCe=["onEntering"],uCe=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],hCe={vertical:"top",horizontal:"right"},pCe={vertical:"top",horizontal:"left"},fCe=t=>{const{classes:r}=t;return Qn({root:["root"],paper:["paper"],list:["list"]},lCe,r)},mCe=Rt(cCe,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,r)=>r.root})({}),gCe=Rt(XY,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,r)=>r.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),_Ce=Rt(eCe,{name:"MuiMenu",slot:"List",overridesResolver:(t,r)=>r.list})({outline:0}),ECe=K.forwardRef(function(r,o){var c,d;const h=Zn({props:r,name:"MuiMenu"}),{autoFocus:f=!0,children:_,className:v,disableAutoFocusItem:b=!1,MenuListProps:A={},onClose:w,open:x,PaperProps:M={},PopoverClasses:V,transitionDuration:G="auto",TransitionProps:{onEntering:H}={},variant:F="selectedMenu",slots:B={},slotProps:L={}}=h,X=jt(h.TransitionProps,dCe),ee=jt(h,uCe),ce=CI(),ie=ce.direction==="rtl",ne=_e({},h,{autoFocus:f,disableAutoFocusItem:b,MenuListProps:A,onEntering:H,PaperProps:M,transitionDuration:G,TransitionProps:X,variant:F}),fe=fCe(ne),oe=f&&!b&&x,ue=K.useRef(null),Ne=(Fe,Ye)=>{ue.current&&ue.current.adjustStyleForScrollbar(Fe,ce),H&&H(Fe,Ye)},Ee=Fe=>{Fe.key==="Tab"&&(Fe.preventDefault(),w&&w(Fe,"tabKeyDown"))};let we=-1;K.Children.map(_,(Fe,Ye)=>{K.isValidElement(Fe)&&(Fe.props.disabled||(F==="selectedMenu"&&Fe.props.selected||we===-1)&&(we=Ye))});const Re=(c=B.paper)!=null?c:gCe,Pe=(d=L.paper)!=null?d:M,$e=Ih({elementType:B.root,externalSlotProps:L.root,ownerState:ne,className:[fe.root,v]}),Ce=Ih({elementType:Re,externalSlotProps:Pe,ownerState:ne,className:fe.paper});return T.jsx(mCe,_e({onClose:w,anchorOrigin:{vertical:"bottom",horizontal:ie?"right":"left"},transformOrigin:ie?hCe:pCe,slots:{paper:Re,root:B.root},slotProps:{root:$e,paper:Ce},open:x,ref:o,transitionDuration:G,TransitionProps:_e({onEntering:Ne},X),ownerState:ne},ee,{classes:V,children:T.jsx(_Ce,_e({onKeyDown:Ee,actions:ue,autoFocus:f&&(we===-1||b),autoFocusItem:oe,variant:F},A,{className:Wt(fe.list,A.className),children:_}))}))}),JY=ECe;function vCe(t){return zn("MuiMenuItem",t)}const yCe=Vn("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Dv=yCe,SCe=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],bCe=(t,r)=>{const{ownerState:o}=t;return[r.root,o.dense&&r.dense,o.divider&&r.divider,!o.disableGutters&&r.gutters]},TCe=t=>{const{disabled:r,dense:o,divider:c,disableGutters:d,selected:h,classes:f}=t,v=Qn({root:["root",o&&"dense",r&&"disabled",!d&&"gutters",c&&"divider",h&&"selected"]},vCe,f);return _e({},f,v)},CCe=Rt(iU,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:bCe})(({theme:t,ownerState:r})=>_e({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!r.disableGutters&&{paddingLeft:16,paddingRight:16},r.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Dv.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:jo(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${Dv.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:jo(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${Dv.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:jo(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:jo(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${Dv.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Dv.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${_G.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${_G.inset}`]:{marginLeft:52},[`& .${rR.root}`]:{marginTop:0,marginBottom:0},[`& .${rR.inset}`]:{paddingLeft:36},[`& .${yG.root}`]:{minWidth:36}},!r.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},r.dense&&_e({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${yG.root} svg`]:{fontSize:"1.25rem"}}))),wCe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiMenuItem"}),{autoFocus:d=!1,component:h="li",dense:f=!1,divider:_=!1,disableGutters:v=!1,focusVisibleClassName:b,role:A="menuitem",tabIndex:w,className:x}=c,M=jt(c,SCe),V=K.useContext(ef),G=K.useMemo(()=>({dense:f||V.dense||!1,disableGutters:v}),[V.dense,f,v]),H=K.useRef(null);Ml(()=>{d&&H.current&&H.current.focus()},[d]);const F=_e({},c,{dense:G.dense,divider:_,disableGutters:v}),B=TCe(c),L=Es(H,o);let X;return c.disabled||(X=w!==void 0?w:-1),T.jsx(ef.Provider,{value:G,children:T.jsx(CCe,_e({ref:L,role:A,tabIndex:X,component:h,focusVisibleClassName:Wt(B.focusVisible,b),className:Wt(B.root,x)},M,{ownerState:F,classes:B}))})}),Hv=wCe;function RCe(t){return zn("MuiNativeSelect",t)}const ICe=Vn("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),cU=ICe,ACe=["className","disabled","error","IconComponent","inputRef","variant"],OCe=t=>{const{classes:r,variant:o,disabled:c,multiple:d,open:h,error:f}=t,_={select:["select",o,c&&"disabled",d&&"multiple",f&&"error"],icon:["icon",`icon${Gt(o)}`,h&&"iconOpen",c&&"disabled"]};return Qn(_,RCe,r)},QY=({ownerState:t,theme:r})=>_e({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":_e({},r.vars?{backgroundColor:`rgba(${r.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:r.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${cU.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(r.vars||r).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(r.vars||r).shape.borderRadius,"&:focus":{borderRadius:(r.vars||r).shape.borderRadius},"&&&":{paddingRight:32}}),NCe=Rt("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Go,overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.select,r[o.variant],o.error&&r.error,{[`&.${cU.multiple}`]:r.multiple}]}})(QY),ZY=({ownerState:t,theme:r})=>_e({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(r.vars||r).palette.action.active,[`&.${cU.disabled}`]:{color:(r.vars||r).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),kCe=Rt("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.icon,o.variant&&r[`icon${Gt(o.variant)}`],o.open&&r.iconOpen]}})(ZY),xCe=K.forwardRef(function(r,o){const{className:c,disabled:d,error:h,IconComponent:f,inputRef:_,variant:v="standard"}=r,b=jt(r,ACe),A=_e({},r,{disabled:d,variant:v,error:h}),w=OCe(A);return T.jsxs(K.Fragment,{children:[T.jsx(NCe,_e({ownerState:A,className:Wt(w.select,c),disabled:d,ref:_||o},b)),r.multiple?null:T.jsx(kCe,{as:f,ownerState:A,className:w.icon})]})}),PCe=xCe;var wG;const DCe=["children","classes","className","label","notched"],LCe=Rt("fieldset",{shouldForwardProp:Go})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),MCe=Rt("legend",{shouldForwardProp:Go})(({ownerState:t,theme:r})=>_e({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:r.transitions.create("width",{duration:150,easing:r.transitions.easing.easeOut})},t.withLabel&&_e({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:r.transitions.create("max-width",{duration:50,easing:r.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:r.transitions.create("max-width",{duration:100,easing:r.transitions.easing.easeOut,delay:50})})));function UCe(t){const{className:r,label:o,notched:c}=t,d=jt(t,DCe),h=o!=null&&o!=="",f=_e({},t,{notched:c,withLabel:h});return T.jsx(LCe,_e({"aria-hidden":!0,className:r,ownerState:f},d,{children:T.jsx(MCe,{ownerState:f,children:h?T.jsx("span",{children:o}):wG||(wG=T.jsx("span",{className:"notranslate",children:"​"}))})}))}const jCe=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],FCe=t=>{const{classes:r}=t,c=Qn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},dSe,r);return _e({},r,c)},VCe=Rt(FI,{shouldForwardProp:t=>Go(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:UI})(({theme:t,ownerState:r})=>{const o=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return _e({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${$u.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${$u.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:o}},[`&.${$u.focused} .${$u.notchedOutline}`]:{borderColor:(t.vars||t).palette[r.color].main,borderWidth:2},[`&.${$u.error} .${$u.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${$u.disabled} .${$u.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},r.startAdornment&&{paddingLeft:14},r.endAdornment&&{paddingRight:14},r.multiline&&_e({padding:"16.5px 14px"},r.size==="small"&&{padding:"8.5px 14px"}))}),BCe=Rt(UCe,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,r)=>r.notchedOutline})(({theme:t})=>{const r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:r}}),WCe=Rt(VI,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:jI})(({theme:t,ownerState:r})=>_e({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},r.size==="small"&&{padding:"8.5px 14px"},r.multiline&&{padding:0},r.startAdornment&&{paddingLeft:0},r.endAdornment&&{paddingRight:0})),eq=K.forwardRef(function(r,o){var c,d,h,f,_;const v=Zn({props:r,name:"MuiOutlinedInput"}),{components:b={},fullWidth:A=!1,inputComponent:w="input",label:x,multiline:M=!1,notched:V,slots:G={},type:H="text"}=v,F=jt(v,jCe),B=FCe(v),L=c_(),X=a_({props:v,muiFormControl:L,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),ee=_e({},v,{color:X.color||"primary",disabled:X.disabled,error:X.error,focused:X.focused,formControl:L,fullWidth:A,hiddenLabel:X.hiddenLabel,multiline:M,size:X.size,type:H}),ce=(c=(d=G.root)!=null?d:b.Root)!=null?c:VCe,ie=(h=(f=G.input)!=null?f:b.Input)!=null?h:WCe;return T.jsx(oU,_e({slots:{root:ce,input:ie},renderSuffix:ne=>T.jsx(BCe,{ownerState:ee,className:B.notchedOutline,label:x!=null&&x!==""&&X.required?_||(_=T.jsxs(K.Fragment,{children:[x," ","*"]})):x,notched:typeof V<"u"?V:!!(ne.startAdornment||ne.filled||ne.focused)}),fullWidth:A,inputComponent:w,multiline:M,ref:o,type:H},F,{classes:_e({},B,{notchedOutline:null})}))});eq.muiName="Input";const tq=eq;function $Ce(t){return zn("MuiSelect",t)}const Lv=Vn("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var RG;const GCe=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],HCe=Rt("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[{[`&.${Lv.select}`]:r.select},{[`&.${Lv.select}`]:r[o.variant]},{[`&.${Lv.error}`]:r.error},{[`&.${Lv.multiple}`]:r.multiple}]}})(QY,{[`&.${Lv.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),zCe=Rt("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.icon,o.variant&&r[`icon${Gt(o.variant)}`],o.open&&r.iconOpen]}})(ZY),KCe=Rt("input",{shouldForwardProp:t=>Dye(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,r)=>r.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function IG(t,r){return typeof r=="object"&&r!==null?t===r:String(t)===String(r)}function YCe(t){return t==null||typeof t=="string"&&!t.trim()}const qCe=t=>{const{classes:r,variant:o,disabled:c,multiple:d,open:h,error:f}=t,_={select:["select",o,c&&"disabled",d&&"multiple",f&&"error"],icon:["icon",`icon${Gt(o)}`,h&&"iconOpen",c&&"disabled"],nativeInput:["nativeInput"]};return Qn(_,$Ce,r)},XCe=K.forwardRef(function(r,o){var c;const{"aria-describedby":d,"aria-label":h,autoFocus:f,autoWidth:_,children:v,className:b,defaultOpen:A,defaultValue:w,disabled:x,displayEmpty:M,error:V=!1,IconComponent:G,inputRef:H,labelId:F,MenuProps:B={},multiple:L,name:X,onBlur:ee,onChange:ce,onClose:ie,onFocus:ne,onOpen:fe,open:oe,readOnly:ue,renderValue:Ne,SelectDisplayProps:Ee={},tabIndex:we,value:Re,variant:Pe="standard"}=r,$e=jt(r,GCe),[Ce,Fe]=kL({controlled:Re,default:w,name:"Select"}),[Ye,Mt]=kL({controlled:oe,default:A,name:"Select"}),yt=K.useRef(null),Xt=K.useRef(null),[Ue,Be]=K.useState(null),{current:at}=K.useRef(oe!=null),[Jt,un]=K.useState(),Ut=Es(o,H),Gr=K.useCallback(bt=>{Xt.current=bt,bt&&Be(bt)},[]),sn=Ue==null?void 0:Ue.parentNode;K.useImperativeHandle(Ut,()=>({focus:()=>{Xt.current.focus()},node:yt.current,value:Ce}),[Ce]),K.useEffect(()=>{A&&Ye&&Ue&&!at&&(un(_?null:sn.clientWidth),Xt.current.focus())},[Ue,_]),K.useEffect(()=>{f&&Xt.current.focus()},[f]),K.useEffect(()=>{if(!F)return;const bt=Wo(Xt.current).getElementById(F);if(bt){const nn=()=>{getSelection().isCollapsed&&Xt.current.focus()};return bt.addEventListener("click",nn),()=>{bt.removeEventListener("click",nn)}}},[F]);const hn=(bt,nn)=>{bt?fe&&fe(nn):ie&&ie(nn),at||(un(_?null:sn.clientWidth),Mt(bt))},Ht=bt=>{bt.button===0&&(bt.preventDefault(),Xt.current.focus(),hn(!0,bt))},on=bt=>{hn(!1,bt)},rt=K.Children.toArray(v),_n=bt=>{const nn=rt.find(Tn=>Tn.props.value===bt.target.value);nn!==void 0&&(Fe(nn.props.value),ce&&ce(bt,nn))},Kn=bt=>nn=>{let Tn;if(nn.currentTarget.hasAttribute("tabindex")){if(L){Tn=Array.isArray(Ce)?Ce.slice():[];const mi=Ce.indexOf(bt.props.value);mi===-1?Tn.push(bt.props.value):Tn.splice(mi,1)}else Tn=bt.props.value;if(bt.props.onClick&&bt.props.onClick(nn),Ce!==Tn&&(Fe(Tn),ce)){const mi=nn.nativeEvent||nn,ac=new mi.constructor(mi.type,mi);Object.defineProperty(ac,"target",{writable:!0,value:{value:Tn,name:X}}),ce(ac,bt)}L||hn(!1,nn)}},En=bt=>{ue||[" ","ArrowUp","ArrowDown","Enter"].indexOf(bt.key)!==-1&&(bt.preventDefault(),hn(!0,bt))},fi=Ue!==null&&Ye,fr=bt=>{!fi&&ee&&(Object.defineProperty(bt,"target",{writable:!0,value:{value:Ce,name:X}}),ee(bt))};delete $e["aria-invalid"];let Ft,mr;const Hr=[];let Mn=!1;(nR({value:Ce})||M)&&(Ne?Ft=Ne(Ce):Mn=!0);const Wi=rt.map(bt=>{if(!K.isValidElement(bt))return null;let nn;if(L){if(!Array.isArray(Ce))throw new Error(jd(2));nn=Ce.some(Tn=>IG(Tn,bt.props.value)),nn&&Mn&&Hr.push(bt.props.children)}else nn=IG(Ce,bt.props.value),nn&&Mn&&(mr=bt.props.children);return K.cloneElement(bt,{"aria-selected":nn?"true":"false",onClick:Kn(bt),onKeyUp:Tn=>{Tn.key===" "&&Tn.preventDefault(),bt.props.onKeyUp&&bt.props.onKeyUp(Tn)},role:"option",selected:nn,value:void 0,"data-value":bt.props.value})});Mn&&(L?Hr.length===0?Ft=null:Ft=Hr.reduce((bt,nn,Tn)=>(bt.push(nn),Tn<Hr.length-1&&bt.push(", "),bt),[]):Ft=mr);let lr=Jt;!_&&at&&Ue&&(lr=sn.clientWidth);let Yn;typeof we<"u"?Yn=we:Yn=x?null:0;const an=Ee.id||(X?`mui-component-select-${X}`:void 0),It=_e({},r,{variant:Pe,value:Ce,open:fi,error:V}),ot=qCe(It),tn=_e({},B.PaperProps,(c=B.slotProps)==null?void 0:c.paper),$i=yI();return T.jsxs(K.Fragment,{children:[T.jsx(HCe,_e({ref:Gr,tabIndex:Yn,role:"combobox","aria-controls":$i,"aria-disabled":x?"true":void 0,"aria-expanded":fi?"true":"false","aria-haspopup":"listbox","aria-label":h,"aria-labelledby":[F,an].filter(Boolean).join(" ")||void 0,"aria-describedby":d,onKeyDown:En,onMouseDown:x||ue?null:Ht,onBlur:fr,onFocus:ne},Ee,{ownerState:It,className:Wt(Ee.className,ot.select,b),id:an,children:YCe(Ft)?RG||(RG=T.jsx("span",{className:"notranslate",children:"​"})):Ft})),T.jsx(KCe,_e({"aria-invalid":V,value:Array.isArray(Ce)?Ce.join(","):Ce,name:X,ref:yt,"aria-hidden":!0,onChange:_n,tabIndex:-1,disabled:x,className:ot.nativeInput,autoFocus:f,ownerState:It},$e)),T.jsx(zCe,{as:G,className:ot.icon,ownerState:It}),T.jsx(JY,_e({id:`menu-${X||""}`,anchorEl:sn,open:fi,onClose:on,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},B,{MenuListProps:_e({"aria-labelledby":F,role:"listbox","aria-multiselectable":L?"true":void 0,disableListWrap:!0,id:$i},B.MenuListProps),slotProps:_e({},B.slotProps,{paper:_e({},tn,{style:_e({minWidth:lr},tn!=null?tn.style:null)})}),children:Wi}))]})}),JCe=XCe,QCe=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],ZCe=["root"],ewe=t=>{const{classes:r}=t;return r},lU={name:"MuiSelect",overridesResolver:(t,r)=>r.root,shouldForwardProp:t=>Go(t)&&t!=="variant",slot:"Root"},twe=Rt(KY,lU)(""),nwe=Rt(tq,lU)(""),rwe=Rt(GY,lU)(""),nq=K.forwardRef(function(r,o){const c=Zn({name:"MuiSelect",props:r}),{autoWidth:d=!1,children:h,classes:f={},className:_,defaultOpen:v=!1,displayEmpty:b=!1,IconComponent:A=fSe,id:w,input:x,inputProps:M,label:V,labelId:G,MenuProps:H,multiple:F=!1,native:B=!1,onClose:L,onOpen:X,open:ee,renderValue:ce,SelectDisplayProps:ie,variant:ne="outlined"}=c,fe=jt(c,QCe),oe=B?PCe:JCe,ue=c_(),Ne=a_({props:c,muiFormControl:ue,states:["variant","error"]}),Ee=Ne.variant||ne,we=_e({},c,{variant:Ee,classes:f}),Re=ewe(we),Pe=jt(Re,ZCe),$e=x||{standard:T.jsx(twe,{ownerState:we}),outlined:T.jsx(nwe,{label:V,ownerState:we}),filled:T.jsx(rwe,{ownerState:we})}[Ee],Ce=Es(o,$e.ref);return T.jsx(K.Fragment,{children:K.cloneElement($e,_e({inputComponent:oe,inputProps:_e({children:h,error:Ne.error,IconComponent:A,variant:Ee,type:void 0,multiple:F},B?{id:w}:{autoWidth:d,defaultOpen:v,displayEmpty:b,labelId:G,MenuProps:H,onClose:L,onOpen:X,open:ee,renderValue:ce,SelectDisplayProps:_e({id:w},ie)},M,{classes:M?pa(Pe,M.classes):Pe},x?x.props.inputProps:{})},(F&&B||b)&&Ee==="outlined"?{notched:!0}:{},{ref:Ce,className:Wt($e.props.className,_,Re.root)},!x&&{variant:Ee},fe))})});nq.muiName="Select";const rq=nq;function iwe(t){return zn("MuiSkeleton",t)}Vn("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const swe=["animation","className","component","height","style","variant","width"];let iR=t=>t,AG,OG,NG,kG;const owe=t=>{const{classes:r,variant:o,animation:c,hasChildren:d,width:h,height:f}=t;return Qn({root:["root",o,c,d&&"withChildren",d&&!h&&"fitContent",d&&!f&&"heightAuto"]},iwe,r)},awe=i_(AG||(AG=iR`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`)),cwe=i_(OG||(OG=iR`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`)),lwe=Rt("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,r[o.variant],o.animation!==!1&&r[o.animation],o.hasChildren&&r.withChildren,o.hasChildren&&!o.width&&r.fitContent,o.hasChildren&&!o.height&&r.heightAuto]}})(({theme:t,ownerState:r})=>{const o=dye(t.shape.borderRadius)||"px",c=uye(t.shape.borderRadius);return _e({display:"block",backgroundColor:t.vars?t.vars.palette.Skeleton.bg:lve(t.palette.text.primary,t.palette.mode==="light"?.11:.13),height:"1.2em"},r.variant==="text"&&{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${c}${o}/${Math.round(c/.6*10)/10}${o}`,"&:empty:before":{content:'"\\00a0"'}},r.variant==="circular"&&{borderRadius:"50%"},r.variant==="rounded"&&{borderRadius:(t.vars||t).shape.borderRadius},r.hasChildren&&{"& > *":{visibility:"hidden"}},r.hasChildren&&!r.width&&{maxWidth:"fit-content"},r.hasChildren&&!r.height&&{height:"auto"})},({ownerState:t})=>t.animation==="pulse"&&qw(NG||(NG=iR`
      animation: ${0} 2s ease-in-out 0.5s infinite;
    `),awe),({ownerState:t,theme:r})=>t.animation==="wave"&&qw(kG||(kG=iR`
      position: relative;
      overflow: hidden;

      /* Fix bug in Safari https://bugs.webkit.org/show_bug.cgi?id=68196 */
      -webkit-mask-image: -webkit-radial-gradient(white, black);

      &::after {
        animation: ${0} 2s linear 0.5s infinite;
        background: linear-gradient(
          90deg,
          transparent,
          ${0},
          transparent
        );
        content: '';
        position: absolute;
        transform: translateX(-100%); /* Avoid flash during server-side hydration */
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
      }
    `),cwe,(r.vars||r).palette.action.hover)),dwe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiSkeleton"}),{animation:d="pulse",className:h,component:f="span",height:_,style:v,variant:b="text",width:A}=c,w=jt(c,swe),x=_e({},c,{animation:d,component:f,variant:b,hasChildren:!!w.children}),M=owe(x);return T.jsx(lwe,_e({as:f,ref:o,className:Wt(M.root,h),ownerState:x},w,{style:_e({width:A,height:_},v)}))}),Ju=dwe;function uwe(t){return zn("MuiTextField",t)}Vn("MuiTextField",["root"]);const hwe=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],pwe={standard:KY,filled:GY,outlined:tq},fwe=t=>{const{classes:r}=t;return Qn({root:["root"]},uwe,r)},mwe=Rt(Qbe,{name:"MuiTextField",slot:"Root",overridesResolver:(t,r)=>r.root})({}),gwe=K.forwardRef(function(r,o){const c=Zn({props:r,name:"MuiTextField"}),{autoComplete:d,autoFocus:h=!1,children:f,className:_,color:v="primary",defaultValue:b,disabled:A=!1,error:w=!1,FormHelperTextProps:x,fullWidth:M=!1,helperText:V,id:G,InputLabelProps:H,inputProps:F,InputProps:B,inputRef:L,label:X,maxRows:ee,minRows:ce,multiline:ie=!1,name:ne,onBlur:fe,onChange:oe,onFocus:ue,placeholder:Ne,required:Ee=!1,rows:we,select:Re=!1,SelectProps:Pe,type:$e,value:Ce,variant:Fe="outlined"}=c,Ye=jt(c,hwe),Mt=_e({},c,{autoFocus:h,color:v,disabled:A,error:w,fullWidth:M,multiline:ie,required:Ee,select:Re,variant:Fe}),yt=fwe(Mt),Xt={};Fe==="outlined"&&(H&&typeof H.shrink<"u"&&(Xt.notched=H.shrink),Xt.label=X),Re&&((!Pe||!Pe.native)&&(Xt.id=void 0),Xt["aria-describedby"]=void 0);const Ue=yI(G),Be=V&&Ue?`${Ue}-helper-text`:void 0,at=X&&Ue?`${Ue}-label`:void 0,Jt=pwe[Fe],un=T.jsx(Jt,_e({"aria-describedby":Be,autoComplete:d,autoFocus:h,defaultValue:b,fullWidth:M,multiline:ie,name:ne,rows:we,maxRows:ee,minRows:ce,type:$e,value:Ce,id:Ue,inputRef:L,onBlur:fe,onChange:oe,onFocus:ue,placeholder:Ne,inputProps:F},Xt,B));return T.jsxs(mwe,_e({className:Wt(yt.root,_),disabled:A,error:w,fullWidth:M,ref:o,required:Ee,color:v,variant:Fe,ownerState:Mt},Ye,{children:[X!=null&&X!==""&&T.jsx(RTe,_e({htmlFor:Ue,id:at},H,{children:X})),Re?T.jsx(rq,_e({"aria-describedby":Be,id:Ue,labelId:at,value:Ce,input:un},Pe,{children:f})):un,V&&T.jsx(sTe,_e({id:Be},x,{children:V}))]}))}),iq=gwe;class dU{addFriend(r,o){return Gn.put(`/api/v1/users/profile/friends/${o}`,{},Wr(r))}findByPhone(r,o){return Gn.get(`/api/v1/users/profile/${r}`,Wr(o))}getFriends(r,o){return Gn.get(`/api/v1/users/profile/friends?type=${o}`,Wr(r))}getFriendSent(r){return Gn.get("/api/v1/users/profile/friends?type=request",Wr(r))}acceptFriend(r,o){return Gn.put(`/api/v1/users/profile/friends/${o}/accept`,{},Wr(r))}declineFriend(r,o){return Gn.put(`/api/v1/users/profile/friends/${o}/decline`,{},Wr(r))}deleteFriend(r,o){return Gn.put(`/api/v1/users/profile/friends/${o}`,{},Wr(r))}}const Wc=K.createContext(),_we=({children:t})=>{const[r,o]=K.useState({}),[c,d]=K.useState([]),[h,f]=K.useState([]),[_,v]=K.useState(null),[b,A]=K.useState([]),[w,x]=K.useState([]);return T.jsx(Wc.Provider,{value:{chat:r,setChat:o,chats:c,setChats:d,messages:h,setMessages:f,chatId:_,setChatId:v,sent:b,setSent:A,friend:w,setFriend:x},children:t})},qs=({token:t,setToken:r,setProfile:o,setPhone:c})=>{K.useEffect(()=>{(()=>{const v=Hn.get("token"),b=Hn.get("profile"),A=Hn.get("phone");v&&b&&A&&(r(v),o(JSON.parse(b)),c(A))})()},[t,Hn.get("token")]);let d=new dU;const{setSent:h,setFriend:f}=K.useContext(Wc);yh({queryKey:["friends"],queryFn:()=>{t!==""&&t!==void 0&&d.getFriends(t,"friend").then(_=>{if(_!=null&&_.data)return f(_.data),_.data})}}),yh({queryKey:["sendRequest"],queryFn:()=>{t!==""&&t!==void 0&&d.getFriendSent(t).then(_=>{if(t&&_!=null&&_.data)return h(_.data),_.data})},enabled:t!==""&&t!==void 0})};class y0{deleteChatRoom(r,o,c){return Gn.put(`/api/v1/users/profile/chats/${o}`,{status:c},Wr(r))}deleteChats(r,o){return Gn.delete(`/api/v1/chats/${o}/messages`,Wr(r))}getChats(r){return Gn.get("/api/v1/users/profile/chats",Wr(r))}getMessages(r,o){return Gn.get(`/api/v1/chats/${o}/messages`,Wr(r))}chat(r,o,c){return Gn.post(`/api/v1/chats/${o}/messages`,c,Wr(r))}unsend(r,o,c){return Gn.put(`/api/v1/chats/${r}/messages/${o}`,{},Wr(c))}delete(r,o,c){return Gn.delete(`/api/v1/chats/${r}/messages/${o}`,Wr(c))}reaction(r,o,c,d){return Gn.put(`/api/v1/chats/${r}/messages/${o}/reaction`,c,Wr(d))}}const xG=({reactions:t,icons:r,showEmoDetails:o,setShowEmoDetails:c})=>{const d=()=>{c(!1)},h=[],[f,_]=K.useState(0);K.useEffect(()=>{let M=0;t==null||t.forEach(V=>{M+=(V==null?void 0:V.quantity)||0}),_(M)},[t]);const[v,b]=K.useState("null"),A=M=>{b(M==="null"?"null":M.type)},w=v!=="null"?t.filter(M=>M.type===v):t,x={};return t==null||t.forEach(M=>{M.type in x?x[M.type]+=M.quantity:x[M.type]=M.quantity}),K.useEffect(()=>{},[v]),T.jsx(T.Fragment,{children:o&&T.jsx("div",{className:"fixed z-50 bg-black bg-opacity-30 justify-center items-center w-full inset-0 ",children:T.jsx("div",{className:"z-50 p-4 max-h-full relative rounded pb-3 pt-1 mx-auto my-20 bg-white lg:max-w-[400px] w-full max-w-screen-lg",children:T.jsxs("div",{className:"relative bg-white rounded-lg min-h-80 shadow dark:bg-gray-700",children:[T.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Biểu cảm"}),T.jsxs("button",{onClick:()=>d(),className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal",children:[T.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:T.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),T.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),T.jsxs("div",{className:"p-4 grid grid-cols-10 gap-2 w-full",children:[T.jsx("div",{className:"col-span-3",children:t&&t.length>0&&T.jsx("div",{className:"cursor-pointer bg-gray-100 p-1 flex",children:T.jsxs("div",{className:"w-full",children:[T.jsxs("div",{className:"flex justify-between min-w-5 p-1  hover:bg-blue-200 ",children:[T.jsx("div",{onClick:()=>A("null"),className:"ml-1 transition-all",children:"Tất cả"}),T.jsx("div",{className:"",children:f})]}),t==null?void 0:t.map((M,V)=>{if(!h.includes(M.type)){h.push(M.type);let G=0;return t.forEach(H=>{H.type===M.type&&(G+=H.quantity)}),h.includes(M.type)||h.push(M.type),T.jsxs("div",{onClick:()=>A(M),className:"flex justify-between min-w-5 p-1 hover:bg-blue-200",children:[T.jsx("img",{src:M.type==="LIKE"?r[0]:M.type==="LOVE"?r[1]:M.type==="CRY"?r[2]:M.type==="ANGER"?r[3]:r[4],alt:"",className:"h-7 w-7"}),T.jsx("div",{children:G})]},V)}})]})})}),T.jsx("div",{className:"col-span-7",children:w==null?void 0:w.map((M,V)=>T.jsxs("div",{className:"justify-between flex w-full mt-1",children:[T.jsxs("div",{className:"flex w-full",children:[T.jsx(pi,{src:M.user.thumbnailAvatar}),T.jsxs("div",{children:[M.user.firstName," ",M.user.lastName]})]}),T.jsxs("div",{className:"flex min-w-5 p-1",children:[T.jsx("img",{src:M.type==="LIKE"?r[0]:M.type==="LOVE"?r[1]:M.type==="CRY"?r[2]:M.type==="ANGER"?r[3]:r[4],alt:"",className:"h-7 w-7"}),T.jsx("div",{children:M==null?void 0:M.quantity})]},V)]}))})]})]})})})})},PG=({showShare:t,setShowShare:r,message:o})=>{const c=()=>{r(!1)},[d,h]=K.useState(""),[f,_]=K.useState(""),[v,b]=K.useState("");qs({token:d,setToken:h,setProfile:b,setPhone:_});const A=new y0,{chats:w,setChats:x}=K.useContext(Wc);yh({queryKey:["chats"],queryFn:async()=>{try{const ie=await A.getChats(d);if(ie.data)return x(ie.data),ie.data}catch(ie){console.log(ie)}}});const[M,V]=K.useState(!1),G=()=>{V(!M)},H=M?"blue-500":"gray-400",[F,B]=K.useState([]),L=ie=>{F.includes(ie)?B(F.filter(ne=>ne!==ie)):B([...F,ie])},X=Os(),ee=ki({mutationKey:["saveChat"],mutationFn:async ie=>await A.chat(d,ie.chatId,ie.mes).then(ne=>{if(ne.data)return console.log(ne.data),w.push(ne.data),X.invalidateQueries(["chat"]),X.invalidateQueries(["chats"]),ne.data}).catch(ne=>{console.error(ne)})}),ce=()=>{F.forEach(ie=>{ee.mutate({chatId:ie.id,mes:o})}),c()};return T.jsx(T.Fragment,{children:t&&T.jsx("div",{className:"fixed z-50 bg-black bg-opacity-30 justify-center mb-10 items-center w-full h-full inset-0 ",children:T.jsx("div",{className:"z-50 p-4 min-w-[30rem] relative rounded pb-3 pt-1 mx-auto my-5 h-[80%] overflow-scroll bg-white lg:max-w-[400px] max-w-screen-lg",children:T.jsxs("div",{className:"relative bg-white  rounded-lg  dark:bg-gray-700",children:[T.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Chia sẻ"}),T.jsxs("button",{onClick:()=>c(),className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal",children:[T.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:T.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),T.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),T.jsx("div",{className:"mt-5 border-b pb-5",children:T.jsxs("div",{className:`md:flex hidden md:items-center w-full bg-white py-1 px-2 rounded-full border transition-all ${M?"border-blue-500 ":"border-gray-600 "} `,children:[T.jsx("span",{children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-${H}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),T.jsx("input",{className:"h-7 bg-white focus:outline-none px-4 py-2 border-none rounded-full",type:"text",placeholder:"Tìm kiếm",onFocus:G,onBlur:G})]})}),T.jsxs("div",{className:"text-black grid grid-cols-3 w-full my-2",children:[T.jsxs("div",{className:"col-span-2 w-full",children:[T.jsx("div",{children:T.jsx("h3",{children:"Chọn phòng chat"})}),w==null?void 0:w.map((ie,ne)=>T.jsxs("div",{className:"flex gap-2 w-full mt-3",children:[T.jsx("input",{type:"checkbox",onClick:()=>L(ie),checked:F==null?void 0:F.some(fe=>fe.id===(ie==null?void 0:ie.id))}),T.jsx(pi,{sx:{width:40,height:40},src:ie==null?void 0:ie.avatar}),T.jsxs("div",{className:"ml-2",children:[" ",ie==null?void 0:ie.name," "]})]},ne))]}),F.length>0&&T.jsxs("div",{className:"col-span-1 p-2 border text-sm",children:[T.jsx("div",{children:T.jsx("h3",{children:"Đã chọn"})}),T.jsx("div",{className:"mt-3 rounded-full w-full",children:F.map((ie,ne)=>T.jsxs("div",{className:"justify-between flex mt-4 p-2 bg-blue-100",children:[T.jsxs("div",{className:"flex w-full",children:[T.jsx(pi,{sx:{width:20,height:20},src:ie==null?void 0:ie.avatar}),T.jsxs("div",{className:"ml-1",children:[" ",ie==null?void 0:ie.name," "]})]},ne),T.jsx(Dn,{icon:Ny,className:"cursor-pointer",onClick:()=>L(ie)})]}))})]})]}),T.jsxs("div",{className:"flex mt-3 justify-end gap-5",children:[T.jsx("button",{onClick:()=>c(),className:" p-2 rounded-md bg-gray-100",children:"Hủy"}),T.jsx("button",{onClick:()=>ce(),className:`${F.length<1?" bg-blue-300 ":"bg-blue-700"} p-2 rounded-md text-white`,disabled:F.length<1,children:"Share"})]})]})})})})};var BI={exports:{}},uU={};(function(t){(function(){var r,o,c,d,h={}.hasOwnProperty,f=[].slice;r={LF:`
`,NULL:"\0"},c=function(){var _;function v(b,A,w){this.command=b,this.headers=A??{},this.body=w??""}return v.prototype.toString=function(){var b,A,w,x,M;b=[this.command],w=this.headers["content-length"]===!1,w&&delete this.headers["content-length"],M=this.headers;for(A in M)h.call(M,A)&&(x=M[A],b.push(""+A+":"+x));return this.body&&!w&&b.push("content-length:"+v.sizeOfUTF8(this.body)),b.push(r.LF+this.body),b.join(r.LF)},v.sizeOfUTF8=function(b){return b?encodeURI(b).match(/%..|./g).length:0},_=function(b){var A,w,x,M,V,G,H,F,B,L,X,ee,ce,ie,ne,fe,oe;for(M=b.search(RegExp(""+r.LF+r.LF)),V=b.substring(0,M).split(r.LF),x=V.shift(),G={},ee=function(ue){return ue.replace(/^\s+|\s+$/g,"")},fe=V.reverse(),ce=0,ne=fe.length;ce<ne;ce++)L=fe[ce],F=L.indexOf(":"),G[ee(L.substring(0,F))]=ee(L.substring(F+1));if(A="",X=M+2,G["content-length"])B=parseInt(G["content-length"]),A=(""+b).substring(X,X+B);else for(w=null,H=ie=X,oe=b.length;(X<=oe?ie<oe:ie>oe)&&(w=b.charAt(H),w!==r.NULL);H=X<=oe?++ie:--ie)A+=w;return new v(x,G,A)},v.unmarshall=function(b){var A;return function(){var w,x,M,V;for(M=b.split(RegExp(""+r.NULL+r.LF+"*")),V=[],w=0,x=M.length;w<x;w++)A=M[w],(A!=null?A.length:void 0)>0&&V.push(_(A));return V}()},v.marshall=function(b,A,w){var x;return x=new v(b,A,w),x.toString()+r.NULL},v}(),o=function(){var _;function v(b){this.ws=b,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16*1024,this.subscriptions={}}return v.prototype.debug=function(b){var A;return typeof window<"u"&&window!==null&&(A=window.console)!=null?A.log(b):void 0},_=function(){return Date.now?Date.now():new Date().valueOf},v.prototype._transmit=function(b,A,w){var x;for(x=c.marshall(b,A,w),typeof this.debug=="function"&&this.debug(">>> "+x);;)if(x.length>this.maxWebSocketFrameSize)this.ws.send(x.substring(0,this.maxWebSocketFrameSize)),x=x.substring(this.maxWebSocketFrameSize),typeof this.debug=="function"&&this.debug("remaining = "+x.length);else return this.ws.send(x)},v.prototype._setupHeartbeat=function(b){var A,w,x,M,V,G;if(!((V=b.version)!==d.VERSIONS.V1_1&&V!==d.VERSIONS.V1_2)&&(G=function(){var H,F,B,L;for(B=b["heart-beat"].split(","),L=[],H=0,F=B.length;H<F;H++)M=B[H],L.push(parseInt(M));return L}(),w=G[0],A=G[1],this.heartbeat.outgoing===0||A===0||(x=Math.max(this.heartbeat.outgoing,A),typeof this.debug=="function"&&this.debug("send PING every "+x+"ms"),this.pinger=d.setInterval(x,function(H){return function(){return H.ws.send(r.LF),typeof H.debug=="function"?H.debug(">>> PING"):void 0}}(this))),!(this.heartbeat.incoming===0||w===0)))return x=Math.max(this.heartbeat.incoming,w),typeof this.debug=="function"&&this.debug("check PONG every "+x+"ms"),this.ponger=d.setInterval(x,function(H){return function(){var F;if(F=_()-H.serverActivity,F>x*2)return typeof H.debug=="function"&&H.debug("did not receive server activity for the last "+F+"ms"),H.ws.close()}}(this))},v.prototype._parseConnect=function(){var b,A,w,x;switch(b=1<=arguments.length?f.call(arguments,0):[],x={},b.length){case 2:x=b[0],A=b[1];break;case 3:b[1]instanceof Function?(x=b[0],A=b[1],w=b[2]):(x.login=b[0],x.passcode=b[1],A=b[2]);break;case 4:x.login=b[0],x.passcode=b[1],A=b[2],w=b[3];break;default:x.login=b[0],x.passcode=b[1],A=b[2],w=b[3],x.host=b[4]}return[x,A,w]},v.prototype.connect=function(){var b,A,w,x;return b=1<=arguments.length?f.call(arguments,0):[],x=this._parseConnect.apply(this,b),w=x[0],this.connectCallback=x[1],A=x[2],typeof this.debug=="function"&&this.debug("Opening Web Socket..."),this.ws.onmessage=function(M){return function(V){var G,H,F,B,L,X,ee,ce,ie,ne,fe,oe;if(B=typeof ArrayBuffer<"u"&&V.data instanceof ArrayBuffer?(G=new Uint8Array(V.data),typeof M.debug=="function"&&M.debug("--- got data length: "+G.length),function(){var ue,Ne,Ee;for(Ee=[],ue=0,Ne=G.length;ue<Ne;ue++)H=G[ue],Ee.push(String.fromCharCode(H));return Ee}().join("")):V.data,M.serverActivity=_(),B===r.LF){typeof M.debug=="function"&&M.debug("<<< PONG");return}for(typeof M.debug=="function"&&M.debug("<<< "+B),fe=c.unmarshall(B),oe=[],ie=0,ne=fe.length;ie<ne;ie++)switch(L=fe[ie],L.command){case"CONNECTED":typeof M.debug=="function"&&M.debug("connected to server "+L.headers.server),M.connected=!0,M._setupHeartbeat(L.headers),oe.push(typeof M.connectCallback=="function"?M.connectCallback(L):void 0);break;case"MESSAGE":ce=L.headers.subscription,ee=M.subscriptions[ce]||M.onreceive,ee?(F=M,X=L.headers["message-id"],L.ack=function(ue){return ue==null&&(ue={}),F.ack(X,ce,ue)},L.nack=function(ue){return ue==null&&(ue={}),F.nack(X,ce,ue)},oe.push(ee(L))):oe.push(typeof M.debug=="function"?M.debug("Unhandled received MESSAGE: "+L):void 0);break;case"RECEIPT":oe.push(typeof M.onreceipt=="function"?M.onreceipt(L):void 0);break;case"ERROR":oe.push(typeof A=="function"?A(L):void 0);break;default:oe.push(typeof M.debug=="function"?M.debug("Unhandled frame: "+L):void 0)}return oe}}(this),this.ws.onclose=function(M){return function(){var V;return V="Whoops! Lost connection to "+M.ws.url,typeof M.debug=="function"&&M.debug(V),M._cleanUp(),typeof A=="function"?A(V):void 0}}(this),this.ws.onopen=function(M){return function(){return typeof M.debug=="function"&&M.debug("Web Socket Opened..."),w["accept-version"]=d.VERSIONS.supportedVersions(),w["heart-beat"]=[M.heartbeat.outgoing,M.heartbeat.incoming].join(","),M._transmit("CONNECT",w)}}(this)},v.prototype.disconnect=function(b,A){return A==null&&(A={}),this._transmit("DISCONNECT",A),this.ws.onclose=null,this.ws.close(),this._cleanUp(),typeof b=="function"?b():void 0},v.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&d.clearInterval(this.pinger),this.ponger)return d.clearInterval(this.ponger)},v.prototype.send=function(b,A,w){return A==null&&(A={}),w==null&&(w=""),A.destination=b,this._transmit("SEND",A,w)},v.prototype.subscribe=function(b,A,w){var x;return w==null&&(w={}),w.id||(w.id="sub-"+this.counter++),w.destination=b,this.subscriptions[w.id]=A,this._transmit("SUBSCRIBE",w),x=this,{id:w.id,unsubscribe:function(){return x.unsubscribe(w.id)}}},v.prototype.unsubscribe=function(b){return delete this.subscriptions[b],this._transmit("UNSUBSCRIBE",{id:b})},v.prototype.begin=function(b){var A,w;return w=b||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:w}),A=this,{id:w,commit:function(){return A.commit(w)},abort:function(){return A.abort(w)}}},v.prototype.commit=function(b){return this._transmit("COMMIT",{transaction:b})},v.prototype.abort=function(b){return this._transmit("ABORT",{transaction:b})},v.prototype.ack=function(b,A,w){return w==null&&(w={}),w["message-id"]=b,w.subscription=A,this._transmit("ACK",w)},v.prototype.nack=function(b,A,w){return w==null&&(w={}),w["message-id"]=b,w.subscription=A,this._transmit("NACK",w)},v}(),d={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(_,v){var b,A;return v==null&&(v=["v10.stomp","v11.stomp"]),b=d.WebSocketClass||WebSocket,A=new b(_,v),new o(A)},over:function(_){return new o(_)},Frame:c},t!==null&&(t.Stomp=d),typeof window<"u"&&window!==null?(d.setInterval=function(_,v){return window.setInterval(v,_)},d.clearInterval=function(_){return window.clearInterval(_)},window.Stomp=d):t||(self.Stomp=d)}).call(nt)})(uU);var FL={},DG={},LG;function sq(){if(LG)return DG;LG=1;var t=sq();for(k in t)nt[k]=t[k];return DG}var kP,MG;function Ewe(){if(MG)return kP;MG=1;var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return kP=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}(),kP}const vwe="websocket",ywe="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Swe=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],bwe="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",Twe=["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Cwe="1.0.34",wwe={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},Rwe="https://github.com/theturtle32/WebSocket-Node",Iwe={node:">=4.0.0"},Awe={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Owe={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Nwe={verbose:!1},kwe={test:"tape test/unit/*.js",gulp:"gulp"},xwe="index",Pwe={lib:"./lib"},Dwe="lib/browser.js",Lwe="Apache-2.0",Mwe={name:vwe,description:ywe,keywords:Swe,author:bwe,contributors:Twe,version:Cwe,repository:wwe,homepage:Rwe,engines:Iwe,dependencies:Awe,devDependencies:Owe,config:Nwe,scripts:kwe,main:xwe,directories:Pwe,browser:Dwe,license:Lwe};var xP,UG;function Uwe(){return UG||(UG=1,xP=Mwe.version),xP}var PP,jG;function jwe(){if(jG)return PP;jG=1;var t;if(typeof globalThis=="object")t=globalThis;else try{t=Ewe()}catch{}finally{if(!t&&typeof window<"u"&&(t=window),!t)throw new Error("Could not determine global this")}var r=t.WebSocket||t.MozWebSocket,o=Uwe();function c(d,h){var f;return h?f=new r(d,h):f=new r(d),f}return r&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(d){Object.defineProperty(c,d,{get:function(){return r[d]}})}),PP={w3cwebsocket:r?c:null,version:o},PP}(function(){var t,r,o,c,d,h;t=uU,r=sq(),t.Stomp.setInterval=function(f,_){return setInterval(_,f)},t.Stomp.clearInterval=function(f){return clearInterval(f)},d=function(f,_){var v,b;return v=null,b={url:"tcp:// "+_+":"+f,send:function(A){return v.write(A)},close:function(){return v.end()}},v=r.connect(f,_,function(A){return b.onopen()}),v.on("error",function(A){return typeof b.onclose=="function"?b.onclose(A):void 0}),v.on("close",function(A){return typeof b.onclose=="function"?b.onclose(A):void 0}),v.on("data",function(A){var w;return w={data:A.toString()},b.onmessage(w)}),b},h=function(f){var _,v,b,A;return _=jwe().client,v=null,A={url:f,send:function(w){return v.sendUTF(w)},close:function(){return v.close()}},b=new _,b.on("connect",function(w){return v=w,A.onopen(),v.on("error",function(x){return typeof A.onclose=="function"?A.onclose(x):void 0}),v.on("close",function(){return typeof A.onclose=="function"?A.onclose():void 0}),v.on("message",function(x){var M;if(x.type==="utf8")return M={data:x.utf8Data},A.onmessage(M)})}),b.connect(f),A},o=function(f,_){var v;return v=d(_,f),t.Stomp.over(v)},c=function(f){var _;return _=h(f),t.Stomp.over(_)},FL.overTCP=o,FL.overWS=c}).call(nt);var Fwe=uU,oq=FL;BI.exports=Fwe.Stomp;BI.exports.overTCP=oq.overTCP;BI.exports.overWS=oq.overWS;var aq=BI.exports,cq={exports:{}},VL={};nt.crypto&&nt.crypto.getRandomValues?VL.randomBytes=function(t){var r=new Uint8Array(t);return nt.crypto.getRandomValues(r),r}:VL.randomBytes=function(t){for(var r=new Array(t),o=0;o<t;o++)r[o]=Math.floor(Math.random()*256);return r};var Vwe=VL,FG="abcdefghijklmnopqrstuvwxyz012345",l_={string:function(t){for(var r=FG.length,o=Vwe.randomBytes(t),c=[],d=0;d<t;d++)c.push(FG.substr(o[d]%r,1));return c.join("")},number:function(t){return Math.floor(Math.random()*t)},numberString:function(t){var r=(""+(t-1)).length,o=new Array(r+1).join("0");return(o+this.number(t)).slice(-r)}};(function(t){var r=l_,o={},c=!1,d=nt.chrome&&nt.chrome.app&&nt.chrome.app.runtime;t.exports={attachEvent:function(f,_){typeof nt.addEventListener<"u"?nt.addEventListener(f,_,!1):nt.document&&nt.attachEvent&&(nt.document.attachEvent("on"+f,_),nt.attachEvent("on"+f,_))},detachEvent:function(f,_){typeof nt.addEventListener<"u"?nt.removeEventListener(f,_,!1):nt.document&&nt.detachEvent&&(nt.document.detachEvent("on"+f,_),nt.detachEvent("on"+f,_))},unloadAdd:function(f){if(d)return null;var _=r.string(8);return o[_]=f,c&&setTimeout(this.triggerUnloadCallbacks,0),_},unloadDel:function(f){f in o&&delete o[f]},triggerUnloadCallbacks:function(){for(var f in o)o[f](),delete o[f]}};var h=function(){c||(c=!0,t.exports.triggerUnloadCallbacks())};d||t.exports.attachEvent("unload",h)})(cq);var Ph=cq.exports,Bwe=function(r,o){if(o=o.split(":")[0],r=+r,!r)return!1;switch(o){case"http":case"ws":return r!==80;case"https":case"wss":return r!==443;case"ftp":return r!==21;case"gopher":return r!==70;case"file":return!1}return r!==0},hU={},Wwe=Object.prototype.hasOwnProperty,$we;function VG(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch{return null}}function BG(t){try{return encodeURIComponent(t)}catch{return null}}function Gwe(t){for(var r=/([^=?#&]+)=?([^&]*)/g,o={},c;c=r.exec(t);){var d=VG(c[1]),h=VG(c[2]);d===null||h===null||d in o||(o[d]=h)}return o}function Hwe(t,r){r=r||"";var o=[],c,d;typeof r!="string"&&(r="?");for(d in t)if(Wwe.call(t,d)){if(c=t[d],!c&&(c===null||c===$we||isNaN(c))&&(c=""),d=BG(d),c=BG(c),d===null||c===null)continue;o.push(d+"="+c)}return o.length?r+o.join("&"):""}hU.stringify=Hwe;hU.parse=Gwe;var lq=Bwe,WI=hU,zwe=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,dq=/[\n\r\t]/g,Kwe=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,uq=/:\d+$/,Ywe=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,qwe=/^[a-zA-Z]:/;function pU(t){return(t||"").toString().replace(zwe,"")}var BL=[["#","hash"],["?","query"],function(r,o){return Dl(o.protocol)?r.replace(/\\/g,"/"):r},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],WG={hash:1,query:1};function hq(t){var r;typeof window<"u"?r=window:typeof nt<"u"?r=nt:typeof self<"u"?r=self:r={};var o=r.location||{};t=t||o;var c={},d=typeof t,h;if(t.protocol==="blob:")c=new Ul(unescape(t.pathname),{});else if(d==="string"){c=new Ul(t,{});for(h in WG)delete c[h]}else if(d==="object"){for(h in t)h in WG||(c[h]=t[h]);c.slashes===void 0&&(c.slashes=Kwe.test(t.href))}return c}function Dl(t){return t==="file:"||t==="ftp:"||t==="http:"||t==="https:"||t==="ws:"||t==="wss:"}function pq(t,r){t=pU(t),t=t.replace(dq,""),r=r||{};var o=Ywe.exec(t),c=o[1]?o[1].toLowerCase():"",d=!!o[2],h=!!o[3],f=0,_;return d?h?(_=o[2]+o[3]+o[4],f=o[2].length+o[3].length):(_=o[2]+o[4],f=o[2].length):h?(_=o[3]+o[4],f=o[3].length):_=o[4],c==="file:"?f>=2&&(_=_.slice(2)):Dl(c)?_=o[4]:c?d&&(_=_.slice(2)):f>=2&&Dl(r.protocol)&&(_=o[4]),{protocol:c,slashes:d||Dl(c),slashesCount:f,rest:_}}function Xwe(t,r){if(t==="")return r;for(var o=(r||"/").split("/").slice(0,-1).concat(t.split("/")),c=o.length,d=o[c-1],h=!1,f=0;c--;)o[c]==="."?o.splice(c,1):o[c]===".."?(o.splice(c,1),f++):f&&(c===0&&(h=!0),o.splice(c,1),f--);return h&&o.unshift(""),(d==="."||d==="..")&&o.push(""),o.join("/")}function Ul(t,r,o){if(t=pU(t),t=t.replace(dq,""),!(this instanceof Ul))return new Ul(t,r,o);var c,d,h,f,_,v,b=BL.slice(),A=typeof r,w=this,x=0;for(A!=="object"&&A!=="string"&&(o=r,r=null),o&&typeof o!="function"&&(o=WI.parse),r=hq(r),d=pq(t||"",r),c=!d.protocol&&!d.slashes,w.slashes=d.slashes||c&&r.slashes,w.protocol=d.protocol||r.protocol||"",t=d.rest,(d.protocol==="file:"&&(d.slashesCount!==2||qwe.test(t))||!d.slashes&&(d.protocol||d.slashesCount<2||!Dl(w.protocol)))&&(b[3]=[/(.*)/,"pathname"]);x<b.length;x++){if(f=b[x],typeof f=="function"){t=f(t,w);continue}h=f[0],v=f[1],h!==h?w[v]=t:typeof h=="string"?(_=h==="@"?t.lastIndexOf(h):t.indexOf(h),~_&&(typeof f[2]=="number"?(w[v]=t.slice(0,_),t=t.slice(_+f[2])):(w[v]=t.slice(_),t=t.slice(0,_)))):(_=h.exec(t))&&(w[v]=_[1],t=t.slice(0,_.index)),w[v]=w[v]||c&&f[3]&&r[v]||"",f[4]&&(w[v]=w[v].toLowerCase())}o&&(w.query=o(w.query)),c&&r.slashes&&w.pathname.charAt(0)!=="/"&&(w.pathname!==""||r.pathname!=="")&&(w.pathname=Xwe(w.pathname,r.pathname)),w.pathname.charAt(0)!=="/"&&Dl(w.protocol)&&(w.pathname="/"+w.pathname),lq(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(_=w.auth.indexOf(":"),~_?(w.username=w.auth.slice(0,_),w.username=encodeURIComponent(decodeURIComponent(w.username)),w.password=w.auth.slice(_+1),w.password=encodeURIComponent(decodeURIComponent(w.password))):w.username=encodeURIComponent(decodeURIComponent(w.auth)),w.auth=w.password?w.username+":"+w.password:w.username),w.origin=w.protocol!=="file:"&&Dl(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString()}function Jwe(t,r,o){var c=this;switch(t){case"query":typeof r=="string"&&r.length&&(r=(o||WI.parse)(r)),c[t]=r;break;case"port":c[t]=r,lq(r,c.protocol)?r&&(c.host=c.hostname+":"+r):(c.host=c.hostname,c[t]="");break;case"hostname":c[t]=r,c.port&&(r+=":"+c.port),c.host=r;break;case"host":c[t]=r,uq.test(r)?(r=r.split(":"),c.port=r.pop(),c.hostname=r.join(":")):(c.hostname=r,c.port="");break;case"protocol":c.protocol=r.toLowerCase(),c.slashes=!o;break;case"pathname":case"hash":if(r){var d=t==="pathname"?"/":"#";c[t]=r.charAt(0)!==d?d+r:r}else c[t]=r;break;case"username":case"password":c[t]=encodeURIComponent(r);break;case"auth":var h=r.indexOf(":");~h?(c.username=r.slice(0,h),c.username=encodeURIComponent(decodeURIComponent(c.username)),c.password=r.slice(h+1),c.password=encodeURIComponent(decodeURIComponent(c.password))):c.username=encodeURIComponent(decodeURIComponent(r))}for(var f=0;f<BL.length;f++){var _=BL[f];_[4]&&(c[_[1]]=c[_[1]].toLowerCase())}return c.auth=c.password?c.username+":"+c.password:c.username,c.origin=c.protocol!=="file:"&&Dl(c.protocol)&&c.host?c.protocol+"//"+c.host:"null",c.href=c.toString(),c}function Qwe(t){(!t||typeof t!="function")&&(t=WI.stringify);var r,o=this,c=o.host,d=o.protocol;d&&d.charAt(d.length-1)!==":"&&(d+=":");var h=d+(o.protocol&&o.slashes||Dl(o.protocol)?"//":"");return o.username?(h+=o.username,o.password&&(h+=":"+o.password),h+="@"):o.password?(h+=":"+o.password,h+="@"):o.protocol!=="file:"&&Dl(o.protocol)&&!c&&o.pathname!=="/"&&(h+="@"),(c[c.length-1]===":"||uq.test(o.hostname)&&!o.port)&&(c+=":"),h+=c+o.pathname,r=typeof o.query=="object"?t(o.query):o.query,r&&(h+=r.charAt(0)!=="?"?"?"+r:r),o.hash&&(h+=o.hash),h}Ul.prototype={set:Jwe,toString:Qwe};Ul.extractProtocol=pq;Ul.location=hq;Ul.trimLeft=pU;Ul.qs=WI;var fq=Ul,Zwe=fq,oc={getOrigin:function(t){if(!t)return null;var r=new Zwe(t);if(r.protocol==="file:")return null;var o=r.port;return o||(o=r.protocol==="https:"?"443":"80"),r.protocol+"//"+r.hostname+":"+o},isOriginEqual:function(t,r){var o=this.getOrigin(t)===this.getOrigin(r);return o},isSchemeEqual:function(t,r){return t.split(":")[0]===r.split(":")[0]},addPath:function(t,r){var o=t.split("?");return o[0]+r+(o[1]?"?"+o[1]:"")},addQuery:function(t,r){return t+(t.indexOf("?")===-1?"?"+r:"&"+r)},isLoopbackAddr:function(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^\[::1\]$/.test(t)}},WL={exports:{}};typeof Object.create=="function"?WL.exports=function(r,o){o&&(r.super_=o,r.prototype=Object.create(o.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:WL.exports=function(r,o){if(o){r.super_=o;var c=function(){};c.prototype=o.prototype,r.prototype=new c,r.prototype.constructor=r}};var cr=WL.exports,Xs={};function $I(){this._listeners={}}$I.prototype.addEventListener=function(t,r){t in this._listeners||(this._listeners[t]=[]);var o=this._listeners[t];o.indexOf(r)===-1&&(o=o.concat([r])),this._listeners[t]=o};$I.prototype.removeEventListener=function(t,r){var o=this._listeners[t];if(o){var c=o.indexOf(r);if(c!==-1){o.length>1?this._listeners[t]=o.slice(0,c).concat(o.slice(c+1)):delete this._listeners[t];return}}};$I.prototype.dispatchEvent=function(){var t=arguments[0],r=t.type,o=arguments.length===1?[t]:Array.apply(null,arguments);if(this["on"+r]&&this["on"+r].apply(this,o),r in this._listeners)for(var c=this._listeners[r],d=0;d<c.length;d++)c[d].apply(this,o)};var mq=$I,eRe=cr,GI=mq;function Ah(){GI.call(this)}eRe(Ah,GI);Ah.prototype.removeAllListeners=function(t){t?delete this._listeners[t]:this._listeners={}};Ah.prototype.once=function(t,r){var o=this,c=!1;function d(){o.removeListener(t,d),c||(c=!0,r.apply(this,arguments))}this.on(t,d)};Ah.prototype.emit=function(){var t=arguments[0],r=this._listeners[t];if(r){for(var o=arguments.length,c=new Array(o-1),d=1;d<o;d++)c[d-1]=arguments[d];for(var h=0;h<r.length;h++)r[h].apply(this,c)}};Ah.prototype.on=Ah.prototype.addListener=GI.prototype.addEventListener;Ah.prototype.removeListener=GI.prototype.removeEventListener;Xs.EventEmitter=Ah;var $L={exports:{}},$G=nt.WebSocket||nt.MozWebSocket;$G?$L.exports=function(r){return new $G(r)}:$L.exports=void 0;var tRe=$L.exports,gq=Ph,nRe=oc,rRe=cr,_q=Xs.EventEmitter,Eq=tRe,GG=function(){};function Hd(t,r,o){if(!Hd.enabled())throw new Error("Transport created when disabled");_q.call(this);var c=this,d=nRe.addPath(t,"/websocket");d.slice(0,5)==="https"?d="wss"+d.slice(5):d="ws"+d.slice(4),this.url=d,this.ws=new Eq(this.url,[],o),this.ws.onmessage=function(h){GG("message event",h.data),c.emit("message",h.data)},this.unloadRef=gq.unloadAdd(function(){c.ws.close()}),this.ws.onclose=function(h){GG("close event",h.code,h.reason),c.emit("close",h.code,h.reason),c._cleanup()},this.ws.onerror=function(h){c.emit("close",1006,"WebSocket connection broken"),c._cleanup()}}rRe(Hd,_q);Hd.prototype.send=function(t){var r="["+t+"]";this.ws.send(r)};Hd.prototype.close=function(){var t=this.ws;this._cleanup(),t&&t.close()};Hd.prototype._cleanup=function(){var t=this.ws;t&&(t.onmessage=t.onclose=t.onerror=null),gq.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()};Hd.enabled=function(){return!!Eq};Hd.transportName="websocket";Hd.roundTrips=2;var iRe=Hd,sRe=cr,vq=Xs.EventEmitter,oRe=function(){};function of(t,r){vq.call(this),this.sendBuffer=[],this.sender=r,this.url=t}sRe(of,vq);of.prototype.send=function(t){this.sendBuffer.push(t),this.sendStop||this.sendSchedule()};of.prototype.sendScheduleWait=function(){var t=this,r;this.sendStop=function(){t.sendStop=null,clearTimeout(r)},r=setTimeout(function(){t.sendStop=null,t.sendSchedule()},25)};of.prototype.sendSchedule=function(){oRe("sendSchedule",this.sendBuffer.length);var t=this;if(this.sendBuffer.length>0){var r="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,r,function(o){t.sendStop=null,o?(t.emit("close",o.code||1006,"Sending error: "+o),t.close()):t.sendScheduleWait()}),this.sendBuffer=[]}};of.prototype._cleanup=function(){this.removeAllListeners()};of.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)};var aRe=of,cRe=cr,yq=Xs.EventEmitter,lRe=function(){};function HI(t,r,o){yq.call(this),this.Receiver=t,this.receiveUrl=r,this.AjaxObject=o,this._scheduleReceiver()}cRe(HI,yq);HI.prototype._scheduleReceiver=function(){var t=this,r=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);r.on("message",function(o){t.emit("message",o)}),r.once("close",function(o,c){lRe("close",o,c,t.pollIsClosing),t.poll=r=null,t.pollIsClosing||(c==="network"?t._scheduleReceiver():(t.emit("close",o||1006,c),t.removeAllListeners()))})};HI.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()};var dRe=HI,uRe=cr,hRe=oc,fU=aRe,pRe=dRe;function mU(t,r,o,c,d){var h=hRe.addPath(t,r),f=this;fU.call(this,t,o),this.poll=new pRe(c,h,d),this.poll.on("message",function(_){f.emit("message",_)}),this.poll.once("close",function(_,v){f.poll=null,f.emit("close",_,v),f.close()})}uRe(mU,fU);mU.prototype.close=function(){fU.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)};var Sq=mU,fRe=cr,mRe=oc,bq=Sq;function gRe(t){return function(r,o,c){var d={};typeof o=="string"&&(d.headers={"Content-type":"text/plain"});var h=mRe.addPath(r,"/xhr_send"),f=new t("POST",h,o,d);return f.once("finish",function(_){if(f=null,_!==200&&_!==204)return c(new Error("http status "+_));c()}),function(){f.close(),f=null;var _=new Error("Aborted");_.code=1e3,c(_)}}}function Tq(t,r,o,c){bq.call(this,t,r,gRe(c),o,c)}fRe(Tq,bq);var d_=Tq,_Re=cr,Cq=Xs.EventEmitter;function S0(t,r){Cq.call(this);var o=this;this.bufferPosition=0,this.xo=new r("POST",t,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(c,d){o._chunkHandler(c,d),o.xo=null;var h=c===200?"network":"permanent";o.emit("close",null,h),o._cleanup()})}_Re(S0,Cq);S0.prototype._chunkHandler=function(t,r){if(!(t!==200||!r))for(var o=-1;;this.bufferPosition+=o+1){var c=r.slice(this.bufferPosition);if(o=c.indexOf(`
`),o===-1)break;var d=c.slice(0,o);d&&this.emit("message",d)}};S0.prototype._cleanup=function(){this.removeAllListeners()};S0.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()};var zI=S0,wq=Xs.EventEmitter,ERe=cr,Rq=Ph,vRe=oc,Wy=nt.XMLHttpRequest,DP=function(){};function jl(t,r,o,c){var d=this;wq.call(this),setTimeout(function(){d._start(t,r,o,c)},0)}ERe(jl,wq);jl.prototype._start=function(t,r,o,c){var d=this;try{this.xhr=new Wy}catch{}if(!this.xhr){this.emit("finish",0,"no xhr support"),this._cleanup();return}r=vRe.addQuery(r,"t="+ +new Date),this.unloadRef=Rq.unloadAdd(function(){d._cleanup(!0)});try{this.xhr.open(t,r,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){DP("xhr timeout"),d.emit("finish",0,""),d._cleanup(!1)})}catch{this.emit("finish",0,""),this._cleanup(!1);return}if((!c||!c.noCredentials)&&jl.supportsCORS&&(this.xhr.withCredentials=!0),c&&c.headers)for(var h in c.headers)this.xhr.setRequestHeader(h,c.headers[h]);this.xhr.onreadystatechange=function(){if(d.xhr){var f=d.xhr,_,v;switch(DP("readyState",f.readyState),f.readyState){case 3:try{v=f.status,_=f.responseText}catch{}v===1223&&(v=204),v===200&&_&&_.length>0&&d.emit("chunk",v,_);break;case 4:v=f.status,v===1223&&(v=204),(v===12005||v===12029)&&(v=0),DP("finish",v,f.responseText),d.emit("finish",v,f.responseText),d._cleanup(!1);break}}};try{d.xhr.send(o)}catch{d.emit("finish",0,""),d._cleanup(!1)}};jl.prototype._cleanup=function(t){if(this.xhr){if(this.removeAllListeners(),Rq.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),t)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}};jl.prototype.close=function(){this._cleanup(!0)};jl.enabled=!!Wy;var HG=["Active"].concat("Object").join("X");!jl.enabled&&HG in nt&&(Wy=function(){try{return new nt[HG]("Microsoft.XMLHTTP")}catch{return null}},jl.enabled=!!new Wy);var Iq=!1;try{Iq="withCredentials"in new Wy}catch{}jl.supportsCORS=Iq;var Aq=jl,yRe=cr,sR=Aq;function gU(t,r,o,c){sR.call(this,t,r,o,c)}yRe(gU,sR);gU.enabled=sR.enabled&&sR.supportsCORS;var KI=gU,SRe=cr,_U=Aq;function EU(t,r,o){_U.call(this,t,r,o,{noCredentials:!0})}SRe(EU,_U);EU.enabled=_U.enabled;var b0=EU,T0={isOpera:function(){return nt.navigator&&/opera/i.test(nt.navigator.userAgent)},isKonqueror:function(){return nt.navigator&&/konqueror/i.test(nt.navigator.userAgent)},hasDomain:function(){if(!nt.document)return!0;try{return!!nt.document.domain}catch{return!1}}},bRe=cr,Oq=d_,TRe=zI,GL=KI,CRe=b0,wRe=T0;function u_(t){if(!CRe.enabled&&!GL.enabled)throw new Error("Transport created when disabled");Oq.call(this,t,"/xhr_streaming",TRe,GL)}bRe(u_,Oq);u_.enabled=function(t){return t.nullOrigin||wRe.isOpera()?!1:GL.enabled};u_.transportName="xhr-streaming";u_.roundTrips=2;u_.needBody=!!nt.document;var RRe=u_,Nq=Xs.EventEmitter,IRe=cr,kq=Ph,ARe=T0,ORe=oc,NRe=function(){};function af(t,r,o){var c=this;Nq.call(this),setTimeout(function(){c._start(t,r,o)},0)}IRe(af,Nq);af.prototype._start=function(t,r,o){var c=this,d=new nt.XDomainRequest;r=ORe.addQuery(r,"t="+ +new Date),d.onerror=function(){c._error()},d.ontimeout=function(){c._error()},d.onprogress=function(){NRe("progress",d.responseText),c.emit("chunk",200,d.responseText)},d.onload=function(){c.emit("finish",200,d.responseText),c._cleanup(!1)},this.xdr=d,this.unloadRef=kq.unloadAdd(function(){c._cleanup(!0)});try{this.xdr.open(t,r),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(o)}catch{this._error()}};af.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)};af.prototype._cleanup=function(t){if(this.xdr){if(this.removeAllListeners(),kq.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,t)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}};af.prototype.close=function(){this._cleanup(!0)};af.enabled=!!(nt.XDomainRequest&&ARe.hasDomain());var vU=af,kRe=cr,xq=d_,xRe=zI,HL=vU;function C0(t){if(!HL.enabled)throw new Error("Transport created when disabled");xq.call(this,t,"/xhr_streaming",xRe,HL)}kRe(C0,xq);C0.enabled=function(t){return t.cookie_needed||t.nullOrigin?!1:HL.enabled&&t.sameScheme};C0.transportName="xdr-streaming";C0.roundTrips=2;var Pq=C0,Dq=nt.EventSource,PRe=cr,Lq=Xs.EventEmitter,DRe=Dq,zG=function(){};function w0(t){Lq.call(this);var r=this,o=this.es=new DRe(t);o.onmessage=function(c){zG("message",c.data),r.emit("message",decodeURI(c.data))},o.onerror=function(c){zG("error",o.readyState);var d=o.readyState!==2?"network":"permanent";r._cleanup(),r._close(d)}}PRe(w0,Lq);w0.prototype.abort=function(){this._cleanup(),this._close("user")};w0.prototype._cleanup=function(){var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)};w0.prototype._close=function(t){var r=this;setTimeout(function(){r.emit("close",null,t),r.removeAllListeners()},200)};var LRe=w0,MRe=cr,Mq=d_,URe=LRe,jRe=KI,FRe=Dq;function h_(t){if(!h_.enabled())throw new Error("Transport created when disabled");Mq.call(this,t,"/eventsource",URe,jRe)}MRe(h_,Mq);h_.enabled=function(){return!!FRe};h_.transportName="eventsource";h_.roundTrips=2;var KG=h_,LP,YG;function Uq(){return YG||(YG=1,LP="1.6.1"),LP}var jq={exports:{}};(function(t){var r=Ph,o=T0;t.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){t.exports.WPrefix in nt||(nt[t.exports.WPrefix]={})},postMessage:function(c,d){nt.parent!==nt&&nt.parent.postMessage(JSON.stringify({windowId:t.exports.currentWindowId,type:c,data:d||""}),"*")},createIframe:function(c,d){var h=nt.document.createElement("iframe"),f,_,v=function(){clearTimeout(f);try{h.onload=null}catch{}h.onerror=null},b=function(){h&&(v(),setTimeout(function(){h&&h.parentNode.removeChild(h),h=null},0),r.unloadDel(_))},A=function(x){h&&(b(),d(x))},w=function(x,M){setTimeout(function(){try{h&&h.contentWindow&&h.contentWindow.postMessage(x,M)}catch{}},0)};return h.src=c,h.style.display="none",h.style.position="absolute",h.onerror=function(){A("onerror")},h.onload=function(){clearTimeout(f),f=setTimeout(function(){A("onload timeout")},2e3)},nt.document.body.appendChild(h),f=setTimeout(function(){A("timeout")},15e3),_=r.unloadAdd(b),{post:w,cleanup:b,loaded:v}},createHtmlfile:function(c,d){var h=["Active"].concat("Object").join("X"),f=new nt[h]("htmlfile"),_,v,b,A=function(){clearTimeout(_),b.onerror=null},w=function(){f&&(A(),r.unloadDel(v),b.parentNode.removeChild(b),b=f=null,CollectGarbage())},x=function(G){f&&(w(),d(G))},M=function(G,H){try{setTimeout(function(){b&&b.contentWindow&&b.contentWindow.postMessage(G,H)},0)}catch{}};f.open(),f.write('<html><script>document.domain="'+nt.document.domain+'";<\/script></html>'),f.close(),f.parentWindow[t.exports.WPrefix]=nt[t.exports.WPrefix];var V=f.createElement("div");return f.body.appendChild(V),b=f.createElement("iframe"),V.appendChild(b),b.src=c,b.onerror=function(){x("onerror")},_=setTimeout(function(){x("timeout")},15e3),v=r.unloadAdd(w),{post:M,cleanup:w,loaded:A}}},t.exports.iframeEnabled=!1,nt.document&&(t.exports.iframeEnabled=(typeof nt.postMessage=="function"||typeof nt.postMessage=="object")&&!o.isKonqueror())})(jq);var R0=jq.exports,VRe=cr,Fq=Xs.EventEmitter,BRe=Uq(),zL=oc,Vq=R0,Bq=Ph,WRe=l_,Mv=function(){};function Bl(t,r,o){if(!Bl.enabled())throw new Error("Transport created when disabled");Fq.call(this);var c=this;this.origin=zL.getOrigin(o),this.baseUrl=o,this.transUrl=r,this.transport=t,this.windowId=WRe.string(8);var d=zL.addPath(o,"/iframe.html")+"#"+this.windowId;this.iframeObj=Vq.createIframe(d,function(h){c.emit("close",1006,"Unable to load an iframe ("+h+")"),c.close()}),this.onmessageCallback=this._message.bind(this),Bq.attachEvent("message",this.onmessageCallback)}VRe(Bl,Fq);Bl.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){Bq.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}};Bl.prototype._message=function(t){if(Mv("message",t.data),!zL.isOriginEqual(t.origin,this.origin)){Mv("not same origin",t.origin,this.origin);return}var r;try{r=JSON.parse(t.data)}catch{Mv("bad json",t.data);return}if(r.windowId!==this.windowId){Mv("mismatched window id",r.windowId,this.windowId);return}switch(r.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([BRe,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",r.data);break;case"c":var o;try{o=JSON.parse(r.data)}catch{Mv("bad json",r.data);return}this.emit("close",o[0],o[1]),this.close();break}};Bl.prototype.postMessage=function(t,r){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:t,data:r||""}),this.origin)};Bl.prototype.send=function(t){this.postMessage("m",t)};Bl.enabled=function(){return Vq.iframeEnabled};Bl.transportName="iframe";Bl.roundTrips=2;var Wq=Bl,yU={isObject:function(t){var r=typeof t;return r==="function"||r==="object"&&!!t},extend:function(t){if(!this.isObject(t))return t;for(var r,o,c=1,d=arguments.length;c<d;c++){r=arguments[c];for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t}},$Re=cr,LC=Wq,GRe=yU,MP=function(t){function r(o,c){LC.call(this,t.transportName,o,c)}return $Re(r,LC),r.enabled=function(o,c){if(!nt.document)return!1;var d=GRe.extend({},c);return d.sameOrigin=!0,t.enabled(d)&&LC.enabled()},r.transportName="iframe-"+t.transportName,r.needBody=!0,r.roundTrips=LC.roundTrips+t.roundTrips-1,r.facadeTransport=t,r},HRe=cr,Ip=R0,zRe=oc,$q=Xs.EventEmitter,KRe=l_,YRe=function(){};function Bc(t){$q.call(this);var r=this;Ip.polluteGlobalNamespace(),this.id="a"+KRe.string(6),t=zRe.addQuery(t,"c="+decodeURIComponent(Ip.WPrefix+"."+this.id)),YRe("using htmlfile",Bc.htmlfileEnabled);var o=Bc.htmlfileEnabled?Ip.createHtmlfile:Ip.createIframe;nt[Ip.WPrefix][this.id]={start:function(){r.iframeObj.loaded()},message:function(c){r.emit("message",c)},stop:function(){r._cleanup(),r._close("network")}},this.iframeObj=o(t,function(){r._cleanup(),r._close("permanent")})}HRe(Bc,$q);Bc.prototype.abort=function(){this._cleanup(),this._close("user")};Bc.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete nt[Ip.WPrefix][this.id]};Bc.prototype._close=function(t){this.emit("close",null,t),this.removeAllListeners()};Bc.htmlfileEnabled=!1;var qG=["Active"].concat("Object").join("X");if(qG in nt)try{Bc.htmlfileEnabled=!!new nt[qG]("htmlfile")}catch{}Bc.enabled=Bc.htmlfileEnabled||Ip.iframeEnabled;var qRe=Bc,XRe=cr,KL=qRe,JRe=b0,Gq=d_;function I0(t){if(!KL.enabled)throw new Error("Transport created when disabled");Gq.call(this,t,"/htmlfile",KL,JRe)}XRe(I0,Gq);I0.enabled=function(t){return KL.enabled&&t.sameOrigin};I0.transportName="htmlfile";I0.roundTrips=2;var XG=I0,QRe=cr,Hq=d_,ZRe=zI,YL=KI,zq=b0;function A0(t){if(!zq.enabled&&!YL.enabled)throw new Error("Transport created when disabled");Hq.call(this,t,"/xhr",ZRe,YL)}QRe(A0,Hq);A0.enabled=function(t){return t.nullOrigin?!1:zq.enabled&&t.sameOrigin?!0:YL.enabled};A0.transportName="xhr-polling";A0.roundTrips=2;var JG=A0,eIe=cr,Kq=d_,tIe=Pq,nIe=zI,QG=vU;function O0(t){if(!QG.enabled)throw new Error("Transport created when disabled");Kq.call(this,t,"/xhr",nIe,QG)}eIe(O0,Kq);O0.enabled=tIe.enabled;O0.transportName="xdr-polling";O0.roundTrips=2;var rIe=O0,cy=R0,Yq=l_,iIe=T0,sIe=oc,oIe=cr,qq=Xs.EventEmitter,aIe=function(){};function nc(t){var r=this;qq.call(this),cy.polluteGlobalNamespace(),this.id="a"+Yq.string(6);var o=sIe.addQuery(t,"c="+encodeURIComponent(cy.WPrefix+"."+this.id));nt[cy.WPrefix][this.id]=this._callback.bind(this),this._createScript(o),this.timeoutId=setTimeout(function(){r._abort(new Error("JSONP script loaded abnormally (timeout)"))},nc.timeout)}oIe(nc,qq);nc.prototype.abort=function(){if(nt[cy.WPrefix][this.id]){var t=new Error("JSONP user aborted read");t.code=1e3,this._abort(t)}};nc.timeout=35e3;nc.scriptErrorTimeout=1e3;nc.prototype._callback=function(t){this._cleanup(),!this.aborting&&(t&&this.emit("message",t),this.emit("close",null,"network"),this.removeAllListeners())};nc.prototype._abort=function(t){this._cleanup(),this.aborting=!0,this.emit("close",t.code,t.message),this.removeAllListeners()};nc.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var t=this.script;t.parentNode.removeChild(t),t.onreadystatechange=t.onerror=t.onload=t.onclick=null,this.script=null}delete nt[cy.WPrefix][this.id]};nc.prototype._scriptError=function(){var t=this;this.errorTimer||(this.errorTimer=setTimeout(function(){t.loadedOkay||t._abort(new Error("JSONP script loaded abnormally (onerror)"))},nc.scriptErrorTimeout))};nc.prototype._createScript=function(t){var r=this,o=this.script=nt.document.createElement("script"),c;if(o.id="a"+Yq.string(8),o.src=t,o.type="text/javascript",o.charset="UTF-8",o.onerror=this._scriptError.bind(this),o.onload=function(){r._abort(new Error("JSONP script loaded abnormally (onload)"))},o.onreadystatechange=function(){if(aIe("onreadystatechange",o.readyState),/loaded|closed/.test(o.readyState)){if(o&&o.htmlFor&&o.onclick){r.loadedOkay=!0;try{o.onclick()}catch{}}o&&r._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},typeof o.async>"u"&&nt.document.attachEvent)if(iIe.isOpera())c=this.script2=nt.document.createElement("script"),c.text="try{var a = document.getElementById('"+o.id+"'); if(a)a.onerror();}catch(x){};",o.async=c.async=!1;else{try{o.htmlFor=o.id,o.event="onclick"}catch{}o.async=!0}typeof o.async<"u"&&(o.async=!0);var d=nt.document.getElementsByTagName("head")[0];d.insertBefore(o,d.firstChild),c&&d.insertBefore(c,d.firstChild)};var cIe=nc,lIe=l_,ZG=oc,dIe=function(){},aa,ly;function uIe(t){try{return nt.document.createElement('<iframe name="'+t+'">')}catch{var r=nt.document.createElement("iframe");return r.name=t,r}}function hIe(){aa=nt.document.createElement("form"),aa.style.display="none",aa.style.position="absolute",aa.method="POST",aa.enctype="application/x-www-form-urlencoded",aa.acceptCharset="UTF-8",ly=nt.document.createElement("textarea"),ly.name="d",aa.appendChild(ly),nt.document.body.appendChild(aa)}var pIe=function(t,r,o){aa||hIe();var c="a"+lIe.string(8);aa.target=c,aa.action=ZG.addQuery(ZG.addPath(t,"/jsonp_send"),"i="+c);var d=uIe(c);d.id=c,d.style.display="none",aa.appendChild(d);try{ly.value=r}catch{}aa.submit();var h=function(f){d.onerror&&(d.onreadystatechange=d.onerror=d.onload=null,setTimeout(function(){d.parentNode.removeChild(d),d=null},500),ly.value="",o(f))};return d.onerror=function(){h()},d.onload=function(){h()},d.onreadystatechange=function(f){dIe("onreadystatechange",c,d.readyState),d.readyState==="complete"&&h()},function(){h(new Error("Aborted"))}},fIe=cr,Xq=Sq,mIe=cIe,gIe=pIe;function cf(t){if(!cf.enabled())throw new Error("Transport created when disabled");Xq.call(this,t,"/jsonp",gIe,mIe)}fIe(cf,Xq);cf.enabled=function(){return!!nt.document};cf.transportName="jsonp-polling";cf.roundTrips=1;cf.needBody=!0;var _Ie=cf,EIe=[iRe,RRe,Pq,KG,MP(KG),XG,MP(XG),JG,rIe,MP(JG),_Ie],$y=Array.prototype,SU=Object.prototype,vIe=Function.prototype,Gy=String.prototype,UP=$y.slice,bU=SU.toString,Jq=function(t){return SU.toString.call(t)==="[object Function]"},yIe=function(r){return bU.call(r)==="[object Array]"},Qq=function(r){return bU.call(r)==="[object String]"},SIe=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}(),qL;SIe?qL=function(t,r,o,c){!c&&r in t||Object.defineProperty(t,r,{configurable:!0,enumerable:!1,writable:!0,value:o})}:qL=function(t,r,o,c){!c&&r in t||(t[r]=o)};var N0=function(t,r,o){for(var c in r)SU.hasOwnProperty.call(r,c)&&qL(t,c,r[c],o)},Zq=function(t){if(t==null)throw new TypeError("can't convert "+t+" to object");return Object(t)};function bIe(t){var r=+t;return r!==r?r=0:r!==0&&r!==1/0&&r!==-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r))),r}function TIe(t){return t>>>0}function jP(){}N0(vIe,{bind:function(r){var o=this;if(!Jq(o))throw new TypeError("Function.prototype.bind called on incompatible "+o);for(var c=UP.call(arguments,1),d=function(){if(this instanceof v){var b=o.apply(this,c.concat(UP.call(arguments)));return Object(b)===b?b:this}else return o.apply(r,c.concat(UP.call(arguments)))},h=Math.max(0,o.length-c.length),f=[],_=0;_<h;_++)f.push("$"+_);var v=Function("binder","return function ("+f.join(",")+"){ return binder.apply(this, arguments); }")(d);return o.prototype&&(jP.prototype=o.prototype,v.prototype=new jP,jP.prototype=null),v}});N0(Array,{isArray:yIe});var eH=Object("a"),eX=eH[0]!=="a"||!(0 in eH),CIe=function(r){var o=!0,c=!0;return r&&(r.call("foo",function(d,h,f){typeof f!="object"&&(o=!1)}),r.call([1],function(){c=typeof this=="string"},"x")),!!r&&o&&c};N0($y,{forEach:function(r){var o=Zq(this),c=eX&&Qq(this)?this.split(""):o,d=arguments[1],h=-1,f=c.length>>>0;if(!Jq(r))throw new TypeError;for(;++h<f;)h in c&&r.call(d,c[h],h,o)}},!CIe($y.forEach));var wIe=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;N0($y,{indexOf:function(r){var o=eX&&Qq(this)?this.split(""):Zq(this),c=o.length>>>0;if(!c)return-1;var d=0;for(arguments.length>1&&(d=bIe(arguments[1])),d=d>=0?d:Math.max(0,c+d);d<c;d++)if(d in o&&o[d]===r)return d;return-1}},wIe);var tH=Gy.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1?function(){var t=/()??/.exec("")[1]===void 0;Gy.split=function(r,o){var c=this;if(r===void 0&&o===0)return[];if(bU.call(r)!=="[object RegExp]")return tH.call(this,r,o);var d=[],h=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.extended?"x":"")+(r.sticky?"y":""),f=0,_,v,b,A;for(r=new RegExp(r.source,h+"g"),c+="",t||(_=new RegExp("^"+r.source+"$(?!\\s)",h)),o=o===void 0?-1>>>0:TIe(o);(v=r.exec(c))&&(b=v.index+v[0].length,!(b>f&&(d.push(c.slice(f,v.index)),!t&&v.length>1&&v[0].replace(_,function(){for(var w=1;w<arguments.length-2;w++)arguments[w]===void 0&&(v[w]=void 0)}),v.length>1&&v.index<c.length&&$y.push.apply(d,v.slice(1)),A=v[0].length,f=b,d.length>=o)));)r.lastIndex===v.index&&r.lastIndex++;return f===c.length?(A||!r.test(""))&&d.push(""):d.push(c.slice(f)),d.length>o?d.slice(0,o):d}}():"0".split(void 0,0).length&&(Gy.split=function(r,o){return r===void 0&&o===0?[]:tH.call(this,r,o)});var RIe=Gy.substr,IIe="".substr&&"0b".substr(-1)!=="b";N0(Gy,{substr:function(r,o){return RIe.call(this,r<0&&(r=this.length+r)<0?0:r,o)}},IIe);var MC=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,FP,AIe=function(t){var r,o={},c=[];for(r=0;r<65536;r++)c.push(String.fromCharCode(r));return t.lastIndex=0,c.join("").replace(t,function(d){return o[d]="\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,o},OIe={quote:function(t){var r=JSON.stringify(t);return MC.lastIndex=0,MC.test(r)?(FP||(FP=AIe(MC)),r.replace(MC,function(o){return FP[o]})):r}},VP=function(){},NIe=function(t){return{filterToEnabled:function(r,o){var c={main:[],facade:[]};return r?typeof r=="string"&&(r=[r]):r=[],t.forEach(function(d){if(d&&!(d.transportName==="websocket"&&o.websocket===!1)){if(r.length&&r.indexOf(d.transportName)===-1){VP("not in whitelist",d.transportName);return}d.enabled(o)?(VP("enabled",d.transportName),c.main.push(d),d.facadeTransport&&c.facade.push(d.facadeTransport)):VP("disabled",d.transportName)}}),c}}},XL={};["log","debug","warn"].forEach(function(t){var r;try{r=nt.console&&nt.console[t]&&nt.console[t].apply}catch{}XL[t]=r?function(){return nt.console[t].apply(nt.console,arguments)}:t==="log"?function(){}:XL.log});var kIe=XL;function lf(t){this.type=t}lf.prototype.initEvent=function(t,r,o){return this.type=t,this.bubbles=r,this.cancelable=o,this.timeStamp=+new Date,this};lf.prototype.stopPropagation=function(){};lf.prototype.preventDefault=function(){};lf.CAPTURING_PHASE=1;lf.AT_TARGET=2;lf.BUBBLING_PHASE=3;var TU=lf,tX=nt.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""},xIe=cr,nX=TU;function rX(){nX.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}xIe(rX,nX);var PIe=rX,DIe=cr,iX=TU;function sX(t){iX.call(this),this.initEvent("message",!1,!1),this.data=t}DIe(sX,iX);var LIe=sX,oX=Xs.EventEmitter,MIe=cr;function k0(){var t=this;oX.call(this),this.to=setTimeout(function(){t.emit("finish",200,"{}")},k0.timeout)}MIe(k0,oX);k0.prototype.close=function(){clearTimeout(this.to)};k0.timeout=2e3;var UIe=k0,aX=Xs.EventEmitter,jIe=cr,FIe=yU;function CU(t,r){aX.call(this);var o=this,c=+new Date;this.xo=new r("GET",t),this.xo.once("finish",function(d,h){var f,_;if(d===200){if(_=+new Date-c,h)try{f=JSON.parse(h)}catch{}FIe.isObject(f)||(f={})}o.emit("finish",f,_),o.removeAllListeners()})}jIe(CU,aX);CU.prototype.close=function(){this.removeAllListeners(),this.xo.close()};var cX=CU,BP,nH;function lX(){if(nH)return BP;nH=1;var t=cr,r=Xs.EventEmitter,o=b0,c=cX;function d(h){var f=this;r.call(this),this.ir=new c(h,o),this.ir.once("finish",function(_,v){f.ir=null,f.emit("message",JSON.stringify([_,v]))})}return t(d,r),d.transportName="iframe-info-receiver",d.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},BP=d,BP}var dX=Xs.EventEmitter,VIe=cr,BIe=Ph,uX=Wq,WIe=lX();function YI(t,r){var o=this;dX.call(this);var c=function(){var d=o.ifr=new uX(WIe.transportName,r,t);d.once("message",function(h){if(h){var f;try{f=JSON.parse(h)}catch{o.emit("finish"),o.close();return}var _=f[0],v=f[1];o.emit("finish",_,v)}o.close()}),d.once("close",function(){o.emit("finish"),o.close()})};nt.document.body?c():BIe.attachEvent("load",c)}VIe(YI,dX);YI.enabled=function(){return uX.enabled()};YI.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null};var $Ie=YI,hX=Xs.EventEmitter,GIe=cr,HIe=oc,rH=vU,iH=KI,zIe=b0,KIe=UIe,sH=$Ie,UC=cX;function Od(t,r){var o=this;hX.call(this),setTimeout(function(){o.doXhr(t,r)},0)}GIe(Od,hX);Od._getReceiver=function(t,r,o){return o.sameOrigin?new UC(r,zIe):iH.enabled?new UC(r,iH):rH.enabled&&o.sameScheme?new UC(r,rH):sH.enabled()?new sH(t,r):new UC(r,KIe)};Od.prototype.doXhr=function(t,r){var o=this,c=HIe.addPath(t,"/info");this.xo=Od._getReceiver(t,c,r),this.timeoutRef=setTimeout(function(){o._cleanup(!1),o.emit("finish")},Od.timeout),this.xo.once("finish",function(d,h){o._cleanup(!0),o.emit("finish",d,h)})};Od.prototype._cleanup=function(t){clearTimeout(this.timeoutRef),this.timeoutRef=null,!t&&this.xo&&this.xo.close(),this.xo=null};Od.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)};Od.timeout=8e3;var YIe=Od,WP,oH;function qIe(){if(oH)return WP;oH=1;var t=R0;function r(o){this._transport=o,o.on("message",this._transportMessage.bind(this)),o.on("close",this._transportClose.bind(this))}return r.prototype._transportClose=function(o,c){t.postMessage("c",JSON.stringify([o,c]))},r.prototype._transportMessage=function(o){t.postMessage("t",o)},r.prototype._send=function(o){this._transport.send(o)},r.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},WP=r,WP}var $P,aH;function XIe(){if(aH)return $P;aH=1;var t=oc,r=Ph,o=qIe(),c=lX(),d=R0,h=tX,f=function(){};return $P=function(_,v){var b={};v.forEach(function(w){w.facadeTransport&&(b[w.facadeTransport.transportName]=w.facadeTransport)}),b[c.transportName]=c;var A;_.bootstrap_iframe=function(){var w;d.currentWindowId=h.hash.slice(1);var x=function(M){if(M.source===parent&&(typeof A>"u"&&(A=M.origin),M.origin===A)){var V;try{V=JSON.parse(M.data)}catch{f("bad json",M.data);return}if(V.windowId===d.currentWindowId)switch(V.type){case"s":var G;try{G=JSON.parse(V.data)}catch{f("bad json",V.data);break}var H=G[0],F=G[1],B=G[2],L=G[3];if(H!==_.version)throw new Error('Incompatible SockJS! Main site uses: "'+H+'", the iframe: "'+_.version+'".');if(!t.isOriginEqual(B,h.href)||!t.isOriginEqual(L,h.href))throw new Error("Can't connect to different domain from within an iframe. ("+h.href+", "+B+", "+L+")");w=new o(new b[F](B,L));break;case"m":w._send(V.data);break;case"c":w&&w._close(),w=null;break}}};r.attachEvent("message",x),d.postMessage("s")}},$P}var JIe=fq,QIe=cr,cH=l_,ZIe=OIe,zv=oc,eAe=Ph,tAe=NIe,nAe=yU,rAe=T0,iAe=kIe,wU=TU,pX=mq,jC=tX,sAe=PIe,lH=LIe,oAe=YIe,Ll=function(){},fX;function nr(t,r,o){if(!(this instanceof nr))return new nr(t,r,o);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");pX.call(this),this.readyState=nr.CONNECTING,this.extensions="",this.protocol="",o=o||{},o.protocols_whitelist&&iAe.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=o.transports,this._transportOptions=o.transportOptions||{},this._timeout=o.timeout||0;var c=o.sessionId||8;if(typeof c=="function")this._generateSessionId=c;else if(typeof c=="number")this._generateSessionId=function(){return cH.string(c)};else throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=o.server||cH.numberString(1e3);var d=new JIe(t);if(!d.host||!d.protocol)throw new SyntaxError("The URL '"+t+"' is invalid");if(d.hash)throw new SyntaxError("The URL must not contain a fragment");if(d.protocol!=="http:"&&d.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+d.protocol+"' is not allowed.");var h=d.protocol==="https:";if(jC.protocol==="https:"&&!h&&!zv.isLoopbackAddr(d.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");r?Array.isArray(r)||(r=[r]):r=[];var f=r.sort();f.forEach(function(v,b){if(!v)throw new SyntaxError("The protocols entry '"+v+"' is invalid.");if(b<f.length-1&&v===f[b+1])throw new SyntaxError("The protocols entry '"+v+"' is duplicated.")});var _=zv.getOrigin(jC.href);this._origin=_?_.toLowerCase():null,d.set("pathname",d.pathname.replace(/\/+$/,"")),this.url=d.href,Ll("using url",this.url),this._urlInfo={nullOrigin:!rAe.hasDomain(),sameOrigin:zv.isOriginEqual(this.url,jC.href),sameScheme:zv.isSchemeEqual(this.url,jC.href)},this._ir=new oAe(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}QIe(nr,pX);function mX(t){return t===1e3||t>=3e3&&t<=4999}nr.prototype.close=function(t,r){if(t&&!mX(t))throw new Error("InvalidAccessError: Invalid code");if(r&&r.length>123)throw new SyntaxError("reason argument has an invalid length");if(!(this.readyState===nr.CLOSING||this.readyState===nr.CLOSED)){var o=!0;this._close(t||1e3,r||"Normal closure",o)}};nr.prototype.send=function(t){if(typeof t!="string"&&(t=""+t),this.readyState===nr.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===nr.OPEN&&this._transport.send(ZIe.quote(t))};nr.version=Uq();nr.CONNECTING=0;nr.OPEN=1;nr.CLOSING=2;nr.CLOSED=3;nr.prototype._receiveInfo=function(t,r){if(this._ir=null,!t){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(r),this._transUrl=t.base_url?t.base_url:this.url,t=nAe.extend(t,this._urlInfo);var o=fX.filterToEnabled(this._transportsWhitelist,t);this._transports=o.main,Ll(this._transports.length+" enabled transports"),this._connect()};nr.prototype._connect=function(){for(var t=this._transports.shift();t;t=this._transports.shift()){if(Ll("attempt",t.transportName),t.needBody&&(!nt.document.body||typeof nt.document.readyState<"u"&&nt.document.readyState!=="complete"&&nt.document.readyState!=="interactive")){this._transports.unshift(t),eAe.attachEvent("load",this._connect.bind(this));return}var r=Math.max(this._timeout,this._rto*t.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),r);var o=zv.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),c=this._transportOptions[t.transportName],d=new t(o,this._transUrl,c);d.on("message",this._transportMessage.bind(this)),d.once("close",this._transportClose.bind(this)),d.transportName=t.transportName,this._transport=d;return}this._close(2e3,"All transports failed",!1)};nr.prototype._transportTimeout=function(){this.readyState===nr.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))};nr.prototype._transportMessage=function(t){var r=this,o=t.slice(0,1),c=t.slice(1),d;switch(o){case"o":this._open();return;case"h":this.dispatchEvent(new wU("heartbeat")),Ll("heartbeat",this.transport);return}if(c)try{d=JSON.parse(c)}catch{}if(!(typeof d>"u"))switch(o){case"a":Array.isArray(d)&&d.forEach(function(h){Ll("message",r.transport),r.dispatchEvent(new lH(h))});break;case"m":Ll("message",this.transport),this.dispatchEvent(new lH(d));break;case"c":Array.isArray(d)&&d.length===2&&this._close(d[0],d[1],!0);break}};nr.prototype._transportClose=function(t,r){if(Ll("_transportClose",this.transport),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!mX(t)&&t!==2e3&&this.readyState===nr.CONNECTING){this._connect();return}this._close(t,r)};nr.prototype._open=function(){Ll("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===nr.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=nr.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new wU("open")),Ll("connected",this.transport)):this._close(1006,"Server lost session")};nr.prototype._close=function(t,r,o){Ll("_close",this.transport,t,r,o,this.readyState);var c=!1;if(this._ir&&(c=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===nr.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=nr.CLOSING,setTimeout((function(){this.readyState=nr.CLOSED,c&&this.dispatchEvent(new wU("error"));var d=new sAe;d.wasClean=o||!1,d.code=t||1e3,d.reason=r,this.dispatchEvent(d),this.onmessage=this.onclose=this.onerror=null}).bind(this),0)};nr.prototype.countRTO=function(t){return t>100?4*t:300+t};var aAe=function(t){return fX=tAe(t),XIe()(nr,t),nr},cAe=EIe,lAe=aAe(cAe);"_sockjs_onload"in nt&&setTimeout(nt._sockjs_onload,1);const gX=Yg(lAe);let Kv=null;const dH=(t,r,o,c)=>{const d=_=>{console.log(_.body),o(v=>[...v,JSON.parse(_.body)])};let h=new gX("http://ec2-13-213-1-120.ap-southeast-1.compute.amazonaws.com:8080/api/ws");Kv=aq.over(h);const f=()=>{Kv.subscribe(`/chatroom/${t==null?void 0:t.id}`,d),Kv.send(`/app/chat/${t==null?void 0:t.id}`,{},JSON.stringify(r))};Kv.connect({Authorization:`Bearer ${c}`},f,_=>console.log(_))},dAe=(t,r,o,c)=>{let d=new gX("http://ec2-13-213-1-120.ap-southeast-1.compute.amazonaws.com:8080/api/ws");Kv=aq.over(d)},uAe=({message:t,chatId:r,isGroup:o,querychat:c,mess:d,mesref:h,searchQuery:f,setChats:_})=>{var Ft,mr,Hr,Mn,Wi,lr,Yn,an,It;const{sender:v,content:b,createdAt:A,avatar:w,reactions:x,attachments:M,messageId:V,status:G,type:H}=t;K.useRef(null);const[F,B]=K.useState(!1),[L,X]=K.useState(!1),[ee,ce]=K.useState(t==null?void 0:t.reactions),ie=()=>{X(!0)},ne=()=>{X(!1)},[fe,oe]=K.useState(!1),ue=()=>{oe(!0)},Ne=()=>{oe(!1)},Ee=ot=>{ot.preventDefault(),B(!F),X(!0)};K.useEffect(()=>{console.log("reactions",x)},[t==null?void 0:t.reactions,x]);const[we,Re]=K.useState(""),[Pe,$e]=K.useState(""),[Ce,Fe]=K.useState("");qs({token:we,setToken:Re,setProfile:Fe,setPhone:$e});const[Ye,Mt]=K.useState(!1),yt=()=>{Mt(!Ye)},Xt=Os();let Ue=new y0;const Be=ki({mutationKey:["unSend"],mutationFn:async()=>await Ue.unsend(r,V,we).then(ot=>{if(ot.data)return console.log(ot.data),Xt.invalidateQueries(["chat"]),ot.data}).catch(ot=>{console.error(ot)})}),at=ki({mutationKey:["deleteChat"],mutationFn:async()=>await Ue.delete(r,V,we).then(ot=>{if(ot.data)return console.log(ot.data),Xt.invalidateQueries(["chat"]),ot.data}).catch(ot=>{console.error(ot)})}),Jt=()=>{Be.mutate()},un=()=>{at.mutate()},Ut=["like.png","love.png","cry.png","angry.png","wow.png"],Gr=ot=>{console.log("emo "+ot);const tn={type:ot,quantity:1};sn.mutate(tn)},sn=ki({mutationKey:["reaction"],mutationFn:async ot=>await Ue.reaction(r,V,ot,we).then(tn=>{tn.data&&(dAe(),console.log(ee),ce($i=>[...$i,tn.data.reactions]),c.refetch(),Xt.invalidateQueries(["chat"]))}).catch(tn=>{console.error(tn)})}),[hn,Ht]=K.useState(0);K.useEffect(()=>{let ot=0;ee==null||ee.forEach(tn=>{ot+=(tn==null?void 0:tn.quantity)||0}),Ht(ot)},[ee]);const on=[],[rt,_n]=K.useState(!1),Kn=()=>{_n(!0)};K.useEffect(()=>{},[rt]);const[En,fi]=K.useState(!1),fr=()=>{fi(!0),X(!0)};return T.jsx(T.Fragment,{children:T.jsxs("div",{ref:ot=>h.current[V]=ot,className:`mb-3 flex ${L?"group":""} ${(v==null?void 0:v.id)===Ce.id&&v?"justify-end mr-20":"justify-start"}`,onMouseEnter:()=>ie(),onMouseLeave:()=>ne(),onContextMenu:Ee,children:[(v==null?void 0:v.id)===Ce.id&&v!=="null"&&T.jsx("div",{children:T.jsx("div",{className:"flex items-end",children:L&&G!=="UNSEND"&&H!=="EVENT"?T.jsxs("div",{className:"mb-3 ml-7 mr-3 flex w-[116px] justify-between rounded-lg bg-[#DDDBDB] p-1 px-2",children:[T.jsx("a",{href:"",children:T.jsx("img",{src:"/src/assets/reply-arrow.png",alt:"",className:"h-4 w-4"})}),T.jsx("a",{className:"cursor-pointer",onClick:()=>fr(),children:T.jsx("img",{src:"/src/assets/reply.png",alt:"",className:"h-4 w-4"})}),En&&t!==void 0&&T.jsx(PG,{showShare:En,setShowShare:fi,message:t}),T.jsx("a",{href:"",children:T.jsx("img",{src:"/src/assets/todos.png",alt:"",className:"h-4 w-4"})}),T.jsxs("a",{onClick:()=>yt(),className:"relative cursor-pointer",children:[Ye&&T.jsx("div",{className:"bg-white absolute z-50 right-0 w-52 py-2 mt-1 border border-gray-200 shadow-2xl",style:{display:"none;"},children:T.jsxs("div",{className:"py-2 border-b",children:[T.jsx("div",{className:"flex justify-end",children:T.jsx("div",{className:"text-gray-700 text-xs px-6 uppercase mb-1 ",children:T.jsx("button",{onClick:()=>yt(),children:T.jsx(Dn,{icon:Ny})})})}),T.jsx("button",{className:"w-full flex items-center px-6 py-1.5 space-x-2 hover:bg-gray-200",children:T.jsx("span",{onClick:()=>navigator.clipboard.writeText(b),className:"cursor-pointer text-sm text-gray-700",children:"Sao chép"})}),T.jsx("button",{onClick:()=>Jt(),className:"cursor-pointer w-full flex items-center py-1.5 px-6 space-x-2 hover:bg-gray-200",children:T.jsx("span",{className:"text-sm text-gray-700",children:"Thu hồi"})}),T.jsx("button",{onClick:()=>un(),className:"w-full cursor-pointer flex items-center py-1.5 px-6 space-x-2 hover:bg-gray-200",children:T.jsx("span",{className:"text-sm text-gray-700 ml-1",children:"Xoá"})})]})}),T.jsx("img",{src:"/src/assets/option.png",alt:"",className:"h-4 w-4"})]})]}):T.jsx("div",{className:"mb-3 ml-7 mr-3 flex w-[116px] justify-between rounded-lg p-1 px-2"})})}),(v==null?void 0:v.id)!==Ce.id&&v&&v!=="null"&&H!=="EVENT"&&T.jsx(T.Fragment,{children:T.jsx("div",{className:"flex",children:T.jsx(pi,{sx:{width:40,height:40},alt:"",src:v==null?void 0:v.thumbnailAvatar,className:"mr-5  z-0"})})}),T.jsx("div",{children:M&&(M==null?void 0:M.length)>0?T.jsxs("div",{className:`
               text-[#081c36] flex flex-col items-start p-3 transition-all duration-300`,children:[T.jsx("img",{src:(Ft=M[0])==null?void 0:Ft.url,width:160,height:160,alt:"img"}),T.jsxs("div",{className:`${(v==null?void 0:v.id)===(Ce==null?void 0:Ce.id)&&G!=="UNSEND"?"bg-blue-200 ":"bg-[#FFFFFF] "} flex flex-col items-start relative rounded-md p-3 w-40 transition-all duration-300 border border-t-2`,children:[T.jsx("div",{className:"items-center",children:T.jsx("div",{className:`text-[#081c36] ${f!=null&&f.trim()&&(b!=null&&b.includes(f))?"bg-yellow-300":""}  `,children:b})}),T.jsx("span",{className:"mt-3 text-xs text-gray-500",children:A}),G!=="UNSEND"&&H!=="EVENT"&&T.jsx("div",{className:"",children:ee&&ee.length>0&&T.jsx("div",{className:"absolute cursor-pointer transition-all duration-300 -bottom-3 right-10 ring-gray-400 ring-1 text-gray-500 bg-white p-1 rounded-full flex items-center justify-center",children:T.jsxs("div",{onClick:()=>Kn(),className:"flex",children:[ee==null?void 0:ee.map((ot,tn)=>{if(!on.includes(ot.type))return on.push(ot.type),T.jsx("div",{className:"flex items-center justify-end min-w-5",children:T.jsx("img",{src:ot.type==="LIKE"?Ut[0]:ot.type==="LOVE"?Ut[1]:ot.type==="CRY"?Ut[2]:ot.type==="ANGER"?Ut[3]:Ut[4],alt:"",className:"h-5 w-5"})},tn)}),hn!==0&&hn&&T.jsx("p",{children:hn})]})})}),T.jsx(xG,{reactions:ee,icons:Ut,showEmoDetails:rt,setShowEmoDetails:_n}),L&&G!=="UNSEND"&&H!=="EVENT"&&T.jsx("div",{onMouseEnter:ue,className:"duration-300",onMouseLeave:Ne,children:T.jsxs("div",{className:"absolute cursor-pointer transition-all duration-300 -bottom-3 right-2 ring-gray-400 ring-1 text-gray-500 bg-white p-1 rounded-full flex items-center justify-center",children:[(x==null?void 0:x.length)<=0?T.jsx(Dn,{icon:x$,className:"relative"}):T.jsx("div",{children:T.jsx("img",{src:((mr=ee[0])==null?void 0:mr.type)==="LIKE"?Ut[0]:((Hr=ee[0])==null?void 0:Hr.type)==="LOVE"?Ut[1]:((Mn=ee[0])==null?void 0:Mn.type)==="CRY"?Ut[2]:((Wi=ee[0])==null?void 0:Wi.type)==="ANGER"?Ut[3]:Ut[4],alt:"",className:"h-5 w-5"})}),fe&&T.jsx("div",{className:"absolute flex bottom-5 h-10 bg-white gap-2 rounded-full px-4 justify-center items-center min-w-52",children:Ut.map((ot,tn)=>T.jsx("img",{src:ot,onClick:()=>Gr(tn===0?"LIKE":tn===1?"LOVE":tn===2?"CRY":tn===3?"ANGER":"WOW"),alt:"",className:"h-7 w-7 hover:h-10 hover:w-10 cursor-pointer"},tn))})]})})]})]}):T.jsxs("div",{className:`${H==="EVENT"?"mx-[20rem] text-center items-center bg-gray-300 ":"bg-[#FFFFFF] "}  ${(v==null?void 0:v.id)===Ce.id&&G!="UNSEND"?" bg-blue-200 ":G==="UNSEND"?"bg-gray-100 text-sm":"bg-[#FFFFFF] "} flex flex-col items-start relative z-0 rounded-md p-3 transition-all duration-300`,children:[T.jsx("div",{className:"text-gray-500",children:o&&(v==null?void 0:v.id)!==(Ce==null?void 0:Ce.id)&&T.jsxs("div",{children:[v==null?void 0:v.firstName," ",v==null?void 0:v.lastName]})}),T.jsx("div",{className:"flex items-center mt-1",children:T.jsx("p",{className:`${f!=null&&f.trim()&&(b!=null&&b.includes(f))?"bg-yellow-300":""} ${G==="UNSEND"?"text-gray-500 text-sm ":"text-[#081c36] "} ${(v==null?void 0:v.id)===(Ce==null?void 0:Ce.id),""}`,children:b})}),T.jsx("span",{className:"mt-3 text-xs text-gray-500 pb-2",children:A}),G!=="UNSEND"&&H!=="EVENT"&&T.jsx("div",{className:"",children:ee&&ee.length>0&&T.jsx("div",{className:"absolute cursor-pointer transition-all duration-300 -bottom-3 right-10 ring-gray-400 ring-1 text-gray-500 bg-white p-1 rounded-full flex items-center justify-center",children:T.jsxs("div",{onClick:()=>Kn(),className:"flex",children:[ee==null?void 0:ee.map((ot,tn)=>{if(!on.includes(ot.type))return on.push(ot.type),T.jsx("div",{className:"flex items-center justify-end min-w-5",children:T.jsx("img",{src:ot.type==="LIKE"?Ut[0]:ot.type==="LOVE"?Ut[1]:ot.type==="CRY"?Ut[2]:ot.type==="ANGER"?Ut[3]:Ut[4],alt:"",className:"h-5 w-5"})},tn)}),hn!==0&&hn&&T.jsx("p",{children:hn})]})})}),T.jsx(xG,{reactions:ee,icons:Ut,showEmoDetails:rt,setShowEmoDetails:_n}),L&&G!=="UNSEND"&&H!=="EVENT"&&T.jsx("div",{onMouseEnter:ue,className:"duration-300",onMouseLeave:Ne,children:T.jsxs("div",{className:"absolute cursor-pointer transition-all duration-300 -bottom-3 right-2 ring-gray-400 ring-1 text-gray-500 bg-white p-1 rounded-full flex items-center justify-center",children:[(x==null?void 0:x.length)<=0?T.jsx(Dn,{icon:x$,className:"relative"}):T.jsx("div",{children:T.jsx("img",{src:((lr=ee[0])==null?void 0:lr.type)==="LIKE"?Ut[0]:((Yn=ee[0])==null?void 0:Yn.type)==="LOVE"?Ut[1]:((an=ee[0])==null?void 0:an.type)==="CRY"?Ut[2]:((It=ee[0])==null?void 0:It.type)==="ANGER"?Ut[3]:Ut[4],alt:"",className:"h-5 w-5"})}),fe&&T.jsx("div",{className:"absolute flex bottom-5 h-10 bg-white gap-2 rounded-full px-4 justify-center items-center min-w-52",children:Ut.map((ot,tn)=>T.jsx("img",{src:ot,onClick:()=>Gr(tn===0?"LIKE":tn===1?"LOVE":tn===2?"CRY":tn===3?"ANGER":"WOW"),alt:"",className:"h-7 w-7 hover:h-10 hover:w-10 cursor-pointer"},tn))})]})})]})}),(v==null?void 0:v.id)!==Ce.id&&v&&T.jsx("div",{className:"flex w-[155px] items-end",children:L&&G!=="UNSEND"&&H!=="EVENT"?T.jsxs("div",{className:"mb-3 ml-7 mr-3 flex w-[116px] justify-between rounded-lg bg-[#DDDBDB] p-1 px-2",children:[T.jsx("a",{href:"",children:T.jsx("img",{src:"/src/assets/reply-arrow.png",alt:"",className:"h-4 w-4"})}),T.jsx("a",{className:"cursor-pointer",onClick:()=>fr(),children:T.jsx("img",{src:"/src/assets/reply.png",alt:"",className:"h-4 w-4"})}),En&&t!==void 0&&T.jsx(PG,{showShare:En,setShowShare:fi,message:t}),T.jsx("a",{href:"",children:T.jsx("img",{src:"/src/assets/todos.png",alt:"",className:"h-4 w-4"})}),T.jsxs("a",{onClick:()=>yt(),className:"relative cursor-pointer",children:[Ye&&T.jsx("div",{className:"bg-white absolute z-50 right-0 w-52 py-2 mt-1 border border-gray-200 shadow-2xl",style:{display:"none;"},children:T.jsxs("div",{className:"py-2 border-b",children:[T.jsx("div",{className:"flex justify-end",children:T.jsx("div",{className:"text-gray-700 text-xs px-6 uppercase mb-1 ",children:T.jsx("button",{onClick:()=>yt(),children:T.jsx(Dn,{icon:Ny})})})}),T.jsx("button",{className:"w-full flex items-center px-6 py-1.5 space-x-2 hover:bg-gray-200",children:T.jsx("span",{onClick:()=>navigator.clipboard.writeText(b),className:"cursor-pointer text-sm text-gray-700",children:"Sao chép"})}),T.jsx("button",{onClick:()=>Jt(),className:"cursor-pointer w-full flex items-center py-1.5 px-6 space-x-2 hover:bg-gray-200",children:T.jsx("span",{className:"text-sm text-gray-700",children:"Thu hồi"})}),T.jsx("button",{onClick:()=>un(),className:"w-full cursor-pointer flex items-center py-1.5 px-6 space-x-2 hover:bg-gray-200",children:T.jsx("span",{className:"text-sm text-gray-700 ml-1",children:"Xoá"})})]})}),T.jsx("img",{src:"/src/assets/option.png",alt:"",className:"h-4 w-4"})]})]}):T.jsx("div",{className:"mb-3 ml-7 mr-3 flex w-[116px] justify-between rounded-lg p-1 px-2"})})]})})};function hAe(){const t=[{title:"Section 1",data:[{name:"Item1",avt:"https://www.vlance.vn/uploads/160x160/3435fd58f6937ad78ebd009ad162cd59080e3db51.jpg"},{name:"Item2",avt:"https://www.vlance.vn/uploads/160x160/3435fd58f6937ad78ebd009ad162cd59080e3db51.jpg"},{name:"Item3",avt:"https://www.vlance.vn/uploads/160x160/3435fd58f6937ad78ebd009ad162cd59080e3db51.jpg"}]}],r=({data:o})=>o.map((c,d)=>T.jsx("div",{className:"py-4",children:T.jsx("div",{children:o[d].data.map((h,f)=>T.jsxs("div",{className:"p-4 flex flex-row items-center",children:[T.jsx(pi,{alt:h.avt,src:h.avt,className:"m-4"}),T.jsx("div",{className:"w-full p-4 py-5 border-b",children:h.name})]},f))})},d));return T.jsx("div",{className:"h-screen w-full",children:T.jsxs("div",{className:"h-[69px] w-full",children:[T.jsx("div",{className:"flex h-full w-full flex-row items-center justify-between border-b",children:T.jsxs("div",{className:"flex flex-row items-center gap-x-2 px-4",children:[T.jsx(Dn,{icon:kM,className:"pl-1 pr-3"}),T.jsx("div",{className:"flex flex-col",children:T.jsx("div",{className:"text-lg font-medium text-[#081c36]",children:T.jsx("span",{children:"Danh sách bạn bè"})})})]})}),T.jsxs("div",{className:"bg-neutral-100 p-4 pr-2 h-[700px] w-full overflow-auto",children:[T.jsx("div",{className:"font-medium pb-4",children:"Bạn bè"}),T.jsx("div",{className:"bg-white rounded-l p-4 ",children:T.jsx(r,{data:t})})]})]})})}const pAe="modulepreload",fAe=function(t){return"/"+t},uH={},qI=function(r,o,c){let d=Promise.resolve();if(o&&o.length>0){const h=document.getElementsByTagName("link");d=Promise.all(o.map(f=>{if(f=fAe(f),f in uH)return;uH[f]=!0;const _=f.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(!!c)for(let w=h.length-1;w>=0;w--){const x=h[w];if(x.href===f&&(!_||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${v}`))return;const A=document.createElement("link");if(A.rel=_?"stylesheet":pAe,_||(A.as="script",A.crossOrigin=""),A.href=f,document.head.appendChild(A),_)return new Promise((w,x)=>{A.addEventListener("load",w),A.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${f}`)))})}))}return d.then(()=>r()).catch(h=>{const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=h,window.dispatchEvent(f),!f.defaultPrevented)throw h})},Td={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1};let $m,JL,zg,RU=!1,oR=!1,IU=!1,ca=!1,hH=null,QL=!1;const mAe={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},gAe=t=>{const r=new URL(t,As.$resourcesUrl$);return r.origin!==D0.location.origin?r.href:r.pathname},tf=(t,r="")=>()=>{},_Ae="slot-fb{display:contents}slot-fb[hidden]{display:none}",pH="http://www.w3.org/1999/xlink",fH={},EAe="http://www.w3.org/2000/svg",vAe="http://www.w3.org/1999/xhtml",yAe=t=>t!=null,AU=t=>(t=typeof t,t==="object"||t==="function");function SAe(t){var r,o,c;return(c=(o=(r=t.head)===null||r===void 0?void 0:r.querySelector('meta[name="csp-nonce"]'))===null||o===void 0?void 0:o.getAttribute("content"))!==null&&c!==void 0?c:void 0}const uo=(t,r,...o)=>{let c=null,d=null,h=null,f=!1,_=!1;const v=[],b=w=>{for(let x=0;x<w.length;x++)c=w[x],Array.isArray(c)?b(c):c!=null&&typeof c!="boolean"&&((f=typeof t!="function"&&!AU(c))&&(c=String(c)),f&&_?v[v.length-1].$text$+=c:v.push(f?aR(null,c):c),_=f)};if(b(o),r){r.key&&(d=r.key),r.name&&(h=r.name);{const w=r.className||r.class;w&&(r.class=typeof w!="object"?w:Object.keys(w).filter(x=>w[x]).join(" "))}}if(typeof t=="function")return t(r===null?{}:r,v,TAe);const A=aR(t,null);return A.$attrs$=r,v.length>0&&(A.$children$=v),A.$key$=d,A.$name$=h,A},aR=(t,r)=>{const o={$flags$:0,$tag$:t,$text$:r,$elm$:null,$children$:null};return o.$attrs$=null,o.$key$=null,o.$name$=null,o},x0={},bAe=t=>t&&t.$tag$===x0,TAe={forEach:(t,r)=>t.map(mH).forEach(r),map:(t,r)=>t.map(mH).map(r).map(CAe)},mH=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),CAe=t=>{if(typeof t.vtag=="function"){const o=Object.assign({},t.vattrs);return t.vkey&&(o.key=t.vkey),t.vname&&(o.name=t.vname),uo(t.vtag,o,...t.vchildren||[])}const r=aR(t.vtag,t.vtext);return r.$attrs$=t.vattrs,r.$children$=t.vchildren,r.$key$=t.vkey,r.$name$=t.vname,r},wAe=t=>e1e.map(r=>r(t)).find(r=>!!r),RAe=t=>f_(t).$modeName$,IAe=(t,r)=>t!=null&&!AU(t)?r&4?t==="false"?!1:t===""||!!t:r&2?parseFloat(t):r&1?String(t):t:t,AAe=t=>t,Nd=(t,r,o)=>{const c=AAe(t);return{emit:d=>OAe(c,r,{bubbles:!!(o&4),composed:!!(o&2),cancelable:!!(o&1),detail:d})}},OAe=(t,r,o)=>{const c=As.ce(r,o);return t.dispatchEvent(c),c},gH=new WeakMap,NAe=(t,r,o)=>{let c=lR.get(t);r1e&&o?(c=c||new CSSStyleSheet,typeof c=="string"?c=r:c.replaceSync(r)):c=r,lR.set(t,c)},kAe=(t,r,o)=>{var c;const d=_X(r,o),h=lR.get(d);if(t=t.nodeType===11?t:Fc,h)if(typeof h=="string"){t=t.head||t;let f=gH.get(t),_;if(f||gH.set(t,f=new Set),!f.has(d)){{_=Fc.createElement("style"),_.innerHTML=h;const v=(c=As.$nonce$)!==null&&c!==void 0?c:SAe(Fc);v!=null&&_.setAttribute("nonce",v),t.insertBefore(_,t.querySelector("link"))}r.$flags$&4&&(_.innerHTML+=_Ae),f&&f.add(d)}}else t.adoptedStyleSheets.includes(h)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,h]);return d},xAe=t=>{const r=t.$cmpMeta$,o=t.$hostElement$,c=r.$flags$,d=tf("attachStyles",r.$tagName$),h=kAe(o.shadowRoot?o.shadowRoot:o.getRootNode(),r,t.$modeName$);c&10&&(o["s-sc"]=h,o.classList.add(h+"-h"),c&2&&o.classList.add(h+"-s")),d()},_X=(t,r)=>"sc-"+(r&&t.$flags$&32?t.$tagName$+"-"+r:t.$tagName$),_H=(t,r,o,c,d,h)=>{if(o!==c){let f=bH(t,r),_=r.toLowerCase();if(r==="class"){const v=t.classList,b=EH(o),A=EH(c);v.remove(...b.filter(w=>w&&!A.includes(w))),v.add(...A.filter(w=>w&&!b.includes(w)))}else if(r==="style"){for(const v in o)(!c||c[v]==null)&&(v.includes("-")?t.style.removeProperty(v):t.style[v]="");for(const v in c)(!o||c[v]!==o[v])&&(v.includes("-")?t.style.setProperty(v,c[v]):t.style[v]=c[v])}else if(r!=="key")if(r==="ref")c&&c(t);else if(!t.__lookupSetter__(r)&&r[0]==="o"&&r[1]==="n"){if(r[2]==="-"?r=r.slice(3):bH(D0,_)?r=_.slice(2):r=_[2]+r.slice(3),o||c){const v=r.endsWith(EX);r=r.replace(DAe,""),o&&As.rel(t,r,o,v),c&&As.ael(t,r,c,v)}}else{const v=AU(c);if((f||v&&c!==null)&&!d)try{if(t.tagName.includes("-"))t[r]=c;else{const A=c??"";r==="list"?f=!1:(o==null||t[r]!=A)&&(t[r]=A)}}catch{}let b=!1;_!==(_=_.replace(/^xlink\:?/,""))&&(r=_,b=!0),c==null||c===!1?(c!==!1||t.getAttribute(r)==="")&&(b?t.removeAttributeNS(pH,r):t.removeAttribute(r)):(!f||h&4||d)&&!v&&(c=c===!0?"":c,b?t.setAttributeNS(pH,r,c):t.setAttribute(r,c))}}},PAe=/\s/,EH=t=>t?t.split(PAe):[],EX="Capture",DAe=new RegExp(EX+"$"),vX=(t,r,o,c)=>{const d=r.$elm$.nodeType===11&&r.$elm$.host?r.$elm$.host:r.$elm$,h=t&&t.$attrs$||fH,f=r.$attrs$||fH;for(c in h)c in f||_H(d,c,h[c],void 0,o,r.$flags$);for(c in f)_H(d,c,h[c],f[c],o,r.$flags$)},cR=(t,r,o,c)=>{var d;const h=r.$children$[o];let f=0,_,v,b;if(RU||(IU=!0,h.$tag$==="slot"&&($m&&c.classList.add($m+"-s"),h.$flags$|=h.$children$?2:1)),h.$text$!==null)_=h.$elm$=Fc.createTextNode(h.$text$);else if(h.$flags$&1)_=h.$elm$=Fc.createTextNode("");else{if(ca||(ca=h.$tag$==="svg"),_=h.$elm$=Fc.createElementNS(ca?EAe:vAe,h.$flags$&2?"slot-fb":h.$tag$),ca&&h.$tag$==="foreignObject"&&(ca=!1),vX(null,h,ca),yAe($m)&&_["s-si"]!==$m&&_.classList.add(_["s-si"]=$m),h.$children$)for(f=0;f<h.$children$.length;++f)v=cR(t,h,f,_),v&&_.appendChild(v);h.$tag$==="svg"?ca=!1:_.tagName==="foreignObject"&&(ca=!0)}return _["s-hn"]=zg,h.$flags$&3&&(_["s-sr"]=!0,_["s-cr"]=JL,_["s-sn"]=h.$name$||"",_["s-rf"]=(d=h.$attrs$)===null||d===void 0?void 0:d.ref,b=t&&t.$children$&&t.$children$[o],b&&b.$tag$===h.$tag$&&t.$elm$&&Hy(t.$elm$,!1)),_},Hy=(t,r)=>{As.$flags$|=1;const o=Array.from(t.childNodes);if(t["s-sr"]&&Td.experimentalSlotFixes){let c=t;for(;c=c.nextSibling;)c&&c["s-sn"]===t["s-sn"]&&c["s-sh"]===zg&&o.push(c)}for(let c=o.length-1;c>=0;c--){const d=o[c];d["s-hn"]!==zg&&d["s-ol"]&&(bX(d).insertBefore(d,OU(d)),d["s-ol"].remove(),d["s-ol"]=void 0,d["s-sh"]=void 0,IU=!0),r&&Hy(d,r)}As.$flags$&=-2},yX=(t,r,o,c,d,h)=>{let f=t["s-cr"]&&t["s-cr"].parentNode||t,_;for(f.shadowRoot&&f.tagName===zg&&(f=f.shadowRoot);d<=h;++d)c[d]&&(_=cR(null,o,d,t),_&&(c[d].$elm$=_,f.insertBefore(_,OU(r))))},SX=(t,r,o)=>{for(let c=r;c<=o;++c){const d=t[c];if(d){const h=d.$elm$;wX(d),h&&(oR=!0,h["s-ol"]?h["s-ol"].remove():Hy(h,!0),h.remove())}}},LAe=(t,r,o,c,d=!1)=>{let h=0,f=0,_=0,v=0,b=r.length-1,A=r[0],w=r[b],x=c.length-1,M=c[0],V=c[x],G,H;for(;h<=b&&f<=x;)if(A==null)A=r[++h];else if(w==null)w=r[--b];else if(M==null)M=c[++f];else if(V==null)V=c[--x];else if(FC(A,M,d))Gm(A,M,d),A=r[++h],M=c[++f];else if(FC(w,V,d))Gm(w,V,d),w=r[--b],V=c[--x];else if(FC(A,V,d))(A.$tag$==="slot"||V.$tag$==="slot")&&Hy(A.$elm$.parentNode,!1),Gm(A,V,d),t.insertBefore(A.$elm$,w.$elm$.nextSibling),A=r[++h],V=c[--x];else if(FC(w,M,d))(A.$tag$==="slot"||V.$tag$==="slot")&&Hy(w.$elm$.parentNode,!1),Gm(w,M,d),t.insertBefore(w.$elm$,A.$elm$),w=r[--b],M=c[++f];else{for(_=-1,v=h;v<=b;++v)if(r[v]&&r[v].$key$!==null&&r[v].$key$===M.$key$){_=v;break}_>=0?(H=r[_],H.$tag$!==M.$tag$?G=cR(r&&r[f],o,_,t):(Gm(H,M,d),r[_]=void 0,G=H.$elm$),M=c[++f]):(G=cR(r&&r[f],o,f,t),M=c[++f]),G&&bX(A.$elm$).insertBefore(G,OU(A.$elm$))}h>b?yX(t,c[x+1]==null?null:c[x+1].$elm$,o,c,f,x):f>x&&SX(r,h,b)},FC=(t,r,o=!1)=>t.$tag$===r.$tag$?t.$tag$==="slot"?t.$name$===r.$name$:o?!0:t.$key$===r.$key$:!1,OU=t=>t&&t["s-ol"]||t,bX=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,Gm=(t,r,o=!1)=>{const c=r.$elm$=t.$elm$,d=t.$children$,h=r.$children$,f=r.$tag$,_=r.$text$;let v;_===null?(ca=f==="svg"?!0:f==="foreignObject"?!1:ca,f==="slot"&&!RU||vX(t,r,ca),d!==null&&h!==null?LAe(c,d,r,h,o):h!==null?(t.$text$!==null&&(c.textContent=""),yX(c,null,r,h,0,h.length-1)):d!==null&&SX(d,0,d.length-1),ca&&f==="svg"&&(ca=!1)):(v=c["s-cr"])?v.parentNode.textContent=_:t.$text$!==_&&(c.data=_)},TX=t=>{const r=t.childNodes;for(const o of r)if(o.nodeType===1){if(o["s-sr"]){const c=o["s-sn"];o.hidden=!1;for(const d of r)if(d!==o){if(d["s-hn"]!==o["s-hn"]||c!==""){if(d.nodeType===1&&(c===d.getAttribute("slot")||c===d["s-sn"])){o.hidden=!0;break}}else if(d.nodeType===1||d.nodeType===3&&d.textContent.trim()!==""){o.hidden=!0;break}}}TX(o)}},Sd=[],CX=t=>{let r,o,c;for(const d of t.childNodes){if(d["s-sr"]&&(r=d["s-cr"])&&r.parentNode){o=r.parentNode.childNodes;const h=d["s-sn"];for(c=o.length-1;c>=0;c--)if(r=o[c],!r["s-cn"]&&!r["s-nr"]&&r["s-hn"]!==d["s-hn"]&&!Td.experimentalSlotFixes)if(vH(r,h)){let f=Sd.find(_=>_.$nodeToRelocate$===r);oR=!0,r["s-sn"]=r["s-sn"]||h,f?(f.$nodeToRelocate$["s-sh"]=d["s-hn"],f.$slotRefNode$=d):(r["s-sh"]=d["s-hn"],Sd.push({$slotRefNode$:d,$nodeToRelocate$:r})),r["s-sr"]&&Sd.map(_=>{vH(_.$nodeToRelocate$,r["s-sn"])&&(f=Sd.find(v=>v.$nodeToRelocate$===r),f&&!_.$slotRefNode$&&(_.$slotRefNode$=f.$slotRefNode$))})}else Sd.some(f=>f.$nodeToRelocate$===r)||Sd.push({$nodeToRelocate$:r})}d.nodeType===1&&CX(d)}},vH=(t,r)=>t.nodeType===1?t.getAttribute("slot")===null&&r===""||t.getAttribute("slot")===r:t["s-sn"]===r?!0:r==="",wX=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(wX)},MAe=(t,r,o=!1)=>{var c,d,h,f,_;const v=t.$hostElement$,b=t.$cmpMeta$,A=t.$vnode$||aR(null,null),w=bAe(r)?r:uo(null,null,r);if(zg=v.tagName,b.$attrsToReflect$&&(w.$attrs$=w.$attrs$||{},b.$attrsToReflect$.map(([x,M])=>w.$attrs$[M]=v[x])),o&&w.$attrs$)for(const x of Object.keys(w.$attrs$))v.hasAttribute(x)&&!["key","ref","style","class"].includes(x)&&(w.$attrs$[x]=v[x]);w.$tag$=null,w.$flags$|=4,t.$vnode$=w,w.$elm$=A.$elm$=v.shadowRoot||v,$m=v["s-sc"],RU=(b.$flags$&1)!==0,JL=v["s-cr"],oR=!1,Gm(A,w,o);{if(As.$flags$|=1,IU){CX(w.$elm$);for(const x of Sd){const M=x.$nodeToRelocate$;if(!M["s-ol"]){const V=Fc.createTextNode("");V["s-nr"]=M,M.parentNode.insertBefore(M["s-ol"]=V,M)}}for(const x of Sd){const M=x.$nodeToRelocate$,V=x.$slotRefNode$;if(V){const G=V.parentNode;let H=V.nextSibling;{let F=(c=M["s-ol"])===null||c===void 0?void 0:c.previousSibling;for(;F;){let B=(d=F["s-nr"])!==null&&d!==void 0?d:null;if(B&&B["s-sn"]===M["s-sn"]&&G===B.parentNode&&(B=B.nextSibling,!B||!B["s-nr"])){H=B;break}F=F.previousSibling}}(!H&&G!==M.parentNode||M.nextSibling!==H)&&M!==H&&(!M["s-hn"]&&M["s-ol"]&&(M["s-hn"]=M["s-ol"].parentNode.nodeName),G.insertBefore(M,H),M.nodeType===1&&(M.hidden=(h=M["s-ih"])!==null&&h!==void 0?h:!1)),M&&typeof V["s-rf"]=="function"&&V["s-rf"](M)}else M.nodeType===1&&(o&&(M["s-ih"]=(f=M.hidden)!==null&&f!==void 0?f:!1),M.hidden=!0)}}oR&&TX(w.$elm$),As.$flags$&=-2,Sd.length=0}if(Td.experimentalScopedSlotChanges&&b.$flags$&2)for(const x of w.$elm$.childNodes)x["s-hn"]!==zg&&!x["s-sh"]&&(o&&x["s-ih"]==null&&(x["s-ih"]=(_=x.hidden)!==null&&_!==void 0?_:!1),x.hidden=!0);JL=void 0},UAe=(t,r)=>{},RX=(t,r)=>(t.$flags$|=16,UAe(t,t.$ancestorComponent$),NU(()=>jAe(t,r))),jAe=(t,r)=>{const o=t.$hostElement$,c=tf("scheduleUpdate",t.$cmpMeta$.$tagName$),d=o;let h;return r?h=_g(d,"componentWillLoad"):h=_g(d,"componentWillUpdate"),h=yH(h,()=>_g(d,"componentWillRender")),c(),yH(h,()=>VAe(t,d,r))},yH=(t,r)=>FAe(t)?t.then(r):r(),FAe=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",VAe=async(t,r,o)=>{const c=t.$hostElement$,d=tf("update",t.$cmpMeta$.$tagName$);c["s-rc"],o&&xAe(t);const h=tf("render",t.$cmpMeta$.$tagName$);BAe(t,r,c,o),h(),d(),WAe(t)},BAe=(t,r,o,c)=>{try{hH=r,r=r.render&&r.render(),t.$flags$&=-17,t.$flags$|=2,(Td.hasRenderFn||Td.reflect)&&(Td.vdomRender||Td.reflect)&&(Td.hydrateServerSide||MAe(t,r,c))}catch(v){P0(v,t.$hostElement$)}return hH=null,null},WAe=t=>{const r=t.$cmpMeta$.$tagName$,o=t.$hostElement$,c=tf("postUpdate",r),d=o;t.$ancestorComponent$,_g(d,"componentDidRender"),t.$flags$&64?(_g(d,"componentDidUpdate"),c()):(t.$flags$|=64,_g(d,"componentDidLoad"),c())},_g=(t,r,o)=>{if(t&&t[r])try{return t[r](o)}catch(c){P0(c)}},$Ae=(t,r)=>f_(t).$instanceValues$.get(r),GAe=(t,r,o,c)=>{const d=f_(t),h=t,f=d.$instanceValues$.get(r),_=d.$flags$,v=h;o=IAe(o,c.$members$[r][0]);const b=Number.isNaN(f)&&Number.isNaN(o);if(o!==f&&!b){d.$instanceValues$.set(r,o);{if(c.$watchers$&&_&128){const w=c.$watchers$[r];w&&w.map(x=>{try{v[x](o,f,r)}catch(M){P0(M,h)}})}if((_&18)===2){if(v.componentShouldUpdate&&v.componentShouldUpdate(o,f,r)===!1)return;RX(d,!1)}}}},HAe=(t,r,o)=>{var c;const d=t.prototype;if(r.$members$){t.watchers&&(r.$watchers$=t.watchers);const h=Object.entries(r.$members$);h.map(([f,[_]])=>{(_&31||_&32)&&Object.defineProperty(d,f,{get(){return $Ae(this,f)},set(v){GAe(this,f,v,r)},configurable:!0,enumerable:!0})});{const f=new Map;d.attributeChangedCallback=function(_,v,b){As.jmp(()=>{var A;const w=f.get(_);if(this.hasOwnProperty(w))b=this[w],delete this[w];else{if(d.hasOwnProperty(w)&&typeof this[w]=="number"&&this[w]==b)return;if(w==null){const x=f_(this),M=x==null?void 0:x.$flags$;if(M&&!(M&8)&&M&128&&b!==v){const G=this,H=(A=r.$watchers$)===null||A===void 0?void 0:A[_];H==null||H.forEach(F=>{G[F]!=null&&G[F].call(G,b,v,_)})}return}}this[w]=b===null&&typeof this[w]=="boolean"?!1:b})},t.observedAttributes=Array.from(new Set([...Object.keys((c=r.$watchers$)!==null&&c!==void 0?c:{}),...h.filter(([_,v])=>v[0]&15).map(([_,v])=>{var b;const A=v[1]||_;return f.set(A,_),v[0]&512&&((b=r.$attrsToReflect$)===null||b===void 0||b.push([_,A])),A})]))}}return t},zAe=async(t,r,o,c)=>{let d;if(!(r.$flags$&32)&&(r.$flags$|=32,o.$lazyBundleId$,d=t.constructor,customElements.whenDefined(o.$tagName$).then(()=>r.$flags$|=128),d.style)){let f=d.style;typeof f!="string"&&(f=f[r.$modeName$=wAe(t)]);const _=_X(o,r.$modeName$);if(!lR.has(_)){const v=tf("registerStyles",o.$tagName$);NAe(_,f,!!(o.$flags$&1)),v()}}r.$ancestorComponent$,RX(r,!0)},SH=t=>{},KAe=t=>{if(!(As.$flags$&1)){const r=f_(t),o=r.$cmpMeta$,c=tf("connectedCallback",o.$tagName$);r.$flags$&1?(IX(t,r,o.$listeners$),r!=null&&r.$lazyInstance$?SH(r.$lazyInstance$):r!=null&&r.$onReadyPromise$&&r.$onReadyPromise$.then(()=>SH(r.$lazyInstance$))):(r.$flags$|=1,o.$flags$&12&&YAe(t),o.$members$&&Object.entries(o.$members$).map(([d,[h]])=>{if(h&31&&t.hasOwnProperty(d)){const f=t[d];delete t[d],t[d]=f}}),zAe(t,r,o)),c()}},YAe=t=>{const r=t["s-cr"]=Fc.createComment("");r["s-cn"]=!0,t.insertBefore(r,t.firstChild)},qAe=async t=>{if(!(As.$flags$&1)){const r=f_(t);r.$rmListeners$&&(r.$rmListeners$.map(o=>o()),r.$rmListeners$=void 0)}},p_=(t,r)=>{const o={$flags$:r[0],$tagName$:r[1]};o.$members$=r[2],o.$listeners$=r[3],o.$watchers$=t.$watchers$,o.$attrsToReflect$=[];const c=t.prototype.connectedCallback,d=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){ZAe(this,o)},connectedCallback(){KAe(this),c&&c.call(this)},disconnectedCallback(){qAe(this),d&&d.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(o.$flags$&16)})}}),t.is=o.$tagName$,HAe(t,o)},IX=(t,r,o,c)=>{o&&o.map(([d,h,f])=>{const _=JAe(t,d),v=XAe(r,f),b=QAe(d);As.ael(_,h,v,b),(r.$rmListeners$=r.$rmListeners$||[]).push(()=>As.rel(_,h,v,b))})},XAe=(t,r)=>o=>{try{Td.lazyLoad||t.$hostElement$[r](o)}catch(c){P0(c)}},JAe=(t,r)=>r&4?Fc:r&8?D0:r&16?Fc.body:t,QAe=t=>t1e?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0,AX=new WeakMap,f_=t=>AX.get(t),ZAe=(t,r)=>{const o={$flags$:0,$hostElement$:t,$cmpMeta$:r,$instanceValues$:new Map};return IX(t,o,r.$listeners$),AX.set(t,o)},bH=(t,r)=>r in t,P0=(t,r)=>(0,console.error)(t,r),lR=new Map,e1e=[],D0=typeof window<"u"?window:{},Fc=D0.document||{head:{}},m_=D0.HTMLElement||class{},As={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,r,o,c)=>t.addEventListener(r,o,c),rel:(t,r,o,c)=>t.removeEventListener(r,o,c),ce:(t,r)=>new CustomEvent(t,r)},t1e=(()=>{let t=!1;try{Fc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch{}return t})(),n1e=t=>Promise.resolve(t),r1e=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),ZL=[],OX=[],NX=(t,r)=>o=>{t.push(o),QL||(QL=!0,r&&As.$flags$&4?i1e(e2):As.raf(e2))},TH=t=>{for(let r=0;r<t.length;r++)try{t[r](performance.now())}catch(o){P0(o)}t.length=0},e2=()=>{TH(ZL),TH(OX),(QL=ZL.length>0)&&As.raf(e2)},i1e=t=>n1e().then(t),s1e=NX(ZL,!1),NU=NX(OX,!0);/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const zs=typeof window<"u"?window:void 0,GP=typeof document<"u"?document:void 0;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const kX=(t,r)=>{t.componentOnReady?t.componentOnReady().then(o=>r(o)):vd(()=>r(t))},o1e=t=>t.componentOnReady!==void 0,a1e=(t,r=[])=>{const o={};return r.forEach(c=>{t.hasAttribute(c)&&(t.getAttribute(c)!==null&&(o[c]=t.getAttribute(c)),t.removeAttribute(c))}),o},vd=t=>typeof __zone_symbol__requestAnimationFrame=="function"?__zone_symbol__requestAnimationFrame(t):typeof requestAnimationFrame=="function"?requestAnimationFrame(t):setTimeout(t),Tke=(t,r,o)=>Math.max(t,Math.min(r,o)),Po=(t,r)=>{if(!t){const o="ASSERT: "+r;console.error(o);debugger;throw new Error(o)}},xX=(t,r)=>{if(t??(t={}),r??(r={}),t===r)return!0;const o=Object.keys(t);if(o.length!==Object.keys(r).length)return!1;for(const c of o)if(!(c in r)||t[c]!==r[c])return!1;return!0};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */let HP;const c1e=t=>(t.forEach(r=>{for(const o in r)if(r.hasOwnProperty(o)){const c=r[o];if(o==="easing"){const d="animation-timing-function";r[d]=c,delete r[o]}else{const d=l1e(o);d!==o&&(r[d]=c,delete r[o])}}}),t),l1e=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kU=t=>{if(HP===void 0){const r=t.style.animationName!==void 0,o=t.style.webkitAnimationName!==void 0;HP=!r&&o?"-webkit-":""}return HP},di=(t,r,o)=>{const c=r.startsWith("animation")?kU(t):"";t.style.setProperty(c+r,o)},kc=(t,r)=>{const o=r.startsWith("animation")?kU(t):"";t.style.removeProperty(o+r)},d1e=(t,r)=>{let o;const c={passive:!0},d=()=>{o&&o()},h=f=>{t===f.target&&(d(),r(f))};return t&&(t.addEventListener("webkitAnimationEnd",h,c),t.addEventListener("animationend",h,c),o=()=>{t.removeEventListener("webkitAnimationEnd",h,c),t.removeEventListener("animationend",h,c)}),d},u1e=(t=[])=>t.map(r=>{const o=r.offset,c=[];for(const d in r)r.hasOwnProperty(d)&&d!=="offset"&&c.push(`${d}: ${r[d]};`);return`${o*100}% { ${c.join(" ")} }`}).join(" "),CH=[],h1e=t=>{let r=CH.indexOf(t);return r<0&&(r=CH.push(t)-1),`ion-animation-${r}`},p1e=t=>{const r=t.getRootNode!==void 0?t.getRootNode():t;return r.head||r},f1e=(t,r,o)=>{var c;const d=p1e(o),h=kU(o),f=d.querySelector("#"+t);if(f)return f;const _=((c=o.ownerDocument)!==null&&c!==void 0?c:document).createElement("style");return _.id=t,_.textContent=`@${h}keyframes ${t} { ${r} } @${h}keyframes ${t}-alt { ${r} }`,d.appendChild(_),_},VC=(t=[],r)=>{if(r!==void 0){const o=Array.isArray(r)?r:[r];return[...t,...o]}return t},m1e=t=>{let r,o,c,d,h,f,_=[],v=[],b=[],A=!1,w,x={},M=[],V=[],G={},H=0,F=!1,B=!1,L,X,ee,ce,ie=!0,ne=!1,fe=!0,oe,ue,Ne=!1;const Ee=t,we=[],Re=[],Pe=[],$e=[],Ce=[],Fe=[],Ye=[],Mt=[],yt=[],Xt=[],Ue=[],Be=typeof AnimationEffect=="function"||zs!==void 0&&typeof zs.AnimationEffect=="function",at=typeof Element=="function"&&typeof Element.prototype.animate=="function"&&Be,Jt=100,un=()=>Ue,Ut=ke=>(Ce.forEach(tt=>{tt.destroy(ke)}),Gr(ke),$e.length=0,Ce.length=0,_.length=0,_n(),A=!1,fe=!0,ue),Gr=ke=>{Kn(),ke&&En()},sn=()=>{F=!1,B=!1,fe=!0,X=void 0,ee=void 0,ce=void 0,H=0,ne=!1,ie=!0,Ne=!1},hn=()=>H!==0&&!Ne,Ht=(ke,tt)=>{const dt=tt.findIndex(rr=>rr.c===ke);dt>-1&&tt.splice(dt,1)},on=(ke,tt)=>(Pe.push({c:ke,o:tt}),ue),rt=(ke,tt)=>((tt!=null&&tt.oneTimeCallback?Re:we).push({c:ke,o:tt}),ue),_n=()=>(we.length=0,Re.length=0,ue),Kn=()=>{if(at)Ue.forEach(ke=>{ke.cancel()}),Ue.length=0;else{const ke=$e.slice();vd(()=>{ke.forEach(tt=>{kc(tt,"animation-name"),kc(tt,"animation-duration"),kc(tt,"animation-timing-function"),kc(tt,"animation-iteration-count"),kc(tt,"animation-delay"),kc(tt,"animation-play-state"),kc(tt,"animation-fill-mode"),kc(tt,"animation-direction")})})}},En=()=>{Fe.forEach(ke=>{ke!=null&&ke.parentNode&&ke.parentNode.removeChild(ke)}),Fe.length=0},fi=ke=>(Ye.push(ke),ue),fr=ke=>(Mt.push(ke),ue),Ft=ke=>(yt.push(ke),ue),mr=ke=>(Xt.push(ke),ue),Hr=ke=>(v=VC(v,ke),ue),Mn=ke=>(b=VC(b,ke),ue),Wi=(ke={})=>(x=ke,ue),lr=(ke=[])=>{for(const tt of ke)x[tt]="";return ue},Yn=ke=>(M=VC(M,ke),ue),an=ke=>(V=VC(V,ke),ue),It=(ke={})=>(G=ke,ue),ot=(ke=[])=>{for(const tt of ke)G[tt]="";return ue},tn=()=>h!==void 0?h:w?w.getFill():"both",$i=()=>X!==void 0?X:f!==void 0?f:w?w.getDirection():"normal",bt=()=>F?"linear":c!==void 0?c:w?w.getEasing():"linear",nn=()=>B?0:ee!==void 0?ee:o!==void 0?o:w?w.getDuration():0,Tn=()=>d!==void 0?d:w?w.getIterations():1,mi=()=>ce!==void 0?ce:r!==void 0?r:w?w.getDelay():0,ac=()=>_,g_=ke=>(f=ke,zr(!0),ue),Ho=ke=>(h=ke,zr(!0),ue),df=ke=>(r=ke,zr(!0),ue),Wl=ke=>(c=ke,zr(!0),ue),$c=ke=>(!at&&ke===0&&(ke=1),o=ke,zr(!0),ue),Lh=ke=>(d=ke,zr(!0),ue),Kd=ke=>(w=ke,ue),lt=ke=>{if(ke!=null)if(ke.nodeType===1)$e.push(ke);else if(ke.length>=0)for(let tt=0;tt<ke.length;tt++)$e.push(ke[tt]);else console.error("Invalid addElement value");return ue},__=ke=>{if(ke!=null)if(Array.isArray(ke))for(const tt of ke)tt.parent(ue),Ce.push(tt);else ke.parent(ue),Ce.push(ke);return ue},Gc=ke=>{const tt=_!==ke;return _=ke,tt&&zo(_),ue},zo=ke=>{at?un().forEach(tt=>{const dt=tt.effect;if(dt.setKeyframes)dt.setKeyframes(ke);else{const rr=new KeyframeEffect(dt.target,ke,dt.getTiming());tt.effect=rr}}):qn()},Ns=()=>{Ye.forEach(rr=>rr()),Mt.forEach(rr=>rr());const ke=v,tt=b,dt=x;$e.forEach(rr=>{const ti=rr.classList;ke.forEach(Ps=>ti.add(Ps)),tt.forEach(Ps=>ti.remove(Ps));for(const Ps in dt)dt.hasOwnProperty(Ps)&&di(rr,Ps,dt[Ps])})},vn=()=>{ya(),yt.forEach(ti=>ti()),Xt.forEach(ti=>ti());const ke=ie?1:0,tt=M,dt=V,rr=G;$e.forEach(ti=>{const Ps=ti.classList;tt.forEach(lc=>Ps.add(lc)),dt.forEach(lc=>Ps.remove(lc));for(const lc in rr)rr.hasOwnProperty(lc)&&di(ti,lc,rr[lc])}),ee=void 0,X=void 0,ce=void 0,we.forEach(ti=>ti.c(ke,ue)),Re.forEach(ti=>ti.c(ke,ue)),Re.length=0,fe=!0,ie&&(ne=!0),ie=!0},gi=()=>{H!==0&&(H--,H===0&&(vn(),w&&w.animationFinish()))},qn=(ke=!0)=>{En();const tt=c1e(_);$e.forEach(dt=>{if(tt.length>0){const rr=u1e(tt);oe=t!==void 0?t:h1e(rr);const ti=f1e(oe,rr,dt);Fe.push(ti),di(dt,"animation-duration",`${nn()}ms`),di(dt,"animation-timing-function",bt()),di(dt,"animation-delay",`${mi()}ms`),di(dt,"animation-fill-mode",tn()),di(dt,"animation-direction",$i());const Ps=Tn()===1/0?"infinite":Tn().toString();di(dt,"animation-iteration-count",Ps),di(dt,"animation-play-state","paused"),ke&&di(dt,"animation-name",`${ti.id}-alt`),vd(()=>{di(dt,"animation-name",ti.id||null)})}})},$l=()=>{$e.forEach(ke=>{const tt=ke.animate(_,{id:Ee,delay:mi(),duration:nn(),easing:bt(),iterations:Tn(),fill:tn(),direction:$i()});tt.pause(),Ue.push(tt)}),Ue.length>0&&(Ue[0].onfinish=()=>{gi()})},Yd=(ke=!0)=>{Ns(),_.length>0&&(at?$l():qn(ke)),A=!0},mo=ke=>{if(ke=Math.min(Math.max(ke,0),.9999),at)Ue.forEach(tt=>{tt.currentTime=tt.effect.getComputedTiming().delay+nn()*ke,tt.pause()});else{const tt=`-${nn()*ke}ms`;$e.forEach(dt=>{_.length>0&&(di(dt,"animation-delay",tt),di(dt,"animation-play-state","paused"))})}},_i=ke=>{Ue.forEach(tt=>{tt.effect.updateTiming({delay:mi(),duration:nn(),easing:bt(),iterations:Tn(),fill:tn(),direction:$i()})}),ke!==void 0&&mo(ke)},ks=(ke=!0,tt)=>{vd(()=>{$e.forEach(dt=>{di(dt,"animation-name",oe||null),di(dt,"animation-duration",`${nn()}ms`),di(dt,"animation-timing-function",bt()),di(dt,"animation-delay",tt!==void 0?`-${tt*nn()}ms`:`${mi()}ms`),di(dt,"animation-fill-mode",tn()||null),di(dt,"animation-direction",$i()||null);const rr=Tn()===1/0?"infinite":Tn().toString();di(dt,"animation-iteration-count",rr),ke&&di(dt,"animation-name",`${oe}-alt`),vd(()=>{di(dt,"animation-name",oe||null)})})})},zr=(ke=!1,tt=!0,dt)=>(ke&&Ce.forEach(rr=>{rr.update(ke,tt,dt)}),at?_i(dt):ks(tt,dt),ue),Zr=(ke=!1,tt)=>(Ce.forEach(dt=>{dt.progressStart(ke,tt)}),va(),F=ke,A||Yd(),zr(!1,!0,tt),ue),xs=ke=>(Ce.forEach(tt=>{tt.progressStep(ke)}),mo(ke),ue),Ko=(ke,tt,dt)=>(F=!1,Ce.forEach(rr=>{rr.progressEnd(ke,tt,dt)}),dt!==void 0&&(ee=dt),ne=!1,ie=!0,ke===0?(X=$i()==="reverse"?"normal":"reverse",X==="reverse"&&(ie=!1),at?(zr(),mo(1-tt)):(ce=(1-tt)*nn()*-1,zr(!1,!1))):ke===1&&(at?(zr(),mo(tt)):(ce=tt*nn()*-1,zr(!1,!1))),ke!==void 0&&!w&&Uh(),ue),va=()=>{A&&(at?Ue.forEach(ke=>{ke.pause()}):$e.forEach(ke=>{di(ke,"animation-play-state","paused")}),Ne=!0)},uf=()=>(Ce.forEach(ke=>{ke.pause()}),va(),ue),Mh=()=>{L=void 0,gi()},ya=()=>{L&&clearTimeout(L)},cc=()=>{if(ya(),vd(()=>{$e.forEach(ke=>{_.length>0&&di(ke,"animation-play-state","running")})}),_.length===0||$e.length===0)gi();else{const ke=mi()||0,tt=nn()||0,dt=Tn()||1;isFinite(dt)&&(L=setTimeout(Mh,ke+tt*dt+Jt)),d1e($e[0],()=>{ya(),vd(()=>{E_(),vd(gi)})})}},E_=()=>{$e.forEach(ke=>{kc(ke,"animation-duration"),kc(ke,"animation-delay"),kc(ke,"animation-play-state")})},Hc=()=>{Ue.forEach(ke=>{ke.play()}),(_.length===0||$e.length===0)&&gi()},cs=()=>{at?(mo(0),_i()):ks()},Uh=ke=>new Promise(tt=>{ke!=null&&ke.sync&&(B=!0,rt(()=>B=!1,{oneTimeCallback:!0})),A||Yd(),ne&&(cs(),ne=!1),fe&&(H=Ce.length+1,fe=!1);const dt=()=>{Ht(rr,Re),tt()},rr=()=>{Ht(dt,Pe),tt()};rt(rr,{oneTimeCallback:!0}),on(dt,{oneTimeCallback:!0}),Ce.forEach(ti=>{ti.play()}),at?Hc():cc(),Ne=!1}),v_=()=>{Ce.forEach(ke=>{ke.stop()}),A&&(Kn(),A=!1),sn(),Pe.forEach(ke=>ke.c(0,ue)),Pe.length=0},Ei=(ke,tt)=>{const dt=_[0];return dt!==void 0&&(dt.offset===void 0||dt.offset===0)?dt[ke]=tt:_=[{offset:0,[ke]:tt},..._],ue};return ue={parentAnimation:w,elements:$e,childAnimations:Ce,id:Ee,animationFinish:gi,from:Ei,to:(ke,tt)=>{const dt=_[_.length-1];return dt!==void 0&&(dt.offset===void 0||dt.offset===1)?dt[ke]=tt:_=[..._,{offset:1,[ke]:tt}],ue},fromTo:(ke,tt,dt)=>Ei(ke,tt).to(ke,dt),parent:Kd,play:Uh,pause:uf,stop:v_,destroy:Ut,keyframes:Gc,addAnimation:__,addElement:lt,update:zr,fill:Ho,direction:g_,iterations:Lh,duration:$c,easing:Wl,delay:df,getWebAnimations:un,getKeyframes:ac,getFill:tn,getDirection:$i,getDelay:mi,getIterations:Tn,getEasing:bt,getDuration:nn,afterAddRead:Ft,afterAddWrite:mr,afterClearStyles:ot,afterStyles:It,afterRemoveClass:an,afterAddClass:Yn,beforeAddRead:fi,beforeAddWrite:fr,beforeClearStyles:lr,beforeStyles:Wi,beforeRemoveClass:Mn,beforeAddClass:Hr,onFinish:rt,isRunning:hn,progressStart:Zr,progressStep:xs,progressEnd:Ko}},g1e="ionViewWillEnter",_1e="ionViewDidEnter",PX="ionViewWillLeave",DX="ionViewDidLeave",zP="ionViewWillUnload",E1e=()=>qI(()=>import("./ios.transition-DDx80k1x.js"),__vite__mapDeps([])),v1e=()=>qI(()=>import("./md.transition-DoXHyTTW.js"),__vite__mapDeps([])),LX=t=>new Promise((r,o)=>{NU(()=>{y1e(t),S1e(t).then(c=>{c.animation&&c.animation.destroy(),wH(t),r(c)},c=>{wH(t),o(c)})})}),y1e=t=>{const r=t.enteringEl,o=t.leavingEl;I1e(r,o,t.direction),t.showGoBack?r.classList.add("can-go-back"):r.classList.remove("can-go-back"),n2(r,!1),r.style.setProperty("pointer-events","none"),o&&(n2(o,!1),o.style.setProperty("pointer-events","none"))},S1e=async t=>{const r=await b1e(t);return r&&mAe.isBrowser?T1e(r,t):C1e(t)},wH=t=>{const r=t.enteringEl,o=t.leavingEl;r.classList.remove("ion-page-invisible"),r.style.removeProperty("pointer-events"),o!==void 0&&(o.classList.remove("ion-page-invisible"),o.style.removeProperty("pointer-events"))},b1e=async t=>!t.leavingEl||!t.animated||t.duration===0?void 0:t.animationBuilder?t.animationBuilder:t.mode==="ios"?(await E1e()).iosTransitionAnimation:(await v1e()).mdTransitionAnimation,T1e=async(t,r)=>{await MX(r,!0);const o=t(r.baseEl,r);UX(r.enteringEl,r.leavingEl);const c=await R1e(o,r);return r.progressCallback&&r.progressCallback(void 0),c&&jX(r.enteringEl,r.leavingEl),{hasCompleted:c,animation:o}},C1e=async t=>{const r=t.enteringEl,o=t.leavingEl;return await MX(t,!1),UX(r,o),jX(r,o),{hasCompleted:!0}},MX=async(t,r)=>{(t.deepWait!==void 0?t.deepWait:r)&&await Promise.all([t2(t.enteringEl),t2(t.leavingEl)]),await w1e(t.viewIsReady,t.enteringEl)},w1e=async(t,r)=>{t&&await t(r)},R1e=(t,r)=>{const o=r.progressCallback,c=new Promise(d=>{t.onFinish(h=>d(h===1))});return o?(t.progressStart(!0),o(t)):t.play(),c},UX=(t,r)=>{Cd(r,PX),Cd(t,g1e)},jX=(t,r)=>{Cd(t,_1e),Cd(r,DX)},Cd=(t,r)=>{if(t){const o=new CustomEvent(r,{bubbles:!1,cancelable:!1});t.dispatchEvent(o)}},t2=async t=>{const r=t;if(r){if(r.componentOnReady!=null){if(await r.componentOnReady()!=null)return}else if(r.__registerHost!=null){await new Promise(c=>vd(c));return}await Promise.all(Array.from(r.children).map(t2))}},n2=(t,r)=>{r?(t.setAttribute("aria-hidden","true"),t.classList.add("ion-page-hidden")):(t.hidden=!1,t.removeAttribute("aria-hidden"),t.classList.remove("ion-page-hidden"))},I1e=(t,r,o)=>{t!==void 0&&(t.style.zIndex=o==="back"?"99":"101"),r!==void 0&&(r.style.zIndex="100")},Cke=t=>{if(t.classList.contains("ion-page"))return t;const r=t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return r||t};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const dR=(t,r,o,c,d)=>O1e(t[1],r[1],o[1],c[1],d).map(h=>A1e(t[0],r[0],o[0],c[0],h)),A1e=(t,r,o,c,d)=>{const h=3*r*Math.pow(d-1,2),f=-3*o*d+3*o+c*d,_=t*Math.pow(d-1,3);return d*(h+d*f)-_},O1e=(t,r,o,c,d)=>(t-=d,r-=d,o-=d,c-=d,k1e(c-3*o+3*r-t,3*o-6*r+3*t,3*r-3*t,t).filter(f=>f>=0&&f<=1)),N1e=(t,r,o)=>{const c=r*r-4*t*o;return c<0?[]:[(-r+Math.sqrt(c))/(2*t),(-r-Math.sqrt(c))/(2*t)]},k1e=(t,r,o,c)=>{if(t===0)return N1e(r,o,c);r/=t,o/=t,c/=t;const d=(3*o-r*r)/3,h=(2*r*r*r-9*r*o+27*c)/27;if(d===0)return[Math.pow(-h,1/3)];if(h===0)return[Math.sqrt(-d),-Math.sqrt(-d)];const f=Math.pow(h/2,2)+Math.pow(d/3,3);if(f===0)return[Math.pow(h/2,1/2)-r/3];if(f>0)return[Math.pow(-(h/2)+Math.sqrt(f),1/3)-Math.pow(h/2+Math.sqrt(f),1/3)-r/3];const _=Math.sqrt(Math.pow(-(d/3),3)),v=Math.acos(-(h/(2*Math.sqrt(Math.pow(-(d/3),3))))),b=2*Math.pow(_,1/3);return[b*Math.cos(v/3)-r/3,b*Math.cos((v+2*Math.PI)/3)-r/3,b*Math.cos((v+4*Math.PI)/3)-r/3]};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */class x1e{constructor(){this.m=new Map}reset(r){this.m=new Map(Object.entries(r))}get(r,o){const c=this.m.get(r);return c!==void 0?c:o}getBoolean(r,o=!1){const c=this.m.get(r);return c===void 0?o:typeof c=="string"?c==="true":!!c}getNumber(r,o){const c=parseFloat(this.m.get(r));return isNaN(c)?o!==void 0?o:NaN:c}set(r,o){this.m.set(r,o)}}const Eg=new x1e;let P1e;const Kg=t=>t&&RAe(t)||P1e;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const D1e=(t,r)=>typeof t=="string"&&t.length>0?Object.assign({"ion-color":!0,[`ion-color-${t}`]:!0},r):r;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const FX=async(t,r,o,c,d,h)=>{var f;if(t)return t.attachViewToDom(r,o,d,c);if(!h&&typeof o!="string"&&!(o instanceof HTMLElement))throw new Error("framework delegate is missing");const _=typeof o=="string"?(f=r.ownerDocument)===null||f===void 0?void 0:f.createElement(o):o;return c&&c.forEach(v=>_.classList.add(v)),d&&Object.assign(_,d),r.appendChild(_),await new Promise(v=>kX(_,v)),_},L1e=(t,r)=>{if(r){if(t){const o=r.parentElement;return t.removeViewFromDom(o,r)}r.remove()}return Promise.resolve()};function zd(t,r){var o={};for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&r.indexOf(c)<0&&(o[c]=t[c]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(t);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(t,c[d])&&(o[c[d]]=t[c[d]]);return o}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const M1e=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}",U1e=M1e,j1e=p_(class extends m_{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(r,o){return new Promise(c=>{s1e(()=>{const d=this.el.getBoundingClientRect(),h=d.width,f=d.height,_=Math.sqrt(h*h+f*f),v=Math.max(f,h),b=this.unbounded?v:_+V1e,A=Math.floor(v*B1e),w=b/A;let x=r-d.left,M=o-d.top;this.unbounded&&(x=h*.5,M=f*.5);const V=x-A*.5,G=M-A*.5,H=h*.5-x,F=f*.5-M;NU(()=>{const B=document.createElement("div");B.classList.add("ripple-effect");const L=B.style;L.top=G+"px",L.left=V+"px",L.width=L.height=A+"px",L.setProperty("--final-scale",`${w}`),L.setProperty("--translate-end",`${H}px, ${F}px`),(this.el.shadowRoot||this.el).appendChild(B),setTimeout(()=>{c(()=>{F1e(B)})},325)})})})}get unbounded(){return this.type==="unbounded"}render(){const r=Kg(this);return uo(x0,{key:"9f2578664e5ff8a0a7e27cd90b2339bd430e72b8",role:"presentation",class:{[r]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return U1e}},[1,"ion-ripple-effect",{type:[1],addRipple:[64]}]),F1e=t=>{t.classList.add("fade-out"),setTimeout(()=>{t.remove()},200)},V1e=10,B1e=.5;function W1e(){if(typeof customElements>"u")return;["ion-ripple-effect"].forEach(r=>{switch(r){case"ion-ripple-effect":customElements.get(r)||customElements.define(r,j1e);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const BC=typeof window<"u"?window:void 0;BC&&(BC.CSS&&BC.CSS.supports&&BC.CSS.supports("--a: 0"));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const $1e=()=>{if(zs!==void 0)return zs.Capacitor};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const G1e=()=>{let t;return{lock:async()=>{const o=t;let c;return t=new Promise(d=>c=d),o!==void 0&&await o,c}}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */var r2;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(r2||(r2={}));var i2;(function(t){t.Body="body",t.Ionic="ionic",t.Native="native",t.None="none"})(i2||(i2={}));const H1e={getEngine(){const t=$1e();if(t!=null&&t.isPluginAvailable("Keyboard"))return t.Plugins.Keyboard},getResizeMode(){const t=this.getEngine();return t!=null&&t.getResizeMode?t.getResizeMode().catch(r=>{if(r.code!==r2.Unimplemented)throw r}):Promise.resolve(void 0)}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const VX=t=>{if(GP===void 0||t===i2.None||t===void 0)return null;const r=GP.querySelector("ion-app");return r??GP.body},RH=t=>{const r=VX(t);return r===null?0:r.clientHeight},z1e=async t=>{let r,o,c,d;const h=async()=>{const A=await H1e.getResizeMode(),w=A===void 0?void 0:A.mode;r=()=>{d===void 0&&(d=RH(w)),c=!0,f(c,w)},o=()=>{c=!1,f(c,w)},zs==null||zs.addEventListener("keyboardWillShow",r),zs==null||zs.addEventListener("keyboardWillHide",o)},f=(A,w)=>{t&&t(A,_(w))},_=A=>{if(d===0||d===RH(A))return;const w=VX(A);if(w!==null)return new Promise(x=>{const M=()=>{w.clientHeight===d&&(V.disconnect(),x())},V=new ResizeObserver(M);V.observe(w)})},v=()=>{zs==null||zs.removeEventListener("keyboardWillShow",r),zs==null||zs.removeEventListener("keyboardWillHide",o),r=o=void 0},b=()=>c;return await h(),{init:h,destroy:v,isKeyboardVisible:b}},BX=1,WX=2,uR=3;class s2{constructor(r,o){this.component=r,this.params=o,this.state=BX}async init(r){if(this.state=WX,!this.element){const o=this.component;this.element=await FX(this.delegate,r,o,["ion-page","ion-page-invisible"],this.params)}}_destroy(){Po(this.state!==uR,"view state must be ATTACHED");const r=this.element;r&&(this.delegate?this.delegate.removeViewFromDom(r.parentElement,r):r.remove()),this.nav=void 0,this.state=uR}}const IH=(t,r,o)=>!t||t.component!==r?!1:xX(t.params,o),AH=(t,r)=>t?t instanceof s2?t:new s2(t,r):null,K1e=t=>t.map(r=>r instanceof s2?r:"component"in r?AH(r.component,r.componentProps===null?void 0:r.componentProps):AH(r,void 0)).filter(r=>r!==null),Y1e=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",q1e=Y1e,X1e=p_(class extends m_{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Nd(this,"ionNavWillLoad",7),this.ionNavWillChange=Nd(this,"ionNavWillChange",3),this.ionNavDidChange=Nd(this,"ionNavDidChange",3),this.transInstr=[],this.gestureOrAnimationInProgress=!1,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.delegate=void 0,this.swipeGesture=void 0,this.animated=!0,this.animation=void 0,this.rootParams=void 0,this.root=void 0}swipeGestureChanged(){this.gesture&&this.gesture.enable(this.swipeGesture===!0)}rootChanged(){this.root!==void 0&&this.didLoad!==!1&&(this.useRouter||this.root!==void 0&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=document.querySelector("ion-router")!==null&&this.el.closest("[no-router]")===null,this.swipeGesture===void 0){const r=Kg(this);this.swipeGesture=Eg.getBoolean("swipeBackEnabled",r==="ios")}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await qI(()=>import("./swipe-back-Gdf5fF8g.js"),__vite__mapDeps([]))).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const r of this.views)Cd(r.element,zP),r._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(r,o,c,d){return this.insert(-1,r,o,c,d)}insert(r,o,c,d,h){return this.insertPages(r,[{component:o,componentProps:c}],d,h)}insertPages(r,o,c,d){return this.queueTrns({insertStart:r,insertViews:o,opts:c},d)}pop(r,o){return this.removeIndex(-1,1,r,o)}popTo(r,o,c){const d={removeStart:-1,removeCount:-1,opts:o};return typeof r=="object"&&r.component?(d.removeView=r,d.removeStart=1):typeof r=="number"&&(d.removeStart=r+1),this.queueTrns(d,c)}popToRoot(r,o){return this.removeIndex(1,-1,r,o)}removeIndex(r,o=1,c,d){return this.queueTrns({removeStart:r,removeCount:o,opts:c},d)}setRoot(r,o,c,d){return this.setPages([{component:r,componentProps:o}],c,d)}setPages(r,o,c){return o??(o={}),o.animated!==!0&&(o.animated=!1),this.queueTrns({insertStart:0,insertViews:r,removeStart:0,removeCount:-1,opts:o},c)}setRouteId(r,o,c,d){const h=this.getActiveSync();if(IH(h,r,o))return Promise.resolve({changed:!1,element:h.element});let f;const _=new Promise(A=>f=A);let v;const b={updateURL:!1,viewIsReady:A=>{let w;const x=new Promise(M=>w=M);return f({changed:!0,element:A,markVisible:async()=>{w(),await v}}),x}};if(c==="root")v=this.setRoot(r,o,b);else{const A=this.views.find(w=>IH(w,r,o));A?v=this.popTo(A,Object.assign(Object.assign({},b),{direction:"back",animationBuilder:d})):c==="forward"?v=this.push(r,o,Object.assign(Object.assign({},b),{animationBuilder:d})):c==="back"&&(v=this.setRoot(r,o,Object.assign(Object.assign({},b),{direction:"back",animated:!0,animationBuilder:d})))}return _}async getRouteId(){const r=this.getActiveSync();if(r)return{id:r.element.tagName,params:r.params,element:r.element}}async getActive(){return this.getActiveSync()}async getByIndex(r){return this.views[r]}async canGoBack(r){return this.canGoBackSync(r)}async getPrevious(r){return this.getPreviousSync(r)}getLength(){return this.views.length}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(r=this.getActiveSync()){return!!(r&&this.getPreviousSync(r))}getPreviousSync(r=this.getActiveSync()){if(!r)return;const o=this.views,c=o.indexOf(r);return c>0?o[c-1]:void 0}async queueTrns(r,o){var c,d;if(this.isTransitioning&&(!((c=r.opts)===null||c===void 0)&&c.skipIfBusy))return!1;const h=new Promise((f,_)=>{r.resolve=f,r.reject=_});if(r.done=o,r.opts&&r.opts.updateURL!==!1&&this.useRouter){const f=document.querySelector("ion-router");if(f){const _=await f.canTransition();if(_===!1)return!1;if(typeof _=="string")return f.push(_,r.opts.direction||"back"),!1}}return((d=r.insertViews)===null||d===void 0?void 0:d.length)===0&&(r.insertViews=void 0),this.transInstr.push(r),this.nextTrns(),h}success(r,o){if(this.destroyed){this.fireError("nav controller was destroyed",o);return}if(o.done&&o.done(r.hasCompleted,r.requiresTransition,r.enteringView,r.leavingView,r.direction),o.resolve(r.hasCompleted),o.opts.updateURL!==!1&&this.useRouter){const c=document.querySelector("ion-router");if(c){const d=r.direction==="back"?"back":"forward";c.navChanged(d)}}}failed(r,o){if(this.destroyed){this.fireError("nav controller was destroyed",o);return}this.transInstr.length=0,this.fireError(r,o)}fireError(r,o){o.done&&o.done(!1,!1,r),o.reject&&!this.destroyed?o.reject(r):o.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const r=this.transInstr.shift();return r?(this.runTransition(r),!0):!1}async runTransition(r){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(r);const o=this.getActiveSync(),c=this.getEnteringView(r,o);if(!o&&!c)throw new Error("no views in the stack to be removed");c&&c.state===BX&&await c.init(this.el),this.postViewInit(c,o,r);const d=(r.enteringRequiresTransition||r.leavingRequiresTransition)&&c!==o;d&&r.opts&&o&&(r.opts.direction==="back"&&(r.opts.animationBuilder=r.opts.animationBuilder||(c==null?void 0:c.animationBuilder)),o.animationBuilder=r.opts.animationBuilder);let h;d?h=await this.transition(c,o,r):h={hasCompleted:!0,requiresTransition:!1},this.success(h,r),this.ionNavDidChange.emit()}catch(o){this.failed(o,r)}this.isTransitioning=!1,this.nextTrns()}prepareTI(r){var o,c,d;const h=this.views.length;if((o=r.opts)!==null&&o!==void 0||(r.opts={}),(c=(d=r.opts).delegate)!==null&&c!==void 0||(d.delegate=this.delegate),r.removeView!==void 0){Po(r.removeStart!==void 0,"removeView needs removeStart"),Po(r.removeCount!==void 0,"removeView needs removeCount");const v=this.views.indexOf(r.removeView);if(v<0)throw new Error("removeView was not found");r.removeStart+=v}r.removeStart!==void 0&&(r.removeStart<0&&(r.removeStart=h-1),r.removeCount<0&&(r.removeCount=h-r.removeStart),r.leavingRequiresTransition=r.removeCount>0&&r.removeStart+r.removeCount===h),r.insertViews&&((r.insertStart<0||r.insertStart>h)&&(r.insertStart=h),r.enteringRequiresTransition=r.insertStart===h);const f=r.insertViews;if(!f)return;Po(f.length>0,"length can not be zero");const _=K1e(f);if(_.length===0)throw new Error("invalid views to insert");for(const v of _){v.delegate=r.opts.delegate;const b=v.nav;if(b&&b!==this)throw new Error("inserted view was already inserted");if(v.state===uR)throw new Error("inserted view was already destroyed")}r.insertViews=_}getEnteringView(r,o){const c=r.insertViews;if(c!==void 0)return c[c.length-1];const d=r.removeStart;if(d!==void 0){const h=this.views,f=d+r.removeCount;for(let _=h.length-1;_>=0;_--){const v=h[_];if((_<d||_>=f)&&v!==o)return v}}}postViewInit(r,o,c){var d,h,f;Po(o||r,"Both leavingView and enteringView are null"),Po(c.resolve,"resolve must be valid"),Po(c.reject,"reject must be valid");const _=c.opts,{insertViews:v,removeStart:b,removeCount:A}=c;let w;if(b!==void 0&&A!==void 0){Po(b>=0,"removeStart can not be negative"),Po(A>=0,"removeCount can not be negative"),w=[];for(let M=b;M<b+A;M++){const V=this.views[M];V!==void 0&&V!==r&&V!==o&&w.push(V)}(d=_.direction)!==null&&d!==void 0||(_.direction="back")}const x=this.views.length+((h=v==null?void 0:v.length)!==null&&h!==void 0?h:0)-(A??0);if(Po(x>=0,"final balance can not be negative"),x===0)throw console.warn("You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(v){let M=c.insertStart;for(const V of v)this.insertViewAt(V,M),M++;c.enteringRequiresTransition&&((f=_.direction)!==null&&f!==void 0||(_.direction="forward"))}if(w&&w.length>0){for(const M of w)Cd(M.element,PX),Cd(M.element,DX),Cd(M.element,zP);for(const M of w)this.destroyView(M)}}async transition(r,o,c){const d=c.opts,h=d.progressAnimation?w=>{w!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,w.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0}),w.progressEnd(0,0,0)):this.sbAni=w}:void 0,f=Kg(this),_=r.element,v=o&&o.element,b=Object.assign(Object.assign({mode:f,showGoBack:this.canGoBackSync(r),baseEl:this.el,progressCallback:h,animated:this.animated&&Eg.getBoolean("animated",!0),enteringEl:_,leavingEl:v},d),{animationBuilder:d.animationBuilder||this.animation||Eg.get("navAnimation")}),{hasCompleted:A}=await LX(b);return this.transitionFinish(A,r,o,d)}transitionFinish(r,o,c,d){const h=r?o:c;return h&&this.unmountInactiveViews(h),{hasCompleted:r,requiresTransition:!0,enteringView:o,leavingView:c,direction:d.direction}}insertViewAt(r,o){const c=this.views,d=c.indexOf(r);d>-1?(Po(r.nav===this,"view is not part of the nav"),c.splice(d,1),c.splice(o,0,r)):(Po(!r.nav,"nav is used"),r.nav=this,c.splice(o,0,r))}removeView(r){Po(r.state===WX||r.state===uR,"view state should be loaded or destroyed");const o=this.views,c=o.indexOf(r);Po(c>-1,"view must be part of the stack"),c>=0&&o.splice(c,1)}destroyView(r){r._destroy(),this.removeView(r)}unmountInactiveViews(r){if(this.destroyed)return;const o=this.views,c=o.indexOf(r);for(let d=o.length-1;d>=0;d--){const h=o[d],f=h.element;f&&(d>c?(Cd(f,zP),this.destroyView(h)):d<c&&n2(f,!0))}}canStart(){return!this.gestureOrAnimationInProgress&&!!this.swipeGesture&&!this.isTransitioning&&this.transInstr.length===0&&this.canGoBackSync()}onStart(){this.gestureOrAnimationInProgress=!0,this.pop({direction:"back",progressAnimation:!0})}onMove(r){this.sbAni&&this.sbAni.progressStep(r)}onEnd(r,o,c){if(this.sbAni){this.sbAni.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0});let d=r?-.001:.001;r?d+=dR([0,0],[.32,.72],[0,1],[1,1],o)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),d+=dR([0,0],[1,0],[.68,.28],[1,1],o)[0]),this.sbAni.progressEnd(r?1:0,d,c)}else this.gestureOrAnimationInProgress=!1}render(){return uo("slot",{key:"8254ea10bef0575c13f8b0ddbe4643bec19f2366"})}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return q1e}},[1,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64]},void 0,{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}]);function J1e(){if(typeof customElements>"u")return;["ion-nav"].forEach(r=>{switch(r){case"ion-nav":customElements.get(r)||customElements.define(r,X1e);break}})}const Q1e=J1e;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */var OH;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(OH||(OH={}));const Z1e=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",eOe=Z1e,tOe=p_(class extends m_{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Nd(this,"ionNavWillLoad",7),this.ionNavWillChange=Nd(this,"ionNavWillChange",3),this.ionNavDidChange=Nd(this,"ionNavDidChange",3),this.lockController=G1e(),this.gestureOrAnimationInProgress=!1,this.mode=Kg(this),this.delegate=void 0,this.animated=!0,this.animation=void 0,this.swipeHandler=void 0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(this.swipeHandler!==void 0)}async connectedCallback(){const r=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await qI(()=>import("./swipe-back-Gdf5fF8g.js"),__vite__mapDeps([]))).createSwipeBackGesture(this.el,()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart(),()=>r(),o=>{var c;return(c=this.ani)===null||c===void 0?void 0:c.progressStep(o)},(o,c,d)=>{if(this.ani){this.ani.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(o)},{oneTimeCallback:!0});let h=o?-.001:.001;o?h+=dR([0,0],[.32,.72],[0,1],[1,1],c)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),h+=dR([0,0],[1,0],[.68,.28],[1,1],c)[0]),this.ani.progressEnd(o?1:0,h,d)}else this.gestureOrAnimationInProgress=!1}),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(r,o,c){const d=await this.lockController.lock();let h=!1;try{h=await this.transition(r,o,c)}catch(f){console.error(f)}return d(),h}async setRouteId(r,o,c,d){return{changed:await this.setRoot(r,o,{duration:c==="root"?0:void 0,direction:c==="back"?"back":"forward",animationBuilder:d}),element:this.activeEl}}async getRouteId(){const r=this.activeEl;return r?{id:r.tagName,element:r,params:this.activeParams}:void 0}async setRoot(r,o,c){if(this.activeComponent===r&&xX(o,this.activeParams))return!1;const d=this.activeEl,h=await FX(this.delegate,this.el,r,["ion-page","ion-page-invisible"],o);return this.activeComponent=r,this.activeEl=h,this.activeParams=o,await this.commit(h,d,c),await L1e(this.delegate,d),!0}async transition(r,o,c={}){if(o===r)return!1;this.ionNavWillChange.emit();const{el:d,mode:h}=this,f=this.animated&&Eg.getBoolean("animated",!0),_=c.animationBuilder||this.animation||Eg.get("navAnimation");return await LX(Object.assign(Object.assign({mode:h,animated:f,enteringEl:r,leavingEl:o,baseEl:d,deepWait:o1e(d),progressCallback:c.progressAnimation?v=>{v!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,v.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)},{oneTimeCallback:!0}),v.progressEnd(0,0,0)):this.ani=v}:void 0},c),{animationBuilder:_})),this.ionNavDidChange.emit(),!0}render(){return uo("slot",{key:"e4eaa40478f70742d0ff7602ed5f83879da9f1b4"})}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return eOe}},[1,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]},void 0,{swipeHandler:["swipeHandlerChanged"]}]);function nOe(){if(typeof customElements>"u")return;["ion-router-outlet"].forEach(r=>{switch(r){case"ion-router-outlet":customElements.get(r)||customElements.define(r,tOe);break}})}const rOe=nOe;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const iOe=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.2))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, #666666));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",sOe=iOe,oOe=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.07))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, #595959));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:56px}",aOe=oOe,cOe=p_(class extends m_{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=Nd(this,"ionTabBarChanged",7),this.ionTabBarLoaded=Nd(this,"ionTabBarLoaded",7),this.keyboardCtrl=null,this.keyboardVisible=!1,this.color=void 0,this.selectedTab=void 0,this.translucent=!1}selectedTabChanged(){this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentWillLoad(){this.selectedTabChanged()}async connectedCallback(){this.keyboardCtrl=await z1e(async(r,o)=>{r===!1&&o!==void 0&&await o,this.keyboardVisible=r})}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}componentDidLoad(){this.ionTabBarLoaded.emit()}render(){const{color:r,translucent:o,keyboardVisible:c}=this,d=Kg(this),h=c&&this.el.getAttribute("slot")!=="top";return uo(x0,{key:"51e4bdbce8c7107c1114a39618b4a9a941876bb1",role:"tablist","aria-hidden":h?"true":null,class:D1e(r,{[d]:!0,"tab-bar-translucent":o,"tab-bar-hidden":h})},uo("slot",{key:"c11618f97e93deb0a56f33c904481b4811c685ec"}))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:sOe,md:aOe}}},[33,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]},void 0,{selectedTab:["selectedTabChanged"]}]);function lOe(){if(typeof customElements>"u")return;["ion-tab-bar"].forEach(r=>{switch(r){case"ion-tab-bar":customElements.get(r)||customElements.define(r,cOe);break}})}const dOe=lOe;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const uOe=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:30px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:calc(50% + 12px)}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 12px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom:dir(rtl)) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 12px)}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:calc(50% + 35px)}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 35px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start:dir(rtl)) ::slotted(ion-badge),:host(.tab-layout-icon-end:dir(rtl)) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 35px)}}}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:calc(50% + 30px)}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 30px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide:dir(rtl)) ::slotted(ion-badge),:host(.tab-has-label-only:dir(rtl)) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 30px)}}}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}',hOe=uOe,pOe=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom:dir(rtl)) ::slotted(ion-badge){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:80%}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:80%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start:dir(rtl)) ::slotted(ion-badge),:host(.tab-layout-icon-end:dir(rtl)) ::slotted(ion-badge){left:unset;right:unset;right:80%}}}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide:dir(rtl)) ::slotted(ion-badge),:host(.tab-has-label-only:dir(rtl)) ::slotted(ion-badge){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}',fOe=pOe,mOe=p_(class extends m_{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=Nd(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.onKeyUp=r=>{(r.key==="Enter"||r.key===" ")&&this.selectTab(r)},this.onClick=r=>{this.selectTab(r)},this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.layout=void 0,this.selected=!1,this.tab=void 0,this.target=void 0}onTabBarChanged(r){const o=r.target,c=this.el.parentElement;(r.composedPath().includes(c)||o!=null&&o.contains(this.el))&&(this.selected=this.tab===r.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},a1e(this.el,["aria-label"])),this.layout===void 0&&(this.layout=Eg.get("tabButtonLayout","icon-top"))}selectTab(r){this.tab!==void 0&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),r.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:r,hasIcon:o,hasLabel:c,href:d,rel:h,target:f,layout:_,selected:v,tab:b,inheritedAttributes:A}=this,w=Kg(this),x={download:this.download,href:d,rel:h,target:f};return uo(x0,{key:"32ec1fb183523dadaaed6689add4a042d0fdd69a",onClick:this.onClick,onKeyup:this.onKeyUp,id:b!==void 0?`tab-button-${b}`:null,class:{[w]:!0,"tab-selected":v,"tab-disabled":r,"tab-has-label":c,"tab-has-icon":o,"tab-has-label-only":c&&!o,"tab-has-icon-only":o&&!c,[`tab-layout-${_}`]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},uo("a",Object.assign({key:"9e56304c52e30ae3a3dca434fa0b41eccc873faa"},x,{class:"button-native",part:"native",role:"tab","aria-selected":v?"true":null,"aria-disabled":r?"true":null,tabindex:r?"-1":void 0},A),uo("span",{key:"34eae18c23584742a25d20b4038aa1742d9ab0d8",class:"button-inner"},uo("slot",{key:"4bc9629861f5ce3f1ef87ac77bc027ba0dea694c"})),w==="md"&&uo("ion-ripple-effect",{type:"unbounded"})))}get el(){return this}static get style(){return{ios:hOe,md:fOe}}},[33,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]);function gOe(){if(typeof customElements>"u")return;["ion-tab-button","ion-ripple-effect"].forEach(r=>{switch(r){case"ion-tab-button":customElements.get(r)||customElements.define(r,mOe);break;case"ion-ripple-effect":customElements.get(r)||W1e();break}})}const _Oe=gOe;let KP;const EOe=()=>{if(typeof window>"u")return new Map;if(!KP){const t=window;t.Ionicons=t.Ionicons||{},KP=t.Ionicons.map=t.Ionicons.map||new Map}return KP},vOe=t=>{let r=YP(t.src);return r||(r=$X(t.name,t.icon,t.mode,t.ios,t.md),r?yOe(r,t):t.icon&&(r=YP(t.icon),r||(r=YP(t.icon[t.mode]),r))?r:null)},yOe=(t,r)=>{const o=EOe().get(t);if(o)return o;try{return gAe(`svg/${t}.svg`)}catch{console.warn(`[Ionicons Warning]: Could not load icon with name "${t}". Ensure that the icon is registered using addIcons or that the icon SVG data is passed directly to the icon component.`,r)}},$X=(t,r,o,c,d)=>(o=(o&&WC(o))==="ios"?"ios":"md",c&&o==="ios"?t=WC(c):d&&o==="md"?t=WC(d):(!t&&r&&!GX(r)&&(t=r),hR(t)&&(t=WC(t))),!hR(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),YP=t=>hR(t)&&(t=t.trim(),GX(t))?t:null,GX=t=>t.length>0&&/(\/|\.)/.test(t),hR=t=>typeof t=="string",WC=t=>t.toLowerCase(),SOe=(t,r=[])=>{const o={};return r.forEach(c=>{t.hasAttribute(c)&&(t.getAttribute(c)!==null&&(o[c]=t.getAttribute(c)),t.removeAttribute(c))}),o},bOe=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":(document==null?void 0:document.dir.toLowerCase())==="rtl",TOe=t=>{const r=document.createElement("div");r.innerHTML=t;for(let c=r.childNodes.length-1;c>=0;c--)r.childNodes[c].nodeName.toLowerCase()!=="svg"&&r.removeChild(r.childNodes[c]);const o=r.firstElementChild;if(o&&o.nodeName.toLowerCase()==="svg"){const c=o.getAttribute("class")||"";if(o.setAttribute("class",(c+" s-ion-icon").trim()),HX(o))return r.innerHTML}return""},HX=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let r=0;r<t.attributes.length;r++){const o=t.attributes[r].name;if(hR(o)&&o.toLowerCase().indexOf("on")===0)return!1}for(let r=0;r<t.childNodes.length;r++)if(!HX(t.childNodes[r]))return!1}return!0},COe=t=>t.startsWith("data:image/svg+xml"),wOe=t=>t.indexOf(";utf8,")!==-1,Lp=new Map,NH=new Map;let qP;const ROe=(t,r)=>{let o=NH.get(t);if(!o)if(typeof fetch<"u"&&typeof document<"u")if(COe(t)&&wOe(t)){qP||(qP=new DOMParser);const d=qP.parseFromString(t,"text/html").querySelector("svg");return d&&Lp.set(t,d.outerHTML),Promise.resolve()}else o=fetch(t).then(c=>{if(c.ok)return c.text().then(d=>{d&&r!==!1&&(d=TOe(d)),Lp.set(t,d||"")});Lp.set(t,"")}),NH.set(t,o);else return Lp.set(t,""),Promise.resolve();return o},IOe=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:1.125rem !important}:host(.icon-large){font-size:2rem !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",AOe=p_(class extends m_{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.didLoadIcon=!1,this.svgContent=void 0,this.isVisible=!1,this.mode=OOe(),this.color=void 0,this.ios=void 0,this.md=void 0,this.flipRtl=void 0,this.name=void 0,this.src=void 0,this.icon=void 0,this.size=void 0,this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=SOe(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}componentDidLoad(){this.didLoadIcon||this.loadIcon()}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(r,o,c){if(this.lazy&&typeof window<"u"&&window.IntersectionObserver){const d=this.io=new window.IntersectionObserver(h=>{h[0].isIntersecting&&(d.disconnect(),this.io=void 0,c())},{rootMargin:o});d.observe(r)}else c()}loadIcon(){if(this.isVisible){const r=vOe(this);r&&(Lp.has(r)?this.svgContent=Lp.get(r):ROe(r,this.sanitize).then(()=>this.svgContent=Lp.get(r)),this.didLoadIcon=!0)}this.iconName=$X(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:r,iconName:o,inheritedAttributes:c,el:d}=this,h=this.mode||"md",f=o?(o.includes("arrow")||o.includes("chevron"))&&r!==!1:!1,_=r||f;return uo(x0,Object.assign({role:"img",class:Object.assign(Object.assign({[h]:!0},NOe(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":_,"icon-rtl":_&&bOe(d)})},c),this.svgContent?uo("div",{class:"icon-inner",innerHTML:this.svgContent}):uo("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return IOe}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]}]),OOe=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",NOe=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function kOe(){if(typeof customElements>"u")return;["ion-icon"].forEach(r=>{switch(r){case"ion-icon":customElements.get(r)||customElements.define(r,AOe);break}})}const xOe=kOe,xU=gt.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{},cleanupIonViewWillEnter:()=>{},cleanupIonViewDidEnter:()=>{},cleanupIonViewWillLeave:()=>{},cleanupIonViewDidLeave:()=>{}}),POe=class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[],this.ionViewWillEnterDestructorCallbacks=[],this.ionViewDidEnterDestructorCallbacks=[],this.ionViewWillLeaveDestructorCallbacks=[],this.ionViewDidLeaveDestructorCallbacks=[]}onIonViewWillEnter(t){if(t.id){const r=this.ionViewWillEnterCallbacks.findIndex(o=>o.id===t.id);r>-1?this.ionViewWillEnterCallbacks[r]=t:this.ionViewWillEnterCallbacks.push(t)}else this.ionViewWillEnterCallbacks.push(t)}teardownCallback(t,r){const o=r.filter(c=>c.id===t.id);o.length!==0&&(o.forEach(c=>{c&&typeof c.destructor=="function"&&c.destructor()}),r=r.filter(c=>c.id!==t.id))}cleanupIonViewWillEnter(t){this.teardownCallback(t,this.ionViewWillEnterDestructorCallbacks)}cleanupIonViewDidEnter(t){this.teardownCallback(t,this.ionViewDidEnterDestructorCallbacks)}cleanupIonViewWillLeave(t){this.teardownCallback(t,this.ionViewWillLeaveDestructorCallbacks)}cleanupIonViewDidLeave(t){this.teardownCallback(t,this.ionViewDidLeaveDestructorCallbacks)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach(t=>{const r=t();t.id&&this.ionViewWillEnterDestructorCallbacks.push({id:t.id,destructor:r})})}onIonViewDidEnter(t){if(t.id){const r=this.ionViewDidEnterCallbacks.findIndex(o=>o.id===t.id);r>-1?this.ionViewDidEnterCallbacks[r]=t:this.ionViewDidEnterCallbacks.push(t)}else this.ionViewDidEnterCallbacks.push(t)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach(t=>{const r=t();t.id&&this.ionViewDidEnterDestructorCallbacks.push({id:t.id,destructor:r})})}onIonViewWillLeave(t){if(t.id){const r=this.ionViewWillLeaveCallbacks.findIndex(o=>o.id===t.id);r>-1?this.ionViewWillLeaveCallbacks[r]=t:this.ionViewWillLeaveCallbacks.push(t)}else this.ionViewWillLeaveCallbacks.push(t)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach(t=>{const r=t();t.id&&this.ionViewWillLeaveDestructorCallbacks.push({id:t.id,destructor:r})})}onIonViewDidLeave(t){if(t.id){const r=this.ionViewDidLeaveCallbacks.findIndex(o=>o.id===t.id);r>-1?this.ionViewDidLeaveCallbacks[r]=t:this.ionViewDidLeaveCallbacks.push(t)}else this.ionViewDidLeaveCallbacks.push(t)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach(t=>{const r=t();t.id&&this.ionViewDidLeaveDestructorCallbacks.push({id:t.id,destructor:r})}),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(t){this.componentCanBeDestroyedCallback=t}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},Dh=gt.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:t=>{typeof window<"u"&&(typeof t=="string"?window.location.pathname=t:window.history.back())},navigate:t=>{typeof window<"u"&&(window.location.pathname=t)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(t,r)=>{typeof window<"u"&&(window.location.pathname=r)},resetTab:(t,r)=>{typeof window<"u"&&(window.location.pathname=r)}}),DOe=t=>t.toLowerCase().split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(""),zX=t=>t.replace(/([A-Z])/g,r=>`-${r[0].toLowerCase()}`),LOe=(t,r,o={})=>{if(t instanceof Element){const c=MOe(t.classList,r,o);c!==""&&(t.className=c),Object.keys(r).forEach(d=>{if(!(d==="children"||d==="style"||d==="ref"||d==="class"||d==="className"||d==="forwardedRef"))if(d.indexOf("on")===0&&d[2]===d[2].toUpperCase()){const h=d.substring(2),f=h[0].toLowerCase()+h.substring(1);KX(f)||jOe(t,f,r[d])}else t[d]=r[d],typeof r[d]==="string"&&t.setAttribute(zX(d),r[d])})}},MOe=(t,r,o)=>{const c=r.className||r.class,d=o.className||o.class,h=XP(t),f=XP(c?c.split(" "):[]),_=XP(d?d.split(" "):[]),v=[];return h.forEach(b=>{f.has(b)?(v.push(b),f.delete(b)):_.has(b)||v.push(b)}),f.forEach(b=>v.push(b)),v.join(" ")},UOe=t=>{switch(t){case"doubleclick":return"dblclick"}return t};/**
 * Checks if an event is supported in the current execution environment.
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */const KX=t=>{if(typeof document>"u")return!0;{const r="on"+UOe(t);let o=r in document;if(!o){const c=document.createElement("div");c.setAttribute(r,"return;"),o=typeof c[r]=="function"}return o}},jOe=(t,r,o)=>{const c=t.__events||(t.__events={}),d=c[r];d&&t.removeEventListener(r,d),t.addEventListener(r,c[r]=function(f){o&&o.call(this,f)})},XP=t=>{const r=new Map;return t.forEach(o=>r.set(o,o)),r},FOe=(t,r)=>{typeof t=="function"?t(r):t!=null&&(t.current=r)},YX=(...t)=>r=>{t.forEach(o=>{FOe(o,r)})},VOe=(t,r)=>{const o=(c,d)=>gt.createElement(t,Object.assign({},c,{forwardedRef:d}));return o.displayName=r,gt.forwardRef(o)},L0=(t,r,o,c)=>{c!==void 0&&c();const d=DOe(t),h=class extends gt.Component{constructor(f){super(f),this.setComponentElRef=_=>{this.componentEl=_}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(f){LOe(this.componentEl,this.props,f)}render(){const f=this.props,{children:_,forwardedRef:v,style:b,className:A,ref:w}=f,x=zd(f,["children","forwardedRef","style","className","ref"]);let M=Object.keys(x).reduce((G,H)=>{const F=x[H];if(H.indexOf("on")===0&&H[2]===H[2].toUpperCase()){const B=H.substring(2).toLowerCase();typeof document<"u"&&KX(B)&&(G[H]=F)}else{const B=typeof F;(B==="string"||B==="boolean"||B==="number")&&(G[zX(H)]=F)}return G},{});o&&(M=o(this.props,M));const V=Object.assign(Object.assign({},M),{ref:YX(v,this.setComponentElRef),style:b});return K.createElement(t,V,_)}static get displayName(){return d}};return r&&(h.contextType=r),VOe(h,d)},M0=(t,r)=>{const o=(c,d)=>gt.createElement(t,Object.assign({},c,{forwardedRef:d}));return o.displayName=r,gt.forwardRef(o)},BOe=()=>{if(typeof window<"u"){const t=window.Ionic;if(t&&t.config)return t.config}return null};gt.createContext({addOverlay:()=>{},removeOverlay:()=>{}});const WOe=L0("ion-tab-button",void 0,void 0,_Oe),$Oe=L0("ion-tab-bar",void 0,void 0,dOe),o2=L0("ion-router-outlet",void 0,void 0,rOe),GOe=L0("ion-icon",void 0,void 0,xOe),qX=gt.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class XX extends gt.PureComponent{constructor(r){super(r),this.ionPageElementRef=gt.createRef(),this.stableMergedRefs=YX(this.ionPageElementRef,this.props.forwardedRef),this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const r=this.props,{className:o,children:c,routeInfo:d,forwardedRef:h}=r,f=zd(r,["className","children","routeInfo","forwardedRef"]);return gt.createElement(xU.Consumer,null,_=>(this.ionLifeCycleContext=_,gt.createElement("div",Object.assign({className:o?`${o} ion-page`:"ion-page",ref:this.stableMergedRefs},f),c)))}static get contextType(){return qX}}class HOe extends gt.Component{constructor(r){super(r)}render(){const r=this.props,{className:o,children:c,forwardedRef:d}=r,h=zd(r,["className","children","forwardedRef"]);return this.context.hasIonicRouter()?gt.createElement(XX,Object.assign({className:o?`${o}`:"",routeInfo:this.context.routeInfo,forwardedRef:d},h),c):gt.createElement("div",Object.assign({className:o?`ion-page ${o}`:"ion-page",ref:d},h),c)}static get displayName(){return"IonPage"}static get contextType(){return Dh}}M0(HOe,"IonPage");const kH={main:0},zOe=(t="main")=>{var r;const o=((r=kH[t])!==null&&r!==void 0?r:0)+1;return kH[t]=o,o.toString()},KOe=(t,r)=>{const o=new WeakMap,c=`react-delegate-${zOe()}`;let d=0;return{attachViewToDom:async(_,v,b,A)=>{const w=document.createElement("div");A&&w.classList.add(...A),_.appendChild(w);const x=v(b),M=`${c}-${d++}`,V=NR.createPortal(x,w,M);return o.set(w,V),t(V),Promise.resolve(w)},removeViewFromDom:(_,v)=>{const b=o.get(v);return b&&r(b),v.remove(),Promise.resolve()}}},YOe=L0("ion-nav",void 0,void 0,Q1e),qOe=t=>{var{children:r,forwardedRef:o}=t,c=zd(t,["children","forwardedRef"]);const[d,h]=K.useState([]),f=b=>h(A=>[...A,b]),_=b=>h(A=>A.filter(w=>w!==b)),v=K.useMemo(()=>KOe(f,_),[]);return gt.createElement(YOe,Object.assign({delegate:v,ref:o},c),d)};M0(qOe,"IonNav");gt.createContext({activeTab:void 0,selectTab:()=>!1});const XOe=typeof HTMLElement<"u"?HTMLElement:class{};class JOe extends gt.Component{constructor(r){super(r),this.outletIsReady=!1,this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||kX(this.ionRouterOutlet,()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)}),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const r=this.props,{StackManager:o,children:c,routeInfo:d}=r,h=zd(r,["StackManager","children","routeInfo"]);return gt.createElement(xU.Consumer,null,f=>(this.ionLifeCycleContext=f,gt.createElement(o,{routeInfo:d},gt.createElement(o2,Object.assign({setRef:_=>this.ionRouterOutlet=_},h),c))))}static get contextType(){return qX}}class QOe extends gt.Component{constructor(r){super(r)}render(){const r=this.context.getStackManager(),o=this.props,{children:c,forwardedRef:d}=o,h=zd(o,["children","forwardedRef"]);return this.context.hasIonicRouter()?h.ionPage?gt.createElement(JOe,Object.assign({StackManager:r,routeInfo:this.context.routeInfo},h),c):gt.createElement(r,{routeInfo:this.context.routeInfo},gt.createElement(o2,Object.assign({},h,{forwardedRef:d}),c)):gt.createElement(o2,Object.assign({ref:d},this.props),this.props.children)}static get contextType(){return Dh}}M0(QOe,"IonRouterOutlet");const JP=class extends gt.Component{constructor(t){super(t),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const t=this.props,r=zd(t,["onClick"]);return gt.createElement(WOe,Object.assign({onIonTabButtonClick:this.handleIonTabButtonClick},r))}static get displayName(){return"IonTabButton"}};class ZOe extends gt.PureComponent{constructor(r){super(r),this.setActiveTabOnContext=c=>{};const o={};gt.Children.forEach(r.children,c=>{var d,h,f,_;c!=null&&typeof c=="object"&&c.props&&(c.type===JP||c.type.isTabButton)&&(o[c.props.tab]={originalHref:c.props.href,currentHref:c.props.href,originalRouteOptions:c.props.href===((d=r.routeInfo)===null||d===void 0?void 0:d.pathname)?(h=r.routeInfo)===null||h===void 0?void 0:h.routeOptions:void 0,currentRouteOptions:c.props.href===((f=r.routeInfo)===null||f===void 0?void 0:f.pathname)?(_=r.routeInfo)===null||_===void 0?void 0:_.routeOptions:void 0})}),this.state={tabs:o},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const r=this.state.tabs,c=Object.keys(r).find(d=>{const h=r[d].originalHref;return this.props.routeInfo.pathname.startsWith(h)});c&&this.setState({activeTab:c})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(r){const o=this.state.tabs[r];return o?(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:o.currentHref,tab:r,selected:r===this.state.activeTab,routeOptions:void 0}})),!0):!1}static getDerivedStateFromProps(r,o){var c,d,h;const f=Object.assign({},o.tabs),v=Object.keys(o.tabs).find(A=>{const w=o.tabs[A].originalHref;return r.routeInfo.pathname.startsWith(w)});gt.Children.forEach(r.children,A=>{if(A!=null&&typeof A=="object"&&A.props&&(A.type===JP||A.type.isTabButton)){const w=f[A.props.tab];(!w||w.originalHref!==A.props.href)&&(f[A.props.tab]={originalHref:A.props.href,currentHref:A.props.href,originalRouteOptions:A.props.routeOptions,currentRouteOptions:A.props.routeOptions})}});const{activeTab:b}=o;if(v&&b){const A=o.tabs[b].currentHref,w=o.tabs[b].currentRouteOptions;(v!==b||A!==((c=r.routeInfo)===null||c===void 0?void 0:c.pathname)||w!==((d=r.routeInfo)===null||d===void 0?void 0:d.routeOptions))&&(f[v]={originalHref:f[v].originalHref,currentHref:r.routeInfo.pathname+(r.routeInfo.search||""),originalRouteOptions:f[v].originalRouteOptions,currentRouteOptions:(h=r.routeInfo)===null||h===void 0?void 0:h.routeOptions},r.routeInfo.routeAction==="pop"&&v!==b&&(f[b]={originalHref:f[b].originalHref,currentHref:f[b].originalHref,originalRouteOptions:f[b].originalRouteOptions,currentRouteOptions:f[b].currentRouteOptions}))}return v&&r.onSetCurrentTab(v,r.routeInfo),{activeTab:v,tabs:f}}onTabButtonClick(r,o){const c=this.state.tabs[r.detail.tab],d=c.originalHref,h=r.detail.href,{activeTab:f}=this.state;o&&o(r),f===r.detail.tab?d!==h&&this.context.resetTab(r.detail.tab,d,c.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:r.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:r.detail.tab}})),this.setActiveTabOnContext(r.detail.tab),this.context.changeTab(r.detail.tab,h,r.detail.routeOptions))}renderTabButton(r){return o=>{var c,d;if(o!=null&&o.props&&(o.type===JP||o.type.isTabButton)){const h=o.props.tab===r?(c=this.props.routeInfo)===null||c===void 0?void 0:c.pathname:this.state.tabs[o.props.tab].currentHref,f=o.props.tab===r?(d=this.props.routeInfo)===null||d===void 0?void 0:d.routeOptions:this.state.tabs[o.props.tab].currentRouteOptions;return gt.cloneElement(o,{href:h,routeOptions:f,onClick:_=>this.onTabButtonClick(_,o.props.onClick)})}return null}}render(){const{activeTab:r}=this.state;return gt.createElement($Oe,Object.assign({},this.props,{selectedTab:r}),gt.Children.map(this.props.children,this.renderTabButton(r)))}static get contextType(){return Dh}}const eNe=gt.memo(t=>{var{forwardedRef:r}=t,o=zd(t,["forwardedRef"]);const c=K.useContext(Dh);return gt.createElement(ZOe,Object.assign({ref:r},o,{routeInfo:o.routeInfo||c.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:c.setCurrentTab}),o.children)});M0(eNe,"IonTabBar");class tNe extends XOe{constructor(){super()}}typeof window<"u"&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",tNe));class nNe extends gt.PureComponent{constructor(r){super(r),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){var r,o;const c=this.props,{icon:d,ios:h,md:f,mode:_}=c,v=zd(c,["icon","ios","md","mode"]);let b;const A=BOe(),w=_||(A==null?void 0:A.get("mode"));return h||f?w==="ios"?b=(r=h??f)!==null&&r!==void 0?r:d:b=(o=f??h)!==null&&o!==void 0?o:d:b=d,gt.createElement(GOe,Object.assign({ref:this.props.forwardedRef,icon:b},v),this.props.children)}static get contextType(){return Dh}}const rNe=M0(nNe,"IonIcon");class JX extends gt.PureComponent{render(){const r=this.context.getIonRoute();return!this.context.hasIonicRouter()||!JX?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null):gt.createElement(r,Object.assign({},this.props))}static get contextType(){return Dh}}class QX extends gt.PureComponent{render(){const r=this.context.getIonRedirect();return!this.context.hasIonicRouter()||!QX?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRedirect>"),null):gt.createElement(r,Object.assign({},this.props))}static get contextType(){return Dh}}const iNe=gt.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});class kke extends gt.PureComponent{constructor(r){super(r),this.nodes=new Map,this.animation=m1e(r.id)}setupAnimation(r){const o=this.animation;this.nodes.size>0&&o.addElement(Array.from(this.nodes.values())),xH(o,r),PH(o,r)}componentDidMount(){const r=this.props;this.setupAnimation(r)}componentDidUpdate(r){const o=this.animation,c=this.props;xH(o,c,r),sNe(o,c,r),PH(o,c,r)}render(){const{children:r}=this.props;return gt.createElement(gt.Fragment,null,gt.Children.map(r,(o,c)=>gt.cloneElement(o,{ref:d=>this.nodes.set(c,d)})))}}const xH=(t,r={},o={})=>{const c=["children","progressStart","progressStep","progressEnd","pause","stop","destroy","play","from","to","fromTo","onFinish"];for(const v in r)r.hasOwnProperty(v)&&!c.includes(v)&&r[v]!==o[v]&&t[v](r[v]);const d=r.from;d&&d!==o.from&&(Array.isArray(d)?d:[d]).forEach(b=>t.from(b.property,b.value));const h=r.to;h&&h!==o.to&&(Array.isArray(h)?h:[h]).forEach(b=>t.to(b.property,b.value));const f=r.fromTo;f&&f!==o.fromTo&&(Array.isArray(f)?f:[f]).forEach(b=>t.fromTo(b.property,b.fromValue,b.toValue));const _=r.onFinish;_&&_!==o.onFinish&&(Array.isArray(_)?_:[_]).forEach(b=>t.onFinish(b.callback,b.opts))},sNe=(t,r={},o={})=>{var c,d,h,f,_;const{progressStart:v,progressStep:b,progressEnd:A}=r;v&&(((c=o.progressStart)===null||c===void 0?void 0:c.forceLinearEasing)!==(v==null?void 0:v.forceLinearEasing)||((d=o.progressStart)===null||d===void 0?void 0:d.step)!==(v==null?void 0:v.step))&&t.progressStart(v.forceLinearEasing,v.step),b&&((h=o.progressStep)===null||h===void 0?void 0:h.step)!==(b==null?void 0:b.step)&&t.progressStep(b.step),A&&(((f=o.progressEnd)===null||f===void 0?void 0:f.playTo)!==(A==null?void 0:A.playTo)||((_=o.progressEnd)===null||_===void 0?void 0:_.step)!==(A==null?void 0:A.step)||(o==null?void 0:o.dur)!==(A==null?void 0:A.dur))&&t.progressEnd(A.playTo,A.step,A.dur)},PH=(t,r={},o={})=>{!o.play&&r.play&&t.play(),!o.pause&&r.pause&&t.pause(),!o.stop&&r.stop&&t.stop(),!o.destroy&&r.destroy&&t.destroy()};class xke extends gt.Component{constructor(r){super(r),this.ionLifeCycleContext=new POe,this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed(()=>{this.props.mount||this._isMounted&&this.setState({show:!1},()=>this.props.removeView())}),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:r}=this.state;return gt.createElement(xU.Provider,{value:this.ionLifeCycleContext},r&&this.props.children)}}class Pke extends gt.PureComponent{constructor(r){super(r),this.ionRouterContextValue={push:(o,c,d,h,f)=>{this.navigate(o,c,d,f,h)},back:o=>{this.goBack(void 0,o)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){typeof document<"u"&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){typeof document<"u"&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(r){r.detail.register(0,o=>{this.nativeGoBack(),o()})}goBack(r,o){this.props.onNavigateBack(r,o)}nativeGoBack(){this.props.onNativeBack()}navigate(r,o="forward",c="push",d,h,f){this.props.onNavigate(r,c,o,d,h,f)}getPageManager(){return XX}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return gt.createElement(Dh.Provider,{value:Object.assign(Object.assign({},this.state),{routeInfo:this.props.routeInfo})},gt.createElement(iNe.Provider,{value:Object.assign(Object.assign({},this.ionRouterContextValue),{routeInfo:this.props.routeInfo})},this.props.children))}}const oNe=()=>{let t=new dU;const r=Os(),[o,c]=K.useState(""),[d,h]=K.useState(""),[f,_]=K.useState("");qs({token:o,setToken:c,setProfile:_,setPhone:h});const{sent:v,friend:b}=K.useContext(Wc),A=ki({mutationKey:["submitFriend"],mutationFn:G=>{console.log(o),console.log(G),t.acceptFriend(o,G).then(H=>{o&&(console.log("data",H.data),H.status===200&&(St({title:"ok",text:"You have pressed the button!",icon:"success"}),r.invalidateQueries(["friends"]),r.invalidateQueries(["friendRequest"]),r.invalidateQueries(["chats"]),r.invalidateQueries(["chat"])))})},onSuccess:G=>{console.log("data",G),G&&St({title:"ok",text:"You have pressed the button!",icon:"success"})},onSettled:G=>{console.log("done",G)},onError:G=>{console.error("err",G),St({title:"Error",text:"You have pressed the button!",icon:"error"})}}),w=ki({mutationKey:["declineFriend"],mutationFn:G=>{console.log(o),console.log(G),t.declineFriend(o,G).then(H=>{o&&(console.log("data",H.data),H.status===200&&(St({title:"ok",text:"You have pressed the button!",icon:"success"}),r.invalidateQueries(["friendRequest"])))})},onSuccess:G=>{console.log("data",G)},onSettled:G=>{console.log("done",G)},onError:G=>{console.error("err",G),St({title:"Error",text:"You have pressed the button!",icon:"error"})}}),x=G=>{A.mutate(G),console.log(A)},M=G=>{w.mutate(G),console.log(w)},V=()=>(v==null?void 0:v.length)>0?v==null?void 0:v.map((G,H)=>{var F;return T.jsxs("div",{className:"w-full mb-4",children:[T.jsx("div",{children:G.title}),T.jsx("div",{className:"flex w-full mt-4 gap-2 rounded-lg",children:T.jsxs("div",{className:"p-4 mx-2 flex w-full bg-white rounded-lg",children:[T.jsx("div",{children:T.jsx(pi,{alt:"",src:(F=G==null?void 0:G.profile)==null?void 0:F.thumbnailAvatar,className:"m-4"})}),T.jsxs("div",{className:"flex w-full pb-4 border-b justify-between",children:[T.jsxs("div",{className:"w-full",children:[T.jsx("div",{className:"w-full font-semibold mt-3",children:G.displayName}),T.jsx("div",{className:"h-10 mt-2",children:T.jsxs("span",{className:"text-gray-500",children:["Xin chào mình là ",G.displayName," kết bạn với mình nhé"]})}),T.jsxs("div",{className:"gap-5 flex mt-3 w-full",children:[T.jsx("button",{onClick:()=>{var B;return x((B=G==null?void 0:G.profile)==null?void 0:B.id)},className:"bg-blue-400 text-white rounded-2xl px-5 py-1",children:"Đồng ý"}),T.jsx("button",{onClick:()=>{var B;return M((B=G==null?void 0:G.profile)==null?void 0:B.id)},className:"bg-gray-400 text-white rounded-2xl px-5",children:"Từ chối"})]})]}),T.jsx("div",{className:"text-gray-400",children:T.jsx(Dn,{className:"w-5 h-5 cursor-pointer",icon:kge})})]})]})})]},H)}):T.jsx("div",{children:"Bạn ko có lời mời nào"});return T.jsx("div",{className:"h-screen w-full ",children:T.jsxs("div",{className:"h-[69px] w-full",children:[T.jsx("div",{className:"flex h-full w-full flex-row items-center border-b",children:T.jsxs("div",{className:"flex flex-row items-center gap-x-2 px-4",children:[T.jsx(Dn,{icon:LK,className:"pl-1 pr-3"}),T.jsx("div",{className:"flex flex-col",children:T.jsx("div",{className:"text-lg font-medium text-[#081c36]",children:T.jsx("span",{children:"Lời mời kết bạn"})})})]})}),T.jsx("div",{className:" p-4 px-4 h-[700px] w-full bg-[#F5F5F5]",children:T.jsx("div",{className:"bg-[#F5F5F5]",children:T.jsx(V,{})})})]})})};function ZX(){const[t,r]=K.useState(""),[o,c]=K.useState(""),[d,h]=K.useState("");qs({token:t,setToken:r,setProfile:h,setPhone:c});const{friend:f,sent:_}=K.useContext(Wc),v=()=>f?T.jsxs("div",{children:[" ",(f==null?void 0:f.length)>0?T.jsx("div",{children:f==null?void 0:f.map((b,A)=>{var w,x;return T.jsx("div",{className:"py-4",children:T.jsx("div",{children:T.jsxs("div",{className:"p-4 flex flex-row items-center",children:[(w=b==null?void 0:b.user)!=null&&w.thubnaiAvatar&&f.isLoading?T.jsx(Ju,{variant:"circular",width:40,height:40}):T.jsx(pi,{alt:"",src:(x=b==null?void 0:b.profile)==null?void 0:x.thumbnailAvatar,className:"m-4"}),b!=null&&b.displayName?T.jsx("div",{className:"w-full p-4 py-5 border-b",children:b==null?void 0:b.displayName}):T.jsx(Ju,{variant:"rectangular",width:210,height:60})]})})},A)})}):T.jsx("div",{children:"Bạn ko bạn bè nào"})]}):T.jsx(Ju,{children:f==null?void 0:f.map((b,A)=>{var w,x,M;return T.jsx("div",{className:"py-4",children:T.jsx("div",{children:T.jsxs("div",{className:"p-4 flex flex-row items-center",children:[(w=b==null?void 0:b.user)!=null&&w.thubnaiAvatar&&f.isLoading?T.jsx(Ju,{variant:"circular",width:40,height:40}):T.jsx(pi,{alt:"",src:(x=b==null?void 0:b.profile)!=null&&x.thumbnailAvatar?(M=b==null?void 0:b.profile)==null?void 0:M.thumbnailAvatar:"avatar.jpg",className:"m-4"}),b!=null&&b.displayName?T.jsx("div",{className:"w-full p-4 py-5 border-b",children:b==null?void 0:b.displayName}):T.jsx(Ju,{variant:"rectangular",width:210,height:60})]})})},A)})});return T.jsx("div",{className:"h-screen w-full",children:T.jsxs("div",{className:"h-[69px] w-full",children:[T.jsx("div",{className:"flex h-full w-full flex-row items-center justify-between border-b",children:T.jsxs("div",{className:"flex flex-row items-center gap-x-2 px-4",children:[T.jsx(Dn,{icon:kM,className:"pl-1 pr-3"}),T.jsx("div",{className:"flex flex-col",children:T.jsx("div",{className:"text-lg font-medium text-[#081c36]",children:T.jsx("span",{children:"Danh sách bạn bè"})})})]})}),T.jsxs("div",{className:"bg-neutral-100 p-4 pr-2 h-[700px] w-full overflow-auto",children:[T.jsx("div",{className:"font-medium pb-4",children:"Bạn bè"}),T.jsx("div",{className:"bg-white rounded-l p-4 ",children:T.jsx(v,{})})]})]})})}function aNe({setComp:t}){const[r,o]=K.useState(0),c=(f,_)=>{o(_),_==0?t(T.jsx(ZX,{})):_==1?t(T.jsx(hAe,{})):_==2&&t(T.jsx(oNe,{}))},[d,h]=K.useState("");return K.useEffect(()=>{const f=Hn.get("token");console.log(d),f&&f!==d&&h(f)},[d]),T.jsx("div",{className:"h-[64px] w-[334px] flex-col checked:text-red-700",children:T.jsxs(YY,{className:"p-0 my-0",children:[T.jsxs(RP,{className:"h-[64px]",id:"listFriend",selected:r===0,onClick:f=>c(f,0),children:[T.jsx(IP,{children:T.jsx(Dn,{icon:kM,className:"mx-3"})}),T.jsx(AP,{primary:"Danh sách bạn bè"})]}),T.jsxs(RP,{className:"h-[64px]",id:"listGroup",selected:r===1,onClick:f=>c(f,1),children:[T.jsx(IP,{children:T.jsx(Dn,{icon:Ohe,className:"mx-3"})}),T.jsx(AP,{primary:"Danh sách nhóm"})]}),T.jsxs(RP,{className:"h-[64px]",id:"addFriend",selected:r===2,onClick:f=>c(f,2),children:[T.jsx(IP,{children:T.jsx(Dn,{icon:LK,className:"mx-3"})}),T.jsx(AP,{primary:"Lời mời kết bạn"})]})]})})}function cNe(){return T.jsxs("div",{className:"h-full w-full flex-1 flex-col",children:[T.jsx("div",{}),T.jsx("div",{className:"flex-1 pl-4 ",children:T.jsx("div",{className:"h-screen w-full overflow-auto",children:T.jsx("div",{className:"flex w-full items-center pr-2",children:T.jsx("div",{className:"transition-min-width flex min-w-[calc(100vw-600px)] items-center text-[#7589A3] duration-200 md:min-w-[306px]",children:T.jsx("p",{className:"text-justify text-rose-600",children:"ok"})})})})})]})}function es(t){const r=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&r==="[object Date]"?new t.constructor(+t):typeof t=="number"||r==="[object Number]"||typeof t=="string"||r==="[object String]"?new Date(t):new Date(NaN)}const lNe=864e5,dNe=6e4,uNe=36e5;function DH(t){const r=es(t);return r.setHours(0,0,0,0),r}function LH(t){const r=es(t),o=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return o.setUTCFullYear(r.getFullYear()),+t-+o}function hNe(t,r){const o=DH(t),c=DH(r),d=+o-LH(o),h=+c-LH(c);return Math.round((d-h)/lNe)}function dy(t,r){const o=es(t),c=es(r),d=o.getTime()-c.getTime();return d<0?-1:d>0?1:d}function pNe(t,r){const o=es(t),c=es(r),d=o.getFullYear()-c.getFullYear(),h=o.getMonth()-c.getMonth();return d*12+h}function fNe(t,r){const o=es(t),c=es(r);return o.getFullYear()-c.getFullYear()}function mNe(t,r){const o=es(t),c=es(r),d=MH(o,c),h=Math.abs(hNe(o,c));o.setDate(o.getDate()-d*h);const f=+(MH(o,c)===-d),_=d*(h-f);return _===0?0:_}function MH(t,r){const o=t.getFullYear()-r.getFullYear()||t.getMonth()-r.getMonth()||t.getDate()-r.getDate()||t.getHours()-r.getHours()||t.getMinutes()-r.getMinutes()||t.getSeconds()-r.getSeconds()||t.getMilliseconds()-r.getMilliseconds();return o<0?-1:o>0?1:o}function eJ(t){return r=>{const c=(t?Math[t]:Math.trunc)(r);return c===0?0:c}}function tJ(t,r){return+es(t)-+es(r)}function gNe(t,r,o){const c=tJ(t,r)/uNe;return eJ(o==null?void 0:o.roundingMethod)(c)}function _Ne(t,r,o){const c=tJ(t,r)/dNe;return eJ(o==null?void 0:o.roundingMethod)(c)}function ENe(t){const r=es(t);return r.setHours(23,59,59,999),r}function vNe(t){const r=es(t),o=r.getMonth();return r.setFullYear(r.getFullYear(),o+1,0),r.setHours(23,59,59,999),r}function yNe(t){const r=es(t);return+ENe(r)==+vNe(r)}function SNe(t,r){const o=es(t),c=es(r),d=dy(o,c),h=Math.abs(pNe(o,c));let f;if(h<1)f=0;else{o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-d*h);let _=dy(o,c)===-d;yNe(es(t))&&h===1&&dy(t,c)===1&&(_=!1),f=d*(h-Number(_))}return f===0?0:f}function bNe(t,r){const o=es(t),c=es(r),d=dy(o,c),h=Math.abs(fNe(o,c));o.setFullYear(1584),c.setFullYear(1584);const f=dy(o,c)===-d,_=d*(h-+f);return _===0?0:_}function TNe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var CNe={exports:{}};(function(t,r){(function(o,c){t.exports=c()})(nt,function(){var o;function c(){return o.apply(null,arguments)}function d(S){o=S}function h(S){return S instanceof Array||Object.prototype.toString.call(S)==="[object Array]"}function f(S){return S!=null&&Object.prototype.toString.call(S)==="[object Object]"}function _(S,O){return Object.prototype.hasOwnProperty.call(S,O)}function v(S){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(S).length===0;var O;for(O in S)if(_(S,O))return!1;return!0}function b(S){return S===void 0}function A(S){return typeof S=="number"||Object.prototype.toString.call(S)==="[object Number]"}function w(S){return S instanceof Date||Object.prototype.toString.call(S)==="[object Date]"}function x(S,O){var W=[],Y,te=S.length;for(Y=0;Y<te;++Y)W.push(O(S[Y],Y));return W}function M(S,O){for(var W in O)_(O,W)&&(S[W]=O[W]);return _(O,"toString")&&(S.toString=O.toString),_(O,"valueOf")&&(S.valueOf=O.valueOf),S}function V(S,O,W,Y){return eS(S,O,W,Y,!0).utc()}function G(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function H(S){return S._pf==null&&(S._pf=G()),S._pf}var F;Array.prototype.some?F=Array.prototype.some:F=function(S){var O=Object(this),W=O.length>>>0,Y;for(Y=0;Y<W;Y++)if(Y in O&&S.call(this,O[Y],Y,O))return!0;return!1};function B(S){var O=null,W=!1,Y=S._d&&!isNaN(S._d.getTime());if(Y&&(O=H(S),W=F.call(O.parsedDateParts,function(te){return te!=null}),Y=O.overflow<0&&!O.empty&&!O.invalidEra&&!O.invalidMonth&&!O.invalidWeekday&&!O.weekdayMismatch&&!O.nullInput&&!O.invalidFormat&&!O.userInvalidated&&(!O.meridiem||O.meridiem&&W),S._strict&&(Y=Y&&O.charsLeftOver===0&&O.unusedTokens.length===0&&O.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(S))S._isValid=Y;else return Y;return S._isValid}function L(S){var O=V(NaN);return S!=null?M(H(O),S):H(O).userInvalidated=!0,O}var X=c.momentProperties=[],ee=!1;function ce(S,O){var W,Y,te,ve=X.length;if(b(O._isAMomentObject)||(S._isAMomentObject=O._isAMomentObject),b(O._i)||(S._i=O._i),b(O._f)||(S._f=O._f),b(O._l)||(S._l=O._l),b(O._strict)||(S._strict=O._strict),b(O._tzm)||(S._tzm=O._tzm),b(O._isUTC)||(S._isUTC=O._isUTC),b(O._offset)||(S._offset=O._offset),b(O._pf)||(S._pf=H(O)),b(O._locale)||(S._locale=O._locale),ve>0)for(W=0;W<ve;W++)Y=X[W],te=O[Y],b(te)||(S[Y]=te);return S}function ie(S){ce(this,S),this._d=new Date(S._d!=null?S._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ee===!1&&(ee=!0,c.updateOffset(this),ee=!1)}function ne(S){return S instanceof ie||S!=null&&S._isAMomentObject!=null}function fe(S){c.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+S)}function oe(S,O){var W=!0;return M(function(){if(c.deprecationHandler!=null&&c.deprecationHandler(null,S),W){var Y=[],te,ve,Le,ut=arguments.length;for(ve=0;ve<ut;ve++){if(te="",typeof arguments[ve]=="object"){te+=`
[`+ve+"] ";for(Le in arguments[0])_(arguments[0],Le)&&(te+=Le+": "+arguments[0][Le]+", ");te=te.slice(0,-2)}else te=arguments[ve];Y.push(te)}fe(S+`
Arguments: `+Array.prototype.slice.call(Y).join("")+`
`+new Error().stack),W=!1}return O.apply(this,arguments)},O)}var ue={};function Ne(S,O){c.deprecationHandler!=null&&c.deprecationHandler(S,O),ue[S]||(fe(O),ue[S]=!0)}c.suppressDeprecationWarnings=!1,c.deprecationHandler=null;function Ee(S){return typeof Function<"u"&&S instanceof Function||Object.prototype.toString.call(S)==="[object Function]"}function we(S){var O,W;for(W in S)_(S,W)&&(O=S[W],Ee(O)?this[W]=O:this["_"+W]=O);this._config=S,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Re(S,O){var W=M({},S),Y;for(Y in O)_(O,Y)&&(f(S[Y])&&f(O[Y])?(W[Y]={},M(W[Y],S[Y]),M(W[Y],O[Y])):O[Y]!=null?W[Y]=O[Y]:delete W[Y]);for(Y in S)_(S,Y)&&!_(O,Y)&&f(S[Y])&&(W[Y]=M({},W[Y]));return W}function Pe(S){S!=null&&this.set(S)}var $e;Object.keys?$e=Object.keys:$e=function(S){var O,W=[];for(O in S)_(S,O)&&W.push(O);return W};var Ce={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Fe(S,O,W){var Y=this._calendar[S]||this._calendar.sameElse;return Ee(Y)?Y.call(O,W):Y}function Ye(S,O,W){var Y=""+Math.abs(S),te=O-Y.length,ve=S>=0;return(ve?W?"+":"":"-")+Math.pow(10,Math.max(0,te)).toString().substr(1)+Y}var Mt=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,yt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Xt={},Ue={};function Be(S,O,W,Y){var te=Y;typeof Y=="string"&&(te=function(){return this[Y]()}),S&&(Ue[S]=te),O&&(Ue[O[0]]=function(){return Ye(te.apply(this,arguments),O[1],O[2])}),W&&(Ue[W]=function(){return this.localeData().ordinal(te.apply(this,arguments),S)})}function at(S){return S.match(/\[[\s\S]/)?S.replace(/^\[|\]$/g,""):S.replace(/\\/g,"")}function Jt(S){var O=S.match(Mt),W,Y;for(W=0,Y=O.length;W<Y;W++)Ue[O[W]]?O[W]=Ue[O[W]]:O[W]=at(O[W]);return function(te){var ve="",Le;for(Le=0;Le<Y;Le++)ve+=Ee(O[Le])?O[Le].call(te,S):O[Le];return ve}}function un(S,O){return S.isValid()?(O=Ut(O,S.localeData()),Xt[O]=Xt[O]||Jt(O),Xt[O](S)):S.localeData().invalidDate()}function Ut(S,O){var W=5;function Y(te){return O.longDateFormat(te)||te}for(yt.lastIndex=0;W>=0&&yt.test(S);)S=S.replace(yt,Y),yt.lastIndex=0,W-=1;return S}var Gr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function sn(S){var O=this._longDateFormat[S],W=this._longDateFormat[S.toUpperCase()];return O||!W?O:(this._longDateFormat[S]=W.match(Mt).map(function(Y){return Y==="MMMM"||Y==="MM"||Y==="DD"||Y==="dddd"?Y.slice(1):Y}).join(""),this._longDateFormat[S])}var hn="Invalid date";function Ht(){return this._invalidDate}var on="%d",rt=/\d{1,2}/;function _n(S){return this._ordinal.replace("%d",S)}var Kn={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function En(S,O,W,Y){var te=this._relativeTime[W];return Ee(te)?te(S,O,W,Y):te.replace(/%d/i,S)}function fi(S,O){var W=this._relativeTime[S>0?"future":"past"];return Ee(W)?W(O):W.replace(/%s/i,O)}var fr={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ft(S){return typeof S=="string"?fr[S]||fr[S.toLowerCase()]:void 0}function mr(S){var O={},W,Y;for(Y in S)_(S,Y)&&(W=Ft(Y),W&&(O[W]=S[Y]));return O}var Hr={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Mn(S){var O=[],W;for(W in S)_(S,W)&&O.push({unit:W,priority:Hr[W]});return O.sort(function(Y,te){return Y.priority-te.priority}),O}var Wi=/\d/,lr=/\d\d/,Yn=/\d{3}/,an=/\d{4}/,It=/[+-]?\d{6}/,ot=/\d\d?/,tn=/\d\d\d\d?/,$i=/\d\d\d\d\d\d?/,bt=/\d{1,3}/,nn=/\d{1,4}/,Tn=/[+-]?\d{1,6}/,mi=/\d+/,ac=/[+-]?\d+/,g_=/Z|[+-]\d\d:?\d\d/gi,Ho=/Z|[+-]\d\d(?::?\d\d)?/gi,df=/[+-]?\d+(\.\d{1,3})?/,Wl=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,$c=/^[1-9]\d?/,Lh=/^([1-9]\d|\d)/,Kd;Kd={};function lt(S,O,W){Kd[S]=Ee(O)?O:function(Y,te){return Y&&W?W:O}}function __(S,O){return _(Kd,S)?Kd[S](O._strict,O._locale):new RegExp(Gc(S))}function Gc(S){return zo(S.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(O,W,Y,te,ve){return W||Y||te||ve}))}function zo(S){return S.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ns(S){return S<0?Math.ceil(S)||0:Math.floor(S)}function vn(S){var O=+S,W=0;return O!==0&&isFinite(O)&&(W=Ns(O)),W}var gi={};function qn(S,O){var W,Y=O,te;for(typeof S=="string"&&(S=[S]),A(O)&&(Y=function(ve,Le){Le[O]=vn(ve)}),te=S.length,W=0;W<te;W++)gi[S[W]]=Y}function $l(S,O){qn(S,function(W,Y,te,ve){te._w=te._w||{},O(W,te._w,te,ve)})}function Yd(S,O,W){O!=null&&_(gi,S)&&gi[S](O,W._a,W,S)}function mo(S){return S%4===0&&S%100!==0||S%400===0}var _i=0,ks=1,zr=2,Zr=3,xs=4,Ko=5,va=6,uf=7,Mh=8;Be("Y",0,0,function(){var S=this.year();return S<=9999?Ye(S,4):"+"+S}),Be(0,["YY",2],0,function(){return this.year()%100}),Be(0,["YYYY",4],0,"year"),Be(0,["YYYYY",5],0,"year"),Be(0,["YYYYYY",6,!0],0,"year"),lt("Y",ac),lt("YY",ot,lr),lt("YYYY",nn,an),lt("YYYYY",Tn,It),lt("YYYYYY",Tn,It),qn(["YYYYY","YYYYYY"],_i),qn("YYYY",function(S,O){O[_i]=S.length===2?c.parseTwoDigitYear(S):vn(S)}),qn("YY",function(S,O){O[_i]=c.parseTwoDigitYear(S)}),qn("Y",function(S,O){O[_i]=parseInt(S,10)});function ya(S){return mo(S)?366:365}c.parseTwoDigitYear=function(S){return vn(S)+(vn(S)>68?1900:2e3)};var cc=Hc("FullYear",!0);function E_(){return mo(this.year())}function Hc(S,O){return function(W){return W!=null?(Uh(this,S,W),c.updateOffset(this,O),this):cs(this,S)}}function cs(S,O){if(!S.isValid())return NaN;var W=S._d,Y=S._isUTC;switch(O){case"Milliseconds":return Y?W.getUTCMilliseconds():W.getMilliseconds();case"Seconds":return Y?W.getUTCSeconds():W.getSeconds();case"Minutes":return Y?W.getUTCMinutes():W.getMinutes();case"Hours":return Y?W.getUTCHours():W.getHours();case"Date":return Y?W.getUTCDate():W.getDate();case"Day":return Y?W.getUTCDay():W.getDay();case"Month":return Y?W.getUTCMonth():W.getMonth();case"FullYear":return Y?W.getUTCFullYear():W.getFullYear();default:return NaN}}function Uh(S,O,W){var Y,te,ve,Le,ut;if(!(!S.isValid()||isNaN(W))){switch(Y=S._d,te=S._isUTC,O){case"Milliseconds":return void(te?Y.setUTCMilliseconds(W):Y.setMilliseconds(W));case"Seconds":return void(te?Y.setUTCSeconds(W):Y.setSeconds(W));case"Minutes":return void(te?Y.setUTCMinutes(W):Y.setMinutes(W));case"Hours":return void(te?Y.setUTCHours(W):Y.setHours(W));case"Date":return void(te?Y.setUTCDate(W):Y.setDate(W));case"FullYear":break;default:return}ve=W,Le=S.month(),ut=S.date(),ut=ut===29&&Le===1&&!mo(ve)?28:ut,te?Y.setUTCFullYear(ve,Le,ut):Y.setFullYear(ve,Le,ut)}}function v_(S){return S=Ft(S),Ee(this[S])?this[S]():this}function Ei(S,O){if(typeof S=="object"){S=mr(S);var W=Mn(S),Y,te=W.length;for(Y=0;Y<te;Y++)this[W[Y].unit](S[W[Y].unit])}else if(S=Ft(S),Ee(this[S]))return this[S](O);return this}function U0(S,O){return(S%O+O)%O}var ei;Array.prototype.indexOf?ei=Array.prototype.indexOf:ei=function(S){var O;for(O=0;O<this.length;++O)if(this[O]===S)return O;return-1};function ke(S,O){if(isNaN(S)||isNaN(O))return NaN;var W=U0(O,12);return S+=(O-W)/12,W===1?mo(S)?29:28:31-W%7%2}Be("M",["MM",2],"Mo",function(){return this.month()+1}),Be("MMM",0,0,function(S){return this.localeData().monthsShort(this,S)}),Be("MMMM",0,0,function(S){return this.localeData().months(this,S)}),lt("M",ot,$c),lt("MM",ot,lr),lt("MMM",function(S,O){return O.monthsShortRegex(S)}),lt("MMMM",function(S,O){return O.monthsRegex(S)}),qn(["M","MM"],function(S,O){O[ks]=vn(S)-1}),qn(["MMM","MMMM"],function(S,O,W,Y){var te=W._locale.monthsParse(S,Y,W._strict);te!=null?O[ks]=te:H(W).invalidMonth=S});var tt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),dt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),rr=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ti=Wl,Ps=Wl;function lc(S,O){return S?h(this._months)?this._months[S.month()]:this._months[(this._months.isFormat||rr).test(O)?"format":"standalone"][S.month()]:h(this._months)?this._months:this._months.standalone}function JI(S,O){return S?h(this._monthsShort)?this._monthsShort[S.month()]:this._monthsShort[rr.test(O)?"format":"standalone"][S.month()]:h(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function qd(S,O,W){var Y,te,ve,Le=S.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],Y=0;Y<12;++Y)ve=V([2e3,Y]),this._shortMonthsParse[Y]=this.monthsShort(ve,"").toLocaleLowerCase(),this._longMonthsParse[Y]=this.months(ve,"").toLocaleLowerCase();return W?O==="MMM"?(te=ei.call(this._shortMonthsParse,Le),te!==-1?te:null):(te=ei.call(this._longMonthsParse,Le),te!==-1?te:null):O==="MMM"?(te=ei.call(this._shortMonthsParse,Le),te!==-1?te:(te=ei.call(this._longMonthsParse,Le),te!==-1?te:null)):(te=ei.call(this._longMonthsParse,Le),te!==-1?te:(te=ei.call(this._shortMonthsParse,Le),te!==-1?te:null))}function y_(S,O,W){var Y,te,ve;if(this._monthsParseExact)return qd.call(this,S,O,W);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),Y=0;Y<12;Y++){if(te=V([2e3,Y]),W&&!this._longMonthsParse[Y]&&(this._longMonthsParse[Y]=new RegExp("^"+this.months(te,"").replace(".","")+"$","i"),this._shortMonthsParse[Y]=new RegExp("^"+this.monthsShort(te,"").replace(".","")+"$","i")),!W&&!this._monthsParse[Y]&&(ve="^"+this.months(te,"")+"|^"+this.monthsShort(te,""),this._monthsParse[Y]=new RegExp(ve.replace(".",""),"i")),W&&O==="MMMM"&&this._longMonthsParse[Y].test(S))return Y;if(W&&O==="MMM"&&this._shortMonthsParse[Y].test(S))return Y;if(!W&&this._monthsParse[Y].test(S))return Y}}function j0(S,O){if(!S.isValid())return S;if(typeof O=="string"){if(/^\d+$/.test(O))O=vn(O);else if(O=S.localeData().monthsParse(O),!A(O))return S}var W=O,Y=S.date();return Y=Y<29?Y:Math.min(Y,ke(S.year(),W)),S._isUTC?S._d.setUTCMonth(W,Y):S._d.setMonth(W,Y),S}function gr(S){return S!=null?(j0(this,S),c.updateOffset(this,!0),this):cs(this,"Month")}function QI(){return ke(this.year(),this.month())}function F0(S){return this._monthsParseExact?(_(this,"_monthsRegex")||B0.call(this),S?this._monthsShortStrictRegex:this._monthsShortRegex):(_(this,"_monthsShortRegex")||(this._monthsShortRegex=ti),this._monthsShortStrictRegex&&S?this._monthsShortStrictRegex:this._monthsShortRegex)}function V0(S){return this._monthsParseExact?(_(this,"_monthsRegex")||B0.call(this),S?this._monthsStrictRegex:this._monthsRegex):(_(this,"_monthsRegex")||(this._monthsRegex=Ps),this._monthsStrictRegex&&S?this._monthsStrictRegex:this._monthsRegex)}function B0(){function S(Vt,yn){return yn.length-Vt.length}var O=[],W=[],Y=[],te,ve,Le,ut;for(te=0;te<12;te++)ve=V([2e3,te]),Le=zo(this.monthsShort(ve,"")),ut=zo(this.months(ve,"")),O.push(Le),W.push(ut),Y.push(ut),Y.push(Le);O.sort(S),W.sort(S),Y.sort(S),this._monthsRegex=new RegExp("^("+Y.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+W.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+O.join("|")+")","i")}function ZI(S,O,W,Y,te,ve,Le){var ut;return S<100&&S>=0?(ut=new Date(S+400,O,W,Y,te,ve,Le),isFinite(ut.getFullYear())&&ut.setFullYear(S)):ut=new Date(S,O,W,Y,te,ve,Le),ut}function jh(S){var O,W;return S<100&&S>=0?(W=Array.prototype.slice.call(arguments),W[0]=S+400,O=new Date(Date.UTC.apply(null,W)),isFinite(O.getUTCFullYear())&&O.setUTCFullYear(S)):O=new Date(Date.UTC.apply(null,arguments)),O}function hf(S,O,W){var Y=7+O-W,te=(7+jh(S,0,Y).getUTCDay()-O)%7;return-te+Y-1}function W0(S,O,W,Y,te){var ve=(7+W-Y)%7,Le=hf(S,Y,te),ut=1+7*(O-1)+ve+Le,Vt,yn;return ut<=0?(Vt=S-1,yn=ya(Vt)+ut):ut>ya(S)?(Vt=S+1,yn=ut-ya(S)):(Vt=S,yn=ut),{year:Vt,dayOfYear:yn}}function Fh(S,O,W){var Y=hf(S.year(),O,W),te=Math.floor((S.dayOfYear()-Y-1)/7)+1,ve,Le;return te<1?(Le=S.year()-1,ve=te+go(Le,O,W)):te>go(S.year(),O,W)?(ve=te-go(S.year(),O,W),Le=S.year()+1):(Le=S.year(),ve=te),{week:ve,year:Le}}function go(S,O,W){var Y=hf(S,O,W),te=hf(S+1,O,W);return(ya(S)-Y+te)/7}Be("w",["ww",2],"wo","week"),Be("W",["WW",2],"Wo","isoWeek"),lt("w",ot,$c),lt("ww",ot,lr),lt("W",ot,$c),lt("WW",ot,lr),$l(["w","ww","W","WW"],function(S,O,W,Y){O[Y.substr(0,1)]=vn(S)});function $0(S){return Fh(S,this._week.dow,this._week.doy).week}var S_={dow:0,doy:6};function eA(){return this._week.dow}function b_(){return this._week.doy}function tA(S){var O=this.localeData().week(this);return S==null?O:this.add((S-O)*7,"d")}function G0(S){var O=Fh(this,1,4).week;return S==null?O:this.add((S-O)*7,"d")}Be("d",0,"do","day"),Be("dd",0,0,function(S){return this.localeData().weekdaysMin(this,S)}),Be("ddd",0,0,function(S){return this.localeData().weekdaysShort(this,S)}),Be("dddd",0,0,function(S){return this.localeData().weekdays(this,S)}),Be("e",0,0,"weekday"),Be("E",0,0,"isoWeekday"),lt("d",ot),lt("e",ot),lt("E",ot),lt("dd",function(S,O){return O.weekdaysMinRegex(S)}),lt("ddd",function(S,O){return O.weekdaysShortRegex(S)}),lt("dddd",function(S,O){return O.weekdaysRegex(S)}),$l(["dd","ddd","dddd"],function(S,O,W,Y){var te=W._locale.weekdaysParse(S,Y,W._strict);te!=null?O.d=te:H(W).invalidWeekday=S}),$l(["d","e","E"],function(S,O,W,Y){O[Y]=vn(S)});function nA(S,O){return typeof S!="string"?S:isNaN(S)?(S=O.weekdaysParse(S),typeof S=="number"?S:null):parseInt(S,10)}function rA(S,O){return typeof S=="string"?O.weekdaysParse(S)%7||7:isNaN(S)?null:S}function T_(S,O){return S.slice(O,7).concat(S.slice(0,O))}var iA="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),H0="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),sA="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),oA=Wl,aA=Wl,z0=Wl;function cA(S,O){var W=h(this._weekdays)?this._weekdays:this._weekdays[S&&S!==!0&&this._weekdays.isFormat.test(O)?"format":"standalone"];return S===!0?T_(W,this._week.dow):S?W[S.day()]:W}function lA(S){return S===!0?T_(this._weekdaysShort,this._week.dow):S?this._weekdaysShort[S.day()]:this._weekdaysShort}function dA(S){return S===!0?T_(this._weekdaysMin,this._week.dow):S?this._weekdaysMin[S.day()]:this._weekdaysMin}function Vh(S,O,W){var Y,te,ve,Le=S.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],Y=0;Y<7;++Y)ve=V([2e3,1]).day(Y),this._minWeekdaysParse[Y]=this.weekdaysMin(ve,"").toLocaleLowerCase(),this._shortWeekdaysParse[Y]=this.weekdaysShort(ve,"").toLocaleLowerCase(),this._weekdaysParse[Y]=this.weekdays(ve,"").toLocaleLowerCase();return W?O==="dddd"?(te=ei.call(this._weekdaysParse,Le),te!==-1?te:null):O==="ddd"?(te=ei.call(this._shortWeekdaysParse,Le),te!==-1?te:null):(te=ei.call(this._minWeekdaysParse,Le),te!==-1?te:null):O==="dddd"?(te=ei.call(this._weekdaysParse,Le),te!==-1||(te=ei.call(this._shortWeekdaysParse,Le),te!==-1)?te:(te=ei.call(this._minWeekdaysParse,Le),te!==-1?te:null)):O==="ddd"?(te=ei.call(this._shortWeekdaysParse,Le),te!==-1||(te=ei.call(this._weekdaysParse,Le),te!==-1)?te:(te=ei.call(this._minWeekdaysParse,Le),te!==-1?te:null)):(te=ei.call(this._minWeekdaysParse,Le),te!==-1||(te=ei.call(this._weekdaysParse,Le),te!==-1)?te:(te=ei.call(this._shortWeekdaysParse,Le),te!==-1?te:null))}function uA(S,O,W){var Y,te,ve;if(this._weekdaysParseExact)return Vh.call(this,S,O,W);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),Y=0;Y<7;Y++){if(te=V([2e3,1]).day(Y),W&&!this._fullWeekdaysParse[Y]&&(this._fullWeekdaysParse[Y]=new RegExp("^"+this.weekdays(te,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[Y]=new RegExp("^"+this.weekdaysShort(te,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[Y]=new RegExp("^"+this.weekdaysMin(te,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[Y]||(ve="^"+this.weekdays(te,"")+"|^"+this.weekdaysShort(te,"")+"|^"+this.weekdaysMin(te,""),this._weekdaysParse[Y]=new RegExp(ve.replace(".",""),"i")),W&&O==="dddd"&&this._fullWeekdaysParse[Y].test(S))return Y;if(W&&O==="ddd"&&this._shortWeekdaysParse[Y].test(S))return Y;if(W&&O==="dd"&&this._minWeekdaysParse[Y].test(S))return Y;if(!W&&this._weekdaysParse[Y].test(S))return Y}}function hA(S){if(!this.isValid())return S!=null?this:NaN;var O=cs(this,"Day");return S!=null?(S=nA(S,this.localeData()),this.add(S-O,"d")):O}function pA(S){if(!this.isValid())return S!=null?this:NaN;var O=(this.day()+7-this.localeData()._week.dow)%7;return S==null?O:this.add(S-O,"d")}function fA(S){if(!this.isValid())return S!=null?this:NaN;if(S!=null){var O=rA(S,this.localeData());return this.day(this.day()%7?O:O-7)}else return this.day()||7}function K0(S){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||C_.call(this),S?this._weekdaysStrictRegex:this._weekdaysRegex):(_(this,"_weekdaysRegex")||(this._weekdaysRegex=oA),this._weekdaysStrictRegex&&S?this._weekdaysStrictRegex:this._weekdaysRegex)}function mA(S){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||C_.call(this),S?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(_(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=aA),this._weekdaysShortStrictRegex&&S?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function gA(S){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||C_.call(this),S?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(_(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=z0),this._weekdaysMinStrictRegex&&S?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function C_(){function S(ys,gc){return gc.length-ys.length}var O=[],W=[],Y=[],te=[],ve,Le,ut,Vt,yn;for(ve=0;ve<7;ve++)Le=V([2e3,1]).day(ve),ut=zo(this.weekdaysMin(Le,"")),Vt=zo(this.weekdaysShort(Le,"")),yn=zo(this.weekdays(Le,"")),O.push(ut),W.push(Vt),Y.push(yn),te.push(ut),te.push(Vt),te.push(yn);O.sort(S),W.sort(S),Y.sort(S),te.sort(S),this._weekdaysRegex=new RegExp("^("+te.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+Y.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+W.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+O.join("|")+")","i")}function Sa(){return this.hours()%12||12}function _o(){return this.hours()||24}Be("H",["HH",2],0,"hour"),Be("h",["hh",2],0,Sa),Be("k",["kk",2],0,_o),Be("hmm",0,0,function(){return""+Sa.apply(this)+Ye(this.minutes(),2)}),Be("hmmss",0,0,function(){return""+Sa.apply(this)+Ye(this.minutes(),2)+Ye(this.seconds(),2)}),Be("Hmm",0,0,function(){return""+this.hours()+Ye(this.minutes(),2)}),Be("Hmmss",0,0,function(){return""+this.hours()+Ye(this.minutes(),2)+Ye(this.seconds(),2)});function w_(S,O){Be(S,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),O)})}w_("a",!0),w_("A",!1);function Y0(S,O){return O._meridiemParse}lt("a",Y0),lt("A",Y0),lt("H",ot,Lh),lt("h",ot,$c),lt("k",ot,$c),lt("HH",ot,lr),lt("hh",ot,lr),lt("kk",ot,lr),lt("hmm",tn),lt("hmmss",$i),lt("Hmm",tn),lt("Hmmss",$i),qn(["H","HH"],Zr),qn(["k","kk"],function(S,O,W){var Y=vn(S);O[Zr]=Y===24?0:Y}),qn(["a","A"],function(S,O,W){W._isPm=W._locale.isPM(S),W._meridiem=S}),qn(["h","hh"],function(S,O,W){O[Zr]=vn(S),H(W).bigHour=!0}),qn("hmm",function(S,O,W){var Y=S.length-2;O[Zr]=vn(S.substr(0,Y)),O[xs]=vn(S.substr(Y)),H(W).bigHour=!0}),qn("hmmss",function(S,O,W){var Y=S.length-4,te=S.length-2;O[Zr]=vn(S.substr(0,Y)),O[xs]=vn(S.substr(Y,2)),O[Ko]=vn(S.substr(te)),H(W).bigHour=!0}),qn("Hmm",function(S,O,W){var Y=S.length-2;O[Zr]=vn(S.substr(0,Y)),O[xs]=vn(S.substr(Y))}),qn("Hmmss",function(S,O,W){var Y=S.length-4,te=S.length-2;O[Zr]=vn(S.substr(0,Y)),O[xs]=vn(S.substr(Y,2)),O[Ko]=vn(S.substr(te))});function _A(S){return(S+"").toLowerCase().charAt(0)==="p"}var EA=/[ap]\.?m?\.?/i,Js=Hc("Hours",!0);function vA(S,O,W){return S>11?W?"pm":"PM":W?"am":"AM"}var q0={calendar:Ce,longDateFormat:Gr,invalidDate:hn,ordinal:on,dayOfMonthOrdinalParse:rt,relativeTime:Kn,months:tt,monthsShort:dt,week:S_,weekdays:iA,weekdaysMin:sA,weekdaysShort:H0,meridiemParse:EA},Pr={},zc={},Xd;function yA(S,O){var W,Y=Math.min(S.length,O.length);for(W=0;W<Y;W+=1)if(S[W]!==O[W])return W;return Y}function pf(S){return S&&S.toLowerCase().replace("_","-")}function SA(S){for(var O=0,W,Y,te,ve;O<S.length;){for(ve=pf(S[O]).split("-"),W=ve.length,Y=pf(S[O+1]),Y=Y?Y.split("-"):null;W>0;){if(te=Jd(ve.slice(0,W).join("-")),te)return te;if(Y&&Y.length>=W&&yA(ve,Y)>=W-1)break;W--}O++}return Xd}function R_(S){return!!(S&&S.match("^[^/\\\\]*$"))}function Jd(S){var O=null,W;if(Pr[S]===void 0&&t&&t.exports&&R_(S))try{O=Xd._abbr,W=TNe,W("./locale/"+S),ba(O)}catch{Pr[S]=null}return Pr[S]}function ba(S,O){var W;return S&&(b(O)?W=ls(S):W=I_(S,O),W?Xd=W:typeof console<"u"&&console.warn&&console.warn("Locale "+S+" not found. Did you forget to load it?")),Xd._abbr}function I_(S,O){if(O!==null){var W,Y=q0;if(O.abbr=S,Pr[S]!=null)Ne("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),Y=Pr[S]._config;else if(O.parentLocale!=null)if(Pr[O.parentLocale]!=null)Y=Pr[O.parentLocale]._config;else if(W=Jd(O.parentLocale),W!=null)Y=W._config;else return zc[O.parentLocale]||(zc[O.parentLocale]=[]),zc[O.parentLocale].push({name:S,config:O}),null;return Pr[S]=new Pe(Re(Y,O)),zc[S]&&zc[S].forEach(function(te){I_(te.name,te.config)}),ba(S),Pr[S]}else return delete Pr[S],null}function bA(S,O){if(O!=null){var W,Y,te=q0;Pr[S]!=null&&Pr[S].parentLocale!=null?Pr[S].set(Re(Pr[S]._config,O)):(Y=Jd(S),Y!=null&&(te=Y._config),O=Re(te,O),Y==null&&(O.abbr=S),W=new Pe(O),W.parentLocale=Pr[S],Pr[S]=W),ba(S)}else Pr[S]!=null&&(Pr[S].parentLocale!=null?(Pr[S]=Pr[S].parentLocale,S===ba()&&ba(S)):Pr[S]!=null&&delete Pr[S]);return Pr[S]}function ls(S){var O;if(S&&S._locale&&S._locale._abbr&&(S=S._locale._abbr),!S)return Xd;if(!h(S)){if(O=Jd(S),O)return O;S=[S]}return SA(S)}function ff(){return $e(Pr)}function A_(S){var O,W=S._a;return W&&H(S).overflow===-2&&(O=W[ks]<0||W[ks]>11?ks:W[zr]<1||W[zr]>ke(W[_i],W[ks])?zr:W[Zr]<0||W[Zr]>24||W[Zr]===24&&(W[xs]!==0||W[Ko]!==0||W[va]!==0)?Zr:W[xs]<0||W[xs]>59?xs:W[Ko]<0||W[Ko]>59?Ko:W[va]<0||W[va]>999?va:-1,H(S)._overflowDayOfYear&&(O<_i||O>zr)&&(O=zr),H(S)._overflowWeeks&&O===-1&&(O=uf),H(S)._overflowWeekday&&O===-1&&(O=Mh),H(S).overflow=O),S}var TA=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,CA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wA=/Z|[+-]\d\d(?::?\d\d)?/,mf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Kc=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],RA=/^\/?Date\((-?\d+)/i,Qd=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,X0={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function J0(S){var O,W,Y=S._i,te=TA.exec(Y)||CA.exec(Y),ve,Le,ut,Vt,yn=mf.length,ys=Kc.length;if(te){for(H(S).iso=!0,O=0,W=yn;O<W;O++)if(mf[O][1].exec(te[1])){Le=mf[O][0],ve=mf[O][2]!==!1;break}if(Le==null){S._isValid=!1;return}if(te[3]){for(O=0,W=ys;O<W;O++)if(Kc[O][1].exec(te[3])){ut=(te[2]||" ")+Kc[O][0];break}if(ut==null){S._isValid=!1;return}}if(!ve&&ut!=null){S._isValid=!1;return}if(te[4])if(wA.exec(te[4]))Vt="Z";else{S._isValid=!1;return}S._f=Le+(ut||"")+(Vt||""),k_(S)}else S._isValid=!1}function On(S,O,W,Y,te,ve){var Le=[IA(S),dt.indexOf(O),parseInt(W,10),parseInt(Y,10),parseInt(te,10)];return ve&&Le.push(parseInt(ve,10)),Le}function IA(S){var O=parseInt(S,10);return O<=49?2e3+O:O<=999?1900+O:O}function AA(S){return S.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function OA(S,O,W){if(S){var Y=H0.indexOf(S),te=new Date(O[0],O[1],O[2]).getDay();if(Y!==te)return H(W).weekdayMismatch=!0,W._isValid=!1,!1}return!0}function O_(S,O,W){if(S)return X0[S];if(O)return 0;var Y=parseInt(W,10),te=Y%100,ve=(Y-te)/100;return ve*60+te}function Q0(S){var O=Qd.exec(AA(S._i)),W;if(O){if(W=On(O[4],O[3],O[2],O[5],O[6],O[7]),!OA(O[1],W,S))return;S._a=W,S._tzm=O_(O[8],O[9],O[10]),S._d=jh.apply(null,S._a),S._d.setUTCMinutes(S._d.getUTCMinutes()-S._tzm),H(S).rfc2822=!0}else S._isValid=!1}function NA(S){var O=RA.exec(S._i);if(O!==null){S._d=new Date(+O[1]);return}if(J0(S),S._isValid===!1)delete S._isValid;else return;if(Q0(S),S._isValid===!1)delete S._isValid;else return;S._strict?S._isValid=!1:c.createFromInputFallback(S)}c.createFromInputFallback=oe("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(S){S._d=new Date(S._i+(S._useUTC?" UTC":""))});function Zd(S,O,W){return S??O??W}function Z0(S){var O=new Date(c.now());return S._useUTC?[O.getUTCFullYear(),O.getUTCMonth(),O.getUTCDate()]:[O.getFullYear(),O.getMonth(),O.getDate()]}function N_(S){var O,W,Y=[],te,ve,Le;if(!S._d){for(te=Z0(S),S._w&&S._a[zr]==null&&S._a[ks]==null&&kA(S),S._dayOfYear!=null&&(Le=Zd(S._a[_i],te[_i]),(S._dayOfYear>ya(Le)||S._dayOfYear===0)&&(H(S)._overflowDayOfYear=!0),W=jh(Le,0,S._dayOfYear),S._a[ks]=W.getUTCMonth(),S._a[zr]=W.getUTCDate()),O=0;O<3&&S._a[O]==null;++O)S._a[O]=Y[O]=te[O];for(;O<7;O++)S._a[O]=Y[O]=S._a[O]==null?O===2?1:0:S._a[O];S._a[Zr]===24&&S._a[xs]===0&&S._a[Ko]===0&&S._a[va]===0&&(S._nextDay=!0,S._a[Zr]=0),S._d=(S._useUTC?jh:ZI).apply(null,Y),ve=S._useUTC?S._d.getUTCDay():S._d.getDay(),S._tzm!=null&&S._d.setUTCMinutes(S._d.getUTCMinutes()-S._tzm),S._nextDay&&(S._a[Zr]=24),S._w&&typeof S._w.d<"u"&&S._w.d!==ve&&(H(S).weekdayMismatch=!0)}}function kA(S){var O,W,Y,te,ve,Le,ut,Vt,yn;O=S._w,O.GG!=null||O.W!=null||O.E!=null?(ve=1,Le=4,W=Zd(O.GG,S._a[_i],Fh(Ar(),1,4).year),Y=Zd(O.W,1),te=Zd(O.E,1),(te<1||te>7)&&(Vt=!0)):(ve=S._locale._week.dow,Le=S._locale._week.doy,yn=Fh(Ar(),ve,Le),W=Zd(O.gg,S._a[_i],yn.year),Y=Zd(O.w,yn.week),O.d!=null?(te=O.d,(te<0||te>6)&&(Vt=!0)):O.e!=null?(te=O.e+ve,(O.e<0||O.e>6)&&(Vt=!0)):te=ve),Y<1||Y>go(W,ve,Le)?H(S)._overflowWeeks=!0:Vt!=null?H(S)._overflowWeekday=!0:(ut=W0(W,Y,te,ve,Le),S._a[_i]=ut.year,S._dayOfYear=ut.dayOfYear)}c.ISO_8601=function(){},c.RFC_2822=function(){};function k_(S){if(S._f===c.ISO_8601){J0(S);return}if(S._f===c.RFC_2822){Q0(S);return}S._a=[],H(S).empty=!0;var O=""+S._i,W,Y,te,ve,Le,ut=O.length,Vt=0,yn,ys;for(te=Ut(S._f,S._locale).match(Mt)||[],ys=te.length,W=0;W<ys;W++)ve=te[W],Y=(O.match(__(ve,S))||[])[0],Y&&(Le=O.substr(0,O.indexOf(Y)),Le.length>0&&H(S).unusedInput.push(Le),O=O.slice(O.indexOf(Y)+Y.length),Vt+=Y.length),Ue[ve]?(Y?H(S).empty=!1:H(S).unusedTokens.push(ve),Yd(ve,Y,S)):S._strict&&!Y&&H(S).unusedTokens.push(ve);H(S).charsLeftOver=ut-Vt,O.length>0&&H(S).unusedInput.push(O),S._a[Zr]<=12&&H(S).bigHour===!0&&S._a[Zr]>0&&(H(S).bigHour=void 0),H(S).parsedDateParts=S._a.slice(0),H(S).meridiem=S._meridiem,S._a[Zr]=Yc(S._locale,S._a[Zr],S._meridiem),yn=H(S).era,yn!==null&&(S._a[_i]=S._locale.erasConvertYear(yn,S._a[_i])),N_(S),A_(S)}function Yc(S,O,W){var Y;return W==null?O:S.meridiemHour!=null?S.meridiemHour(O,W):(S.isPM!=null&&(Y=S.isPM(W),Y&&O<12&&(O+=12),!Y&&O===12&&(O=0)),O)}function xA(S){var O,W,Y,te,ve,Le,ut=!1,Vt=S._f.length;if(Vt===0){H(S).invalidFormat=!0,S._d=new Date(NaN);return}for(te=0;te<Vt;te++)ve=0,Le=!1,O=ce({},S),S._useUTC!=null&&(O._useUTC=S._useUTC),O._f=S._f[te],k_(O),B(O)&&(Le=!0),ve+=H(O).charsLeftOver,ve+=H(O).unusedTokens.length*10,H(O).score=ve,ut?ve<Y&&(Y=ve,W=O):(Y==null||ve<Y||Le)&&(Y=ve,W=O,Le&&(ut=!0));M(S,W||O)}function PA(S){if(!S._d){var O=mr(S._i),W=O.day===void 0?O.date:O.day;S._a=x([O.year,O.month,W,O.hour,O.minute,O.second,O.millisecond],function(Y){return Y&&parseInt(Y,10)}),N_(S)}}function DA(S){var O=new ie(A_(x_(S)));return O._nextDay&&(O.add(1,"d"),O._nextDay=void 0),O}function x_(S){var O=S._i,W=S._f;return S._locale=S._locale||ls(S._l),O===null||W===void 0&&O===""?L({nullInput:!0}):(typeof O=="string"&&(S._i=O=S._locale.preparse(O)),ne(O)?new ie(A_(O)):(w(O)?S._d=O:h(W)?xA(S):W?k_(S):P_(S),B(S)||(S._d=null),S))}function P_(S){var O=S._i;b(O)?S._d=new Date(c.now()):w(O)?S._d=new Date(O.valueOf()):typeof O=="string"?NA(S):h(O)?(S._a=x(O.slice(0),function(W){return parseInt(W,10)}),N_(S)):f(O)?PA(S):A(O)?S._d=new Date(O):c.createFromInputFallback(S)}function eS(S,O,W,Y,te){var ve={};return(O===!0||O===!1)&&(Y=O,O=void 0),(W===!0||W===!1)&&(Y=W,W=void 0),(f(S)&&v(S)||h(S)&&S.length===0)&&(S=void 0),ve._isAMomentObject=!0,ve._useUTC=ve._isUTC=te,ve._l=W,ve._i=S,ve._f=O,ve._strict=Y,DA(ve)}function Ar(S,O,W,Y){return eS(S,O,W,Y,!1)}var qc=oe("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var S=Ar.apply(null,arguments);return this.isValid()&&S.isValid()?S<this?this:S:L()}),LA=oe("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var S=Ar.apply(null,arguments);return this.isValid()&&S.isValid()?S>this?this:S:L()});function tS(S,O){var W,Y;if(O.length===1&&h(O[0])&&(O=O[0]),!O.length)return Ar();for(W=O[0],Y=1;Y<O.length;++Y)(!O[Y].isValid()||O[Y][S](W))&&(W=O[Y]);return W}function MA(){var S=[].slice.call(arguments,0);return tS("isBefore",S)}function UA(){var S=[].slice.call(arguments,0);return tS("isAfter",S)}var jA=function(){return Date.now?Date.now():+new Date},Bh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function nS(S){var O,W=!1,Y,te=Bh.length;for(O in S)if(_(S,O)&&!(ei.call(Bh,O)!==-1&&(S[O]==null||!isNaN(S[O]))))return!1;for(Y=0;Y<te;++Y)if(S[Bh[Y]]){if(W)return!1;parseFloat(S[Bh[Y]])!==vn(S[Bh[Y]])&&(W=!0)}return!0}function D_(){return this._isValid}function FA(){return je(NaN)}function gf(S){var O=mr(S),W=O.year||0,Y=O.quarter||0,te=O.month||0,ve=O.week||O.isoWeek||0,Le=O.day||0,ut=O.hour||0,Vt=O.minute||0,yn=O.second||0,ys=O.millisecond||0;this._isValid=nS(O),this._milliseconds=+ys+yn*1e3+Vt*6e4+ut*1e3*60*60,this._days=+Le+ve*7,this._months=+te+Y*3+W*12,this._data={},this._locale=ls(),this._bubble()}function Gl(S){return S instanceof gf}function L_(S){return S<0?Math.round(-1*S)*-1:Math.round(S)}function VA(S,O,W){var Y=Math.min(S.length,O.length),te=Math.abs(S.length-O.length),ve=0,Le;for(Le=0;Le<Y;Le++)(W&&S[Le]!==O[Le]||!W&&vn(S[Le])!==vn(O[Le]))&&ve++;return ve+te}function rS(S,O){Be(S,0,0,function(){var W=this.utcOffset(),Y="+";return W<0&&(W=-W,Y="-"),Y+Ye(~~(W/60),2)+O+Ye(~~W%60,2)})}rS("Z",":"),rS("ZZ",""),lt("Z",Ho),lt("ZZ",Ho),qn(["Z","ZZ"],function(S,O,W){W._useUTC=!0,W._tzm=M_(Ho,S)});var Xc=/([\+\-]|\d\d)/gi;function M_(S,O){var W=(O||"").match(S),Y,te,ve;return W===null?null:(Y=W[W.length-1]||[],te=(Y+"").match(Xc)||["-",0,0],ve=+(te[1]*60)+vn(te[2]),ve===0?0:te[0]==="+"?ve:-ve)}function U_(S,O){var W,Y;return O._isUTC?(W=O.clone(),Y=(ne(S)||w(S)?S.valueOf():Ar(S).valueOf())-W.valueOf(),W._d.setTime(W._d.valueOf()+Y),c.updateOffset(W,!1),W):Ar(S).local()}function Ds(S){return-Math.round(S._d.getTimezoneOffset())}c.updateOffset=function(){};function BA(S,O,W){var Y=this._offset||0,te;if(!this.isValid())return S!=null?this:NaN;if(S!=null){if(typeof S=="string"){if(S=M_(Ho,S),S===null)return this}else Math.abs(S)<16&&!W&&(S=S*60);return!this._isUTC&&O&&(te=Ds(this)),this._offset=S,this._isUTC=!0,te!=null&&this.add(te,"m"),Y!==S&&(!O||this._changeInProgress?aS(this,je(S-Y,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,c.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?Y:Ds(this)}function WA(S,O){return S!=null?(typeof S!="string"&&(S=-S),this.utcOffset(S,O),this):-this.utcOffset()}function $A(S){return this.utcOffset(0,S)}function GA(S){return this._isUTC&&(this.utcOffset(0,S),this._isUTC=!1,S&&this.subtract(Ds(this),"m")),this}function iS(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var S=M_(g_,this._i);S!=null?this.utcOffset(S):this.utcOffset(0,!0)}return this}function HA(S){return this.isValid()?(S=S?Ar(S).utcOffset():0,(this.utcOffset()-S)%60===0):!1}function zA(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function KA(){if(!b(this._isDSTShifted))return this._isDSTShifted;var S={},O;return ce(S,this),S=x_(S),S._a?(O=S._isUTC?V(S._a):Ar(S._a),this._isDSTShifted=this.isValid()&&VA(S._a,O.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function sS(){return this.isValid()?!this._isUTC:!1}function YA(){return this.isValid()?this._isUTC:!1}function oS(){return this.isValid()?this._isUTC&&this._offset===0:!1}var j_=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,F_=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function je(S,O){var W=S,Y=null,te,ve,Le;return Gl(S)?W={ms:S._milliseconds,d:S._days,M:S._months}:A(S)||!isNaN(+S)?(W={},O?W[O]=+S:W.milliseconds=+S):(Y=j_.exec(S))?(te=Y[1]==="-"?-1:1,W={y:0,d:vn(Y[zr])*te,h:vn(Y[Zr])*te,m:vn(Y[xs])*te,s:vn(Y[Ko])*te,ms:vn(L_(Y[va]*1e3))*te}):(Y=F_.exec(S))?(te=Y[1]==="-"?-1:1,W={y:Jc(Y[2],te),M:Jc(Y[3],te),w:Jc(Y[4],te),d:Jc(Y[5],te),h:Jc(Y[6],te),m:Jc(Y[7],te),s:Jc(Y[8],te)}):W==null?W={}:typeof W=="object"&&("from"in W||"to"in W)&&(Le=_f(Ar(W.from),Ar(W.to)),W={},W.ms=Le.milliseconds,W.M=Le.months),ve=new gf(W),Gl(S)&&_(S,"_locale")&&(ve._locale=S._locale),Gl(S)&&_(S,"_isValid")&&(ve._isValid=S._isValid),ve}je.fn=gf.prototype,je.invalid=FA;function Jc(S,O){var W=S&&parseFloat(S.replace(",","."));return(isNaN(W)?0:W)*O}function V_(S,O){var W={};return W.months=O.month()-S.month()+(O.year()-S.year())*12,S.clone().add(W.months,"M").isAfter(O)&&--W.months,W.milliseconds=+O-+S.clone().add(W.months,"M"),W}function _f(S,O){var W;return S.isValid()&&O.isValid()?(O=U_(O,S),S.isBefore(O)?W=V_(S,O):(W=V_(O,S),W.milliseconds=-W.milliseconds,W.months=-W.months),W):{milliseconds:0,months:0}}function Qc(S,O){return function(W,Y){var te,ve;return Y!==null&&!isNaN(+Y)&&(Ne(O,"moment()."+O+"(period, number) is deprecated. Please use moment()."+O+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),ve=W,W=Y,Y=ve),te=je(W,Y),aS(this,te,S),this}}function aS(S,O,W,Y){var te=O._milliseconds,ve=L_(O._days),Le=L_(O._months);S.isValid()&&(Y=Y??!0,Le&&j0(S,cs(S,"Month")+Le*W),ve&&Uh(S,"Date",cs(S,"Date")+ve*W),te&&S._d.setTime(S._d.valueOf()+te*W),Y&&c.updateOffset(S,ve||Le))}var qA=Qc(1,"add"),cS=Qc(-1,"subtract");function Ef(S){return typeof S=="string"||S instanceof String}function lS(S){return ne(S)||w(S)||Ef(S)||A(S)||B_(S)||dS(S)||S===null||S===void 0}function dS(S){var O=f(S)&&!v(S),W=!1,Y=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],te,ve,Le=Y.length;for(te=0;te<Le;te+=1)ve=Y[te],W=W||_(S,ve);return O&&W}function B_(S){var O=h(S),W=!1;return O&&(W=S.filter(function(Y){return!A(Y)&&Ef(S)}).length===0),O&&W}function uS(S){var O=f(S)&&!v(S),W=!1,Y=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],te,ve;for(te=0;te<Y.length;te+=1)ve=Y[te],W=W||_(S,ve);return O&&W}function hS(S,O){var W=S.diff(O,"days",!0);return W<-6?"sameElse":W<-1?"lastWeek":W<0?"lastDay":W<1?"sameDay":W<2?"nextDay":W<7?"nextWeek":"sameElse"}function pS(S,O){arguments.length===1&&(arguments[0]?lS(arguments[0])?(S=arguments[0],O=void 0):uS(arguments[0])&&(O=arguments[0],S=void 0):(S=void 0,O=void 0));var W=S||Ar(),Y=U_(W,this).startOf("day"),te=c.calendarFormat(this,Y)||"sameElse",ve=O&&(Ee(O[te])?O[te].call(this,W):O[te]);return this.format(ve||this.localeData().calendar(te,this,Ar(W)))}function fS(){return new ie(this)}function mS(S,O){var W=ne(S)?S:Ar(S);return this.isValid()&&W.isValid()?(O=Ft(O)||"millisecond",O==="millisecond"?this.valueOf()>W.valueOf():W.valueOf()<this.clone().startOf(O).valueOf()):!1}function gS(S,O){var W=ne(S)?S:Ar(S);return this.isValid()&&W.isValid()?(O=Ft(O)||"millisecond",O==="millisecond"?this.valueOf()<W.valueOf():this.clone().endOf(O).valueOf()<W.valueOf()):!1}function _S(S,O,W,Y){var te=ne(S)?S:Ar(S),ve=ne(O)?O:Ar(O);return this.isValid()&&te.isValid()&&ve.isValid()?(Y=Y||"()",(Y[0]==="("?this.isAfter(te,W):!this.isBefore(te,W))&&(Y[1]===")"?this.isBefore(ve,W):!this.isAfter(ve,W))):!1}function ES(S,O){var W=ne(S)?S:Ar(S),Y;return this.isValid()&&W.isValid()?(O=Ft(O)||"millisecond",O==="millisecond"?this.valueOf()===W.valueOf():(Y=W.valueOf(),this.clone().startOf(O).valueOf()<=Y&&Y<=this.clone().endOf(O).valueOf())):!1}function vS(S,O){return this.isSame(S,O)||this.isAfter(S,O)}function yS(S,O){return this.isSame(S,O)||this.isBefore(S,O)}function W_(S,O,W){var Y,te,ve;if(!this.isValid())return NaN;if(Y=U_(S,this),!Y.isValid())return NaN;switch(te=(Y.utcOffset()-this.utcOffset())*6e4,O=Ft(O),O){case"year":ve=Wh(this,Y)/12;break;case"month":ve=Wh(this,Y);break;case"quarter":ve=Wh(this,Y)/3;break;case"second":ve=(this-Y)/1e3;break;case"minute":ve=(this-Y)/6e4;break;case"hour":ve=(this-Y)/36e5;break;case"day":ve=(this-Y-te)/864e5;break;case"week":ve=(this-Y-te)/6048e5;break;default:ve=this-Y}return W?ve:Ns(ve)}function Wh(S,O){if(S.date()<O.date())return-Wh(O,S);var W=(O.year()-S.year())*12+(O.month()-S.month()),Y=S.clone().add(W,"months"),te,ve;return O-Y<0?(te=S.clone().add(W-1,"months"),ve=(O-Y)/(Y-te)):(te=S.clone().add(W+1,"months"),ve=(O-Y)/(te-Y)),-(W+ve)||0}c.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function SS(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function bS(S){if(!this.isValid())return null;var O=S!==!0,W=O?this.clone().utc():this;return W.year()<0||W.year()>9999?un(W,O?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ee(Date.prototype.toISOString)?O?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",un(W,"Z")):un(W,O?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function TS(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var S="moment",O="",W,Y,te,ve;return this.isLocal()||(S=this.utcOffset()===0?"moment.utc":"moment.parseZone",O="Z"),W="["+S+'("]',Y=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",te="-MM-DD[T]HH:mm:ss.SSS",ve=O+'[")]',this.format(W+Y+te+ve)}function $_(S){S||(S=this.isUtc()?c.defaultFormatUtc:c.defaultFormat);var O=un(this,S);return this.localeData().postformat(O)}function CS(S,O){return this.isValid()&&(ne(S)&&S.isValid()||Ar(S).isValid())?je({to:this,from:S}).locale(this.locale()).humanize(!O):this.localeData().invalidDate()}function wS(S){return this.from(Ar(),S)}function RS(S,O){return this.isValid()&&(ne(S)&&S.isValid()||Ar(S).isValid())?je({from:this,to:S}).locale(this.locale()).humanize(!O):this.localeData().invalidDate()}function IS(S){return this.to(Ar(),S)}function G_(S){var O;return S===void 0?this._locale._abbr:(O=ls(S),O!=null&&(this._locale=O),this)}var H_=oe("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(S){return S===void 0?this.localeData():this.locale(S)});function z_(){return this._locale}var $h=1e3,Hl=60*$h,Gh=60*Hl,K_=(365*400+97)*24*Gh;function zl(S,O){return(S%O+O)%O}function Y_(S,O,W){return S<100&&S>=0?new Date(S+400,O,W)-K_:new Date(S,O,W).valueOf()}function q_(S,O,W){return S<100&&S>=0?Date.UTC(S+400,O,W)-K_:Date.UTC(S,O,W)}function AS(S){var O,W;if(S=Ft(S),S===void 0||S==="millisecond"||!this.isValid())return this;switch(W=this._isUTC?q_:Y_,S){case"year":O=W(this.year(),0,1);break;case"quarter":O=W(this.year(),this.month()-this.month()%3,1);break;case"month":O=W(this.year(),this.month(),1);break;case"week":O=W(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":O=W(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":O=W(this.year(),this.month(),this.date());break;case"hour":O=this._d.valueOf(),O-=zl(O+(this._isUTC?0:this.utcOffset()*Hl),Gh);break;case"minute":O=this._d.valueOf(),O-=zl(O,Hl);break;case"second":O=this._d.valueOf(),O-=zl(O,$h);break}return this._d.setTime(O),c.updateOffset(this,!0),this}function OS(S){var O,W;if(S=Ft(S),S===void 0||S==="millisecond"||!this.isValid())return this;switch(W=this._isUTC?q_:Y_,S){case"year":O=W(this.year()+1,0,1)-1;break;case"quarter":O=W(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":O=W(this.year(),this.month()+1,1)-1;break;case"week":O=W(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":O=W(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":O=W(this.year(),this.month(),this.date()+1)-1;break;case"hour":O=this._d.valueOf(),O+=Gh-zl(O+(this._isUTC?0:this.utcOffset()*Hl),Gh)-1;break;case"minute":O=this._d.valueOf(),O+=Hl-zl(O,Hl)-1;break;case"second":O=this._d.valueOf(),O+=$h-zl(O,$h)-1;break}return this._d.setTime(O),c.updateOffset(this,!0),this}function NS(){return this._d.valueOf()-(this._offset||0)*6e4}function kS(){return Math.floor(this.valueOf()/1e3)}function xS(){return new Date(this.valueOf())}function PS(){var S=this;return[S.year(),S.month(),S.date(),S.hour(),S.minute(),S.second(),S.millisecond()]}function DS(){var S=this;return{years:S.year(),months:S.month(),date:S.date(),hours:S.hours(),minutes:S.minutes(),seconds:S.seconds(),milliseconds:S.milliseconds()}}function eu(){return this.isValid()?this.toISOString():null}function XA(){return B(this)}function vf(){return M({},H(this))}function X_(){return H(this).overflow}function yf(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Be("N",0,0,"eraAbbr"),Be("NN",0,0,"eraAbbr"),Be("NNN",0,0,"eraAbbr"),Be("NNNN",0,0,"eraName"),Be("NNNNN",0,0,"eraNarrow"),Be("y",["y",1],"yo","eraYear"),Be("y",["yy",2],0,"eraYear"),Be("y",["yyy",3],0,"eraYear"),Be("y",["yyyy",4],0,"eraYear"),lt("N",Cf),lt("NN",Cf),lt("NNN",Cf),lt("NNNN",e1),lt("NNNNN",t1),qn(["N","NN","NNN","NNNN","NNNNN"],function(S,O,W,Y){var te=W._locale.erasParse(S,Y,W._strict);te?H(W).era=te:H(W).invalidEra=S}),lt("y",mi),lt("yy",mi),lt("yyy",mi),lt("yyyy",mi),lt("yo",n1),qn(["y","yy","yyy","yyyy"],_i),qn(["yo"],function(S,O,W,Y){var te;W._locale._eraYearOrdinalRegex&&(te=S.match(W._locale._eraYearOrdinalRegex)),W._locale.eraYearOrdinalParse?O[_i]=W._locale.eraYearOrdinalParse(S,te):O[_i]=parseInt(S,10)});function Sf(S,O){var W,Y,te,ve=this._eras||ls("en")._eras;for(W=0,Y=ve.length;W<Y;++W){switch(typeof ve[W].since){case"string":te=c(ve[W].since).startOf("day"),ve[W].since=te.valueOf();break}switch(typeof ve[W].until){case"undefined":ve[W].until=1/0;break;case"string":te=c(ve[W].until).startOf("day").valueOf(),ve[W].until=te.valueOf();break}}return ve}function J_(S,O,W){var Y,te,ve=this.eras(),Le,ut,Vt;for(S=S.toUpperCase(),Y=0,te=ve.length;Y<te;++Y)if(Le=ve[Y].name.toUpperCase(),ut=ve[Y].abbr.toUpperCase(),Vt=ve[Y].narrow.toUpperCase(),W)switch(O){case"N":case"NN":case"NNN":if(ut===S)return ve[Y];break;case"NNNN":if(Le===S)return ve[Y];break;case"NNNNN":if(Vt===S)return ve[Y];break}else if([Le,ut,Vt].indexOf(S)>=0)return ve[Y]}function Q_(S,O){var W=S.since<=S.until?1:-1;return O===void 0?c(S.since).year():c(S.since).year()+(O-S.offset)*W}function bf(){var S,O,W,Y=this.localeData().eras();for(S=0,O=Y.length;S<O;++S)if(W=this.clone().startOf("day").valueOf(),Y[S].since<=W&&W<=Y[S].until||Y[S].until<=W&&W<=Y[S].since)return Y[S].name;return""}function Tf(){var S,O,W,Y=this.localeData().eras();for(S=0,O=Y.length;S<O;++S)if(W=this.clone().startOf("day").valueOf(),Y[S].since<=W&&W<=Y[S].until||Y[S].until<=W&&W<=Y[S].since)return Y[S].narrow;return""}function JA(){var S,O,W,Y=this.localeData().eras();for(S=0,O=Y.length;S<O;++S)if(W=this.clone().startOf("day").valueOf(),Y[S].since<=W&&W<=Y[S].until||Y[S].until<=W&&W<=Y[S].since)return Y[S].abbr;return""}function LS(){var S,O,W,Y,te=this.localeData().eras();for(S=0,O=te.length;S<O;++S)if(W=te[S].since<=te[S].until?1:-1,Y=this.clone().startOf("day").valueOf(),te[S].since<=Y&&Y<=te[S].until||te[S].until<=Y&&Y<=te[S].since)return(this.year()-c(te[S].since).year())*W+te[S].offset;return this.year()}function QA(S){return _(this,"_erasNameRegex")||Hh.call(this),S?this._erasNameRegex:this._erasRegex}function ZA(S){return _(this,"_erasAbbrRegex")||Hh.call(this),S?this._erasAbbrRegex:this._erasRegex}function MS(S){return _(this,"_erasNarrowRegex")||Hh.call(this),S?this._erasNarrowRegex:this._erasRegex}function Cf(S,O){return O.erasAbbrRegex(S)}function e1(S,O){return O.erasNameRegex(S)}function t1(S,O){return O.erasNarrowRegex(S)}function n1(S,O){return O._eraYearOrdinalRegex||mi}function Hh(){var S=[],O=[],W=[],Y=[],te,ve,Le,ut,Vt,yn=this.eras();for(te=0,ve=yn.length;te<ve;++te)Le=zo(yn[te].name),ut=zo(yn[te].abbr),Vt=zo(yn[te].narrow),O.push(Le),S.push(ut),W.push(Vt),Y.push(Le),Y.push(ut),Y.push(Vt);this._erasRegex=new RegExp("^("+Y.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+O.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+S.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+W.join("|")+")","i")}Be(0,["gg",2],0,function(){return this.weekYear()%100}),Be(0,["GG",2],0,function(){return this.isoWeekYear()%100});function wf(S,O){Be(0,[S,S.length],0,O)}wf("gggg","weekYear"),wf("ggggg","weekYear"),wf("GGGG","isoWeekYear"),wf("GGGGG","isoWeekYear"),lt("G",ac),lt("g",ac),lt("GG",ot,lr),lt("gg",ot,lr),lt("GGGG",nn,an),lt("gggg",nn,an),lt("GGGGG",Tn,It),lt("ggggg",Tn,It),$l(["gggg","ggggg","GGGG","GGGGG"],function(S,O,W,Y){O[Y.substr(0,2)]=vn(S)}),$l(["gg","GG"],function(S,O,W,Y){O[Y]=c.parseTwoDigitYear(S)});function r1(S){return US.call(this,S,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function i1(S){return US.call(this,S,this.isoWeek(),this.isoWeekday(),1,4)}function s1(){return go(this.year(),1,4)}function Z_(){return go(this.isoWeekYear(),1,4)}function o1(){var S=this.localeData()._week;return go(this.year(),S.dow,S.doy)}function eE(){var S=this.localeData()._week;return go(this.weekYear(),S.dow,S.doy)}function US(S,O,W,Y,te){var ve;return S==null?Fh(this,Y,te).year:(ve=go(S,Y,te),O>ve&&(O=ve),jS.call(this,S,O,W,Y,te))}function jS(S,O,W,Y,te){var ve=W0(S,O,W,Y,te),Le=jh(ve.year,0,ve.dayOfYear);return this.year(Le.getUTCFullYear()),this.month(Le.getUTCMonth()),this.date(Le.getUTCDate()),this}Be("Q",0,"Qo","quarter"),lt("Q",Wi),qn("Q",function(S,O){O[ks]=(vn(S)-1)*3});function a1(S){return S==null?Math.ceil((this.month()+1)/3):this.month((S-1)*3+this.month()%3)}Be("D",["DD",2],"Do","date"),lt("D",ot,$c),lt("DD",ot,lr),lt("Do",function(S,O){return S?O._dayOfMonthOrdinalParse||O._ordinalParse:O._dayOfMonthOrdinalParseLenient}),qn(["D","DD"],zr),qn("Do",function(S,O){O[zr]=vn(S.match(ot)[0])});var FS=Hc("Date",!0);Be("DDD",["DDDD",3],"DDDo","dayOfYear"),lt("DDD",bt),lt("DDDD",Yn),qn(["DDD","DDDD"],function(S,O,W){W._dayOfYear=vn(S)});function VS(S){var O=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return S==null?O:this.add(S-O,"d")}Be("m",["mm",2],0,"minute"),lt("m",ot,Lh),lt("mm",ot,lr),qn(["m","mm"],xs);var c1=Hc("Minutes",!1);Be("s",["ss",2],0,"second"),lt("s",ot,Lh),lt("ss",ot,lr),qn(["s","ss"],Ko);var l1=Hc("Seconds",!1);Be("S",0,0,function(){return~~(this.millisecond()/100)}),Be(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Be(0,["SSS",3],0,"millisecond"),Be(0,["SSSS",4],0,function(){return this.millisecond()*10}),Be(0,["SSSSS",5],0,function(){return this.millisecond()*100}),Be(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),Be(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),Be(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),Be(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),lt("S",bt,Wi),lt("SS",bt,lr),lt("SSS",bt,Yn);var dc,BS;for(dc="SSSS";dc.length<=9;dc+="S")lt(dc,mi);function WS(S,O){O[va]=vn(("0."+S)*1e3)}for(dc="S";dc.length<=9;dc+="S")qn(dc,WS);BS=Hc("Milliseconds",!1),Be("z",0,0,"zoneAbbr"),Be("zz",0,0,"zoneName");function tE(){return this._isUTC?"UTC":""}function d1(){return this._isUTC?"Coordinated Universal Time":""}var Qe=ie.prototype;Qe.add=qA,Qe.calendar=pS,Qe.clone=fS,Qe.diff=W_,Qe.endOf=OS,Qe.format=$_,Qe.from=CS,Qe.fromNow=wS,Qe.to=RS,Qe.toNow=IS,Qe.get=v_,Qe.invalidAt=X_,Qe.isAfter=mS,Qe.isBefore=gS,Qe.isBetween=_S,Qe.isSame=ES,Qe.isSameOrAfter=vS,Qe.isSameOrBefore=yS,Qe.isValid=XA,Qe.lang=H_,Qe.locale=G_,Qe.localeData=z_,Qe.max=LA,Qe.min=qc,Qe.parsingFlags=vf,Qe.set=Ei,Qe.startOf=AS,Qe.subtract=cS,Qe.toArray=PS,Qe.toObject=DS,Qe.toDate=xS,Qe.toISOString=bS,Qe.inspect=TS,typeof Symbol<"u"&&Symbol.for!=null&&(Qe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Qe.toJSON=eu,Qe.toString=SS,Qe.unix=kS,Qe.valueOf=NS,Qe.creationData=yf,Qe.eraName=bf,Qe.eraNarrow=Tf,Qe.eraAbbr=JA,Qe.eraYear=LS,Qe.year=cc,Qe.isLeapYear=E_,Qe.weekYear=r1,Qe.isoWeekYear=i1,Qe.quarter=Qe.quarters=a1,Qe.month=gr,Qe.daysInMonth=QI,Qe.week=Qe.weeks=tA,Qe.isoWeek=Qe.isoWeeks=G0,Qe.weeksInYear=o1,Qe.weeksInWeekYear=eE,Qe.isoWeeksInYear=s1,Qe.isoWeeksInISOWeekYear=Z_,Qe.date=FS,Qe.day=Qe.days=hA,Qe.weekday=pA,Qe.isoWeekday=fA,Qe.dayOfYear=VS,Qe.hour=Qe.hours=Js,Qe.minute=Qe.minutes=c1,Qe.second=Qe.seconds=l1,Qe.millisecond=Qe.milliseconds=BS,Qe.utcOffset=BA,Qe.utc=$A,Qe.local=GA,Qe.parseZone=iS,Qe.hasAlignedHourOffset=HA,Qe.isDST=zA,Qe.isLocal=sS,Qe.isUtcOffset=YA,Qe.isUtc=oS,Qe.isUTC=oS,Qe.zoneAbbr=tE,Qe.zoneName=d1,Qe.dates=oe("dates accessor is deprecated. Use date instead.",FS),Qe.months=oe("months accessor is deprecated. Use month instead",gr),Qe.years=oe("years accessor is deprecated. Use year instead",cc),Qe.zone=oe("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",WA),Qe.isDSTShifted=oe("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",KA);function zh(S){return Ar(S*1e3)}function $S(){return Ar.apply(null,arguments).parseZone()}function Rf(S){return S}var Un=Pe.prototype;Un.calendar=Fe,Un.longDateFormat=sn,Un.invalidDate=Ht,Un.ordinal=_n,Un.preparse=Rf,Un.postformat=Rf,Un.relativeTime=En,Un.pastFuture=fi,Un.set=we,Un.eras=Sf,Un.erasParse=J_,Un.erasConvertYear=Q_,Un.erasAbbrRegex=ZA,Un.erasNameRegex=QA,Un.erasNarrowRegex=MS,Un.months=lc,Un.monthsShort=JI,Un.monthsParse=y_,Un.monthsRegex=V0,Un.monthsShortRegex=F0,Un.week=$0,Un.firstDayOfYear=b_,Un.firstDayOfWeek=eA,Un.weekdays=cA,Un.weekdaysMin=dA,Un.weekdaysShort=lA,Un.weekdaysParse=uA,Un.weekdaysRegex=K0,Un.weekdaysShortRegex=mA,Un.weekdaysMinRegex=gA,Un.isPM=_A,Un.meridiem=vA;function If(S,O,W,Y){var te=ls(),ve=V().set(Y,O);return te[W](ve,S)}function GS(S,O,W){if(A(S)&&(O=S,S=void 0),S=S||"",O!=null)return If(S,O,W,"month");var Y,te=[];for(Y=0;Y<12;Y++)te[Y]=If(S,Y,W,"month");return te}function nE(S,O,W,Y){typeof S=="boolean"?(A(O)&&(W=O,O=void 0),O=O||""):(O=S,W=O,S=!1,A(O)&&(W=O,O=void 0),O=O||"");var te=ls(),ve=S?te._week.dow:0,Le,ut=[];if(W!=null)return If(O,(W+ve)%7,Y,"day");for(Le=0;Le<7;Le++)ut[Le]=If(O,(Le+ve)%7,Y,"day");return ut}function HS(S,O){return GS(S,O,"months")}function u1(S,O){return GS(S,O,"monthsShort")}function zS(S,O,W){return nE(S,O,W,"weekdays")}function h1(S,O,W){return nE(S,O,W,"weekdaysShort")}function p1(S,O,W){return nE(S,O,W,"weekdaysMin")}ba("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(S){var O=S%10,W=vn(S%100/10)===1?"th":O===1?"st":O===2?"nd":O===3?"rd":"th";return S+W}}),c.lang=oe("moment.lang is deprecated. Use moment.locale instead.",ba),c.langData=oe("moment.langData is deprecated. Use moment.localeData instead.",ls);var uc=Math.abs;function f1(){var S=this._data;return this._milliseconds=uc(this._milliseconds),this._days=uc(this._days),this._months=uc(this._months),S.milliseconds=uc(S.milliseconds),S.seconds=uc(S.seconds),S.minutes=uc(S.minutes),S.hours=uc(S.hours),S.months=uc(S.months),S.years=uc(S.years),this}function KS(S,O,W,Y){var te=je(O,W);return S._milliseconds+=Y*te._milliseconds,S._days+=Y*te._days,S._months+=Y*te._months,S._bubble()}function m1(S,O){return KS(this,S,O,1)}function g1(S,O){return KS(this,S,O,-1)}function YS(S){return S<0?Math.floor(S):Math.ceil(S)}function _1(){var S=this._milliseconds,O=this._days,W=this._months,Y=this._data,te,ve,Le,ut,Vt;return S>=0&&O>=0&&W>=0||S<=0&&O<=0&&W<=0||(S+=YS(Af(W)+O)*864e5,O=0,W=0),Y.milliseconds=S%1e3,te=Ns(S/1e3),Y.seconds=te%60,ve=Ns(te/60),Y.minutes=ve%60,Le=Ns(ve/60),Y.hours=Le%24,O+=Ns(Le/24),Vt=Ns(rE(O)),W+=Vt,O-=YS(Af(Vt)),ut=Ns(W/12),W%=12,Y.days=O,Y.months=W,Y.years=ut,this}function rE(S){return S*4800/146097}function Af(S){return S*146097/4800}function E1(S){if(!this.isValid())return NaN;var O,W,Y=this._milliseconds;if(S=Ft(S),S==="month"||S==="quarter"||S==="year")switch(O=this._days+Y/864e5,W=this._months+rE(O),S){case"month":return W;case"quarter":return W/3;case"year":return W/12}else switch(O=this._days+Math.round(Af(this._months)),S){case"week":return O/7+Y/6048e5;case"day":return O+Y/864e5;case"hour":return O*24+Y/36e5;case"minute":return O*1440+Y/6e4;case"second":return O*86400+Y/1e3;case"millisecond":return Math.floor(O*864e5)+Y;default:throw new Error("Unknown unit "+S)}}function hc(S){return function(){return this.as(S)}}var qS=hc("ms"),XS=hc("s"),v1=hc("m"),y1=hc("h"),iE=hc("d"),Of=hc("w"),sE=hc("M"),S1=hc("Q"),b1=hc("y"),T1=qS;function JS(){return je(this)}function QS(S){return S=Ft(S),this.isValid()?this[S+"s"]():NaN}function pc(S){return function(){return this.isValid()?this._data[S]:NaN}}var C1=pc("milliseconds"),w1=pc("seconds"),Nf=pc("minutes"),R1=pc("hours"),I1=pc("days"),A1=pc("months"),O1=pc("years");function N1(){return Ns(this.days()/7)}var fc=Math.round,mc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ZS(S,O,W,Y,te){return te.relativeTime(O||1,!!W,S,Y)}function k1(S,O,W,Y){var te=je(S).abs(),ve=fc(te.as("s")),Le=fc(te.as("m")),ut=fc(te.as("h")),Vt=fc(te.as("d")),yn=fc(te.as("M")),ys=fc(te.as("w")),gc=fc(te.as("y")),_c=ve<=W.ss&&["s",ve]||ve<W.s&&["ss",ve]||Le<=1&&["m"]||Le<W.m&&["mm",Le]||ut<=1&&["h"]||ut<W.h&&["hh",ut]||Vt<=1&&["d"]||Vt<W.d&&["dd",Vt];return W.w!=null&&(_c=_c||ys<=1&&["w"]||ys<W.w&&["ww",ys]),_c=_c||yn<=1&&["M"]||yn<W.M&&["MM",yn]||gc<=1&&["y"]||["yy",gc],_c[2]=O,_c[3]=+S>0,_c[4]=Y,ZS.apply(null,_c)}function eb(S){return S===void 0?fc:typeof S=="function"?(fc=S,!0):!1}function kf(S,O){return mc[S]===void 0?!1:O===void 0?mc[S]:(mc[S]=O,S==="s"&&(mc.ss=O-1),!0)}function x1(S,O){if(!this.isValid())return this.localeData().invalidDate();var W=!1,Y=mc,te,ve;return typeof S=="object"&&(O=S,S=!1),typeof S=="boolean"&&(W=S),typeof O=="object"&&(Y=Object.assign({},mc,O),O.s!=null&&O.ss==null&&(Y.ss=O.s-1)),te=this.localeData(),ve=k1(this,!W,Y,te),W&&(ve=te.pastFuture(+this,ve)),te.postformat(ve)}var oE=Math.abs;function Kl(S){return(S>0)-(S<0)||+S}function xf(){if(!this.isValid())return this.localeData().invalidDate();var S=oE(this._milliseconds)/1e3,O=oE(this._days),W=oE(this._months),Y,te,ve,Le,ut=this.asSeconds(),Vt,yn,ys,gc;return ut?(Y=Ns(S/60),te=Ns(Y/60),S%=60,Y%=60,ve=Ns(W/12),W%=12,Le=S?S.toFixed(3).replace(/\.?0+$/,""):"",Vt=ut<0?"-":"",yn=Kl(this._months)!==Kl(ut)?"-":"",ys=Kl(this._days)!==Kl(ut)?"-":"",gc=Kl(this._milliseconds)!==Kl(ut)?"-":"",Vt+"P"+(ve?yn+ve+"Y":"")+(W?yn+W+"M":"")+(O?ys+O+"D":"")+(te||Y||S?"T":"")+(te?gc+te+"H":"")+(Y?gc+Y+"M":"")+(S?gc+Le+"S":"")):"P0D"}var Nn=gf.prototype;Nn.isValid=D_,Nn.abs=f1,Nn.add=m1,Nn.subtract=g1,Nn.as=E1,Nn.asMilliseconds=qS,Nn.asSeconds=XS,Nn.asMinutes=v1,Nn.asHours=y1,Nn.asDays=iE,Nn.asWeeks=Of,Nn.asMonths=sE,Nn.asQuarters=S1,Nn.asYears=b1,Nn.valueOf=T1,Nn._bubble=_1,Nn.clone=JS,Nn.get=QS,Nn.milliseconds=C1,Nn.seconds=w1,Nn.minutes=Nf,Nn.hours=R1,Nn.days=I1,Nn.weeks=N1,Nn.months=A1,Nn.years=O1,Nn.humanize=x1,Nn.toISOString=xf,Nn.toString=xf,Nn.toJSON=xf,Nn.locale=G_,Nn.localeData=z_,Nn.toIsoString=oe("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xf),Nn.lang=H_,Be("X",0,0,"unix"),Be("x",0,0,"valueOf"),lt("x",ac),lt("X",df),qn("X",function(S,O,W){W._d=new Date(parseFloat(S)*1e3)}),qn("x",function(S,O,W){W._d=new Date(vn(S))});//! moment.js
return c.version="2.30.1",d(Ar),c.fn=Qe,c.min=MA,c.max=UA,c.now=jA,c.utc=V,c.unix=zh,c.months=HS,c.isDate=w,c.locale=ba,c.invalid=L,c.duration=je,c.isMoment=ne,c.weekdays=zS,c.parseZone=$S,c.localeData=ls,c.isDuration=Gl,c.monthsShort=u1,c.weekdaysMin=p1,c.defineLocale=I_,c.updateLocale=bA,c.locales=ff,c.weekdaysShort=h1,c.normalizeUnits=Ft,c.relativeTimeRounding=eb,c.relativeTimeThreshold=kf,c.calendarFormat=hS,c.prototype=Qe,c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},c})})(CNe);function wNe(t){if(!(!t||t===null||t===void 0||t==="")){const r=t==null?void 0:t.split(" "),o=r[0],c=r[1],d=o.split("-"),h=parseInt(d[0],10),f=parseInt(d[1],10),_=parseInt(d[2],10),v=c.split(":"),b=parseInt(v[0],10),A=parseInt(v[1],10),w=parseInt(v[2],10);return new Date(`${f}-${h}-${_} ${b}:${A}:${w}`).toLocaleString("en-US",{timeZone:"Asia/Ho_Chi_Minh"})}}function RNe({avatar:t,name:r,lastMessage:o,id:c,chatId:d,handleOnClick:h,isLoading:f,pId:_}){var ue,Ne;const v=o==null?void 0:o.content;let b=o!=null&&o.sender?((ue=o==null?void 0:o.sender)==null?void 0:ue.id)===_?"Bạn: ":((Ne=o==null?void 0:o.sender)==null?void 0:Ne.lastName)+": ":" ";K.useEffect(()=>{},[o]);function A(Ee){const we=new Date().toLocaleString("en-US",{timeZone:"Asia/Ho_Chi_Minh"}),Re=new Date(Ee).toLocaleString("en-US",{timeZone:"Asia/Ho_Chi_Minh"}),Pe=_Ne(we,Re);if(Pe<1)return`${Math.floor(Pe)} giây`;const $e=gNe(we,Re);if($e<1)return`${Math.floor(Pe)} phút`;const Ce=mNe(we,Re);if(Ce<1)return`${Math.floor($e)} giờ`;const Fe=SNe(we,Re);if(Fe<1)return`${Math.floor(Ce)} ngày`;const Ye=bNe(we,Re);return Ye<1?`${Math.floor(Fe)} tháng`:`${Math.floor(Ye)} năm`}const w=o==null?void 0:o.createdAt,x=wNe(w),M=A(x),[V,G]=K.useState(!1),H=()=>{G(!V)},[F,B]=K.useState(""),[L,X]=K.useState(""),[ee,ce]=K.useState("");qs({token:F,setToken:B,setProfile:ce,setPhone:X});const ie=Os(),ne=new y0,fe=()=>{F&&d?St({title:"Bạn có chắc chắn muốn xoá lịch sử phòng chat không?",icon:"warning",buttons:!0,dangerMode:!0}).then(Ee=>{Ee&&ne.deleteChats(F,d).then(we=>(ie.invalidateQueries(["chats"]),G(!1),St({title:"Xoá lịch sử phòng chat thành công",icon:"success"}),we.data)).catch(we=>{St({title:"Xóa lịch sử phòng chat thất bại",icon:"error"}),console.error(we)})}):St({title:"Token hoặc Chat ID không hợp lệ",icon:"error"})},oe=()=>{F&&d?St({title:"Bạn có chắc chắn muốn xoá phòng chat không?",icon:"warning",buttons:!0,dangerMode:!0}).then(Ee=>{Ee&&ne.deleteChatRoom(F,d,"DELETED").then(we=>(ie.invalidateQueries(["chats"]),G(!1),St({title:"Xoá phòng chat thành công",icon:"success"}),we.data)).catch(we=>{St({title:"Xóa phòng chat thất bại",icon:"error"}),console.error(we)})}):St({title:"Token hoặc Chat ID không hợp lệ",icon:"error"})};return T.jsx("a",{id:c,onClick:()=>h(c),className:`${d===c?"bg-blue-100 ":" "}flex cursor-pointer hover:bg-gray-200 h-[5rem] min-w-80 items-center`,children:f?T.jsx(Ju,{children:T.jsxs("div",{className:"flex p-2 grow justify-between pl-3 md:w-80",id:"content",children:[T.jsx(pi,{src:t,alt:"avatar",sx:{width:48,height:48},className:"min-w-12"}),T.jsx("div",{className:"",children:T.jsx(T.Fragment,{children:T.jsxs("div",{className:"grid gap-y-1",children:[T.jsx("div",{children:T.jsx("span",{className:"text-base font-semibold text-[#081C36]",children:r})}),T.jsxs("div",{className:"transition-min-width flex min-w-[calc(100vw-200px)] items-center text-sm font-medium text-[#7589A3] duration-200 md:w-[175px] md:min-w-full",children:[T.jsx("span",{children:b}),T.jsx("span",{className:"truncate md:w-44 ml-1",children:v})]})]})})}),T.jsx("div",{className:"mt-[-4px] grid gap-y-1 ",children:T.jsx("div",{children:T.jsx("span",{className:"truncate text-xs",children:M==="NaN năm"?"NaN":M})})})]})}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"flex grow justify-between p-2 md:w-[23rem]",id:"content",children:[T.jsxs("div",{className:"flex",children:[T.jsx(pi,{src:t,alt:"avatar",sx:{width:48,height:48},className:"min-w-12"}),T.jsx(T.Fragment,{children:T.jsxs("div",{className:"grid gap-y-1 ml-3",children:[T.jsx("div",{children:T.jsx("span",{className:"text-base font-semibold text-[#081C36]",children:r})}),T.jsxs("div",{className:"transition-min-width flex min-w-[calc(100vw-200px)] items-center text-sm font-medium text-[#7589A3] duration-200 md:w-[175px] md:min-w-full",children:[T.jsx("span",{children:b}),T.jsx("span",{className:"truncate md:w-44 ml-1",children:v})]})]})})]}),T.jsxs("div",{className:"mt-[-4px] grid gap-y-1 ",children:[T.jsx("div",{children:T.jsx("span",{className:"truncate text-xs",children:M})}),T.jsx("div",{onClick:()=>H(),className:"",children:T.jsx(Dn,{icon:xhe,className:"text-gray-400"})})]})]}),V&&T.jsxs("div",{className:"absolute ml-72 mt-36 bg-gray-300 m-2 flex-col",children:[T.jsx("div",{onClick:()=>oe(),className:"hover:text-red-500 hover:bg-blue-200",children:T.jsx("div",{className:"p-2",children:"Xóa hội thoại"})}),T.jsx("div",{onClick:()=>fe(),className:"hover:text-red-500 hover:bg-blue-200",children:T.jsx("div",{className:"p-2",children:"Xóa tất cả tin nhắn"})})]})]})},c)}const INe=()=>{const{chat:t,setChat:r,chats:o,setChats:c,chatId:d,setChatId:h,messages:f,setMessages:_}=K.useContext(Wc);return Os(),K.useEffect(()=>{(()=>{if(o.length>0){const A=o.find(w=>w.id===d);A?h(A.id):(console.warn(`Chat with ID ${d} not found in local data.`),o.length>0&&(h(o[0].id),console.log("chats",o[0]),h(o[0].id),r(o[0])))}})()},[o,d]),{chatId:d,handleOnClick:b=>{if(b){const A=o.find(w=>w.id===b);A&&(h(b),console.log(b),r(A))}}}},ANe=()=>{var G;const[t,r]=K.useState(""),[o,c]=K.useState(""),[d,h]=K.useState({});qs({token:o,setToken:c,setProfile:h,setPhone:r}),K.useState([]);const[f,_]=K.useState({}),v=new y0,{chats:b,setChats:A,chatId:w}=K.useContext(Wc),x=yh({queryKey:["chats"],queryFn:async()=>{try{const H=await v.getChats(o);if(H.data)return A(H.data),H.data}catch(H){console.log(H)}},enabled:o!==""&&o!==void 0}),{selectedId:M,handleOnClick:V}=INe();return Os(),T.jsx(T.Fragment,{children:T.jsxs("div",{className:"h-[calc(100vh-95px)] min-w-80 overflow-auto",children:[!(x!=null&&x.isLoading)&&!(x!=null&&x.data)?T.jsx("div",{children:"Không có tin nhắn nào"}):T.jsx("div",{className:"mt-2",children:(G=x==null?void 0:x.data)==null?void 0:G.map(H=>T.jsx(RNe,{id:H.id,name:H.name,lastMessage:H.lastMessage,avatar:H.avatar,isLoading:x.isLoading,chatId:w,handleOnClick:V,pId:d==null?void 0:d.id,setChatSelectId:_,chat:H},H.id))}),T.jsx("div",{className:"h-[60px]",children:T.jsx("p",{className:"mt-5 text-center text-sm mx-2",children:"Viet chat chỉ hiển thị tin nhắn từ sau lần đăng nhập đầu tiên trên trình duyệt này."})})]})})};function ONe(){return T.jsx("div",{className:"h-screen w-full overflow-auto",children:T.jsx("div",{className:"flex w-full items-center pr-2",children:T.jsx("div",{className:"transition-min-width flex min-w-[calc(100vw-200px)] items-center border text-sm text-[#7589A3] duration-200 md:min-w-[322px]",children:T.jsxs("div",{className:"",children:[T.jsx("h1",{children:"This is other message"}),T.jsx("p",{className:"text-red-900",children:"Xin chao"}),T.jsx("p",{className:"text-justify",children:"Lorem ipsum dolor sit, amet consecteture adipisicing elit. Magni vel nam incidunt corrupti laudantium et ea amet vitae, molestias inventore neque nesciunt ipsam nihil, omnis adipisci labore ipsa! Assumenda, obcaecati!"})]})})})})}function NNe({onClose:t}){const[r,o]=K.useState(""),[c,d]=K.useState(""),[h,f]=K.useState("");qs({token:r,setToken:o,setProfile:f,setPhone:d});const[_,v]=K.useState(""),[b,A]=K.useState(""),[w,x]=K.useState(!0),[M,V]=K.useState(new Date(h.birthday));K.useState({}),Wd();function G(L){const X=new Date(L),ee=String(X.getDate()).padStart(2,"0"),ce=String(X.getMonth()+1).padStart(2,"0"),ie=X.getFullYear();return`${ee}-${ce}-${ie}`}const H=G(M);console.log(H);const F=Os(),B=async()=>{const L=G(M);console.log(L);const X={firstName:_,lastName:b,gender:w,birthday:L};if(!_.trim()){window.alert("Họ không được để trống");return}if(!b.trim()){window.alert("Tên không được để trống");return}const ee=new Date(M),ce=new Date;if(ce.setFullYear(ce.getFullYear()-18),ee>ce){window.alert("Tuổi phải lớn hơn 18");return}await hi.put("http://localhost:8080/api/v1/users/profile",X,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}}).then(ie=>{if(ie.status===200)return ie.data;throw new Error("Cập nhật không thành công không thành công. Mã lỗi: ",ie.error)}).then(ie=>{console.log("Cập nhật thành công thành công:",ie),Hn.set("profile",JSON.stringify(ie)),F.invalidateQueries(["profilep"]),window.location.reload(),t()}).catch(ie=>{console.error(ie.message)})};return T.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-black bg-opacity-30 backdrop-blue-sm",children:T.jsxs("div",{className:"relative modal-container rounded pb-3 pt-1 mx-auto my-4 bg-white lg:max-w-[400px] w-full max-w-screen-lg",children:[T.jsxs("div",{className:"modal-header",children:[T.jsx("span",{className:"text-right text-3xl cursor-pointer pl-3",onClick:()=>t(),children:"<"}),T.jsx("span",{className:"ml-4 mr-40 text-base font-medium pl-5",style:{marginRight:"150px"},children:"Cập nhật thông tin"})]}),T.jsx("div",{className:"modal-content pt-5 pb-10",children:T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"relative",children:T.jsx("div",{className:"bg-white p-5",children:T.jsx("form",{className:"w-full",onSubmit:B,children:T.jsx("div",{className:"flex justify-center items-center",children:T.jsxs("div",{className:"flex flex-col ml-2",children:[T.jsx("input",{type:"text",className:"border rounded mb-2 p-1",placeholder:"First Name",value:_,onChange:L=>v(L.target.value)}),T.jsx("input",{type:"text",className:"border rounded mb-2 p-1",placeholder:"Last Name",value:b,onChange:L=>A(L.target.value)}),T.jsxs("select",{className:"border rounded mb-2 p-1",value:w,onChange:L=>x(L.target.value),children:[T.jsx("option",{value:!0,children:"Nam"}),T.jsx("option",{value:!1,children:"Nữ"})]}),T.jsx("input",{type:"date",placeholder:"dd-mm-yyyy",className:"border rounded mb-2 p-1",value:M,onChange:L=>V(L.target.value)})]})})})})}),T.jsx("div",{className:"absolute pt-1",style:{left:"137px"},children:T.jsx("button",{className:"hover:bg-slate-200 font-bold py-2 px-4 rounded",onClick:B,children:"Cập nhật"})})]})}),T.jsx("div",{className:"modal-footer"})]})})}function kNe({onClose:t,userData:r}){const[o,c]=K.useState(""),[d,h]=K.useState(""),[f,_]=K.useState(""),[v,b]=K.useState(!1),[A,w]=K.useState(null);K.useState("0929635572"),K.useState(""),K.useState(""),K.useState(""),K.useState();const x=Os();K.useState(!1);const[M,V]=K.useState(null),[G,H]=K.useState("");qs({token:o,setToken:c,setProfile:_,setPhone:h}),Wd();const{updatedData:F}=xR(),B=ue=>{const Ne=ue.target.files[0];V(Ne);const Ee=new FileReader;Ee.onloadend=()=>{H(Ee.result)},Ee.readAsDataURL(Ne)},L=()=>{V(null),H("")};K.useEffect(()=>{F&&(console.log(JSON.parse(F)),w(JSON.parse(F)))},[F]);const X=()=>{b(!0)},[ee,ce]=K.useState({token:o,connected:!1,url:"",success:!1}),ie=async ue=>{console.log("url:"+ue);const Ne={thumbnailAvatar:ue};await hi.put("http://localhost:8080/api/v1/users/profile",Ne,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(Ee=>{if(Ee.status===200)return Ee.data;throw new Error("Cập nhật không thành công không thành công. Mã lỗi: ",Ee.error)}).then(Ee=>{console.log("Cập nhật thành công thành công:",Ee),Hn.set("profile",JSON.stringify(Ee)),x.invalidateQueries(["profilep"]),window.location.reload()}).catch(Ee=>{console.error(Ee.message)})},ne=async ue=>{const Ee=new FormData(ue.target).get("file");if(!Ee)return null;await hi.post("http://localhost:8080/api/v1/files",{filename:Ee.name,type:"MESSAGE"},{headers:{Authorization:`Bearer ${o}`}}).then(async we=>{if(console.log(we),console.log(ee),(await hi.put(we.data,Ee).catch(Pe=>console.log(Pe))).status===200){ce({...ee,success:!0,url:we.data});const Pe=we.data.substring(0,we.data.indexOf("?"));console.log(Pe),ie(Pe)}else ce({...ee,success:!1})}).catch(we=>console.log(we))},fe=async ue=>{ue.preventDefault(),await ne(ue)},oe=ue=>ue===!0?"Nam":"Nữ";return T.jsx(T.Fragment,{children:v?T.jsx(NNe,{profile:f,phone:d,onClose:()=>b(!1),token:o}):T.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-black bg-opacity-30 backdrop-blue-sm",children:T.jsxs("div",{className:"relative modal-container rounded pb-3 pt-1 mx-auto my-4 bg-white lg:max-w-[400px] w-full max-w-screen-lg",children:[T.jsxs("div",{className:"modal-header ",children:[T.jsx("span",{className:"ml-4 mr-40 text-base font-medium",style:{marginRight:"200px"},children:"Thông tin tài khoản"}),T.jsx("span",{className:"text-right text-3xl cursor-pointer",onClick:()=>t(),children:"×"})]}),T.jsx("div",{className:"modal-content pt-5 pb-10 ",children:T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"relative z-1 bg-white overflow-hidden",children:T.jsx("img",{src:"/src/assets/messi.png",alt:"",className:"w-400 h-300 transition-all blur-sm hover:blur-none"})}),T.jsx("div",{className:"relative",children:T.jsxs("div",{className:"grid grid-cols-3 bg-white z-50 pb-10",style:{position:"absolute",bottom:"-30px",width:"400px"},children:[T.jsx(pi,{sx:{width:75,height:75},src:f==null?void 0:f.thumbnailAvatar,alt:"",className:"w-20 h-20 rounded-full border-2 border-white",style:{position:"absolute",top:"-20px",left:"15px"}}),T.jsx("br",{}),T.jsxs("form",{onSubmit:fe,children:[T.jsx("div",{className:"absolute cursor-pointer",style:{width:"35px",height:"35px",background:"#F5F5F5",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",top:"25px",left:"60px"},children:T.jsxs("label",{htmlFor:"avatar-upload",children:[T.jsx(Dn,{icon:y9}),T.jsx("input",{type:"file",name:"file",accept:"image/*",onChange:B,className:"form-control",style:{opacity:0,position:"absolute",left:"-10px",zIndex:1,width:"100%",height:"100%",cursor:"pointer"}})]})}),M&&G&&T.jsxs("div",{style:{position:"relative",top:"50px",left:"-20px"},className:"grid grid-cols-2",children:[T.jsx("button",{type:"submit",children:"Upload"}),T.jsx("button",{type:"button",onClick:L,children:"Hủy"}),T.jsx("div",{style:{position:"relative",top:"-40px",left:"140px"},children:T.jsx("img",{src:G,alt:"Selected",style:{width:"75px",height:"75px"}})})]})]}),T.jsxs("p",{className:"mt-4 font-bold",style:{marginLeft:"-150px",width:"100px"},children:[f==null?void 0:f.firstName," ",f==null?void 0:f.lastName]})]})}),T.jsx("div",{className:"relative bg-slate-200",style:{height:"35px"}}),T.jsxs("div",{className:"pt-3 pl-6",children:[T.jsx("span",{className:"ml-1 mr-40 pt-100 text-base font-medium",children:"Thông tin cá nhân"}),T.jsxs("div",{className:"grid grid-cols-2 p-2",children:[T.jsx("p",{className:"",children:"Giới tính"}),T.jsx("p",{className:"mr-auto",children:oe(f.gender)})]}),T.jsxs("div",{className:"grid grid-cols-2 p-2",children:[T.jsx("p",{className:"",children:"Ngày sinh"}),T.jsx("p",{className:"",children:f.birthday})]}),T.jsxs("div",{className:"grid grid-cols-2 p-2",children:[T.jsx("p",{className:"",children:"Số điện thoại"}),T.jsx("p",{className:"",children:d})]}),T.jsx("p",{className:"text-sm ml-2 pr-3 text-slate-500 pb-3",children:"Chỉ bạn bè có lưu số của bạn trong danh bạ máy xem được số này"}),T.jsx("div",{className:"border-b-2 ",style:{width:"350px"}})]}),T.jsx("div",{className:"absolute pt-1",style:{left:"137px"},children:T.jsx("button",{className:"hover:bg-slate-200 font-bold py-2 px-4 rounded",onClick:()=>X(),children:"Cập nhật"})})]})}),T.jsx("div",{className:"modal-footer"})]})})})}function xNe(){const t=sf(),[r,o]=K.useState(""),[c,d]=K.useState(""),[h,f]=K.useState("");qs({token:r,setToken:o,setProfile:f,setPhone:d});let _="/message-outline.png",v="/contact-book-outline.png",b="/todo-outline.png";(t.pathname==="/app"||t.pathname==="/app/other-message")&&(_="/message.png"),t.pathname==="/contact"&&(v="/contact-selected.png"),t.pathname==="/todo"&&(b="/todo-selected.png");const[A,w]=K.useState(null),x=!!A,M=ce=>{w(ce.currentTarget)},V=Wd(),G=()=>{w(null)},H=()=>{w(null),V(`/auth/change-password/${c}`)},F=()=>{w(null),Hn.remove("token"),Hn.remove("phone"),Hn.remove("profile"),Hn.remove("chatId"),Hn.remove("chat"),Hn.remove("chats"),V("/auth/login")},[B,L]=K.useState(!1),X=()=>{L(!1)},ee=()=>{w(null),L(!0)};return T.jsxs("div",{className:"fixed h-full w-16 bg-[#0091ff]  pt-8",children:[T.jsx("nav",{className:"w-full",children:T.jsxs("ul",{className:"grid w-full items-center justify-center",children:[T.jsx("li",{className:"pb-5",children:T.jsxs("div",{className:"",children:[T.jsx(Gv,{id:"fade-button","aria-controls":x?"fade-menu":void 0,"aria-haspopup":"true","aria-expanded":x?"true":void 0,onClick:M,disableTouchRipple:!0,children:T.jsx("div",{children:T.jsx(pi,{sx:{width:40,height:40},alt:"",src:h==null?void 0:h.thumbnailAvatar,className:""})})}),T.jsx(JY,{id:"fade-menu",MenuListProps:{"aria-labelledby":"fade-button"},anchorEl:A,open:x,onClose:G,TransitionComponent:aU,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},children:T.jsxs("div",{className:"px-4 text-sm ",children:[T.jsx("div",{className:"py-2",children:T.jsx("span",{className:"text-lg font-medium text-[#081c36]",children:h!=null&&h.firstName?`${h==null?void 0:h.firstName} ${h==null?void 0:h.lastName}`:T.jsx(Ju,{variant:"text",width:150})})}),T.jsxs("div",{className:"w-[270px] border-y py-1 text-sm ",children:[T.jsx(Hv,{sx:{fontSize:14,paddingLeft:0,height:36,color:"#081c36"},onClick:ee,children:"Hồ sơ của bạn"}),T.jsx(Hv,{sx:{fontSize:14,paddingLeft:0,height:36,color:"#081c36"},onClick:H,children:"Đổi mật khẩu"}),T.jsx(Hv,{sx:{fontSize:14,paddingLeft:0,height:36,color:"#081c36"},onClick:G,children:"Cài đặt"})]}),T.jsx(Hv,{sx:{fontSize:14,paddingLeft:0,paddingTop:1,height:36,color:"#081c36"},onClick:()=>F(),children:"Đăng xuất"})]})})]})}),T.jsx("li",{children:T.jsx(sP,{to:"/",className:`flex justify-center p-4 py-5 ${t.pathname==="/app"||t.pathname==="/app/other-message"?"bg-[#006edc]":""}`,children:T.jsx("img",{src:_,className:"h-[24px] w-[24px] items-center justify-center",alt:"avatar"})})}),T.jsx("li",{children:T.jsx(sP,{to:"/contact",className:`flex justify-center p-4 py-5 ${t.pathname==="/contact"?"bg-[#006edc]":""}`,children:T.jsx("img",{src:v,className:"h-[24px] w-[24px]",alt:"avatar"})})}),T.jsx("li",{children:T.jsx(sP,{to:"/todo",className:`flex justify-center p-4 py-5 ${t.pathname==="/todo"?"bg-[#006edc]":""}`,children:T.jsx("img",{src:b,className:"h-[22px] w-[22px]",alt:"avatar"})})})]})}),B&&T.jsx(kNe,{profile:h,phone:c,onClose:X,token:r})]})}var QP={};const PNe=Vd(Vye);var UH;function DNe(){return UH||(UH=1,function(t){"use client";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=PNe}(QP)),QP}const LNe=({onSendMessage:t})=>{const[r,o]=K.useState(""),[c,d]=K.useState([]);K.useState(!1);const h=K.useRef(null),[f,_]=K.useState([]),v=()=>{r.trim()!==""&&c.length===0&&(t(r),o("")),c.length>0&&(t(r,c[0]),o(""),d([]),_([]))};K.useEffect(()=>{},[c,f]);const[b,A]=K.useState(""),[w,x]=K.useState(""),[M,V]=K.useState("");qs({token:b,setToken:A,setProfile:V,setPhone:x});const G=async F=>{F.key==="Enter"&&v()};K.useEffect(()=>((async()=>{const B=[];for(const L of c){const X=await new Promise(ee=>{const ce=new FileReader;ce.onload=ie=>ee(ie.target.result),ce.readAsDataURL(L)});B.push(X)}_(B)})(),()=>{for(const B of f)URL.revokeObjectURL(B)}),[c]);const H=F=>{d([...F.target.files])};return T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"flex gap-2 bg-white h-10",children:[T.jsx("input",{type:"file",className:"hidden",ref:h,onChange:H}),T.jsx("div",{onClick:()=>h.current.click(),className:"flex ml-5 hover:bg-gray-200 px-2 items-center cursor-pointer",children:T.jsx(Dn,{icon:Nhe})}),(f==null?void 0:f.length)>0&&T.jsx("div",{className:"flex ",children:f==null?void 0:f.map((F,B)=>T.jsx("img",{src:F,className:"w-10 h-10 mr-2",alt:`Preview ${B+1}`},B))})]}),T.jsx("div",{className:"flex w-full items-center bg-white",style:{height:"58.5px"},children:T.jsx(iq,{fullWidth:!0,variant:"outlined",placeholder:"Nhập tin nhắn...",value:r,required:!0,onChange:F=>o(F.target.value),onKeyPress:G,inputProps:{style:{fontSize:15}},sx:{"& .MuiOutlinedInput-root":{borderTop:"1px solid",borderBottom:"none",borderLeft:"none",borderRight:"none",borderColor:"#CFD6DC",borderRadius:2},"& .MuiOutlinedInput-root:hover":{borderTop:"1px solid",borderBottom:"none",borderLeft:"none",borderRight:"none",borderRadius:2,borderColor:"blue"},"& .Mui-focused":{borderTop:"1px solid",borderBottom:"none",borderLeft:"none",borderRight:"none",borderRadius:2}}})})]})};class MNe{file(r,o){return Gn.post("/api/v1/files",o,Wr(r))}}const UNe=({preview:t,setPreview:r,setSelectedAvatar:o,showAvatarGroup:c,setShowAvatarGroup:d})=>{const h=["https://res.zaloapp.com/pc/avt_group/1_family.jpg","https://res.zaloapp.com/pc/avt_group/2_family.jpg","https://res.zaloapp.com/pc/avt_group/3_family.jpg","https://res.zaloapp.com/pc/avt_group/4_work.jpg","https://res.zaloapp.com/pc/avt_group/5_work.jpg","https://res.zaloapp.com/pc/avt_group/6_work.jpg","https://res.zaloapp.com/pc/avt_group/7_friends.jpg","https://res.zaloapp.com/pc/avt_group/8_friends.jpg","https://res.zaloapp.com/pc/avt_group/9_friends.jpg","https://res.zaloapp.com/pc/avt_group/10_school.jpg","https://res.zaloapp.com/pc/avt_group/11_school.jpg","https://res.zaloapp.com/pc/avt_group/12_school.jpg"],f=()=>{d(!1)},_=v=>{o(v),d(!1)};return T.jsx(T.Fragment,{children:c&&T.jsx("div",{className:"fixed z-50 bg-black bg-opacity-30 justify-center items-center w-full inset-0 ",children:T.jsx("div",{className:"z-50 p-4 max-h-full relative rounded pb-3 pt-1 mx-auto my-28 bg-white lg:max-w-[400px] w-full max-w-screen-lg",children:T.jsxs("div",{className:"relative bg-white rounded-lg min-h-[24rem] shadow dark:bg-gray-700",children:[T.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Cập nhập ảnh đại diện"}),T.jsxs("button",{onClick:()=>f(),className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal",children:[T.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:T.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),T.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),T.jsx("div",{className:"mt-2 flex"}),T.jsxs("div",{className:"mt-4 text-black px-2",children:[T.jsx("div",{children:T.jsx("h3",{children:"Bộ sưa tập"})}),T.jsx("div",{className:"flex flex-wrap",children:h.map((v,b)=>T.jsx("div",{onClick:()=>_(v),className:"p-2",children:T.jsx(pi,{src:v,sx:{width:70,height:70},alt:"avatar",className:"rounded-lg hover:opacity-65 cursor-pointer"})},b))})]})]})})})})};class XI{changeLead(r,o,c){return Gn.put(`/api/v1/groups/${o}/members/${c}`,{role:"GROUP_LEADER"},Wr(r))}leaveGroup(r,o){return Gn.put(`/api/v1/users/profile/groups/${o}/leave`,{},Wr(r))}createGroup(r,o){return Gn.post("/api/v1/groups",o,Wr(r))}getMembers(r,o){return Gn.get(`/api/v1/groups/${o}/members`,Wr(r))}addMembers(r,o,c){return Gn.put(`/api/v1/groups/${o}/members`,c,Wr(r))}getGroups(r,o){return Gn.get(`/api/v1/groups/${o}`,Wr(r))}delete(r,o,c){return Gn.delete(`/api/v1/groups/${o}/members/${c}`,Wr(r))}deleteGroup(r,o){return Gn.delete(`/api/v1/groups/${o}`,Wr(r))}}const jNe=({showAddGroup:t,setShowAddGroup:r,members:o,setMembers:c,groupId:d,queryChat:h})=>{const f=()=>{r(!1)};K.useState(!1);const[_,v]=K.useState(""),[b,A]=K.useState(""),[w,x]=K.useState("");qs({token:_,setToken:v,setProfile:x,setPhone:A});const{sent:M,friend:V}=K.useContext(Wc),G=Os(),[H,F]=K.useState(!1),B=()=>{F(!H)},L=H?"blue-500":"gray-400",[X,ee]=K.useState([]),ce=oe=>{X.includes(oe)?ee(X.filter(ue=>ue!==oe)):ee([...X,oe])},ie=()=>{let oe=[];X.forEach(ue=>{var Ne;oe.push((Ne=ue.profile)==null?void 0:Ne.id)}),fe.mutate(oe)};let ne=new XI;const fe=ki({mutationKey:["addmemberGroup"],mutationFn:async oe=>ne.addMembers(_,d,oe).then(ue=>{if(ue.data)return console.log(ue.data),ee([]),r(!1),h==null||h.refresh(),G.invalidateQueries(["chat"]),G.invalidateQueries(["members"]),St({title:"Thêm thành công",icon:"success"}),ue.data}).catch(ue=>{console.error(ue)})});return T.jsx(T.Fragment,{children:t&&T.jsx("div",{className:"fixed z-50 bg-black bg-opacity-30 justify-center items-center w-full inset-0 ",children:T.jsx("div",{className:"z-50 p-4 min-w-[30rem] relative rounded pb-3 pt-1 mx-auto my-20 bg-white lg:max-w-[400px] max-w-screen-lg",children:T.jsxs("div",{className:"relative bg-white  rounded-lg dark:bg-gray-700",children:[T.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Thêm thành viên"}),T.jsxs("button",{onClick:()=>f(),className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal",children:[T.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:T.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),T.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),T.jsx("div",{className:"mt-5 border-b pb-5",children:T.jsxs("div",{className:`md:flex hidden md:items-center w-full bg-white py-1 px-2 rounded-full border transition-all ${H?"border-blue-500 ":"border-gray-600 "} `,children:[T.jsx("span",{children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-${L}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),T.jsx("input",{className:"h-7 bg-white focus:outline-none px-4 py-2 border-none rounded-full",type:"text",placeholder:"Tìm kiếm",onFocus:B,onBlur:B})]})}),T.jsxs("div",{className:"text-black grid grid-cols-3 w-full my-2",children:[T.jsxs("div",{className:"col-span-2 w-full",children:[T.jsx("div",{children:T.jsx("h3",{children:"Chọn thành viên"})}),V==null?void 0:V.map((oe,ue)=>{var Ne;return T.jsxs("div",{className:"flex gap-2 w-full mt-3",children:[T.jsx("input",{type:"radio",onClick:()=>ce(oe),disabled:o==null?void 0:o.some(Ee=>{var we;return Ee.id===((we=oe==null?void 0:oe.profile)==null?void 0:we.id)}),checked:(o==null?void 0:o.some(Ee=>{var we;return Ee.id===((we=oe==null?void 0:oe.profile)==null?void 0:we.id)}))||X.includes(oe),onChange:()=>ce(oe)}),T.jsx(pi,{sx:{width:40,height:40},src:(Ne=oe==null?void 0:oe.profile)==null?void 0:Ne.thumbnailAvatar}),T.jsxs("div",{className:"ml-2",children:[" ",oe==null?void 0:oe.displayName," "]})]},ue)})]}),X.length>0&&T.jsxs("div",{className:"col-span-1 p-2 border text-sm",children:[T.jsx("div",{children:T.jsx("h3",{children:"Đã chọn"})}),T.jsx("div",{className:"mt-3 rounded-full w-full",children:X.map((oe,ue)=>{var Ne,Ee;return T.jsxs("div",{className:"justify-between flex mt-4 p-2 bg-blue-100",children:[T.jsxs("div",{className:"flex w-full",children:[T.jsx(pi,{sx:{width:20,height:20},src:(Ne=oe==null?void 0:oe.profile)==null?void 0:Ne.thumbnailAvatar}),T.jsxs("div",{className:"ml-1",children:[" ",(Ee=oe==null?void 0:oe.profile)==null?void 0:Ee.lastName," "]})]},ue),T.jsx(Dn,{icon:Ny,className:"cursor-pointer",onClick:()=>ce(oe)})]})})})]})]}),T.jsxs("div",{className:"flex mt-3 justify-end gap-5",children:[T.jsx("button",{onClick:()=>f(),className:" p-2 rounded-md bg-gray-100",children:"Hủy"}),T.jsx("button",{onClick:()=>ie(),className:`${X.length<=1?" bg-blue-300 ":"bg-blue-700"} p-2 rounded-md text-white`,disabled:X.length<=1,children:"Thêm"})]})]})})})})},FNe=({showMember:t,setShowMember:r,member:o,setMember:c,idLead:d,setIdLead:h,groupId:f})=>{const _=()=>{r(!1)},[v,b]=K.useState(""),[A,w]=K.useState(""),[x,M]=K.useState("");qs({token:v,setToken:b,setProfile:M,setPhone:w}),console.log("mb",o),console.log("lead",d);let V=new XI;const G=ki({mutationFn:oe=>V.delete(v,f,oe==null?void 0:oe.id).then(ue=>(F.invalidateQueries(["chats"]),c(o.filter(Ne=>Ne.id!==oe.id)),St({title:"Xóa thành công",icon:"success"}),ue.data)).catch(ue=>{console.error(ue)})}),H=oe=>{(oe==null?void 0:oe.length)>4?G.mutate(oe):St({title:"Nhóm phải có ít nhất 3 thành viên",icon:"error"})},F=Os(),B=ki({mutationFn:()=>{v&&f?V.leaveGroup(v,f).then(oe=>(F.invalidateQueries(["chats"]),r(!1),St({title:"Rời nhóm thành công",icon:"success"}),oe.data)).catch(oe=>{St({title:"Rời nhóm thất bại",icon:"error"}),console.error(oe)}):St({title:"Rời nhóm thất bại",icon:"error"})}}),L=()=>{(x==null?void 0:x.id)===d?St({title:"Bạn không thể rời nhóm",text:"Vì bạn là trưởng nhóm",icon:"error"}):B.mutate()},[X,ee]=K.useState(""),ce=oe=>{ee(X===oe?"":oe)},ie=ki({mutationFn:oe=>{v&&f&&(oe!=null&&oe.id)?(console.log("m",oe==null?void 0:oe.id,f,v),V.changeLead(v,f,oe==null?void 0:oe.id).then(ue=>(h(oe==null?void 0:oe.id),St({title:"Chuyển trưởng nhóm thành công",icon:"success"}),ee(""),ue.data)).catch(ue=>{console.error(ue)})):St({title:"Chuyển trưởng nhóm thất bại",icon:"error"})}}),ne=oe=>{(x==null?void 0:x.id)===d?ie.mutate(oe):St({title:"Bạn không có quyền chuyển trưởng nhóm",icon:"error"})},fe=()=>{(x==null?void 0:x.id)===d?St({title:"Bạn có chắc chắn muốn giải tán nhóm?",icon:"warning",buttons:!0,dangerMode:!0}).then(oe=>{oe&&V.deleteGroup(v,f).then(ue=>(F.invalidateQueries(["chats"]),r(!1),St({title:"Giải tán nhóm thành công",icon:"success"}),ue.data)).catch(ue=>{St({title:"Giải tán nhóm thất bại",icon:"error"}),console.error(ue)})}):St({title:"Bạn không có quyền giải tán nhóm",icon:"error"})};return T.jsxs(T.Fragment,{children:[" ",t&&T.jsx("div",{className:"fixed z-50 bg-opacity-30 bg-gray-800 justify-center items-center w-full inset-0 ",children:T.jsx("div",{className:"z-50 p-4 max-h-full relative rounded pb-3 pt-1 mx-auto my-20 bg-white lg:max-w-[400px] w-full max-w-screen-lg",children:T.jsxs("div",{className:"relative bg-white rounded-lg min-h-80 shadow dark:bg-gray-700",children:[T.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Thành viên"}),T.jsxs("div",{children:[(x==null?void 0:x.id)===d&&T.jsx("button",{onClick:()=>fe(),className:"border border-red-500 p-2 hover:bg-red-500 hover:text-white",children:"Giải tán nhóm"}),T.jsx("button",{onClick:()=>L(),className:"p-2 ml-2 border-blue-300 border hover:bg-blue-500 hover:text-white",children:"Rời nhóm"}),T.jsxs("button",{onClick:()=>_(),className:"ml-2 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal",children:[T.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:T.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),T.jsx("span",{className:"sr-only",children:"Close modal"})]})]})]}),T.jsx("div",{className:"mt-5 ml-5",children:o==null?void 0:o.map((oe,ue)=>T.jsxs("div",{className:"flex text-black items-center justify-between",children:[T.jsxs("div",{className:"flex mt-2",children:[T.jsx("div",{children:T.jsx(pi,{src:oe==null?void 0:oe.thumbnailAvatar})}),T.jsxs("div",{className:"ml-2",children:[T.jsxs("div",{className:"",children:[oe==null?void 0:oe.firstName," ",oe==null?void 0:oe.lastName]}),d&&d===oe.id&&T.jsx("p",{className:"text-gray-500 mt-1",children:"Trưởng nhóm"})]})]}),T.jsx("div",{className:"flex",onClick:()=>ce(oe==null?void 0:oe.id),children:(x==null?void 0:x.id)===d&&d!==oe.id&&T.jsx("div",{className:"flex mr-4",children:T.jsx("div",{children:T.jsx(Dn,{icon:Ahe})})})}),X===(oe==null?void 0:oe.id)&&T.jsxs("div",{className:" absolute mt-28 right-0 bg-gray-200 p-2",children:[T.jsx("div",{onClick:()=>H(oe),className:"flex p-1 hover:text-red-500 cursor-pointer",children:T.jsx("div",{children:"Xoá thành viên"})}),T.jsx("div",{onClick:()=>ne(oe),className:"flex p-1 mt-2 hover:text-blue-500 cursor-pointer",children:T.jsx("div",{children:"Chuyển nhóm trưởng"})})]})]},ue))})]})})})]})};var nJ={exports:{}};(function(t,r){(function(o,c){t.exports=c()})(nt,function(){function o(i,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(s){if(s!=="default"&&!(s in i)){var a=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:function(){return n[s]}})}})}),Object.freeze(i)}var c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof nt<"u"?nt:typeof self<"u"?self:{};function d(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var h=function(i){try{return!!i()}catch{return!0}},f=!h(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")}),_=f,v=Function.prototype,b=v.call,A=_&&v.bind.bind(b,b),w=_?A:function(i){return function(){return b.apply(i,arguments)}},x=w({}.isPrototypeOf),M=function(i){return i&&i.Math==Math&&i},V=M(typeof globalThis=="object"&&globalThis)||M(typeof window=="object"&&window)||M(typeof self=="object"&&self)||M(typeof c=="object"&&c)||function(){return this}()||c||Function("return this")(),G=f,H=Function.prototype,F=H.apply,B=H.call,L=typeof Reflect=="object"&&Reflect.apply||(G?B.bind(F):function(){return B.apply(F,arguments)}),X=w,ee=X({}.toString),ce=X("".slice),ie=function(i){return ce(ee(i),8,-1)},ne=ie,fe=w,oe=function(i){if(ne(i)==="Function")return fe(i)},ue=typeof document=="object"&&document.all,Ne={all:ue,IS_HTMLDDA:ue===void 0&&ue!==void 0},Ee=Ne.all,we=Ne.IS_HTMLDDA?function(i){return typeof i=="function"||i===Ee}:function(i){return typeof i=="function"},Re={},Pe=!h(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),$e=f,Ce=Function.prototype.call,Fe=$e?Ce.bind(Ce):function(){return Ce.apply(Ce,arguments)},Ye={},Mt={}.propertyIsEnumerable,yt=Object.getOwnPropertyDescriptor,Xt=yt&&!Mt.call({1:2},1);Ye.f=Xt?function(i){var e=yt(this,i);return!!e&&e.enumerable}:Mt;var Ue,Be,at=function(i,e){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:e}},Jt=h,un=ie,Ut=Object,Gr=w("".split),sn=Jt(function(){return!Ut("z").propertyIsEnumerable(0)})?function(i){return un(i)=="String"?Gr(i,""):Ut(i)}:Ut,hn=function(i){return i==null},Ht=hn,on=TypeError,rt=function(i){if(Ht(i))throw on("Can't call method on "+i);return i},_n=sn,Kn=rt,En=function(i){return _n(Kn(i))},fi=we,fr=Ne.all,Ft=Ne.IS_HTMLDDA?function(i){return typeof i=="object"?i!==null:fi(i)||i===fr}:function(i){return typeof i=="object"?i!==null:fi(i)},mr={},Hr=mr,Mn=V,Wi=we,lr=function(i){return Wi(i)?i:void 0},Yn=function(i,e){return arguments.length<2?lr(Hr[i])||lr(Mn[i]):Hr[i]&&Hr[i][e]||Mn[i]&&Mn[i][e]},an=typeof navigator<"u"&&String(navigator.userAgent)||"",It=V,ot=an,tn=It.process,$i=It.Deno,bt=tn&&tn.versions||$i&&$i.version,nn=bt&&bt.v8;nn&&(Be=(Ue=nn.split("."))[0]>0&&Ue[0]<4?1:+(Ue[0]+Ue[1])),!Be&&ot&&(!(Ue=ot.match(/Edge\/(\d+)/))||Ue[1]>=74)&&(Ue=ot.match(/Chrome\/(\d+)/))&&(Be=+Ue[1]);var Tn=Be,mi=Tn,ac=h,g_=V.String,Ho=!!Object.getOwnPropertySymbols&&!ac(function(){var i=Symbol();return!g_(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&mi&&mi<41}),df=Ho&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Wl=Yn,$c=we,Lh=x,Kd=Object,lt=df?function(i){return typeof i=="symbol"}:function(i){var e=Wl("Symbol");return $c(e)&&Lh(e.prototype,Kd(i))},__=String,Gc=function(i){try{return __(i)}catch{return"Object"}},zo=we,Ns=Gc,vn=TypeError,gi=function(i){if(zo(i))return i;throw vn(Ns(i)+" is not a function")},qn=gi,$l=hn,Yd=function(i,e){var n=i[e];return $l(n)?void 0:qn(n)},mo=Fe,_i=we,ks=Ft,zr=TypeError,Zr={exports:{}},xs=V,Ko=Object.defineProperty,va=function(i,e){try{Ko(xs,i,{value:e,configurable:!0,writable:!0})}catch{xs[i]=e}return e},uf="__core-js_shared__",Mh=V[uf]||va(uf,{}),ya=Mh;(Zr.exports=function(i,e){return ya[i]||(ya[i]=e!==void 0?e:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var cc=Zr.exports,E_=rt,Hc=Object,cs=function(i){return Hc(E_(i))},Uh=cs,v_=w({}.hasOwnProperty),Ei=Object.hasOwn||function(i,e){return v_(Uh(i),e)},U0=w,ei=0,ke=Math.random(),tt=U0(1 .toString),dt=function(i){return"Symbol("+(i===void 0?"":i)+")_"+tt(++ei+ke,36)},rr=cc,ti=Ei,Ps=dt,lc=Ho,JI=df,qd=V.Symbol,y_=rr("wks"),j0=JI?qd.for||qd:qd&&qd.withoutSetter||Ps,gr=function(i){return ti(y_,i)||(y_[i]=lc&&ti(qd,i)?qd[i]:j0("Symbol."+i)),y_[i]},QI=Fe,F0=Ft,V0=lt,B0=Yd,ZI=function(i,e){var n,s;if(e==="string"&&_i(n=i.toString)&&!ks(s=mo(n,i))||_i(n=i.valueOf)&&!ks(s=mo(n,i))||e!=="string"&&_i(n=i.toString)&&!ks(s=mo(n,i)))return s;throw zr("Can't convert object to primitive value")},jh=TypeError,hf=gr("toPrimitive"),W0=function(i,e){if(!F0(i)||V0(i))return i;var n,s=B0(i,hf);if(s){if(e===void 0&&(e="default"),n=QI(s,i,e),!F0(n)||V0(n))return n;throw jh("Can't convert object to primitive value")}return e===void 0&&(e="number"),ZI(i,e)},Fh=lt,go=function(i){var e=W0(i,"string");return Fh(e)?e:e+""},$0=Ft,S_=V.document,eA=$0(S_)&&$0(S_.createElement),b_=function(i){return eA?S_.createElement(i):{}},tA=b_,G0=!Pe&&!h(function(){return Object.defineProperty(tA("div"),"a",{get:function(){return 7}}).a!=7}),nA=Pe,rA=Fe,T_=Ye,iA=at,H0=En,sA=go,oA=Ei,aA=G0,z0=Object.getOwnPropertyDescriptor;Re.f=nA?z0:function(i,e){if(i=H0(i),e=sA(e),aA)try{return z0(i,e)}catch{}if(oA(i,e))return iA(!rA(T_.f,i,e),i[e])};var cA=h,lA=we,dA=/#|\.prototype\./,Vh=function(i,e){var n=hA[uA(i)];return n==fA||n!=pA&&(lA(e)?cA(e):!!e)},uA=Vh.normalize=function(i){return String(i).replace(dA,".").toLowerCase()},hA=Vh.data={},pA=Vh.NATIVE="N",fA=Vh.POLYFILL="P",K0=Vh,mA=gi,gA=f,C_=oe(oe.bind),Sa=function(i,e){return mA(i),e===void 0?i:gA?C_(i,e):function(){return i.apply(e,arguments)}},_o={},w_=Pe&&h(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Y0=Ft,_A=String,EA=TypeError,Js=function(i){if(Y0(i))return i;throw EA(_A(i)+" is not an object")},vA=Pe,q0=G0,Pr=w_,zc=Js,Xd=go,yA=TypeError,pf=Object.defineProperty,SA=Object.getOwnPropertyDescriptor,R_="enumerable",Jd="configurable",ba="writable";_o.f=vA?Pr?function(i,e,n){if(zc(i),e=Xd(e),zc(n),typeof i=="function"&&e==="prototype"&&"value"in n&&ba in n&&!n[ba]){var s=SA(i,e);s&&s[ba]&&(i[e]=n.value,n={configurable:Jd in n?n[Jd]:s[Jd],enumerable:R_ in n?n[R_]:s[R_],writable:!1})}return pf(i,e,n)}:pf:function(i,e,n){if(zc(i),e=Xd(e),zc(n),q0)try{return pf(i,e,n)}catch{}if("get"in n||"set"in n)throw yA("Accessors not supported");return"value"in n&&(i[e]=n.value),i};var I_=_o,bA=at,ls=Pe?function(i,e,n){return I_.f(i,e,bA(1,n))}:function(i,e,n){return i[e]=n,i},ff=V,A_=L,TA=oe,CA=we,wA=Re.f,mf=K0,Kc=mr,RA=Sa,Qd=ls,X0=Ei,J0=function(i){var e=function(n,s,a){if(this instanceof e){switch(arguments.length){case 0:return new i;case 1:return new i(n);case 2:return new i(n,s)}return new i(n,s,a)}return A_(i,this,arguments)};return e.prototype=i.prototype,e},On=function(i,e){var n,s,a,l,u,p,m,g,E,y=i.target,C=i.global,I=i.stat,j=i.proto,P=C?ff:I?ff[y]:(ff[y]||{}).prototype,U=C?Kc:Kc[y]||Qd(Kc,y,{})[y],q=U.prototype;for(l in e)s=!(n=mf(C?l:y+(I?".":"#")+l,i.forced))&&P&&X0(P,l),p=U[l],s&&(m=i.dontCallGetSet?(E=wA(P,l))&&E.value:P[l]),u=s&&m?m:e[l],s&&typeof p==typeof u||(g=i.bind&&s?RA(u,ff):i.wrap&&s?J0(u):j&&CA(u)?TA(u):u,(i.sham||u&&u.sham||p&&p.sham)&&Qd(g,"sham",!0),Qd(U,l,g),j&&(X0(Kc,a=y+"Prototype")||Qd(Kc,a,{}),Qd(Kc[a],l,u),i.real&&q&&(n||!q[l])&&Qd(q,l,u)))},IA=Math.ceil,AA=Math.floor,OA=Math.trunc||function(i){var e=+i;return(e>0?AA:IA)(e)},O_=function(i){var e=+i;return e!=e||e===0?0:OA(e)},Q0=O_,NA=Math.max,Zd=Math.min,Z0=function(i,e){var n=Q0(i);return n<0?NA(n+e,0):Zd(n,e)},N_=O_,kA=Math.min,k_=function(i){return i>0?kA(N_(i),9007199254740991):0},Yc=function(i){return k_(i.length)},xA=En,PA=Z0,DA=Yc,x_=function(i){return function(e,n,s){var a,l=xA(e),u=DA(l),p=PA(s,u);if(i&&n!=n){for(;u>p;)if((a=l[p++])!=a)return!0}else for(;u>p;p++)if((i||p in l)&&l[p]===n)return i||p||0;return!i&&-1}},P_={includes:x_(!0),indexOf:x_(!1)},eS=P_.includes;On({target:"Array",proto:!0,forced:h(function(){return!Array(1).includes()})},{includes:function(i){return eS(this,i,arguments.length>1?arguments[1]:void 0)}});var Ar=mr,qc=function(i){return Ar[i+"Prototype"]},LA=qc("Array").includes,tS=Ft,MA=ie,UA=gr("match"),jA=function(i){var e;return tS(i)&&((e=i[UA])!==void 0?!!e:MA(i)=="RegExp")},Bh=TypeError,nS={};nS[gr("toStringTag")]="z";var D_=String(nS)==="[object z]",FA=D_,gf=we,Gl=ie,L_=gr("toStringTag"),VA=Object,rS=Gl(function(){return arguments}())=="Arguments",Xc=FA?Gl:function(i){var e,n,s;return i===void 0?"Undefined":i===null?"Null":typeof(n=function(a,l){try{return a[l]}catch{}}(e=VA(i),L_))=="string"?n:rS?Gl(e):(s=Gl(e))=="Object"&&gf(e.callee)?"Arguments":s},M_=Xc,U_=String,Ds=function(i){if(M_(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return U_(i)},BA=gr("match"),WA=On,$A=function(i){if(jA(i))throw Bh("The method doesn't accept regular expressions");return i},GA=rt,iS=Ds,HA=function(i){var e=/./;try{"/./"[i](e)}catch{try{return e[BA]=!1,"/./"[i](e)}catch{}}return!1},zA=w("".indexOf);WA({target:"String",proto:!0,forced:!HA("includes")},{includes:function(i){return!!~zA(iS(GA(this)),iS($A(i)),arguments.length>1?arguments[1]:void 0)}});var KA=qc("String").includes,sS=x,YA=LA,oS=KA,j_=Array.prototype,F_=String.prototype,je=d(function(i){var e=i.includes;return i===j_||sS(j_,i)&&e===j_.includes?YA:typeof i=="string"||i===F_||sS(F_,i)&&e===F_.includes?oS:e});let Jc=!0,V_=!0;function _f(i,e,n){const s=i.match(e);return s&&s.length>=n&&parseInt(s[n],10)}function Qc(i,e,n){if(!i.RTCPeerConnection)return;const s=i.RTCPeerConnection.prototype,a=s.addEventListener;s.addEventListener=function(u,p){if(u!==e)return a.apply(this,arguments);const m=g=>{const E=n(g);E&&(p.handleEvent?p.handleEvent(E):p(E))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(p,m),a.apply(this,[u,m])};const l=s.removeEventListener;s.removeEventListener=function(u,p){if(u!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(p))return l.apply(this,arguments);const m=this._eventMap[e].get(p);return this._eventMap[e].delete(p),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[u,m])},Object.defineProperty(s,"on"+e,{get(){return this["_on"+e]},set(u){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),u&&this.addEventListener(e,this["_on"+e]=u)},enumerable:!0,configurable:!0})}function aS(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(Jc=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function qA(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(V_=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function cS(){if(typeof window=="object"){if(Jc)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Ef(i,e){V_&&console.warn(i+" is deprecated, please use "+e+" instead.")}function lS(i){return Object.prototype.toString.call(i)==="[object Object]"}function dS(i){return lS(i)?Object.keys(i).reduce(function(e,n){const s=lS(i[n]),a=s?dS(i[n]):i[n],l=s&&!Object.keys(a).length;return a===void 0||l?e:Object.assign(e,{[n]:a})},{}):i}function B_(i,e,n){e&&!n.has(e.id)&&(n.set(e.id,e),Object.keys(e).forEach(s=>{s.endsWith("Id")?B_(i,i.get(e[s]),n):s.endsWith("Ids")&&e[s].forEach(a=>{B_(i,i.get(a),n)})}))}function uS(i,e,n){const s=n?"outbound-rtp":"inbound-rtp",a=new Map;if(e===null)return a;const l=[];return i.forEach(u=>{u.type==="track"&&u.trackIdentifier===e.id&&l.push(u)}),l.forEach(u=>{i.forEach(p=>{p.type===s&&p.trackId===u.id&&B_(i,p,a)})}),a}const hS=cS;function pS(i,e){const n=i&&i.navigator;if(!n.mediaDevices)return;const s=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const p={};return Object.keys(u).forEach(m=>{if(m==="require"||m==="advanced"||m==="mediaSource")return;const g=typeof u[m]=="object"?u[m]:{ideal:u[m]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const E=function(y,C){return y?y+C.charAt(0).toUpperCase()+C.slice(1):C==="deviceId"?"sourceId":C};if(g.ideal!==void 0){p.optional=p.optional||[];let y={};typeof g.ideal=="number"?(y[E("min",m)]=g.ideal,p.optional.push(y),y={},y[E("max",m)]=g.ideal,p.optional.push(y)):(y[E("",m)]=g.ideal,p.optional.push(y))}g.exact!==void 0&&typeof g.exact!="number"?(p.mandatory=p.mandatory||{},p.mandatory[E("",m)]=g.exact):["min","max"].forEach(y=>{g[y]!==void 0&&(p.mandatory=p.mandatory||{},p.mandatory[E(y,m)]=g[y])})}),u.advanced&&(p.optional=(p.optional||[]).concat(u.advanced)),p},a=function(u,p){if(e.version>=61)return p(u);if((u=JSON.parse(JSON.stringify(u)))&&typeof u.audio=="object"){const m=function(g,E,y){E in g&&!(y in g)&&(g[y]=g[E],delete g[E])};m((u=JSON.parse(JSON.stringify(u))).audio,"autoGainControl","googAutoGainControl"),m(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=s(u.audio)}if(u&&typeof u.video=="object"){let m=u.video.facingMode;m=m&&(typeof m=="object"?m:{ideal:m});const g=e.version<66;if(m&&(m.exact==="user"||m.exact==="environment"||m.ideal==="user"||m.ideal==="environment")&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||g)){let E;if(delete u.video.facingMode,m.exact==="environment"||m.ideal==="environment"?E=["back","rear"]:m.exact!=="user"&&m.ideal!=="user"||(E=["front"]),E)return n.mediaDevices.enumerateDevices().then(y=>{let C=(y=y.filter(I=>I.kind==="videoinput")).find(I=>E.some(j=>I.label.toLowerCase().includes(j)));return!C&&y.length&&E.includes("back")&&(C=y[y.length-1]),C&&(u.video.deviceId=m.exact?{exact:C.deviceId}:{ideal:C.deviceId}),u.video=s(u.video),hS("chrome: "+JSON.stringify(u)),p(u)})}u.video=s(u.video)}return hS("chrome: "+JSON.stringify(u)),p(u)},l=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=(function(u,p,m){a(u,g=>{n.webkitGetUserMedia(g,p,E=>{m&&m(l(E))})})}).bind(n),n.mediaDevices.getUserMedia){const u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(p){return a(p,m=>u(m).then(g=>{if(m.audio&&!g.getAudioTracks().length||m.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(E=>{E.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(l(g))))}}}function fS(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function mS(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",s=>{let a;a=i.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(u=>u.track&&u.track.id===s.track.id):{track:s.track};const l=new Event("track");l.track=s.track,l.receiver=a,l.transceiver={receiver:a},l.streams=[n.stream],this.dispatchEvent(l)}),n.stream.getTracks().forEach(s=>{let a;a=i.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(u=>u.track&&u.track.id===s.id):{track:s};const l=new Event("track");l.track=s,l.receiver=a,l.transceiver={receiver:a},l.streams=[n.stream],this.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Qc(i,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function gS(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const e=function(a,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=a.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:a}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(u,p){let m=a.apply(this,arguments);return m||(m=e(this,u),this._senders.push(m)),m};const l=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(u){l.apply(this,arguments);const p=this._senders.indexOf(u);p!==-1&&this._senders.splice(p,1)}}const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(l=>{this._senders.push(e(this,l))})};const s=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],s.apply(this,[a]),a.getTracks().forEach(l=>{const u=this._senders.find(p=>p.track===l);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const e=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(s=>s._pc=this),n},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function _S(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[n,s,a]=arguments;if(arguments.length>0&&typeof n=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof n!="function"))return e.apply(this,[]);const l=function(p){const m={};return p.result().forEach(g=>{const E={id:g.id,timestamp:g.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[g.type]||g.type};g.names().forEach(y=>{E[y]=g.stat(y)}),m[E.id]=E}),m},u=function(p){return new Map(Object.keys(p).map(m=>[m,p[m]]))};if(arguments.length>=2){const p=function(m){s(u(l(m)))};return e.apply(this,[p,n])}return new Promise((p,m)=>{e.apply(this,[function(g){p(u(l(g)))},m])}).then(s,a)}}function ES(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const n=i.RTCPeerConnection.prototype.getSenders;n&&(i.RTCPeerConnection.prototype.getSenders=function(){const a=n.apply(this,[]);return a.forEach(l=>l._pc=this),a});const s=i.RTCPeerConnection.prototype.addTrack;s&&(i.RTCPeerConnection.prototype.addTrack=function(){const a=s.apply(this,arguments);return a._pc=this,a}),i.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>uS(l,a.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const n=i.RTCPeerConnection.prototype.getReceivers;n&&(i.RTCPeerConnection.prototype.getReceivers=function(){const s=n.apply(this,[]);return s.forEach(a=>a._pc=this),s}),Qc(i,"track",s=>(s.receiver._pc=s.srcElement,s)),i.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>uS(a,s.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype)||!("getStats"in i.RTCRtpReceiver.prototype))return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const n=arguments[0];let s,a,l;return this.getSenders().forEach(u=>{u.track===n&&(s?l=!0:s=u)}),this.getReceivers().forEach(u=>(u.track===n&&(a?l=!0:a=u),u.track===n)),l||s&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function vS(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(l=>this._shimmedLocalStreams[l][0])};const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(l,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const p=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(p)===-1&&this._shimmedLocalStreams[u.id].push(p):this._shimmedLocalStreams[u.id]=[u,p],p};const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(l){this._shimmedLocalStreams=this._shimmedLocalStreams||{},l.getTracks().forEach(m=>{if(this.getSenders().find(g=>g.track===m))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();n.apply(this,arguments);const p=this.getSenders().filter(m=>u.indexOf(m)===-1);this._shimmedLocalStreams[l.id]=[l].concat(p)};const s=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[l.id],s.apply(this,arguments)};const a=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},l&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const p=this._shimmedLocalStreams[u].indexOf(l);p!==-1&&this._shimmedLocalStreams[u].splice(p,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),a.apply(this,arguments)}}function yS(i,e){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&e.version>=65)return vS(i);const n=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const m=n.apply(this);return this._reverseStreams=this._reverseStreams||{},m.map(g=>this._reverseStreams[g.id])};const s=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(m){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},m.getTracks().forEach(g=>{if(this.getSenders().find(E=>E.track===g))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[m.id]){const g=new i.MediaStream(m.getTracks());this._streams[m.id]=g,this._reverseStreams[g.id]=m,m=g}s.apply(this,[m])};const a=i.RTCPeerConnection.prototype.removeStream;function l(m,g){let E=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(y=>{const C=m._reverseStreams[y],I=m._streams[C.id];E=E.replace(new RegExp(I.id,"g"),C.id)}),new RTCSessionDescription({type:g.type,sdp:E})}i.RTCPeerConnection.prototype.removeStream=function(m){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[m.id]||m]),delete this._reverseStreams[this._streams[m.id]?this._streams[m.id].id:m.id],delete this._streams[m.id]},i.RTCPeerConnection.prototype.addTrack=function(m,g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const E=[].slice.call(arguments,1);if(E.length!==1||!E[0].getTracks().find(C=>C===m))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(C=>C.track===m))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const y=this._streams[g.id];if(y)y.addTrack(m),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const C=new i.MediaStream([m]);this._streams[g.id]=C,this._reverseStreams[C.id]=g,this.addStream(C)}return this.getSenders().find(C=>C.track===m)},["createOffer","createAnswer"].forEach(function(m){const g=i.RTCPeerConnection.prototype[m],E={[m](){const y=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[C=>{const I=l(this,C);y[0].apply(null,[I])},C=>{y[1]&&y[1].apply(null,C)},arguments[2]]):g.apply(this,arguments).then(C=>l(this,C))}};i.RTCPeerConnection.prototype[m]=E[m]});const u=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(m,g){let E=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(y=>{const C=m._reverseStreams[y],I=m._streams[C.id];E=E.replace(new RegExp(C.id,"g"),I.id)}),new RTCSessionDescription({type:g.type,sdp:E})}(this,arguments[0]),u.apply(this,arguments)):u.apply(this,arguments)};const p=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const m=p.get.apply(this);return m.type===""?m:l(this,m)}}),i.RTCPeerConnection.prototype.removeTrack=function(m){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!m._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(m._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let g;this._streams=this._streams||{},Object.keys(this._streams).forEach(E=>{this._streams[E].getTracks().find(y=>m.track===y)&&(g=this._streams[E])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(m.track),this.dispatchEvent(new Event("negotiationneeded")))}}function W_(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const s=i.RTCPeerConnection.prototype[n],a={[n](){return arguments[0]=new(n==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};i.RTCPeerConnection.prototype[n]=a[n]})}function Wh(i,e){Qc(i,"negotiationneeded",n=>{const s=n.target;if(!(e.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")||s.signalingState==="stable")return n})}var SS=Object.freeze({__proto__:null,fixNegotiationNeeded:Wh,shimAddTrackRemoveTrack:yS,shimAddTrackRemoveTrackWithNative:vS,shimGetDisplayMedia:function(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(typeof e=="function"?i.navigator.mediaDevices.getDisplayMedia=function(n){return e(n).then(s=>{const a=n.video&&n.video.width,l=n.video&&n.video.height,u=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:u||3}},a&&(n.video.mandatory.maxWidth=a),l&&(n.video.mandatory.maxHeight=l),i.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:gS,shimGetStats:_S,shimGetUserMedia:pS,shimMediaStream:fS,shimOnTrack:mS,shimPeerConnection:W_,shimSenderReceiverGetStats:ES});function bS(i,e){const n=i&&i.navigator,s=i&&i.MediaStreamTrack;if(n.getUserMedia=function(a,l,u){Ef("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(a).then(l,u)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const a=function(u,p,m){p in u&&!(m in u)&&(u[m]=u[p],delete u[p])},l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),a(u.audio,"autoGainControl","mozAutoGainControl"),a(u.audio,"noiseSuppression","mozNoiseSuppression")),l(u)},s&&s.prototype.getSettings){const u=s.prototype.getSettings;s.prototype.getSettings=function(){const p=u.apply(this,arguments);return a(p,"mozAutoGainControl","autoGainControl"),a(p,"mozNoiseSuppression","noiseSuppression"),p}}if(s&&s.prototype.applyConstraints){const u=s.prototype.applyConstraints;s.prototype.applyConstraints=function(p){return this.kind==="audio"&&typeof p=="object"&&(p=JSON.parse(JSON.stringify(p)),a(p,"autoGainControl","mozAutoGainControl"),a(p,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[p])}}}}function TS(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function $_(i,e){if(typeof i!="object"||!i.RTCPeerConnection&&!i.mozRTCPeerConnection)return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const l=i.RTCPeerConnection.prototype[a],u={[a](){return arguments[0]=new(a==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};i.RTCPeerConnection.prototype[a]=u[a]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[a,l,u]=arguments;return s.apply(this,[a||null]).then(p=>{if(e.version<53&&!l)try{p.forEach(m=>{m.type=n[m.type]||m.type})}catch(m){if(m.name!=="TypeError")throw m;p.forEach((g,E)=>{p.set(E,Object.assign({},g,{type:n[g.type]||g.type}))})}return p}).then(l,u)}}function CS(i){if(typeof i!="object"||!i.RTCPeerConnection||!i.RTCRtpSender||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const e=i.RTCPeerConnection.prototype.getSenders;e&&(i.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(a=>a._pc=this),s});const n=i.RTCPeerConnection.prototype.addTrack;n&&(i.RTCPeerConnection.prototype.addTrack=function(){const s=n.apply(this,arguments);return s._pc=this,s}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function wS(i){if(typeof i!="object"||!i.RTCPeerConnection||!i.RTCRtpSender||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const e=i.RTCPeerConnection.prototype.getReceivers;e&&(i.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(s=>s._pc=this),n}),Qc(i,"track",n=>(n.receiver._pc=n.srcElement,n)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function RS(i){i.RTCPeerConnection&&!("removeStream"in i.RTCPeerConnection.prototype)&&(i.RTCPeerConnection.prototype.removeStream=function(e){Ef("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&e.getTracks().includes(n.track)&&this.removeTrack(n)})})}function IS(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function G_(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype.addTransceiver;e&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const s=n.length>0;s&&n.forEach(l=>{if("rid"in l&&!/^[a-z0-9]{0,16}$/i.test(l.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in l&&!(parseFloat(l.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in l&&!(parseFloat(l.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(s){const{sender:l}=a,u=l.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=n,l.sendEncodings=n,this.setParametersPromises.push(l.setParameters(u).then(()=>{delete l.sendEncodings}).catch(()=>{delete l.sendEncodings})))}return a})}function H_(i){if(typeof i!="object"||!i.RTCRtpSender)return;const e=i.RTCRtpSender.prototype.getParameters;e&&(i.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function z_(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function $h(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Hl=Object.freeze({__proto__:null,shimAddTransceiver:G_,shimCreateAnswer:$h,shimCreateOffer:z_,shimGetDisplayMedia:function(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,i.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:H_,shimGetUserMedia:bS,shimOnTrack:TS,shimPeerConnection:$_,shimRTCDataChannel:IS,shimReceiverGetStats:wS,shimRemoveStream:RS,shimSenderGetStats:CS});function Gh(i){if(typeof i=="object"&&i.RTCPeerConnection){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(s=>e.call(this,s,n)),n.getVideoTracks().forEach(s=>e.call(this,s,n))},i.RTCPeerConnection.prototype.addTrack=function(n,...s){return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(e);if(n===-1)return;this._localStreams.splice(n,1);const s=e.getTracks();this.getSenders().forEach(a=>{s.includes(a.track)&&this.removeTrack(a)})})}}function K_(i){if(typeof i=="object"&&i.RTCPeerConnection&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const l=new Event("addstream");l.stream=a,this.dispatchEvent(l)})})}});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(a=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(a)>=0)return;n._remoteStreams.push(a);const l=new Event("addstream");l.stream=a,n.dispatchEvent(l)})}),e.apply(n,arguments)}}}function zl(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype,n=e.createOffer,s=e.createAnswer,a=e.setLocalDescription,l=e.setRemoteDescription,u=e.addIceCandidate;e.createOffer=function(m,g){const E=arguments.length>=2?arguments[2]:arguments[0],y=n.apply(this,[E]);return g?(y.then(m,g),Promise.resolve()):y},e.createAnswer=function(m,g){const E=arguments.length>=2?arguments[2]:arguments[0],y=s.apply(this,[E]);return g?(y.then(m,g),Promise.resolve()):y};let p=function(m,g,E){const y=a.apply(this,[m]);return E?(y.then(g,E),Promise.resolve()):y};e.setLocalDescription=p,p=function(m,g,E){const y=l.apply(this,[m]);return E?(y.then(g,E),Promise.resolve()):y},e.setRemoteDescription=p,p=function(m,g,E){const y=u.apply(this,[m]);return E?(y.then(g,E),Promise.resolve()):y},e.addIceCandidate=p}function Y_(i){const e=i&&i.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,s=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=a=>s(q_(a))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,s,a){e.mediaDevices.getUserMedia(n).then(s,a)}).bind(e))}function q_(i){return i&&i.video!==void 0?Object.assign({},i,{video:dS(i.video)}):i}function AS(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection;i.RTCPeerConnection=function(n,s){if(n&&n.iceServers){const a=[];for(let l=0;l<n.iceServers.length;l++){let u=n.iceServers[l];!u.hasOwnProperty("urls")&&u.hasOwnProperty("url")?(Ef("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,a.push(u)):a.push(n.iceServers[l])}n.iceServers=a}return new e(n,s)},i.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get:()=>e.generateCertificate})}function OS(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function NS(i){const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(n){if(n){n.offerToReceiveAudio!==void 0&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const s=this.getTransceivers().find(l=>l.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):n.offerToReceiveAudio!==!0||s||this.addTransceiver("audio",{direction:"recvonly"}),n.offerToReceiveVideo!==void 0&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const a=this.getTransceivers().find(l=>l.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):n.offerToReceiveVideo!==!0||a||this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function kS(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}var xS=Object.freeze({__proto__:null,shimAudioContext:kS,shimCallbacksAPI:zl,shimConstraints:q_,shimCreateOfferLegacy:NS,shimGetUserMedia:Y_,shimLocalStreamsAPI:Gh,shimRTCIceServerUrls:AS,shimRemoteStreamsAPI:K_,shimTrackEventTransceiver:OS}),PS={exports:{}};(function(i){const e={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(s=>s.trim())},e.splitSections=function(n){return n.split(`
m=`).map((s,a)=>(a>0?"m="+s:s).trim()+`\r
`)},e.getDescription=function(n){const s=e.splitSections(n);return s&&s[0]},e.getMediaSections=function(n){const s=e.splitSections(n);return s.shift(),s},e.matchPrefix=function(n,s){return e.splitLines(n).filter(a=>a.indexOf(s)===0)},e.parseCandidate=function(n){let s;s=n.indexOf("a=candidate:")===0?n.substring(12).split(" "):n.substring(10).split(" ");const a={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let l=8;l<s.length;l+=2)switch(s[l]){case"raddr":a.relatedAddress=s[l+1];break;case"rport":a.relatedPort=parseInt(s[l+1],10);break;case"tcptype":a.tcpType=s[l+1];break;case"ufrag":a.ufrag=s[l+1],a.usernameFragment=s[l+1];break;default:a[s[l]]===void 0&&(a[s[l]]=s[l+1])}return a},e.writeCandidate=function(n){const s=[];s.push(n.foundation);const a=n.component;a==="rtp"?s.push(1):a==="rtcp"?s.push(2):s.push(a),s.push(n.protocol.toUpperCase()),s.push(n.priority),s.push(n.address||n.ip),s.push(n.port);const l=n.type;return s.push("typ"),s.push(l),l!=="host"&&n.relatedAddress&&n.relatedPort&&(s.push("raddr"),s.push(n.relatedAddress),s.push("rport"),s.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(s.push("ufrag"),s.push(n.usernameFragment||n.ufrag)),"candidate:"+s.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let s=n.substring(9).split(" ");const a={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),a.name=s[0],a.clockRate=parseInt(s[1],10),a.channels=s.length===3?parseInt(s[2],10):1,a.numChannels=a.channels,a},e.writeRtpMap=function(n){let s=n.payloadType;n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType);const a=n.channels||n.numChannels||1;return"a=rtpmap:"+s+" "+n.name+"/"+n.clockRate+(a!==1?"/"+a:"")+`\r
`},e.parseExtmap=function(n){const s=n.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const s={};let a;const l=n.substring(n.indexOf(" ")+1).split(";");for(let u=0;u<l.length;u++)a=l[u].trim().split("="),s[a[0].trim()]=a[1];return s},e.writeFmtp=function(n){let s="",a=n.payloadType;if(n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const l=[];Object.keys(n.parameters).forEach(u=>{n.parameters[u]!==void 0?l.push(u+"="+n.parameters[u]):l.push(u)}),s+="a=fmtp:"+a+" "+l.join(";")+`\r
`}return s},e.parseRtcpFb=function(n){const s=n.substring(n.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},e.writeRtcpFb=function(n){let s="",a=n.payloadType;return n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(l=>{s+="a=rtcp-fb:"+a+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),s},e.parseSsrcMedia=function(n){const s=n.indexOf(" "),a={ssrc:parseInt(n.substring(7,s),10)},l=n.indexOf(":",s);return l>-1?(a.attribute=n.substring(s+1,l),a.value=n.substring(l+1)):a.attribute=n.substring(s+1),a},e.parseSsrcGroup=function(n){const s=n.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(a=>parseInt(a,10))}},e.getMid=function(n){const s=e.matchPrefix(n,"a=mid:")[0];if(s)return s.substring(6)},e.parseFingerprint=function(n){const s=n.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},e.getDtlsParameters=function(n,s){return{role:"auto",fingerprints:e.matchPrefix(n+s,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,s){let a="a=setup:"+s+`\r
`;return n.fingerprints.forEach(l=>{a+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),a},e.parseCryptoLine=function(n){const s=n.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const s=n.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,s){return e.matchPrefix(n+s,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,s){const a=e.matchPrefix(n+s,"a=ice-ufrag:")[0],l=e.matchPrefix(n+s,"a=ice-pwd:")[0];return a&&l?{usernameFragment:a.substring(12),password:l.substring(10)}:null},e.writeIceParameters=function(n){let s="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(s+=`a=ice-lite\r
`),s},e.parseRtpParameters=function(n){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(n)[0].split(" ");s.profile=a[2];for(let u=3;u<a.length;u++){const p=a[u],m=e.matchPrefix(n,"a=rtpmap:"+p+" ")[0];if(m){const g=e.parseRtpMap(m),E=e.matchPrefix(n,"a=fmtp:"+p+" ");switch(g.parameters=E.length?e.parseFmtp(E[0]):{},g.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+p+" ").map(e.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase())}}}e.matchPrefix(n,"a=extmap:").forEach(u=>{s.headerExtensions.push(e.parseExtmap(u))});const l=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return s.codecs.forEach(u=>{l.forEach(p=>{u.rtcpFeedback.find(m=>m.type===p.type&&m.parameter===p.parameter)||u.rtcpFeedback.push(p)})}),s},e.writeRtpDescription=function(n,s){let a="";a+="m="+n+" ",a+=s.codecs.length>0?"9":"0",a+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",a+=s.codecs.map(u=>u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(u=>{a+=e.writeRtpMap(u),a+=e.writeFmtp(u),a+=e.writeRtcpFb(u)});let l=0;return s.codecs.forEach(u=>{u.maxptime>l&&(l=u.maxptime)}),l>0&&(a+="a=maxptime:"+l+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(u=>{a+=e.writeExtmap(u)}),a},e.parseRtpEncodingParameters=function(n){const s=[],a=e.parseRtpParameters(n),l=a.fecMechanisms.indexOf("RED")!==-1,u=a.fecMechanisms.indexOf("ULPFEC")!==-1,p=e.matchPrefix(n,"a=ssrc:").map(C=>e.parseSsrcMedia(C)).filter(C=>C.attribute==="cname"),m=p.length>0&&p[0].ssrc;let g;const E=e.matchPrefix(n,"a=ssrc-group:FID").map(C=>C.substring(17).split(" ").map(I=>parseInt(I,10)));E.length>0&&E[0].length>1&&E[0][0]===m&&(g=E[0][1]),a.codecs.forEach(C=>{if(C.name.toUpperCase()==="RTX"&&C.parameters.apt){let I={ssrc:m,codecPayloadType:parseInt(C.parameters.apt,10)};m&&g&&(I.rtx={ssrc:g}),s.push(I),l&&(I=JSON.parse(JSON.stringify(I)),I.fec={ssrc:m,mechanism:u?"red+ulpfec":"red"},s.push(I))}}),s.length===0&&m&&s.push({ssrc:m});let y=e.matchPrefix(n,"b=");return y.length&&(y=y[0].indexOf("b=TIAS:")===0?parseInt(y[0].substring(7),10):y[0].indexOf("b=AS:")===0?1e3*parseInt(y[0].substring(5),10)*.95-16e3:void 0,s.forEach(C=>{C.maxBitrate=y})),s},e.parseRtcpParameters=function(n){const s={},a=e.matchPrefix(n,"a=ssrc:").map(p=>e.parseSsrcMedia(p)).filter(p=>p.attribute==="cname")[0];a&&(s.cname=a.value,s.ssrc=a.ssrc);const l=e.matchPrefix(n,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=l.length===0;const u=e.matchPrefix(n,"a=rtcp-mux");return s.mux=u.length>0,s},e.writeRtcpParameters=function(n){let s="";return n.reducedSize&&(s+=`a=rtcp-rsize\r
`),n.mux&&(s+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(s+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),s},e.parseMsid=function(n){let s;const a=e.matchPrefix(n,"a=msid:");if(a.length===1)return s=a[0].substring(7).split(" "),{stream:s[0],track:s[1]};const l=e.matchPrefix(n,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="msid");return l.length>0?(s=l[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},e.parseSctpDescription=function(n){const s=e.parseMLine(n),a=e.matchPrefix(n,"a=max-message-size:");let l;a.length>0&&(l=parseInt(a[0].substring(19),10)),isNaN(l)&&(l=65536);const u=e.matchPrefix(n,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substring(12),10),protocol:s.fmt,maxMessageSize:l};const p=e.matchPrefix(n,"a=sctpmap:");if(p.length>0){const m=p[0].substring(10).split(" ");return{port:parseInt(m[0],10),protocol:m[1],maxMessageSize:l}}},e.writeSctpDescription=function(n,s){let a=[];return a=n.protocol!=="DTLS/SCTP"?["m="+n.kind+" 9 "+n.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:["m="+n.kind+" 9 "+n.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&a.push("a=max-message-size:"+s.maxMessageSize+`\r
`),a.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,s,a){let l;const u=s!==void 0?s:2;return l=n||e.generateSessionId(),`v=0\r
o=`+(a||"thisisadapterortc")+" "+l+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,s){const a=e.splitLines(n);for(let l=0;l<a.length;l++)switch(a[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[l].substring(2)}return s?e.getDirection(s):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const s=e.splitLines(n)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},e.parseOLine=function(n){const s=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const s=e.splitLines(n);for(let a=0;a<s.length;a++)if(s[a].length<2||s[a].charAt(1)!=="=")return!1;return!0},i.exports=e})(PS);var DS=PS.exports,eu=d(DS),XA=o({__proto__:null,default:eu},[DS]);function vf(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const e=i.RTCIceCandidate;i.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&((n=JSON.parse(JSON.stringify(n))).candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const s=new e(n),a=eu.parseCandidate(n.candidate),l=Object.assign(s,a);return l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}},l}return new e(n)},i.RTCIceCandidate.prototype=e.prototype,Qc(i,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new i.RTCIceCandidate(n.candidate),writable:"false"}),n))}function X_(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||Qc(i,"icecandidate",e=>{if(e.candidate){const n=eu.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function yf(i,e){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const n=function(p){if(!p||!p.sdp)return!1;const m=eu.splitSections(p.sdp);return m.shift(),m.some(g=>{const E=eu.parseMLine(g);return E&&E.kind==="application"&&E.protocol.indexOf("SCTP")!==-1})},s=function(p){const m=p.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(m===null||m.length<2)return-1;const g=parseInt(m[1],10);return g!=g?-1:g},a=function(p){let m=65536;return e.browser==="firefox"&&(m=e.version<57?p===-1?16384:2147483637:e.version<60?e.version===57?65535:65536:2147483637),m},l=function(p,m){let g=65536;e.browser==="firefox"&&e.version===57&&(g=65535);const E=eu.matchPrefix(p.sdp,"a=max-message-size:");return E.length>0?g=parseInt(E[0].substr(19),10):e.browser==="firefox"&&m!==-1&&(g=2147483637),g},u=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:p}=this.getConfiguration();p==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const p=s(arguments[0]),m=a(p),g=l(arguments[0],p);let E;E=m===0&&g===0?Number.POSITIVE_INFINITY:m===0||g===0?Math.max(m,g):Math.min(m,g);const y={};Object.defineProperty(y,"maxMessageSize",{get:()=>E}),this._sctp=y}return u.apply(this,arguments)}}function Sf(i){if(!i.RTCPeerConnection||!("createDataChannel"in i.RTCPeerConnection.prototype))return;function e(s,a){const l=s.send;s.send=function(){const u=arguments[0],p=u.length||u.size||u.byteLength;if(s.readyState==="open"&&a.sctp&&p>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const n=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const s=n.apply(this,arguments);return e(s,this),s},Qc(i,"datachannel",s=>(e(s.channel,s.target),s))}function J_(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const e=i.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const s=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const l=a.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const u=new Event("connectionstatechange",a);l.dispatchEvent(u)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Q_(i,e){if(!i.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=s.sdp.split(`
`).filter(l=>l.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&s instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:s.type,sdp:a}):s.sdp=a}return n.apply(this,arguments)}}function bf(i,e){if(!i.RTCPeerConnection||!i.RTCPeerConnection.prototype)return;const n=i.RTCPeerConnection.prototype.addIceCandidate;n&&n.length!==0&&(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Tf(i,e){if(!i.RTCPeerConnection||!i.RTCPeerConnection.prototype)return;const n=i.RTCPeerConnection.prototype.setLocalDescription;n&&n.length!==0&&(i.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return n.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer"}return s.sdp||s.type!=="offer"&&s.type!=="answer"?n.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>n.apply(this,[a]))})}var JA=Object.freeze({__proto__:null,removeExtmapAllowMixed:Q_,shimAddIceCandidateNullOrEmpty:bf,shimConnectionState:J_,shimMaxMessageSize:yf,shimParameterlessSetLocalDescription:Tf,shimRTCIceCandidate:vf,shimRTCIceCandidateRelayProtocol:X_,shimSendThrowTypeError:Sf});(function({window:i}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=cS,s=function(l){const u={browser:null,version:null};if(l===void 0||!l.navigator)return u.browser="Not a browser.",u;const{navigator:p}=l;if(p.mozGetUserMedia)u.browser="firefox",u.version=_f(p.userAgent,/Firefox\/(\d+)\./,1);else if(p.webkitGetUserMedia||l.isSecureContext===!1&&l.webkitRTCPeerConnection)u.browser="chrome",u.version=_f(p.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!l.RTCPeerConnection||!p.userAgent.match(/AppleWebKit\/(\d+)\./))return u.browser="Not a supported browser.",u;u.browser="safari",u.version=_f(p.userAgent,/AppleWebKit\/(\d+)\./,1),u.supportsUnifiedPlan=l.RTCRtpTransceiver&&"currentDirection"in l.RTCRtpTransceiver.prototype}return u}(i),a={browserDetails:s,commonShim:JA,extractVersion:_f,disableLog:aS,disableWarnings:qA,sdp:XA};switch(s.browser){case"chrome":if(!SS||!W_||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),a;if(s.version===null)return n("Chrome shim can not determine version, not shimming."),a;n("adapter.js shimming chrome."),a.browserShim=SS,bf(i,s),Tf(i),pS(i,s),fS(i),W_(i,s),mS(i),yS(i,s),gS(i),_S(i),ES(i),Wh(i,s),vf(i),X_(i),J_(i),yf(i,s),Sf(i),Q_(i,s);break;case"firefox":if(!Hl||!$_||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),a;n("adapter.js shimming firefox."),a.browserShim=Hl,bf(i,s),Tf(i),bS(i,s),$_(i,s),TS(i),RS(i),CS(i),wS(i),IS(i),G_(i),H_(i),z_(i),$h(i),vf(i),J_(i),yf(i,s),Sf(i);break;case"safari":if(!xS||!e.shimSafari)return n("Safari shim is not included in this adapter release."),a;n("adapter.js shimming safari."),a.browserShim=xS,bf(i,s),Tf(i),AS(i),NS(i),zl(i),Gh(i),K_(i),OS(i),Y_(i),kS(i),vf(i),X_(i),yf(i,s),Sf(i),Q_(i,s);break;default:n("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var LS={exports:{}},QA=On,ZA=Pe,MS=_o.f;QA({target:"Object",stat:!0,forced:Object.defineProperty!==MS,sham:!ZA},{defineProperty:MS});var Cf=mr.Object,e1=LS.exports=function(i,e,n){return Cf.defineProperty(i,e,n)};Cf.defineProperty.sham&&(e1.sham=!0);var t1=d(LS.exports),n1=ie,Hh=Array.isArray||function(i){return n1(i)=="Array"},wf=TypeError,r1=go,i1=_o,s1=at,Z_=function(i,e,n){var s=r1(e);s in i?i1.f(i,s,s1(0,n)):i[s]=n},o1=we,eE=Mh,US=w(Function.toString);o1(eE.inspectSource)||(eE.inspectSource=function(i){return US(i)});var jS=eE.inspectSource,a1=w,FS=h,VS=we,c1=Xc,l1=jS,dc=function(){},BS=[],WS=Yn("Reflect","construct"),tE=/^\s*(?:class|function)\b/,d1=a1(tE.exec),Qe=!tE.exec(dc),zh=function(i){if(!VS(i))return!1;try{return WS(dc,BS,i),!0}catch{return!1}},$S=function(i){if(!VS(i))return!1;switch(c1(i)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Qe||!!d1(tE,l1(i))}catch{return!0}};$S.sham=!0;var Rf=!WS||FS(function(){var i;return zh(zh.call)||!zh(Object)||!zh(function(){i=!0})||i})?$S:zh,Un=Hh,If=Rf,GS=Ft,nE=gr("species"),HS=Array,u1=function(i){var e;return Un(i)&&(e=i.constructor,(If(e)&&(e===HS||Un(e.prototype))||GS(e)&&(e=e[nE])===null)&&(e=void 0)),e===void 0?HS:e},zS=function(i,e){return new(u1(i))(e===0?0:e)},h1=h,p1=Tn,uc=gr("species"),f1=On,KS=h,m1=Hh,g1=Ft,YS=cs,_1=Yc,rE=function(i){if(i>9007199254740991)throw wf("Maximum allowed index exceeded");return i},Af=Z_,E1=zS,hc=function(i){return p1>=51||!h1(function(){var e=[];return(e.constructor={})[uc]=function(){return{foo:1}},e[i](Boolean).foo!==1})},qS=Tn,XS=gr("isConcatSpreadable"),v1=qS>=51||!KS(function(){var i=[];return i[XS]=!1,i.concat()[0]!==i}),y1=function(i){if(!g1(i))return!1;var e=i[XS];return e!==void 0?!!e:m1(i)};f1({target:"Array",proto:!0,arity:1,forced:!v1||!hc("concat")},{concat:function(i){var e,n,s,a,l,u=YS(this),p=E1(u,0),m=0;for(e=-1,s=arguments.length;e<s;e++)if(y1(l=e===-1?u:arguments[e]))for(a=_1(l),rE(m+a),n=0;n<a;n++,m++)n in l&&Af(p,m,l[n]);else rE(m+1),Af(p,m++,l);return p.length=m,p}});var iE={},Of={},sE=Ei,S1=En,b1=P_.indexOf,T1=Of,JS=w([].push),QS=function(i,e){var n,s=S1(i),a=0,l=[];for(n in s)!sE(T1,n)&&sE(s,n)&&JS(l,n);for(;e.length>a;)sE(s,n=e[a++])&&(~b1(l,n)||JS(l,n));return l},pc=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],C1=QS,w1=pc,Nf=Object.keys||function(i){return C1(i,w1)},R1=Pe,I1=w_,A1=_o,O1=Js,N1=En,fc=Nf;iE.f=R1&&!I1?Object.defineProperties:function(i,e){O1(i);for(var n,s=N1(e),a=fc(e),l=a.length,u=0;l>u;)A1.f(i,n=a[u++],s[n]);return i};var mc,ZS=Yn("document","documentElement"),k1=dt,eb=cc("keys"),kf=function(i){return eb[i]||(eb[i]=k1(i))},x1=Js,oE=iE,Kl=pc,xf=Of,Nn=ZS,S=b_,O="prototype",W="script",Y=kf("IE_PROTO"),te=function(){},ve=function(i){return"<"+W+">"+i+"</"+W+">"},Le=function(i){i.write(ve("")),i.close();var e=i.parentWindow.Object;return i=null,e},ut=function(){try{mc=new ActiveXObject("htmlfile")}catch{}var i,e,n;ut=typeof document<"u"?document.domain&&mc?Le(mc):(e=S("iframe"),n="java"+W+":",e.style.display="none",Nn.appendChild(e),e.src=String(n),(i=e.contentWindow.document).open(),i.write(ve("document.F=Object")),i.close(),i.F):Le(mc);for(var s=Kl.length;s--;)delete ut[O][Kl[s]];return ut()};xf[Y]=!0;var Vt=Object.create||function(i,e){var n;return i!==null?(te[O]=x1(i),n=new te,te[O]=null,n[Y]=i):n=ut(),e===void 0?n:oE.f(n,e)},yn={},ys=QS,gc=pc.concat("length","prototype");yn.f=Object.getOwnPropertyNames||function(i){return ys(i,gc)};var _c={},DU=Z0,oJ=Yc,aJ=Z_,cJ=Array,lJ=Math.max,P1=function(i,e,n){for(var s=oJ(i),a=DU(e,s),l=DU(n===void 0?s:n,s),u=cJ(lJ(l-a,0)),p=0;a<l;a++,p++)aJ(u,p,i[a]);return u.length=p,u},dJ=ie,uJ=En,LU=yn.f,hJ=P1,MU=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];_c.f=function(i){return MU&&dJ(i)=="Window"?function(e){try{return LU(e)}catch{return hJ(MU)}}(i):LU(uJ(i))};var aE={};aE.f=Object.getOwnPropertySymbols;var pJ=ls,tu=function(i,e,n,s){return s&&s.enumerable?i[e]=n:pJ(i,e,n),i},fJ=_o,tb=function(i,e,n){return fJ.f(i,e,n)},Pf={},mJ=gr;Pf.f=mJ;var nb,cE,rb,UU=mr,gJ=Ei,_J=Pf,EJ=_o.f,wi=function(i){var e=UU.Symbol||(UU.Symbol={});gJ(e,i)||EJ(e,i,{value:_J.f(i)})},vJ=Fe,yJ=Yn,SJ=gr,bJ=tu,jU=function(){var i=yJ("Symbol"),e=i&&i.prototype,n=e&&e.valueOf,s=SJ("toPrimitive");e&&!e[s]&&bJ(e,s,function(a){return vJ(n,this)},{arity:1})},TJ=Xc,CJ=D_?{}.toString:function(){return"[object "+TJ(this)+"]"},wJ=D_,RJ=_o.f,IJ=ls,AJ=Ei,OJ=CJ,FU=gr("toStringTag"),nu=function(i,e,n,s){if(i){var a=n?i:i.prototype;AJ(a,FU)||RJ(a,FU,{configurable:!0,value:e}),s&&!wJ&&IJ(a,"toString",OJ)}},NJ=we,VU=V.WeakMap,kJ=NJ(VU)&&/native code/.test(String(VU)),BU=V,xJ=Ft,PJ=ls,D1=Ei,L1=Mh,DJ=kf,LJ=Of,WU="Object already initialized",M1=BU.TypeError,MJ=BU.WeakMap;if(kJ||L1.state){var Zc=L1.state||(L1.state=new MJ);Zc.get=Zc.get,Zc.has=Zc.has,Zc.set=Zc.set,nb=function(i,e){if(Zc.has(i))throw M1(WU);return e.facade=i,Zc.set(i,e),e},cE=function(i){return Zc.get(i)||{}},rb=function(i){return Zc.has(i)}}else{var Df=DJ("state");LJ[Df]=!0,nb=function(i,e){if(D1(i,Df))throw M1(WU);return e.facade=i,PJ(i,Df,e),e},cE=function(i){return D1(i,Df)?i[Df]:{}},rb=function(i){return D1(i,Df)}}var Lf={set:nb,get:cE,has:rb,enforce:function(i){return rb(i)?cE(i):nb(i,{})},getterFor:function(i){return function(e){var n;if(!xJ(e)||(n=cE(e)).type!==i)throw M1("Incompatible receiver, "+i+" required");return n}}},UJ=Sa,jJ=sn,FJ=cs,VJ=Yc,BJ=zS,$U=w([].push),ru=function(i){var e=i==1,n=i==2,s=i==3,a=i==4,l=i==6,u=i==7,p=i==5||l;return function(m,g,E,y){for(var C,I,j=FJ(m),P=jJ(j),U=UJ(g,E),q=VJ(P),J=0,se=y||BJ,he=e?se(m,q):n||u?se(m,0):void 0;q>J;J++)if((p||J in P)&&(I=U(C=P[J],J,j),i))if(e)he[J]=I;else if(I)switch(i){case 3:return!0;case 5:return C;case 6:return J;case 2:$U(he,C)}else switch(i){case 4:return!1;case 7:$U(he,C)}return l?-1:s||a?a:he}},WJ={forEach:ru(0),map:ru(1),filter:ru(2),some:ru(3),every:ru(4),find:ru(5),findIndex:ru(6),filterReject:ru(7)},ib=On,U1=V,j1=Fe,$J=w,Mf=Pe,Uf=Ho,GJ=h,ds=Ei,HJ=x,F1=Js,sb=En,V1=go,zJ=Ds,B1=at,lE=Vt,GU=Nf,KJ=yn,HU=_c,YJ=aE,zU=Re,KU=_o,qJ=iE,YU=Ye,qU=tu,XJ=tb,W1=cc,XU=Of,JU=dt,JJ=gr,QJ=Pf,ZJ=wi,eQ=jU,tQ=nu,QU=Lf,ob=WJ.forEach,Eo=kf("hidden"),ab="Symbol",dE="prototype",nQ=QU.set,ZU=QU.getterFor(ab),Ec=Object[dE],Kh=U1.Symbol,cb=Kh&&Kh[dE],rQ=U1.TypeError,$1=U1.QObject,ej=zU.f,Yh=KU.f,tj=HU.f,iQ=YU.f,nj=$J([].push),Yl=W1("symbols"),uE=W1("op-symbols"),sQ=W1("wks"),G1=!$1||!$1[dE]||!$1[dE].findChild,H1=Mf&&GJ(function(){return lE(Yh({},"a",{get:function(){return Yh(this,"a",{value:7}).a}})).a!=7})?function(i,e,n){var s=ej(Ec,e);s&&delete Ec[e],Yh(i,e,n),s&&i!==Ec&&Yh(Ec,e,s)}:Yh,z1=function(i,e){var n=Yl[i]=lE(cb);return nQ(n,{type:ab,tag:i,description:e}),Mf||(n.description=e),n},lb=function(i,e,n){i===Ec&&lb(uE,e,n),F1(i);var s=V1(e);return F1(n),ds(Yl,s)?(n.enumerable?(ds(i,Eo)&&i[Eo][s]&&(i[Eo][s]=!1),n=lE(n,{enumerable:B1(0,!1)})):(ds(i,Eo)||Yh(i,Eo,B1(1,{})),i[Eo][s]=!0),H1(i,s,n)):Yh(i,s,n)},K1=function(i,e){F1(i);var n=sb(e),s=GU(n).concat(oj(n));return ob(s,function(a){Mf&&!j1(rj,n,a)||lb(i,a,n[a])}),i},rj=function(i){var e=V1(i),n=j1(iQ,this,e);return!(this===Ec&&ds(Yl,e)&&!ds(uE,e))&&(!(n||!ds(this,e)||!ds(Yl,e)||ds(this,Eo)&&this[Eo][e])||n)},ij=function(i,e){var n=sb(i),s=V1(e);if(n!==Ec||!ds(Yl,s)||ds(uE,s)){var a=ej(n,s);return!a||!ds(Yl,s)||ds(n,Eo)&&n[Eo][s]||(a.enumerable=!0),a}},sj=function(i){var e=tj(sb(i)),n=[];return ob(e,function(s){ds(Yl,s)||ds(XU,s)||nj(n,s)}),n},oj=function(i){var e=i===Ec,n=tj(e?uE:sb(i)),s=[];return ob(n,function(a){!ds(Yl,a)||e&&!ds(Ec,a)||nj(s,Yl[a])}),s};Uf||(Kh=function(){if(HJ(cb,this))throw rQ("Symbol is not a constructor");var i=arguments.length&&arguments[0]!==void 0?zJ(arguments[0]):void 0,e=JU(i),n=function(s){this===Ec&&j1(n,uE,s),ds(this,Eo)&&ds(this[Eo],e)&&(this[Eo][e]=!1),H1(this,e,B1(1,s))};return Mf&&G1&&H1(Ec,e,{configurable:!0,set:n}),z1(e,i)},qU(cb=Kh[dE],"toString",function(){return ZU(this).tag}),qU(Kh,"withoutSetter",function(i){return z1(JU(i),i)}),YU.f=rj,KU.f=lb,qJ.f=K1,zU.f=ij,KJ.f=HU.f=sj,YJ.f=oj,QJ.f=function(i){return z1(JJ(i),i)},Mf&&XJ(cb,"description",{configurable:!0,get:function(){return ZU(this).description}})),ib({global:!0,constructor:!0,wrap:!0,forced:!Uf,sham:!Uf},{Symbol:Kh}),ob(GU(sQ),function(i){ZJ(i)}),ib({target:ab,stat:!0,forced:!Uf},{useSetter:function(){G1=!0},useSimple:function(){G1=!1}}),ib({target:"Object",stat:!0,forced:!Uf,sham:!Mf},{create:function(i,e){return e===void 0?lE(i):K1(lE(i),e)},defineProperty:lb,defineProperties:K1,getOwnPropertyDescriptor:ij}),ib({target:"Object",stat:!0,forced:!Uf},{getOwnPropertyNames:sj}),eQ(),tQ(Kh,ab),XU[Eo]=!0;var aj=Ho&&!!Symbol.for&&!!Symbol.keyFor,oQ=On,aQ=Yn,cQ=Ei,lQ=Ds,cj=cc,dQ=aj,Y1=cj("string-to-symbol-registry"),uQ=cj("symbol-to-string-registry");oQ({target:"Symbol",stat:!0,forced:!dQ},{for:function(i){var e=lQ(i);if(cQ(Y1,e))return Y1[e];var n=aQ("Symbol")(e);return Y1[e]=n,uQ[n]=e,n}});var hQ=On,pQ=Ei,fQ=lt,mQ=Gc,gQ=aj,lj=cc("symbol-to-string-registry");hQ({target:"Symbol",stat:!0,forced:!gQ},{keyFor:function(i){if(!fQ(i))throw TypeError(mQ(i)+" is not a symbol");if(pQ(lj,i))return lj[i]}});var dj=w([].slice),uj=Hh,_Q=we,hj=ie,EQ=Ds,pj=w([].push),vQ=On,fj=Yn,mj=L,yQ=Fe,hE=w,gj=h,_j=we,Ej=lt,vj=dj,SQ=function(i){if(_Q(i))return i;if(uj(i)){for(var e=i.length,n=[],s=0;s<e;s++){var a=i[s];typeof a=="string"?pj(n,a):typeof a!="number"&&hj(a)!="Number"&&hj(a)!="String"||pj(n,EQ(a))}var l=n.length,u=!0;return function(p,m){if(u)return u=!1,m;if(uj(this))return m;for(var g=0;g<l;g++)if(n[g]===p)return m}}},bQ=Ho,TQ=String,iu=fj("JSON","stringify"),db=hE(/./.exec),yj=hE("".charAt),CQ=hE("".charCodeAt),wQ=hE("".replace),RQ=hE(1 .toString),IQ=/[\uD800-\uDFFF]/g,Sj=/^[\uD800-\uDBFF]$/,bj=/^[\uDC00-\uDFFF]$/,Tj=!bQ||gj(function(){var i=fj("Symbol")();return iu([i])!="[null]"||iu({a:i})!="{}"||iu(Object(i))!="{}"}),Cj=gj(function(){return iu("\uDF06\uD834")!=='"\\udf06\\ud834"'||iu("\uDEAD")!=='"\\udead"'}),AQ=function(i,e){var n=vj(arguments),s=SQ(e);if(_j(s)||i!==void 0&&!Ej(i))return n[1]=function(a,l){if(_j(s)&&(l=yQ(s,this,TQ(a),l)),!Ej(l))return l},mj(iu,null,n)},OQ=function(i,e,n){var s=yj(n,e-1),a=yj(n,e+1);return db(Sj,i)&&!db(bj,a)||db(bj,i)&&!db(Sj,s)?"\\u"+RQ(CQ(i,0),16):i};iu&&vQ({target:"JSON",stat:!0,arity:3,forced:Tj||Cj},{stringify:function(i,e,n){var s=vj(arguments),a=mj(Tj?AQ:iu,null,s);return Cj&&typeof a=="string"?wQ(a,IQ,OQ):a}});var wj=aE,NQ=cs;On({target:"Object",stat:!0,forced:!Ho||h(function(){wj.f(1)})},{getOwnPropertySymbols:function(i){var e=wj.f;return e?e(NQ(i)):[]}}),wi("asyncIterator"),wi("hasInstance"),wi("isConcatSpreadable"),wi("iterator"),wi("match"),wi("matchAll"),wi("replace"),wi("search"),wi("species"),wi("split");var kQ=jU;wi("toPrimitive"),kQ();var xQ=Yn,PQ=nu;wi("toStringTag"),PQ(xQ("Symbol"),"Symbol"),wi("unscopables"),nu(V.JSON,"JSON",!0);var qh,Rj,Ij,DQ=mr.Symbol,jf={},q1=Pe,LQ=Ei,Aj=Function.prototype,MQ=q1&&Object.getOwnPropertyDescriptor,X1=LQ(Aj,"name"),Oj={EXISTS:X1,PROPER:X1&&(function(){}).name==="something",CONFIGURABLE:X1&&(!q1||q1&&MQ(Aj,"name").configurable)},UQ=!h(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype}),jQ=Ei,FQ=we,VQ=cs,BQ=UQ,Nj=kf("IE_PROTO"),J1=Object,WQ=J1.prototype,Q1=BQ?J1.getPrototypeOf:function(i){var e=VQ(i);if(jQ(e,Nj))return e[Nj];var n=e.constructor;return FQ(n)&&e instanceof n?n.prototype:e instanceof J1?WQ:null},$Q=h,GQ=we,HQ=Ft,zQ=Vt,kj=Q1,KQ=tu,Z1=gr("iterator"),xj=!1;[].keys&&("next"in(Ij=[].keys())?(Rj=kj(kj(Ij)))!==Object.prototype&&(qh=Rj):xj=!0);var YQ=!HQ(qh)||$Q(function(){var i={};return qh[Z1].call(i)!==i});GQ((qh=YQ?{}:zQ(qh))[Z1])||KQ(qh,Z1,function(){return this});var Pj={IteratorPrototype:qh,BUGGY_SAFARI_ITERATORS:xj},qQ=Pj.IteratorPrototype,XQ=Vt,JQ=at,QQ=nu,ZQ=jf,eZ=function(){return this},Dj=function(i,e,n,s){var a=e+" Iterator";return i.prototype=XQ(qQ,{next:JQ(+!s,n)}),QQ(i,a,!1,!0),ZQ[a]=eZ,i},tZ=w,nZ=gi,rZ=we,iZ=String,sZ=TypeError,oZ=function(i,e,n){try{return tZ(nZ(Object.getOwnPropertyDescriptor(i,e)[n]))}catch{}},aZ=Js,cZ=function(i){if(typeof i=="object"||rZ(i))return i;throw sZ("Can't set "+iZ(i)+" as a prototype")},lZ=Object.setPrototypeOf||("__proto__"in{}?function(){var i,e=!1,n={};try{(i=oZ(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch{}return function(s,a){return aZ(s),cZ(a),e?i(s,a):s.__proto__=a,s}}():void 0),dZ=On,uZ=Fe,hZ=Oj,pZ=Dj,fZ=Q1,mZ=nu,Lj=tu,Mj=jf,gZ=Pj,_Z=hZ.PROPER,ub=gZ.BUGGY_SAFARI_ITERATORS,eO=gr("iterator"),Uj="keys",hb="values",jj="entries",EZ=function(){return this},Fj=function(i,e,n,s,a,l,u){pZ(n,e,s);var p,m,g,E=function(q){if(q===a&&P)return P;if(!ub&&q in I)return I[q];switch(q){case Uj:case hb:case jj:return function(){return new n(this,q)}}return function(){return new n(this)}},y=e+" Iterator",C=!1,I=i.prototype,j=I[eO]||I["@@iterator"]||a&&I[a],P=!ub&&j||E(a),U=e=="Array"&&I.entries||j;if(U&&(p=fZ(U.call(new i)))!==Object.prototype&&p.next&&(mZ(p,y,!0,!0),Mj[y]=EZ),_Z&&a==hb&&j&&j.name!==hb&&(C=!0,P=function(){return uZ(j,this)}),a)if(m={values:E(hb),keys:l?P:E(Uj),entries:E(jj)},u)for(g in m)(ub||C||!(g in I))&&Lj(I,g,m[g]);else dZ({target:e,proto:!0,forced:ub||C},m);return u&&I[eO]!==P&&Lj(I,eO,P,{name:a}),Mj[e]=P,m},Vj=function(i,e){return{value:i,done:e}},vZ=En,Bj=jf,Wj=Lf;_o.f;var yZ=Fj,$j=Vj,Gj="Array Iterator",SZ=Wj.set,bZ=Wj.getterFor(Gj);yZ(Array,"Array",function(i,e){SZ(this,{type:Gj,target:vZ(i),index:0,kind:e})},function(){var i=bZ(this),e=i.target,n=i.kind,s=i.index++;return!e||s>=e.length?(i.target=void 0,$j(void 0,!0)):$j(n=="keys"?s:n=="values"?e[s]:[s,e[s]],!1)},"values"),Bj.Arguments=Bj.Array;var TZ={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},CZ=V,wZ=Xc,RZ=ls,Hj=jf,zj=gr("toStringTag");for(var tO in TZ){var Kj=CZ[tO],nO=Kj&&Kj.prototype;nO&&wZ(nO)!==zj&&RZ(nO,zj,tO),Hj[tO]=Hj.Array}var IZ=DQ,AZ=gr,OZ=_o.f,Yj=AZ("metadata"),qj=Function.prototype;qj[Yj]===void 0&&OZ(qj,Yj,{value:null}),wi("dispose"),wi("metadata");var NZ=IZ;wi("asyncDispose");var kZ=w,rO=Yn("Symbol"),xZ=rO.keyFor,PZ=kZ(rO.prototype.valueOf),Xj=rO.isRegisteredSymbol||function(i){try{return xZ(PZ(i))!==void 0}catch{return!1}};On({target:"Symbol",stat:!0},{isRegisteredSymbol:Xj});for(var DZ=cc,Jj=Yn,LZ=w,MZ=lt,UZ=gr,pb=Jj("Symbol"),Qj=pb.isWellKnownSymbol,Zj=Jj("Object","getOwnPropertyNames"),jZ=LZ(pb.prototype.valueOf),eF=DZ("wks"),iO=0,tF=Zj(pb),FZ=tF.length;iO<FZ;iO++)try{var nF=tF[iO];MZ(pb[nF])&&UZ(nF)}catch{}var rF=function(i){if(Qj&&Qj(i))return!0;try{for(var e=jZ(i),n=0,s=Zj(eF),a=s.length;n<a;n++)if(eF[s[n]]==e)return!0}catch{}return!1};On({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:rF}),wi("matcher"),wi("observable"),On({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:Xj}),On({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:rF}),wi("metadataKey"),wi("patternMatch"),wi("replaceAll");var Ff=d(NZ),sO=w,VZ=O_,BZ=Ds,WZ=rt,$Z=sO("".charAt),iF=sO("".charCodeAt),GZ=sO("".slice),sF=function(i){return function(e,n){var s,a,l=BZ(WZ(e)),u=VZ(n),p=l.length;return u<0||u>=p?i?"":void 0:(s=iF(l,u))<55296||s>56319||u+1===p||(a=iF(l,u+1))<56320||a>57343?i?$Z(l,u):s:i?GZ(l,u,u+2):a-56320+(s-55296<<10)+65536}},oF={codeAt:sF(!1),charAt:sF(!0)},HZ=oF.charAt,zZ=Ds,aF=Lf,KZ=Fj,cF=Vj,lF="String Iterator",YZ=aF.set,qZ=aF.getterFor(lF);KZ(String,"String",function(i){YZ(this,{type:lF,string:zZ(i),index:0})},function(){var i,e=qZ(this),n=e.string,s=e.index;return s>=n.length?cF(void 0,!0):(i=HZ(n,s),e.index+=i.length,cF(i,!1))});var dF=d(Pf.f("iterator"));function pE(i){return pE=typeof Ff=="function"&&typeof dF=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Ff=="function"&&e.constructor===Ff&&e!==Ff.prototype?"symbol":typeof e},pE(i)}var XZ=d(Pf.f("toPrimitive"));function JZ(i){var e=function(n,s){if(pE(n)!=="object"||n===null)return n;var a=n[XZ];if(a!==void 0){var l=a.call(n,s||"default");if(pE(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}(i,"string");return pE(e)==="symbol"?e:String(e)}function R(i,e,n){return(e=JZ(e))in i?t1(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}var QZ=qc("Array").keys,ZZ=Xc,eee=Ei,tee=x,nee=QZ,oO=Array.prototype,ree={DOMTokenList:!0,NodeList:!0},vo=d(function(i){var e=i.keys;return i===oO||tee(oO,i)&&e===oO.keys||eee(ree,ZZ(i))?nee:e}),uF=Gc,iee=TypeError,hF=P1,see=Math.floor,aO=function(i,e){var n=i.length,s=see(n/2);return n<8?oee(i,e):aee(i,aO(hF(i,0,s),e),aO(hF(i,s),e),e)},oee=function(i,e){for(var n,s,a=i.length,l=1;l<a;){for(s=l,n=i[l];s&&e(i[s-1],n)>0;)i[s]=i[--s];s!==l++&&(i[s]=n)}return i},aee=function(i,e,n,s){for(var a=e.length,l=n.length,u=0,p=0;u<a||p<l;)i[u+p]=u<a&&p<l?s(e[u],n[p])<=0?e[u++]:n[p++]:u<a?e[u++]:n[p++];return i},pF=aO,cee=h,cO=function(i,e){var n=[][i];return!!n&&cee(function(){n.call(null,e||function(){return 1},1)})},fF=an.match(/firefox\/(\d+)/i),lee=!!fF&&+fF[1],dee=/MSIE|Trident/.test(an),mF=an.match(/AppleWebKit\/(\d+)\./),uee=!!mF&&+mF[1],hee=On,gF=w,pee=gi,fee=cs,_F=Yc,mee=function(i,e){if(!delete i[e])throw iee("Cannot delete property "+uF(e)+" of "+uF(i))},EF=Ds,lO=h,gee=pF,_ee=cO,vF=lee,Eee=dee,yF=Tn,SF=uee,su=[],bF=gF(su.sort),vee=gF(su.push),yee=lO(function(){su.sort(void 0)}),See=lO(function(){su.sort(null)}),bee=_ee("sort"),TF=!lO(function(){if(yF)return yF<70;if(!(vF&&vF>3)){if(Eee)return!0;if(SF)return SF<603;var i,e,n,s,a="";for(i=65;i<76;i++){switch(e=String.fromCharCode(i),i){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(s=0;s<47;s++)su.push({k:e+s,v:n})}for(su.sort(function(l,u){return u.v-l.v}),s=0;s<su.length;s++)e=su[s].k.charAt(0),a.charAt(a.length-1)!==e&&(a+=e);return a!=="DGBEFHACIJK"}});hee({target:"Array",proto:!0,forced:yee||!See||!bee||!TF},{sort:function(i){i!==void 0&&pee(i);var e=fee(this);if(TF)return i===void 0?bF(e):bF(e,i);var n,s,a=[],l=_F(e);for(s=0;s<l;s++)s in e&&vee(a,e[s]);for(gee(a,function(u){return function(p,m){return m===void 0?-1:p===void 0?1:u!==void 0?+u(p,m)||0:EF(p)>EF(m)?1:-1}}(i)),n=_F(a),s=0;s<n;)e[s]=a[s++];for(;s<l;)mee(e,s++);return e}});var Tee=qc("Array").sort,Cee=x,wee=Tee,dO=Array.prototype,fE=d(function(i){var e=i.sort;return i===dO||Cee(dO,i)&&e===dO.sort?wee:e}),Ree=Yn,Iee=yn,Aee=aE,Oee=Js,Nee=w([].concat),kee=Ree("Reflect","ownKeys")||function(i){var e=Iee.f(Oee(i)),n=Aee.f;return n?Nee(e,n(i)):e},CF=Ei,xee=kee,Pee=Re,Dee=_o,Lee=Ft,Mee=ls,wF=Error,Uee=w("".replace),jee=String(wF("zxcasd").stack),RF=/\n\s*at [^:]*:[^\n]*/,Fee=RF.test(jee),Vee=at,Bee=!h(function(){var i=Error("a");return!("stack"in i)||(Object.defineProperty(i,"stack",Vee(1,7)),i.stack!==7)}),Wee=ls,$ee=function(i,e){if(Fee&&typeof i=="string"&&!wF.prepareStackTrace)for(;e--;)i=Uee(i,RF,"");return i},Gee=Bee,IF=Error.captureStackTrace,Hee=jf,zee=gr("iterator"),Kee=Array.prototype,AF=function(i){return i!==void 0&&(Hee.Array===i||Kee[zee]===i)},Yee=Xc,OF=Yd,qee=hn,Xee=jf,Jee=gr("iterator"),fb=function(i){if(!qee(i))return OF(i,Jee)||OF(i,"@@iterator")||Xee[Yee(i)]},Qee=Fe,Zee=gi,ete=Js,tte=Gc,nte=fb,rte=TypeError,uO=function(i,e){var n=arguments.length<2?nte(i):e;if(Zee(n))return ete(Qee(n,i));throw rte(tte(i)+" is not iterable")},ite=Fe,NF=Js,ste=Yd,kF=function(i,e,n){var s,a;NF(i);try{if(!(s=ste(i,"return"))){if(e==="throw")throw n;return n}s=ite(s,i)}catch(l){a=!0,s=l}if(e==="throw")throw n;if(a)throw s;return NF(s),n},ote=Sa,ate=Fe,cte=Js,lte=Gc,dte=AF,ute=Yc,xF=x,hte=uO,pte=fb,PF=kF,fte=TypeError,mb=function(i,e){this.stopped=i,this.result=e},DF=mb.prototype,mE=function(i,e,n){var s,a,l,u,p,m,g,E=n&&n.that,y=!(!n||!n.AS_ENTRIES),C=!(!n||!n.IS_RECORD),I=!(!n||!n.IS_ITERATOR),j=!(!n||!n.INTERRUPTED),P=ote(e,E),U=function(J){return s&&PF(s,"normal",J),new mb(!0,J)},q=function(J){return y?(cte(J),j?P(J[0],J[1],U):P(J[0],J[1])):j?P(J,U):P(J)};if(C)s=i.iterator;else if(I)s=i;else{if(!(a=pte(i)))throw fte(lte(i)+" is not iterable");if(dte(a)){for(l=0,u=ute(i);u>l;l++)if((p=q(i[l]))&&xF(DF,p))return p;return new mb(!1)}s=hte(i,a)}for(m=C?i.next:s.next;!(g=ate(m,s)).done;){try{p=q(g.value)}catch(J){PF(s,"throw",J)}if(typeof p=="object"&&p&&xF(DF,p))return p}return new mb(!1)},mte=Ds,gte=On,_te=x,Ete=Q1,gb=lZ,vte=function(i,e,n){for(var s=xee(e),a=Dee.f,l=Pee.f,u=0;u<s.length;u++){var p=s[u];CF(i,p)||n&&CF(n,p)||a(i,p,l(e,p))}},LF=Vt,hO=ls,pO=at,yte=function(i,e){Lee(e)&&"cause"in e&&Mee(i,"cause",e.cause)},Ste=function(i,e,n,s){Gee&&(IF?IF(i,e):Wee(i,"stack",$ee(n,s)))},bte=mE,Tte=function(i,e){return i===void 0?arguments.length<2?"":e:mte(i)},Cte=gr("toStringTag"),_b=Error,wte=[].push,Vf=function(i,e){var n,s=_te(fO,this);gb?n=gb(_b(),s?Ete(this):fO):(n=s?this:LF(fO),hO(n,Cte,"Error")),e!==void 0&&hO(n,"message",Tte(e)),Ste(n,Vf,n.stack,1),arguments.length>2&&yte(n,arguments[2]);var a=[];return bte(i,wte,{that:a}),hO(n,"errors",a),n};gb?gb(Vf,_b):vte(Vf,_b,{name:!0});var fO=Vf.prototype=LF(_b.prototype,{constructor:pO(1,Vf),message:pO(1,""),name:pO(1,"AggregateError")});gte({global:!0,constructor:!0,arity:2},{AggregateError:Vf});var gE,Bf,MF,mO,_E=typeof process<"u"&&ie(process)=="process",Rte=Yn,Ite=tb,Ate=Pe,UF=gr("species"),Ote=x,Nte=TypeError,gO=function(i,e){if(Ote(e,i))return i;throw Nte("Incorrect invocation")},kte=Rf,xte=Gc,Pte=TypeError,jF=Js,Dte=function(i){if(kte(i))return i;throw Pte(xte(i)+" is not a constructor")},Lte=hn,Mte=gr("species"),FF=function(i,e){var n,s=jF(i).constructor;return s===void 0||Lte(n=jF(s)[Mte])?e:Dte(n)},Ute=TypeError,Eb=function(i,e){if(i<e)throw Ute("Not enough arguments");return i},VF=/(?:ipad|iphone|ipod).*applewebkit/i.test(an),Yo=V,jte=L,Fte=Sa,BF=we,Vte=Ei,WF=h,$F=ZS,Bte=dj,GF=b_,Wte=Eb,$te=VF,Gte=_E,_O=Yo.setImmediate,EO=Yo.clearImmediate,Hte=Yo.process,vO=Yo.Dispatch,zte=Yo.Function,HF=Yo.MessageChannel,Kte=Yo.String,yO=0,EE={},zF="onreadystatechange";WF(function(){gE=Yo.location});var SO=function(i){if(Vte(EE,i)){var e=EE[i];delete EE[i],e()}},bO=function(i){return function(){SO(i)}},KF=function(i){SO(i.data)},YF=function(i){Yo.postMessage(Kte(i),gE.protocol+"//"+gE.host)};_O&&EO||(_O=function(i){Wte(arguments.length,1);var e=BF(i)?i:zte(i),n=Bte(arguments,1);return EE[++yO]=function(){jte(e,void 0,n)},Bf(yO),yO},EO=function(i){delete EE[i]},Gte?Bf=function(i){Hte.nextTick(bO(i))}:vO&&vO.now?Bf=function(i){vO.now(bO(i))}:HF&&!$te?(mO=(MF=new HF).port2,MF.port1.onmessage=KF,Bf=Fte(mO.postMessage,mO)):Yo.addEventListener&&BF(Yo.postMessage)&&!Yo.importScripts&&gE&&gE.protocol!=="file:"&&!WF(YF)?(Bf=YF,Yo.addEventListener("message",KF,!1)):Bf=zF in GF("script")?function(i){$F.appendChild(GF("script"))[zF]=function(){$F.removeChild(this),SO(i)}}:function(i){setTimeout(bO(i),0)});var qF={set:_O,clear:EO},XF=function(){this.head=null,this.tail=null};XF.prototype={add:function(i){var e={item:i,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var i=this.head;if(i)return(this.head=i.next)===null&&(this.tail=null),i.item}};var Wf,TO,CO,wO,JF,QF=XF,Yte=/ipad|iphone|ipod/i.test(an)&&typeof Pebble<"u",qte=/web0s(?!.*chrome)/i.test(an),Xh=V,ZF=Sa,Xte=Re.f,RO=qF.set,Jte=QF,Qte=VF,Zte=Yte,ene=qte,IO=_E,e5=Xh.MutationObserver||Xh.WebKitMutationObserver,t5=Xh.document,n5=Xh.process,vb=Xh.Promise,r5=Xte(Xh,"queueMicrotask"),AO=r5&&r5.value;if(!AO){var yb=new Jte,Sb=function(){var i,e;for(IO&&(i=n5.domain)&&i.exit();e=yb.get();)try{e()}catch(n){throw yb.head&&Wf(),n}i&&i.enter()};Qte||IO||ene||!e5||!t5?!Zte&&vb&&vb.resolve?((wO=vb.resolve(void 0)).constructor=vb,JF=ZF(wO.then,wO),Wf=function(){JF(Sb)}):IO?Wf=function(){n5.nextTick(Sb)}:(RO=ZF(RO,Xh),Wf=function(){RO(Sb)}):(TO=!0,CO=t5.createTextNode(""),new e5(Sb).observe(CO,{characterData:!0}),Wf=function(){CO.data=TO=!TO}),AO=function(i){yb.head||Wf(),yb.add(i)}}var tne=AO,$f=function(i){try{return{error:!1,value:i()}}catch(e){return{error:!0,value:e}}},Jh=V.Promise,i5=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",nne=!i5&&!_E&&typeof window=="object"&&typeof document=="object",rne=V,vE=Jh,ine=we,sne=K0,one=jS,ane=gr,cne=nne,lne=i5,OO=Tn,s5=vE&&vE.prototype,dne=ane("species"),o5=!1,a5=ine(rne.PromiseRejectionEvent),une=sne("Promise",function(){var i=one(vE),e=i!==String(vE);if(!e&&OO===66||!s5.catch||!s5.finally)return!0;if(!OO||OO<51||!/native code/.test(i)){var n=new vE(function(a){a(1)}),s=function(a){a(function(){},function(){})};if((n.constructor={})[dne]=s,!(o5=n.then(function(){})instanceof s))return!0}return!e&&(cne||lne)&&!a5}),yE={CONSTRUCTOR:une,REJECTION_EVENT:a5,SUBCLASSING:o5},el={},c5=gi,hne=TypeError,pne=function(i){var e,n;this.promise=new i(function(s,a){if(e!==void 0||n!==void 0)throw hne("Bad Promise constructor");e=s,n=a}),this.resolve=c5(e),this.reject=c5(n)};el.f=function(i){return new pne(i)};var NO,l5,fne=On,bb=_E,ou=V,SE=Fe,mne=tu,gne=nu,_ne=function(i){var e=Rte(i);Ate&&e&&!e[UF]&&Ite(e,UF,{configurable:!0,get:function(){return this}})},Ene=gi,kO=we,vne=Ft,yne=gO,Sne=FF,d5=qF.set,xO=tne,bne=function(i,e){try{arguments.length==1?console.error(i):console.error(i,e)}catch{}},Tne=$f,Cne=QF,u5=Lf,PO=Jh,h5=yE,p5=el,Tb="Promise",f5=h5.CONSTRUCTOR,wne=h5.REJECTION_EVENT,DO=u5.getterFor(Tb),Rne=u5.set,Ine=PO&&PO.prototype,bE=PO,LO=Ine,m5=ou.TypeError,MO=ou.document,UO=ou.process,jO=p5.f,Ane=jO,One=!!(MO&&MO.createEvent&&ou.dispatchEvent),g5="unhandledrejection",_5=function(i){var e;return!(!vne(i)||!kO(e=i.then))&&e},E5=function(i,e){var n,s,a,l=e.value,u=e.state==1,p=u?i.ok:i.fail,m=i.resolve,g=i.reject,E=i.domain;try{p?(u||(e.rejection===2&&kne(e),e.rejection=1),p===!0?n=l:(E&&E.enter(),n=p(l),E&&(E.exit(),a=!0)),n===i.promise?g(m5("Promise-chain cycle")):(s=_5(n))?SE(s,n,m,g):m(n)):g(l)}catch(y){E&&!a&&E.exit(),g(y)}},v5=function(i,e){i.notified||(i.notified=!0,xO(function(){for(var n,s=i.reactions;n=s.get();)E5(n,i);i.notified=!1,e&&!i.rejection&&Nne(i)}))},y5=function(i,e,n){var s,a;One?((s=MO.createEvent("Event")).promise=e,s.reason=n,s.initEvent(i,!1,!0),ou.dispatchEvent(s)):s={promise:e,reason:n},!wne&&(a=ou["on"+i])?a(s):i===g5&&bne("Unhandled promise rejection",n)},Nne=function(i){SE(d5,ou,function(){var e,n=i.facade,s=i.value;if(S5(i)&&(e=Tne(function(){bb?UO.emit("unhandledRejection",s,n):y5(g5,n,s)}),i.rejection=bb||S5(i)?2:1,e.error))throw e.value})},S5=function(i){return i.rejection!==1&&!i.parent},kne=function(i){SE(d5,ou,function(){var e=i.facade;bb?UO.emit("rejectionHandled",e):y5("rejectionhandled",e,i.value)})},Gf=function(i,e,n){return function(s){i(e,s,n)}},Hf=function(i,e,n){i.done||(i.done=!0,n&&(i=n),i.value=e,i.state=2,v5(i,!0))},FO=function(i,e,n){if(!i.done){i.done=!0,n&&(i=n);try{if(i.facade===e)throw m5("Promise can't be resolved itself");var s=_5(e);s?xO(function(){var a={done:!1};try{SE(s,e,Gf(FO,a,i),Gf(Hf,a,i))}catch(l){Hf(a,l,i)}}):(i.value=e,i.state=1,v5(i,!1))}catch(a){Hf({done:!1},a,i)}}};f5&&(LO=(bE=function(i){yne(this,LO),Ene(i),SE(NO,this);var e=DO(this);try{i(Gf(FO,e),Gf(Hf,e))}catch(n){Hf(e,n)}}).prototype,(NO=function(i){Rne(this,{type:Tb,done:!1,notified:!1,parent:!1,reactions:new Cne,rejection:!1,state:0,value:void 0})}).prototype=mne(LO,"then",function(i,e){var n=DO(this),s=jO(Sne(this,bE));return n.parent=!0,s.ok=!kO(i)||i,s.fail=kO(e)&&e,s.domain=bb?UO.domain:void 0,n.state==0?n.reactions.add(s):xO(function(){E5(s,n)}),s.promise}),l5=function(){var i=new NO,e=DO(i);this.promise=i,this.resolve=Gf(FO,e),this.reject=Gf(Hf,e)},p5.f=jO=function(i){return i===bE||i===void 0?new l5(i):Ane(i)}),fne({global:!0,constructor:!0,wrap:!0,forced:f5},{Promise:bE}),gne(bE,Tb,!1,!0),_ne(Tb);var b5=gr("iterator"),T5=!1;try{var xne=0,C5={next:function(){return{done:!!xne++}},return:function(){T5=!0}};C5[b5]=function(){return this},Array.from(C5,function(){throw 2})}catch{}var Pne=Jh,Dne=function(i,e){if(!e&&!T5)return!1;var n=!1;try{var s={};s[b5]=function(){return{next:function(){return{done:n=!0}}}},i(s)}catch{}return n},Cb=yE.CONSTRUCTOR||!Dne(function(i){Pne.all(i).then(void 0,function(){})}),Lne=Fe,Mne=gi,Une=el,jne=$f,Fne=mE;On({target:"Promise",stat:!0,forced:Cb},{all:function(i){var e=this,n=Une.f(e),s=n.resolve,a=n.reject,l=jne(function(){var u=Mne(e.resolve),p=[],m=0,g=1;Fne(i,function(E){var y=m++,C=!1;g++,Lne(u,e,E).then(function(I){C||(C=!0,p[y]=I,--g||s(p))},a)}),--g||s(p)});return l.error&&a(l.value),n.promise}});var Vne=On,Bne=yE.CONSTRUCTOR;Jh&&Jh.prototype,Vne({target:"Promise",proto:!0,forced:Bne,real:!0},{catch:function(i){return this.then(void 0,i)}});var Wne=Fe,$ne=gi,Gne=el,Hne=$f,zne=mE;On({target:"Promise",stat:!0,forced:Cb},{race:function(i){var e=this,n=Gne.f(e),s=n.reject,a=Hne(function(){var l=$ne(e.resolve);zne(i,function(u){Wne(l,e,u).then(n.resolve,s)})});return a.error&&s(a.value),n.promise}});var Kne=Fe,Yne=el;On({target:"Promise",stat:!0,forced:yE.CONSTRUCTOR},{reject:function(i){var e=Yne.f(this);return Kne(e.reject,void 0,i),e.promise}});var qne=Js,Xne=Ft,Jne=el,w5=function(i,e){if(qne(i),Xne(e)&&e.constructor===i)return e;var n=Jne.f(i);return(0,n.resolve)(e),n.promise},Qne=On,Zne=Jh,ere=yE.CONSTRUCTOR,tre=w5,nre=Yn("Promise"),rre=!ere;Qne({target:"Promise",stat:!0,forced:!0},{resolve:function(i){return tre(rre&&this===nre?Zne:this,i)}});var ire=Fe,sre=gi,ore=el,are=$f,cre=mE;On({target:"Promise",stat:!0,forced:Cb},{allSettled:function(i){var e=this,n=ore.f(e),s=n.resolve,a=n.reject,l=are(function(){var u=sre(e.resolve),p=[],m=0,g=1;cre(i,function(E){var y=m++,C=!1;g++,ire(u,e,E).then(function(I){C||(C=!0,p[y]={status:"fulfilled",value:I},--g||s(p))},function(I){C||(C=!0,p[y]={status:"rejected",reason:I},--g||s(p))})}),--g||s(p)});return l.error&&a(l.value),n.promise}});var lre=Fe,dre=gi,ure=Yn,hre=el,pre=$f,fre=mE,R5="No one promise resolved";On({target:"Promise",stat:!0,forced:Cb},{any:function(i){var e=this,n=ure("AggregateError"),s=hre.f(e),a=s.resolve,l=s.reject,u=pre(function(){var p=dre(e.resolve),m=[],g=0,E=1,y=!1;fre(i,function(C){var I=g++,j=!1;E++,lre(p,e,C).then(function(P){j||y||(y=!0,a(P))},function(P){j||y||(j=!0,m[I]=P,--E||l(new n(m,R5)))})}),--E||l(new n(m,R5))});return u.error&&l(u.value),s.promise}});var mre=On,VO=Jh,gre=h,_re=Yn,Ere=we,vre=FF,I5=w5,yre=VO&&VO.prototype;mre({target:"Promise",proto:!0,real:!0,forced:!!VO&&gre(function(){yre.finally.call({then:function(){}},function(){})})},{finally:function(i){var e=vre(this,_re("Promise")),n=Ere(i);return this.then(n?function(s){return I5(e,i()).then(function(){return s})}:i,n?function(s){return I5(e,i()).then(function(){throw s})}:i)}});var A5=mr.Promise,pe=d(A5);const Sre=()=>{};function TE(){const i={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:Sre};return i.promise=new pe((e,n)=>{i.resolve=s=>{i.isFinished||(i.isResolved=!0,i.isFinished=!0,e(s),i.value=s)},i.reject=s=>{i.isFinished||(i.isRejected=!0,i.isFinished=!0,n(s))}}),i}const wb=new Map,Rb=new Map,tl=new Map;var Dr,Zt;(function(i){i.WIN_10="Windows 10",i.WIN_81="Windows 8.1",i.WIN_8="Windows 8",i.WIN_7="Windows 7",i.WIN_VISTA="Windows Vista",i.WIN_SERVER_2003="Windows Server 2003",i.WIN_XP="Windows XP",i.WIN_2000="Windows 2000",i.ANDROID="Android",i.HARMONY_OS="HarmonyOS",i.OPEN_BSD="Open BSD",i.SUN_OS="Sun OS",i.LINUX="Linux",i.IOS="iOS",i.MAC_OS="Mac OS",i.CHROMIUM_OS="Chromium OS",i.QNX="QNX",i.UNIX="UNIX",i.BEOS="BeOS",i.OS_2="OS/2",i.SEARCH_BOT="Search Bot"})(Dr||(Dr={})),function(i){i.CHROME="Chrome",i.SAFARI="Safari",i.EDGE="Edge",i.FIREFOX="Firefox",i.OPERA="OPR",i.QQ="QQBrowser",i.WECHAT="MicroMessenger"}(Zt||(Zt={}));var BO={exports:{}};(function(i,e){(function(n,s){var a="function",l="undefined",u="object",p="string",m="major",g="model",E="name",y="type",C="vendor",I="version",j="architecture",P="console",U="mobile",q="tablet",J="smarttv",se="wearable",he="embedded",ae="Amazon",de="Apple",me="ASUS",ge="BlackBerry",Oe="Browser",De="Chrome",_t="Firefox",Pt="Google",Rn="Huawei",kr="LG",xn="Microsoft",io="Motorola",Te="Opera",xe="Samsung",Ke="Sharp",ft="Sony",Yt="Xiaomi",Me="Zebra",D="Facebook",Q="Chromium OS",re="Mac OS",Ae=function(hr){for(var xr={},Pn=0;Pn<hr.length;Pn++)xr[hr[Pn].toUpperCase()]=hr[Pn];return xr},Et=function(hr,xr){return typeof hr===p&&In(xr).indexOf(In(hr))!==-1},In=function(hr){return hr.toLowerCase()},ji=function(hr,xr){if(typeof hr===p)return hr=hr.replace(/^\s\s*/,""),typeof xr===l?hr:hr.substring(0,350)},so=function(hr,xr){for(var Pn,oo,vl,pr,qt,Ws,Fu=0;Fu<xr.length&&!qt;){var Oc=xr[Fu],bW=xr[Fu+1];for(Pn=oo=0;Pn<Oc.length&&!qt&&Oc[Pn];)if(qt=Oc[Pn++].exec(hr))for(vl=0;vl<bW.length;vl++)Ws=qt[++oo],typeof(pr=bW[vl])===u&&pr.length>0?pr.length===2?typeof pr[1]==a?this[pr[0]]=pr[1].call(this,Ws):this[pr[0]]=pr[1]:pr.length===3?typeof pr[1]!==a||pr[1].exec&&pr[1].test?this[pr[0]]=Ws?Ws.replace(pr[1],pr[2]):s:this[pr[0]]=Ws?pr[1].call(this,Ws,pr[2]):s:pr.length===4&&(this[pr[0]]=Ws?pr[3].call(this,Ws.replace(pr[1],pr[2])):s):this[pr]=Ws||s;Fu+=2}},md=function(hr,xr){for(var Pn in xr)if(typeof xr[Pn]===u&&xr[Pn].length>0){for(var oo=0;oo<xr[Pn].length;oo++)if(Et(xr[Pn][oo],hr))return Pn==="?"?s:Pn}else if(Et(xr[Pn],hr))return Pn==="?"?s:Pn;return hr},eC={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},tC={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[I,[E,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[I,[E,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[E,I],[/opios[\/ ]+([\w\.]+)/i],[I,[E,Te+" Mini"]],[/\bopr\/([\w\.]+)/i],[I,[E,Te]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[E,I],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[I,[E,"UC"+Oe]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[I,[E,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[I,[E,"WeChat"]],[/konqueror\/([\w\.]+)/i],[I,[E,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[I,[E,"IE"]],[/yabrowser\/([\w\.]+)/i],[I,[E,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[E,/(.+)/,"$1 Secure "+Oe],I],[/\bfocus\/([\w\.]+)/i],[I,[E,_t+" Focus"]],[/\bopt\/([\w\.]+)/i],[I,[E,Te+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[I,[E,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[I,[E,"Dolphin"]],[/coast\/([\w\.]+)/i],[I,[E,Te+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[I,[E,"MIUI "+Oe]],[/fxios\/([-\w\.]+)/i],[I,[E,_t]],[/\bqihu|(qi?ho?o?|360)browser/i],[[E,"360 "+Oe]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[E,/(.+)/,"$1 "+Oe],I],[/(comodo_dragon)\/([\w\.]+)/i],[[E,/_/g," "],I],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[E,I],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[E],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[E,D],I],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[E,I],[/\bgsa\/([\w\.]+) .*safari\//i],[I,[E,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[I,[E,De+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[E,De+" WebView"],I],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[I,[E,"Android "+Oe]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[E,I],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[I,[E,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[I,E],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[E,[I,md,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[E,I],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[E,"Netscape"],I],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[I,[E,_t+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[E,I],[/(cobalt)\/([\w\.]+)/i],[E,[I,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[j,"amd64"]],[/(ia32(?=;))/i],[[j,In]],[/((?:i[346]|x)86)[;\)]/i],[[j,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[j,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[j,"armhf"]],[/windows (ce|mobile); ppc;/i],[[j,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[j,/ower/,"",In]],[/(sun4\w)[;\)]/i],[[j,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[j,In]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[g,[C,xe],[y,q]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[g,[C,xe],[y,U]],[/\((ip(?:hone|od)[\w ]*);/i],[g,[C,de],[y,U]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[g,[C,de],[y,q]],[/(macintosh);/i],[g,[C,de]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[g,[C,Ke],[y,U]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[g,[C,Rn],[y,q]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[g,[C,Rn],[y,U]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[g,/_/g," "],[C,Yt],[y,U]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[g,/_/g," "],[C,Yt],[y,q]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[g,[C,"OPPO"],[y,U]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[g,[C,"Vivo"],[y,U]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[g,[C,"Realme"],[y,U]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[g,[C,io],[y,U]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[g,[C,io],[y,q]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[g,[C,kr],[y,q]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[g,[C,kr],[y,U]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[g,[C,"Lenovo"],[y,q]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[g,/_/g," "],[C,"Nokia"],[y,U]],[/(pixel c)\b/i],[g,[C,Pt],[y,q]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[g,[C,Pt],[y,U]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[g,[C,ft],[y,U]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[g,"Xperia Tablet"],[C,ft],[y,q]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[g,[C,"OnePlus"],[y,U]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[g,[C,ae],[y,q]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[g,/(.+)/g,"Fire Phone $1"],[C,ae],[y,U]],[/(playbook);[-\w\),; ]+(rim)/i],[g,C,[y,q]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[g,[C,ge],[y,U]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[g,[C,me],[y,q]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[g,[C,me],[y,U]],[/(nexus 9)/i],[g,[C,"HTC"],[y,q]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[C,[g,/_/g," "],[y,U]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[g,[C,"Acer"],[y,q]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[g,[C,"Meizu"],[y,U]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[C,g,[y,U]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[C,g,[y,q]],[/(surface duo)/i],[g,[C,xn],[y,q]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[g,[C,"Fairphone"],[y,U]],[/(u304aa)/i],[g,[C,"AT&T"],[y,U]],[/\bsie-(\w*)/i],[g,[C,"Siemens"],[y,U]],[/\b(rct\w+) b/i],[g,[C,"RCA"],[y,q]],[/\b(venue[\d ]{2,7}) b/i],[g,[C,"Dell"],[y,q]],[/\b(q(?:mv|ta)\w+) b/i],[g,[C,"Verizon"],[y,q]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[g,[C,"Barnes & Noble"],[y,q]],[/\b(tm\d{3}\w+) b/i],[g,[C,"NuVision"],[y,q]],[/\b(k88) b/i],[g,[C,"ZTE"],[y,q]],[/\b(nx\d{3}j) b/i],[g,[C,"ZTE"],[y,U]],[/\b(gen\d{3}) b.+49h/i],[g,[C,"Swiss"],[y,U]],[/\b(zur\d{3}) b/i],[g,[C,"Swiss"],[y,q]],[/\b((zeki)?tb.*\b) b/i],[g,[C,"Zeki"],[y,q]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[C,"Dragon Touch"],g,[y,q]],[/\b(ns-?\w{0,9}) b/i],[g,[C,"Insignia"],[y,q]],[/\b((nxa|next)-?\w{0,9}) b/i],[g,[C,"NextBook"],[y,q]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[C,"Voice"],g,[y,U]],[/\b(lvtel\-)?(v1[12]) b/i],[[C,"LvTel"],g,[y,U]],[/\b(ph-1) /i],[g,[C,"Essential"],[y,U]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[g,[C,"Envizen"],[y,q]],[/\b(trio[-\w\. ]+) b/i],[g,[C,"MachSpeed"],[y,q]],[/\btu_(1491) b/i],[g,[C,"Rotor"],[y,q]],[/(shield[\w ]+) b/i],[g,[C,"Nvidia"],[y,q]],[/(sprint) (\w+)/i],[C,g,[y,U]],[/(kin\.[onetw]{3})/i],[[g,/\./g," "],[C,xn],[y,U]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[g,[C,Me],[y,q]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[g,[C,Me],[y,U]],[/smart-tv.+(samsung)/i],[C,[y,J]],[/hbbtv.+maple;(\d+)/i],[[g,/^/,"SmartTV"],[C,xe],[y,J]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[C,kr],[y,J]],[/(apple) ?tv/i],[C,[g,de+" TV"],[y,J]],[/crkey/i],[[g,De+"cast"],[C,Pt],[y,J]],[/droid.+aft(\w)( bui|\))/i],[g,[C,ae],[y,J]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[g,[C,Ke],[y,J]],[/(bravia[\w ]+)( bui|\))/i],[g,[C,ft],[y,J]],[/(mitv-\w{5}) bui/i],[g,[C,Yt],[y,J]],[/Hbbtv.*(technisat) (.*);/i],[C,g,[y,J]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[C,ji],[g,ji],[y,J]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[y,J]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[C,g,[y,P]],[/droid.+; (shield) bui/i],[g,[C,"Nvidia"],[y,P]],[/(playstation [345portablevi]+)/i],[g,[C,ft],[y,P]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[g,[C,xn],[y,P]],[/((pebble))app/i],[C,g,[y,se]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[g,[C,de],[y,se]],[/droid.+; (glass) \d/i],[g,[C,Pt],[y,se]],[/droid.+; (wt63?0{2,3})\)/i],[g,[C,Me],[y,se]],[/(quest( 2| pro)?)/i],[g,[C,D],[y,se]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[C,[y,he]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[g,[y,U]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[g,[y,q]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[y,q]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[y,U]],[/(android[-\w\. ]{0,9});.+buil/i],[g,[C,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[I,[E,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[I,[E,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[E,I],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[I,E]],os:[[/microsoft (windows) (vista|xp)/i],[E,I],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[E,[I,md,eC]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[E,"Windows"],[I,md,eC]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[I,/_/g,"."],[E,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[E,re],[I,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[I,E],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[E,I],[/\(bb(10);/i],[I,[E,ge]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[I,[E,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[I,[E,_t+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[I,[E,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[I,[E,"watchOS"]],[/crkey\/([\d\.]+)/i],[I,[E,De+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[E,Q],I],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[E,I],[/(sunos) ?([\w\.\d]*)/i],[[E,"Solaris"],I],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[E,I]]},ia=function(hr,xr){if(typeof hr===u&&(xr=hr,hr=s),!(this instanceof ia))return new ia(hr,xr).getResult();var Pn=typeof n!==l&&n.navigator?n.navigator:s,oo=hr||(Pn&&Pn.userAgent?Pn.userAgent:""),vl=Pn&&Pn.userAgentData?Pn.userAgentData:s,pr=xr?function(qt,Ws){var Fu={};for(var Oc in qt)Ws[Oc]&&Ws[Oc].length%2==0?Fu[Oc]=Ws[Oc].concat(qt[Oc]):Fu[Oc]=qt[Oc];return Fu}(tC,xr):tC;return this.getBrowser=function(){var qt={};return qt[E]=s,qt[I]=s,so.call(qt,oo,pr.browser),qt[m]=function(Ws){return typeof Ws===p?Ws.replace(/[^\d\.]/g,"").split(".")[0]:s}(qt[I]),Pn&&Pn.brave&&typeof Pn.brave.isBrave==a&&(qt[E]="Brave"),qt},this.getCPU=function(){var qt={};return qt[j]=s,so.call(qt,oo,pr.cpu),qt},this.getDevice=function(){var qt={};return qt[C]=s,qt[g]=s,qt[y]=s,so.call(qt,oo,pr.device),!qt[y]&&vl&&vl.mobile&&(qt[y]=U),qt[g]=="Macintosh"&&Pn&&typeof Pn.standalone!==l&&Pn.maxTouchPoints&&Pn.maxTouchPoints>2&&(qt[g]="iPad",qt[y]=q),qt},this.getEngine=function(){var qt={};return qt[E]=s,qt[I]=s,so.call(qt,oo,pr.engine),qt},this.getOS=function(){var qt={};return qt[E]=s,qt[I]=s,so.call(qt,oo,pr.os),!qt[E]&&vl&&vl.platform!="Unknown"&&(qt[E]=vl.platform.replace(/chrome os/i,Q).replace(/macos/i,re)),qt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return oo},this.setUA=function(qt){return oo=typeof qt===p&&qt.length>350?ji(qt,350):qt,this},this.setUA(oo),this};ia.VERSION="0.7.34",ia.BROWSER=Ae([E,I,m]),ia.CPU=Ae([j]),ia.DEVICE=Ae([g,C,y,P,U,J,q,se,he]),ia.ENGINE=ia.OS=Ae([E,I]),i.exports&&(e=i.exports=ia),e.UAParser=ia;var ju=typeof n!==l&&(n.jQuery||n.Zepto);if(ju&&!ju.ua){var Dm=new ia;ju.ua=Dm.getResult(),ju.ua.get=function(){return Dm.getUA()},ju.ua.set=function(hr){Dm.setUA(hr);var xr=Dm.getResult();for(var Pn in xr)ju.ua[Pn]=xr[Pn]}}})(typeof window=="object"?window:c)})(BO,BO.exports);const WO=new(d(BO.exports));let ql=WO.getResult(),$O=null;function zt(i){if(!$O){i&&WO.setUA(i),ql=WO.getResult();const e=function(l){if(l.engine.name==="Blink"&&l.browser.name!=="WeChat")return Zt.CHROME;switch(l.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Zt.CHROME;case"Safari":case"Mobile Safari":return Zt.SAFARI;case"Edge":return Zt.EDGE;case"Firefox":return Zt.FIREFOX;case"QQBrowser":return Zt.QQ;case"Opera":return Zt.OPERA;case"WeChat":return Zt.WECHAT;default:return l.browser.name||""}}(ql),n=function(l){let u;return u=l.engine.name==="Blink"?l.engine.version||"":l.browser.version||"",u.split(".")[0]}(ql),s=function(l){return l.os.name==="Windows"?l.os.version?l.os.name+" "+l.os.version:l.os.name:l.os.name||""}(ql),a=ql.os.version;if(!(e&&n&&s&&a))return{name:e,version:n,os:s,osVersion:a};$O={name:e,version:n,os:s,osVersion:a}}return $O}function Ib(){return zt().os}function O5(){const i=zt();return"".concat(i.os," ").concat(i.osVersion)}function Ab(){const i=zt();return!!(ql.engine.name==="WebKit"&&i.os===Dr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&i.name!==Zt.SAFARI||ts()&&i.name!==Zt.SAFARI)}function bre(){const i=zt();if(Ab()){if(i.os===Dr.MAC_OS)return!0;if(i.os===Dr.IOS){const e=ql.os.version&&ql.os.version.split(".");if(e&&Number(e[0])===14&&e[1]&&Number(e[1])>=3||e&&Number(e[0])>14)return!0}}return!1}function Tre(){return ql.engine.name==="WebKit"}function Xl(){return zt().name===Zt.CHROME}function vi(){return zt().name===Zt.SAFARI}function mn(){return zt().name===Zt.FIREFOX}function ts(){return zt().os===Dr.IOS}function GO(i){const e=zt();return!(e.name!==Zt.CHROME||!e.osVersion)&&Number(e.version)>=i}function N5(i){const e=zt();return!(e.name!==Zt.EDGE||!e.osVersion)&&Number(e.version)>=i}function k5(i){const e=zt();return!(e.name!==Zt.OPERA||!e.osVersion)&&Number(e.version)>=i}function x5(){const i=zt();return!(i.name!==Zt.CHROME||!i.osVersion)&&Number(i.version)<=90}function P5(){const i=zt();if(i.os!==Dr.IOS||!i.osVersion)return!1;const e=i.osVersion.split(".");return Number(e[0])<14||Number(e[0])===14&&Number(e[1])<=6}function zf(){const i=zt();if(i.os!==Dr.IOS||!i.osVersion)return!1;const e=i.osVersion.split(".");return Number(e[0])===15}function HO(){const i=zt();if(i.os!==Dr.IOS||!i.osVersion)return!1;const e=i.osVersion.split(".");return Number(e[0])===16}function D5(){const i=zt();if(i.os!==Dr.IOS||!i.osVersion)return!1;const e=i.osVersion.split(".");return Number(e[0])===15&&Number(e[1])>=1}function nl(){return vi()&&navigator.maxTouchPoints>0}function L5(){return zt().name===Zt.WECHAT}function M5(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function au(){const i=zt();return i.name===Zt.EDGE||i.name===Zt.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Ob(){return Ib()===Dr.ANDROID}function CE(){const i=zt();return Ob()&&(i.name===Zt.CHROME||i.name===Zt.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var z;(function(i){i.UNEXPECTED_ERROR="UNEXPECTED_ERROR",i.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",i.TIMEOUT="TIMEOUT",i.INVALID_PARAMS="INVALID_PARAMS",i.NOT_READABLE="NOT_READABLE",i.NOT_SUPPORTED="NOT_SUPPORTED",i.INVALID_OPERATION="INVALID_OPERATION",i.OPERATION_ABORTED="OPERATION_ABORTED",i.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",i.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",i.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",i.DATACHANNEL_FAILED="DATACHANNEL_FAILED",i.NETWORK_ERROR="NETWORK_ERROR",i.NETWORK_TIMEOUT="NETWORK_TIMEOUT",i.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",i.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",i.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",i.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",i.ELECTRON_IS_NULL="ELECTRON_IS_NULL",i.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",i.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",i.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",i.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",i.PERMISSION_DENIED="PERMISSION_DENIED",i.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",i.TRACK_IS_DISABLED="TRACK_IS_DISABLED",i.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",i.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",i.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",i.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",i.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",i.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",i.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",i.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",i.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",i.UID_CONFLICT="UID_CONFLICT",i.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",i.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",i.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",i.INVALID_TRACK="INVALID_TRACK",i.SENDER_NOT_FOUND="SENDER_NOT_FOUND",i.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",i.SET_ANSWER_FAILED="SET_ANSWER_FAILED",i.ICE_FAILED="ICE_FAILED",i.PC_CLOSED="PC_CLOSED",i.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",i.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",i.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",i.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",i.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",i.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",i.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",i.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",i.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",i.INVALID_REMOTE_USER="INVALID_REMOTE_USER",i.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",i.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",i.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",i.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",i.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",i.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",i.WS_ABORT="WS_ABORT",i.WS_DISCONNECT="WS_DISCONNECT",i.WS_ERR="WS_ERR",i.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",i.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",i.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",i.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",i.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",i.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",i.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",i.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",i.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",i.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",i.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",i.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",i.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",i.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",i.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",i.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",i.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",i.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",i.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",i.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",i.INVALID_PLUGIN="INVALID_PLUGIN",i.DISCONNECT_P2P="DISCONNECT_P2P",i.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",i.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",i.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",i.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",i.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",i.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",i.PROHIBITED_OPERATION="PROHIBITED_OPERATION",i.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",i.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED"})(z||(z={}));let ye=class extends Error{constructor(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;super(e),R(this,"code",void 0),R(this,"message",void 0),R(this,"data",void 0),R(this,"name","AgoraRTCException"),this.code=i,this.message="AgoraRTCError ".concat(this.code,": ").concat(e),this.data=n}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",e=arguments.length>1?arguments[1]:void 0;return i==="error"&&(e||console).error(this.toString()),i==="warning"&&(e||console).warn(this.toString()),this}throw(i){throw this.print("error",i),this}};function Jl(i,e){if(typeof i!="boolean")throw new ye(z.INVALID_PARAMS,"Invalid ".concat(e,": The value is of the boolean type."))}function Lr(i,e,n){if(!je(n).call(n,i))throw new ye(z.INVALID_PARAMS,"".concat(e," can only be set as ").concat(JSON.stringify(n)))}function pn(i,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(i<n||i>s||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(a){return typeof a=="number"&&a%1==0}(i))throw new ye(z.INVALID_PARAMS,"invalid ".concat(e,": the value range is [").concat(n,", ").concat(s,"]. integer only"))}function zO(i,e){if(typeof i!="number"){if(!(i.min||i.max||i.ideal||i.exact))throw new ye(z.INVALID_PARAMS,"".concat(e," is not a valid ConstrainLong"));i.min!==void 0&&pn(i.min,"".concat(e,".min"),0,1/0),i.max!==void 0&&pn(i.max,"".concat(e,".max"),1,1/0),i.exact!==void 0&&pn(i.exact,"".concat(e,".exact"),1,1/0),i.ideal!==void 0&&pn(i.ideal,"".concat(e,".ideal"),1,1/0)}else pn(i,e,1,1/0)}function xi(i,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(i==null)throw new ye(z.INVALID_PARAMS,"".concat(e||"param"," cannot be empty"));if(!U5(i,n,s,a))throw new ye(z.INVALID_PARAMS,"Invalid ".concat(e||"string param",": Length of the string: [").concat(n,",").concat(s,"].").concat(a?" ASCII characters only.":""))}function Ql(i,e){if(!Array.isArray(i))throw new ye(z.INVALID_PARAMS,"".concat(e," should be an array"))}function Xn(i){return i==null}function U5(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof i=="string"&&i.length<=n&&i.length>=e&&(!s||function(a){if(typeof a!="string")return!1;for(let l=0;l<a.length;l+=1){const u=a.charCodeAt(l);if(u<0||u>255)return!1}return!0}(i))}function j5(i,e,n){if("getBigUint64"in DataView.prototype)return i.getBigUint64(e,n);const s=i.getUint32(e,n),a=i.getUint32(e+4,n),l=+!!n,u=+!n;return BigInt(s*u+a*l)<<BigInt(32)|BigInt(s*l+a*u)}function F5(i,e,n,s){if("setBigUint64"in DataView.prototype)return i.setBigUint64(e,n,s);const a=Number(n>>BigInt(32)),l=Number(n&BigInt(4294967295));s?(i.setUint32(e+4,a,s),i.setUint32(e,l,s)):(i.setUint32(e,a,s),i.setUint32(e+4,l,s))}var Kf,Nb;(function(i){i.COVERED="COVERED",i.POSITION="POSITION",i.SIZE="SIZE",i.STYLE="STYLE"})(Kf||(Kf={})),function(i){i.UNMOUNTED="UNMOUNTED",i.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(Nb||(Nb={}));const V5=new class{constructor(){R(this,"_clientSize",null),R(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),R(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),R(this,"getStyle",i=>window.getComputedStyle(i,null)),R(this,"checkCssVisibleProperty",i=>{var e;let n=!0;const s=this.getStyle(i),{display:a,visibility:l,opacity:u,filter:p}=s;return(a==="none"||je(e=["hidden","collapse"]).call(e,l)||Number(u)<.1)&&(n=!1),n?(p&&p.split(" ").filter(m=>{var g;const E=m.split("(")[0];return je(g=["brightness","blur","opacity"]).call(g,E)}).map(m=>{const[g,E]=m.split(/\(|\)/);return[g,Number(E.match(/^[0-9\.]+/))]}).forEach(m=>{const[g,E]=m;switch(g){case"brightness":(E<.1||E>3)&&(n=!1);break;case"blur":E>3&&(n=!1);break;case"opacity":E<.1&&(n=!1)}}),n):!1}),R(this,"checkPropertyUpToAllParentNodes",(i,e)=>{let n=!0,s=!0;const a=u=>e(u);let l=i;for(;l&&s;)a(l)||(n=!1,s=!1),l=l.parentElement,l||(s=!1);return n}),R(this,"checkActualCssVisibleIncludeInherit",i=>this.checkPropertyUpToAllParentNodes(i,this.checkCssVisibleProperty)),R(this,"getSizeAboutClient",i=>{const{width:e,height:n,left:s,right:a,top:l,bottom:u}=i.getBoundingClientRect(),p=this.getClientWidth(),m=this.getClientHeight();return{width:e,height:n,left:s,right:a,top:l,bottom:u,clientWidth:p,clientHeight:m,clientMin:Math.min(p,m)}}),R(this,"checkActualSize",()=>{const{width:i,height:e,clientMin:n}=this._clientSize;return this.checkSizeIsVisible(i,e,n)}),R(this,"elementFromPoint",(i,e)=>document.elementFromPoint?document.elementFromPoint(i,e):null),R(this,"checkCoverForAPoint",(i,e,n)=>{const s=this.elementFromPoint(i,e);return s!==null&&s!==n}),R(this,"getPointPositionList",()=>{const{width:i,height:e,left:n,top:s}=this._clientSize,a=i/6,l=e/6,u=[],p=10**6;for(let m=0;m<5;m++)for(let g=0;g<5;g++){const E=(n*p+(m===0?.1:m===4?(a*m*p-1e5)/p:a*m)*p)/p,y=(s*p+(g===0?.1:g===4?(l*g*p-1e5)/p:l*g)*p)/p;u.push({x:E,y})}return[...u]}),R(this,"checkElementCover",i=>this.getPointPositionList().map(e=>this.checkCoverForAPoint(e.x,e.y,i)).filter(e=>!!e).length>6),R(this,"checkSizeIsVisible",(i,e,n)=>(i>50||n/i<=10)&&(e>50||n/e<=10)),R(this,"checkSizeOfPartInClient",()=>{const{left:i,right:e,top:n,bottom:s,clientHeight:a,clientWidth:l,clientMin:u}=this._clientSize;let p,m,g,E;if(i<0)p=0;else{if(!(i<l))return!1;p=i}if(e<0)return!1;if(m=e<l?e:l,n<0)g=0;else{if(!(n<a))return!1;g=n}if(s<0)return!1;E=s<a?s:a;const y=m-p,C=E-g;return this.checkSizeIsVisible(y,C,u)}),R(this,"returnHiddenResult",i=>(this._clientSize=null,{visible:!1,reason:i})),R(this,"checkOneElementVisible",i=>{if(i instanceof HTMLElement){if(this.checkElementIsMountedOnDom(i)){if(this.checkActualCssVisibleIncludeInherit(i)){if(this._clientSize=this.getSizeAboutClient(i),this.checkElementCover(i))return this.returnHiddenResult(Kf.COVERED);{const e=this.checkActualSize(),n=this.checkSizeOfPartInClient();return e&&!n?this.returnHiddenResult(Kf.POSITION):e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Kf.SIZE)}}return this.returnHiddenResult(Kf.STYLE)}return this.returnHiddenResult(Nb.UNMOUNTED)}return this.returnHiddenResult(Nb.INVALID_HTML_ELEMENT)}),R(this,"checkElementIsMountedOnDom",i=>this.checkPropertyUpToAllParentNodes(i,e=>e.nodeName.toUpperCase()!=="HTML"?e.parentElement!==null:!!document.documentElement))}};function KO(i){return new TextEncoder().encode(i)}const B5=function(i,e){const n=new Uint8Array(i.byteLength+e.byteLength);return n.set(new Uint8Array(i),0),n.set(new Uint8Array(e),i.byteLength),n},Cre=async i=>{const e=function(l){const u=window.atob(l),p=new Uint8Array(new ArrayBuffer(u.length));for(let m=0;m<u.length;m+=1)p[m]=u.charCodeAt(m);return p}(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),n=await window.crypto.subtle.importKey("spki",e,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),s=KO(i),a=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,s);return function(l){let u="";for(let p=0;p<l.length;p+=1)u+=String.fromCharCode(l[p]);return window.btoa(u)}(new Uint8Array(a))},YO=async i=>function(e,n){let s="";return new Uint8Array(e).forEach(a=>{s+=a.toString(n).padStart(2,"0")}),s}(await crypto.subtle.digest("SHA-256",KO(i)),16);class jn{constructor(){R(this,"_events",{}),R(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map(n=>n.listener):[]}on(e,n){this._events[e]||(this._events[e]=[]);const s=this._events[e];this._indexOfListener(s,n)===-1&&s.push({listener:n,once:!1})}once(e,n){this._events[e]||(this._events[e]=[]);const s=this._events[e];this._indexOfListener(s,n)===-1&&s.push({listener:n,once:!0})}off(e,n){if(!this._events[e])return;const s=this._events[e],a=this._indexOfListener(s,n);a!==-1&&s.splice(a,1),this._events[e].length===0&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const n=this._events[e].map(u=>u);for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];for(let u=0;u<n.length;u+=1){const p=n[u];p.once&&this.off(e,p.listener),p.listener.apply(this,a||[])}}safeEmit(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];[...this._events[e]||[]].forEach(l=>{l.once&&this.off(e,l.listener);try{l.listener.apply(this,s)}catch(u){console.error("safeEmit event:".concat(e," error ").concat(u==null?void 0:u.toString()))}})}_indexOfListener(e,n){let s=e.length;for(;s--;)if(e[s].listener===n)return s;return-1}}let wE=null;function W5(){if(wE)return wE;if(window.electron)return wE=window.electron;if(!window.require)return null;try{return wE=window.require("electron"),wE}catch{return null}}var br,Bn,qO,Dt,Lt,ni,ns,Zl;function $5(i){return pn(i.timeout,"config.timeout",0,1e5),pn(i.timeoutFactor,"config.timeoutFactor",0,100,!1),pn(i.maxRetryCount,"config.maxRetryConfig",0,1/0),pn(i.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function Yf(i){if(!Array.isArray(i)||i.length<1)return!1;try{i.forEach(e=>{if(!e.urls)throw Error()})}catch{return!1}return!0}function G5(i){return xi(i.turnServerURL,"turnServerURL"),xi(i.username,"username"),xi(i.password,"password"),i.udpport&&pn(i.udpport,"udpport",1,99999,!0),i.forceturn&&Jl(i.forceturn,"forceturn"),i.security&&Jl(i.security,"security"),i.tcpport&&pn(i.tcpport,"tcpport",1,99999,!0),!0}function H5(i){return i.level!==void 0&&Lr(i.level,"level",[1,2,3]),i.delay!==void 0&&pn(i.delay,"delay",0,3e3,!0),!0}function Tr(i,e){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return i.getListeners(e).length===0?pe.reject(new ye(z.UNEXPECTED_ERROR,"can not emit promise")):new pe((l,u)=>{i.emit(e,...s,l,u)})}function gn(i,e){if(i.getListeners(e).length===0)return pe.resolve();for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return Tr(i,e,...s)}function Qs(i,e){if(i.getListeners(e).length===0)return null;for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return Qh(i,e,...s)}function Qh(i,e){let n=null,s=null;for(var a=arguments.length,l=new Array(a>2?a-2:0),u=2;u<a;u++)l[u-2]=arguments[u];if(i.emit(e,...l,p=>{n=p},p=>{s=p}),s!==null)throw s;if(n===null)throw new ye(z.UNEXPECTED_ERROR,"handler is not sync");return n}(function(i){i.CREATE_CLIENT="createClient",i.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",i.SET_AREA="setArea",i.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",i.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",i.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",i.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",i.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",i.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",i.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",i.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",i.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",i.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",i.START_PROXY_SERVER="Client.startProxyServer",i.STOP_PROXY_SERVER="Client.stopProxyServer",i.SET_PROXY_SERVER="Client.setProxyServer",i.SET_TURN_SERVER="Client.setTurnServer",i.SET_CLIENT_ROLE="Client.setClientRole",i.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",i.ENABLE_DUAL_STREAM="Client.enableDualStream",i.DISABLE_DUAL_STREAM="Client.disableDualStream",i.JOIN="Client.join",i.LEAVE="Client.leave",i.PUBLISH="Client.publish",i.UNPUBLISH="Client.unpublish",i.SUBSCRIBE="Client.subscribe",i.MASS_SUBSCRIBE="Client.massSubscribe",i.MASS_UNSUBSCRIBE="Client.massUnsubscribe",i.UNSUBSCRIBE="Client.unsubscribe",i.RENEW_TOKEN="Client.renewToken",i.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",i.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",i.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",i.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",i.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",i.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",i.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",i.DATACHANNEL_FAILBACK="Client._datachannelFailback",i.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",i.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",i.START_LIVE_STREAMING="Client.startLiveStreaming",i.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",i.STOP_LIVE_STREAMING="Client.stopLiveStreaming",i.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",i.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",i.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",i.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",i.SET_CONFIG_DISTRIBUTE="_configDistribute",i.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",i.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",i.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",i.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",i.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",i.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",i.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",i.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",i.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",i.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",i.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",i.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",i.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",i.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",i.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",i.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",i.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",i.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",i.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",i.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",i.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",i.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",i.STREAM_TYPE_CHANGE="streamTypeChange",i.CONNECTION_STATE_CHANGE="connectionStateChange",i.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",i.IMAGE_MODERATION_UPLOAD="imageModerationUpload"})(br||(br={})),function(i){i.TRACER="tracer"}(Bn||(Bn={})),function(i){i[i.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",i[i.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",i[i.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(qO||(qO={})),function(i){i.LEAVE="LEAVE",i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.UID_BANNED="UID_BANNED",i.IP_BANNED="IP_BANNED",i.CHANNEL_BANNED="CHANNEL_BANNED",i.FALLBACK="FALLBACK",i.LICENSE_MISSING="LICENSE_MISSING",i.LICENSE_EXPIRED="LICENSE_EXPIRED",i.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",i.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",i.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",i.LICENSE_ILLEGAL="LICENSE_ILLEGAL",i.TOKEN_EXPIRE="TOKEN_EXPIRE"}(Dt||(Dt={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.MEDIA_RECONNECT_START="media-reconnect-start",i.MEDIA_RECONNECT_END="media-reconnect-end",i.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",i.USER_JOINED="user-joined",i.USER_LEAVED="user-left",i.USER_PUBLISHED="user-published",i.USER_UNPUBLISHED="user-unpublished",i.USER_INFO_UPDATED="user-info-updated",i.CLIENT_BANNED="client-banned",i.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",i.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",i.VOLUME_INDICATOR="volume-indicator",i.CRYPT_ERROR="crypt-error",i.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",i.NETWORK_QUALITY="network-quality",i.STREAM_TYPE_CHANGED="stream-type-changed",i.STREAM_FALLBACK="stream-fallback",i.RECEIVE_METADATA="receive-metadata",i.STREAM_MESSAGE="stream-message",i.LIVE_STREAMING_ERROR="live-streaming-error",i.LIVE_STREAMING_WARNING="live-streaming-warning",i.INJECT_STREAM_STATUS="stream-inject-status",i.EXCEPTION="exception",i.ERROR="error",i.P2P_LOST="p2p_lost",i.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",i.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",i.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",i.PUBLISHED_USER_LIST="published-user-list",i.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",i.CONTENT_INSPECT_ERROR="content-inspect-error",i.CONTENT_INSPECT_RESULT="content-inspect-result",i.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change"}(Lt||(Lt={})),function(i){i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.MULTI_IP="MULTI_IP",i.TIMEOUT="TIMEOUT",i.OFFLINE="OFFLINE",i.LEAVE="LEAVE",i.P2P_FAILED="P2P_FAILED",i.FALLBACK="FALLBACK"}(ni||(ni={})),function(i){i.ONLINE="ONLINE",i.OFFLINE="OFFLINE"}(ns||(ns={})),function(i){i.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",i.ONLINE="ONLINE",i.OFFLINE="OFFLINE"}(Zl||(Zl={}));const Cr=new class extends jn{set networkState(i){this.emit(Zl.NETWORK_STATE_CHANGE,i,this._networkState),i===ns.ONLINE?this.emit(Zl.ONLINE):i===ns.OFFLINE&&(this.onlineWaiter=new pe(e=>{this.once(Zl.ONLINE,()=>{this.onlineWaiter=void 0,e(ns.ONLINE)})}),this.emit(Zl.OFFLINE)),this._networkState=i}get networkState(){return this._networkState}get isOnline(){return this._networkState===ns.ONLINE}constructor(){super(),R(this,"_moduleName","network-indicator"),R(this,"_networkState",ns.ONLINE),R(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=ns.ONLINE}),window.addEventListener("offline",()=>{this.networkState=ns.OFFLINE})}};var wre=gi,Rre=cs,Ire=sn,Are=Yc,Ore=TypeError,z5=function(i){return function(e,n,s,a){wre(n);var l=Rre(e),u=Ire(l),p=Are(l),m=i?p-1:0,g=i?-1:1;if(s<2)for(;;){if(m in u){a=u[m],m+=g;break}if(m+=g,i?m<0:p<=m)throw Ore("Reduce of empty array with no initial value")}for(;i?m>=0:p>m;m+=g)m in u&&(a=n(a,u[m],m,l));return a}},Nre={left:z5(!1),right:z5(!0)}.left;On({target:"Array",proto:!0,forced:!_E&&Tn>79&&Tn<83||!cO("reduce")},{reduce:function(i){var e=arguments.length;return Nre(this,i,e,e>1?arguments[1]:void 0)}});var kre=qc("Array").reduce,xre=x,Pre=kre,XO=Array.prototype,ed=d(function(i){var e=i.reduce;return i===XO||xre(XO,i)&&e===XO.reduce?Pre:e});function K5(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Zh(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?K5(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):K5(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function kb(i,e){const n=i.indexOf(e);n!==-1&&i.splice(n,1)}function qf(i){const e=[];return i.forEach(n=>{e.indexOf(n)===-1&&e.push(n)}),e}function xb(i){pe!==void 0?pe.resolve().then(i):setTimeout(i,0)}function Cn(i){return JSON.parse(JSON.stringify(i))}function ep(i){try{return Cn(i)}catch{return i}}const Y5={};function Xf(i,e){Y5[e]||(Y5[e]=!0,i())}function RE(i){const e=window.atob(i),n=new Uint8Array(new ArrayBuffer(e.length));for(let s=0;s<e.length;s+=1)n[s]=e.charCodeAt(s);return n}function Jf(i){let e="";for(let n=0;n<i.length;n+=1)e+=String.fromCharCode(i[n]);return window.btoa(e)}function q5(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];const s=ed(e).call(e,(u,p)=>u+p.length,0),a=new Uint8Array(new ArrayBuffer(s));let l=0;return e.forEach(u=>{a.set(u,l),l+=u.length}),a}function rl(i){return window.TextEncoder?new TextEncoder().encode(i).length:i.length}function X5(i){let e=0;return/DingTalk/i.test(navigator.userAgent)&&i.realFormData&&(i=i.realFormData),i.forEach(n=>{e+=typeof n=="string"?rl(n):n.size}),e+138}function Dre(i){const e=new ye(z.TIMEOUT,"timeout");return new pe((n,s)=>{window.setTimeout(()=>s(e),i)})}function ri(i){return new pe(e=>{window.setTimeout(e,i)})}function Sn(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,e=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,i).toLowerCase();return n.length===i?"".concat(e).concat(n):"".concat(e).concat(n)+Sn(i-n.length,"")}function JO(){return Sn(32,"").toUpperCase()}const Pb=()=>{},J5=new class{constructor(){R(this,"fnMap",new Map)}throttleByKey(i,e,n,s){for(var a=arguments.length,l=new Array(a>4?a-4:0),u=4;u<a;u++)l[u-4]=arguments[u];if(this.fnMap.has(e)){const p=this.fnMap.get(e);if(p.threshold!==n){p.fn(...p.args),clearTimeout(p.timer);const m=window.setTimeout(()=>{const g=this.fnMap.get(e);g&&g.fn(...g.args),this.fnMap.delete(e)},n);this.fnMap.set(e,{fn:i,threshold:n,timer:m,args:l,skipFn:s})}else p.skipFn&&p.skipFn(...p.args),this.fnMap.set(e,Zh(Zh({},p),{},{fn:i,args:l,skipFn:s}))}else{const p=window.setTimeout(()=>{const m=this.fnMap.get(e);m&&m.fn(...m.args),this.fnMap.delete(e)},n);this.fnMap.set(e,{fn:i,threshold:n,timer:p,args:l,skipFn:s})}}},Q5=J5.throttleByKey.bind(J5);function Z5(i){return typeof i=="object"&&i!==null&&!(i instanceof RegExp)}function QO(i,e){if(!Z5(i)||!Z5(e)||Array.isArray(i)&&!Array.isArray(e)||!Array.isArray(i)&&Array.isArray(e))return e;if(Array.isArray(e)&&Array.isArray(i)){const n=[...i];for(let s=0;s<e.length;s++)n[s]=QO(i[s],e[s]);return n}{const n=Zh({},i);for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(Object.prototype.hasOwnProperty.call(i,s)?n[s]=QO(i[s],e[s]):n[s]=e[s]);return n}}function e4(i,e){let n=[0];if(e&&(n=new Array(e).fill(0)),i===0)return n;let s=0;for(;i>0&&(n[s]=255&i,i>>=8,s++,!e||s!==e););return n}let Lre=1,Db=console;class ii{static setLogger(e){Db=e}constructor(e){R(this,"lockingPromise",pe.resolve()),R(this,"locks",0),R(this,"name",""),R(this,"lockId",void 0),this.lockId=Lre++,e&&(this.name=e),Db.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(e){let n;this.locks+=1,Db.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof e=="string"?e:""));const s=new pe(l=>{n=()=>{this.locks-=1,Db.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof e=="string"?e:"")),l()}}),a=this.lockingPromise.then(()=>n);return this.lockingPromise=this.lockingPromise.then(()=>s),a}}function Qf(i,e){return function(n,s,a){const l=a.value;if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){const u=this[e];if(!u)throw new Error("mutex property key ".concat(e," doesn't exist on ").concat(i));const p=await u.lock("From ".concat(i,".").concat(s));try{for(var m=arguments.length,g=new Array(m),E=0;E<m;E++)g[E]=arguments[E];return await l.apply(this,g)}finally{p()}},a}}const wr={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function Lb(i,e){const n=Math.floor(e.timeout*Math.pow(e.timeoutFactor,i));return Math.min(e.maxRetryTimeout,n)}function vc(i,e,n,s){const a=Object.assign({},wr,s);let l=a.timeout;const u=async()=>{await function(g){return new pe(E=>{window.setTimeout(E,g)})}(l),l*=a.timeoutFactor,l=Math.min(a.maxRetryTimeout,l)};let p=!1;const m=new pe(async(g,E)=>{e=e||(()=>!1),n=n||(()=>!0);for(let y=0;y<a.maxRetryCount;y+=1){if(p)return E(new ye(z.OPERATION_ABORTED));try{const C=await i();if(!e(C,y)||y+1===a.maxRetryCount)return g(C);await u()}catch(C){if(!n(C,y)||y+1===a.maxRetryCount)return E(C);await u()}}});return m.cancel=()=>p=!0,m}let ZO=class{constructor(i){R(this,"input",[]),R(this,"size",void 0),this.size=i}add(i){this.input.push(i),this.input.length>this.size&&this.input.splice(0,1)}mean(){var i;return this.input.length===0?0:ed(i=this.input).call(i,(e,n)=>e+n)/this.input.length}};function t4(i,e){return function(){return i.apply(e,arguments)}}const{toString:Mre}=Object.prototype,{getPrototypeOf:eN}=Object,Mb=(tN=Object.create(null),i=>{const e=Mre.call(i);return tN[e]||(tN[e]=e.slice(8,-1).toLowerCase())});var tN;const il=i=>(i=i.toLowerCase(),e=>Mb(e)===i),Ub=i=>e=>typeof e===i,{isArray:Zf}=Array,IE=Ub("undefined"),n4=il("ArrayBuffer"),Ure=Ub("string"),Ta=Ub("function"),r4=Ub("number"),jb=i=>i!==null&&typeof i=="object",Fb=i=>{if(Mb(i)!=="object")return!1;const e=eN(i);return!(e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.toStringTag in i||Symbol.iterator in i)},jre=il("Date"),Fre=il("File"),Vre=il("Blob"),Bre=il("FileList"),Wre=il("URLSearchParams");function AE(i,e,{allOwnKeys:n=!1}={}){if(i==null)return;let s,a;if(typeof i!="object"&&(i=[i]),Zf(i))for(s=0,a=i.length;s<a;s++)e.call(null,i[s],s,i);else{const l=n?Object.getOwnPropertyNames(i):Object.keys(i),u=l.length;let p;for(s=0;s<u;s++)p=l[s],e.call(null,i[p],p,i)}}function i4(i,e){e=e.toLowerCase();const n=Object.keys(i);let s,a=n.length;for(;a-- >0;)if(s=n[a],e===s.toLowerCase())return s;return null}const s4=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:nt,o4=i=>!IE(i)&&i!==s4,$re=(nN=typeof Uint8Array<"u"&&eN(Uint8Array),i=>nN&&i instanceof nN);var nN;const Gre=il("HTMLFormElement"),a4=(({hasOwnProperty:i})=>(e,n)=>i.call(e,n))(Object.prototype),Hre=il("RegExp"),c4=(i,e)=>{const n=Object.getOwnPropertyDescriptors(i),s={};AE(n,(a,l)=>{let u;(u=e(a,l,i))!==!1&&(s[l]=u||a)}),Object.defineProperties(i,s)},rN="abcdefghijklmnopqrstuvwxyz",l4="0123456789",d4={DIGIT:l4,ALPHA:rN,ALPHA_DIGIT:rN+rN.toUpperCase()+l4},zre=il("AsyncFunction");var Ge={isArray:Zf,isArrayBuffer:n4,isBuffer:function(i){return i!==null&&!IE(i)&&i.constructor!==null&&!IE(i.constructor)&&Ta(i.constructor.isBuffer)&&i.constructor.isBuffer(i)},isFormData:i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||Ta(i.append)&&((e=Mb(i))==="formdata"||e==="object"&&Ta(i.toString)&&i.toString()==="[object FormData]"))},isArrayBufferView:function(i){let e;return e=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer&&n4(i.buffer),e},isString:Ure,isNumber:r4,isBoolean:i=>i===!0||i===!1,isObject:jb,isPlainObject:Fb,isUndefined:IE,isDate:jre,isFile:Fre,isBlob:Vre,isRegExp:Hre,isFunction:Ta,isStream:i=>jb(i)&&Ta(i.pipe),isURLSearchParams:Wre,isTypedArray:$re,isFileList:Bre,forEach:AE,merge:function i(){const{caseless:e}=o4(this)&&this||{},n={},s=(a,l)=>{const u=e&&i4(n,l)||l;Fb(n[u])&&Fb(a)?n[u]=i(n[u],a):Fb(a)?n[u]=i({},a):Zf(a)?n[u]=a.slice():n[u]=a};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&AE(arguments[a],s);return n},extend:(i,e,n,{allOwnKeys:s}={})=>(AE(e,(a,l)=>{n&&Ta(a)?i[l]=t4(a,n):i[l]=a},{allOwnKeys:s}),i),trim:i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),inherits:(i,e,n,s)=>{i.prototype=Object.create(e.prototype,s),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:e.prototype}),n&&Object.assign(i.prototype,n)},toFlatObject:(i,e,n,s)=>{let a,l,u;const p={};if(e=e||{},i==null)return e;do{for(a=Object.getOwnPropertyNames(i),l=a.length;l-- >0;)u=a[l],s&&!s(u,i,e)||p[u]||(e[u]=i[u],p[u]=!0);i=n!==!1&&eN(i)}while(i&&(!n||n(i,e))&&i!==Object.prototype);return e},kindOf:Mb,kindOfTest:il,endsWith:(i,e,n)=>{i=String(i),(n===void 0||n>i.length)&&(n=i.length),n-=e.length;const s=i.indexOf(e,n);return s!==-1&&s===n},toArray:i=>{if(!i)return null;if(Zf(i))return i;let e=i.length;if(!r4(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=i[e];return n},forEachEntry:(i,e)=>{const n=(i&&i[Symbol.iterator]).call(i);let s;for(;(s=n.next())&&!s.done;){const a=s.value;e.call(i,a[0],a[1])}},matchAll:(i,e)=>{let n;const s=[];for(;(n=i.exec(e))!==null;)s.push(n);return s},isHTMLForm:Gre,hasOwnProperty:a4,hasOwnProp:a4,reduceDescriptors:c4,freezeMethods:i=>{c4(i,(e,n)=>{if(Ta(i)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=i[n];Ta(s)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(i,e)=>{const n={},s=a=>{a.forEach(l=>{n[l]=!0})};return Zf(i)?s(i):s(String(i).split(e)),n},toCamelCase:i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,s){return n.toUpperCase()+s}),noop:()=>{},toFiniteNumber:(i,e)=>(i=+i,Number.isFinite(i)?i:e),findKey:i4,global:s4,isContextDefined:o4,ALPHABET:d4,generateString:(i=16,e=d4.ALPHA_DIGIT)=>{let n="";const{length:s}=e;for(;i--;)n+=e[Math.random()*s|0];return n},isSpecCompliantForm:function(i){return!!(i&&Ta(i.append)&&i[Symbol.toStringTag]==="FormData"&&i[Symbol.iterator])},toJSONObject:i=>{const e=new Array(10),n=(s,a)=>{if(jb(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[a]=s;const l=Zf(s)?[]:{};return AE(s,(u,p)=>{const m=n(u,a+1);!IE(m)&&(l[p]=m)}),e[a]=void 0,l}}return s};return n(i,0)},isAsyncFn:zre,isThenable:i=>i&&(jb(i)||Ta(i))&&Ta(i.then)&&Ta(i.catch)};function Wn(i,e,n,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a)}Ge.inherits(Wn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ge.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const u4=Wn.prototype,h4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{h4[i]={value:i}}),Object.defineProperties(Wn,h4),Object.defineProperty(u4,"isAxiosError",{value:!0}),Wn.from=(i,e,n,s,a,l)=>{const u=Object.create(u4);return Ge.toFlatObject(i,u,function(p){return p!==Error.prototype},p=>p!=="isAxiosError"),Wn.call(u,i.message,e,n,s,a),u.cause=i,u.name=i.name,l&&Object.assign(u,l),u};function iN(i){return Ge.isPlainObject(i)||Ge.isArray(i)}function p4(i){return Ge.endsWith(i,"[]")?i.slice(0,-2):i}function f4(i,e,n){return i?i.concat(e).map(function(s,a){return s=p4(s),!n&&a?"["+s+"]":s}).join(n?".":""):e}const Kre=Ge.toFlatObject(Ge,{},null,function(i){return/^is[A-Z]/.test(i)});function Vb(i,e,n){if(!Ge.isObject(i))throw new TypeError("target must be an object");e=e||new FormData;const s=(n=Ge.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,I){return!Ge.isUndefined(I[C])})).metaTokens,a=n.visitor||g,l=n.dots,u=n.indexes,p=(n.Blob||typeof Blob<"u"&&Blob)&&Ge.isSpecCompliantForm(e);if(!Ge.isFunction(a))throw new TypeError("visitor must be a function");function m(C){if(C===null)return"";if(Ge.isDate(C))return C.toISOString();if(!p&&Ge.isBlob(C))throw new Wn("Blob is not supported. Use a Buffer instead.");return Ge.isArrayBuffer(C)||Ge.isTypedArray(C)?p&&typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}function g(C,I,j){let P=C;if(C&&!j&&typeof C=="object"){if(Ge.endsWith(I,"{}"))I=s?I:I.slice(0,-2),C=JSON.stringify(C);else if(Ge.isArray(C)&&function(U){return Ge.isArray(U)&&!U.some(iN)}(C)||(Ge.isFileList(C)||Ge.endsWith(I,"[]"))&&(P=Ge.toArray(C)))return I=p4(I),P.forEach(function(U,q){!Ge.isUndefined(U)&&U!==null&&e.append(u===!0?f4([I],q,l):u===null?I:I+"[]",m(U))}),!1}return!!iN(C)||(e.append(f4(j,I,l),m(C)),!1)}const E=[],y=Object.assign(Kre,{defaultVisitor:g,convertValue:m,isVisitable:iN});if(!Ge.isObject(i))throw new TypeError("data must be an object");return function C(I,j){if(!Ge.isUndefined(I)){if(E.indexOf(I)!==-1)throw Error("Circular reference detected in "+j.join("."));E.push(I),Ge.forEach(I,function(P,U){(!(Ge.isUndefined(P)||P===null)&&a.call(e,P,Ge.isString(U)?U.trim():U,j,y))===!0&&C(P,j?j.concat(U):[U])}),E.pop()}}(i),e}function m4(i){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function sN(i,e){this._pairs=[],i&&Vb(i,this,e)}const g4=sN.prototype;function Yre(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _4(i,e,n){if(!e)return i;const s=n&&n.encode||Yre,a=n&&n.serialize;let l;if(l=a?a(e,n):Ge.isURLSearchParams(e)?e.toString():new sN(e,n).toString(s),l){const u=i.indexOf("#");u!==-1&&(i=i.slice(0,u)),i+=(i.indexOf("?")===-1?"?":"&")+l}return i}g4.append=function(i,e){this._pairs.push([i,e])},g4.toString=function(i){const e=i?function(n){return i.call(this,n,m4)}:m4;return this._pairs.map(function(n){return e(n[0])+"="+e(n[1])},"").join("&")};var E4=class{constructor(){this.handlers=[]}use(i,e,n){return this.handlers.push({fulfilled:i,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(i){this.handlers[i]&&(this.handlers[i]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(i){Ge.forEach(this.handlers,function(e){e!==null&&i(e)})}},v4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},qre={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:sN,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const y4=typeof window<"u"&&typeof document<"u",Xre=(S4=typeof navigator<"u"&&navigator.product,y4&&["ReactNative","NativeScript","NS"].indexOf(S4)<0);var S4;const Jre=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";var sl={...Object.freeze({__proto__:null,hasBrowserEnv:y4,hasStandardBrowserEnv:Xre,hasStandardBrowserWebWorkerEnv:Jre}),...qre};function b4(i){function e(n,s,a,l){let u=n[l++];if(u==="__proto__")return!0;const p=Number.isFinite(+u),m=l>=n.length;return u=!u&&Ge.isArray(a)?a.length:u,m?(Ge.hasOwnProp(a,u)?a[u]=[a[u],s]:a[u]=s,!p):(a[u]&&Ge.isObject(a[u])||(a[u]=[]),e(n,s,a[u],l)&&Ge.isArray(a[u])&&(a[u]=function(g){const E={},y=Object.keys(g);let C;const I=y.length;let j;for(C=0;C<I;C++)j=y[C],E[j]=g[j];return E}(a[u])),!p)}if(Ge.isFormData(i)&&Ge.isFunction(i.entries)){const n={};return Ge.forEachEntry(i,(s,a)=>{e(function(l){return Ge.matchAll(/\w+|\[(\w*)]/g,l).map(u=>u[0]==="[]"?"":u[1]||u[0])}(s),a,n,0)}),n}return null}const oN={transitional:v4,adapter:["xhr","http"],transformRequest:[function(i,e){const n=e.getContentType()||"",s=n.indexOf("application/json")>-1,a=Ge.isObject(i);if(a&&Ge.isHTMLForm(i)&&(i=new FormData(i)),Ge.isFormData(i))return s?JSON.stringify(b4(i)):i;if(Ge.isArrayBuffer(i)||Ge.isBuffer(i)||Ge.isStream(i)||Ge.isFile(i)||Ge.isBlob(i))return i;if(Ge.isArrayBufferView(i))return i.buffer;if(Ge.isURLSearchParams(i))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),i.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(u,p){return Vb(u,new sl.classes.URLSearchParams,Object.assign({visitor:function(m,g,E,y){return sl.isNode&&Ge.isBuffer(m)?(this.append(g,m.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)}},p))}(i,this.formSerializer).toString();if((l=Ge.isFileList(i))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Vb(l?{"files[]":i}:i,u&&new u,this.formSerializer)}}return a||s?(e.setContentType("application/json",!1),function(u,p,m){if(Ge.isString(u))try{return(p||JSON.parse)(u),Ge.trim(u)}catch(g){if(g.name!=="SyntaxError")throw g}return(m||JSON.stringify)(u)}(i)):i}],transformResponse:[function(i){const e=this.transitional||oN.transitional,n=e&&e.forcedJSONParsing,s=this.responseType==="json";if(i&&Ge.isString(i)&&(n&&!this.responseType||s)){const a=!(e&&e.silentJSONParsing)&&s;try{return JSON.parse(i)}catch(l){if(a)throw l.name==="SyntaxError"?Wn.from(l,Wn.ERR_BAD_RESPONSE,this,null,this.response):l}}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:sl.classes.FormData,Blob:sl.classes.Blob},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ge.forEach(["delete","get","head","post","put","patch"],i=>{oN.headers[i]={}});var aN=oN;const Qre=Ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),T4=Symbol("internals");function OE(i){return i&&String(i).trim().toLowerCase()}function Bb(i){return i===!1||i==null?i:Ge.isArray(i)?i.map(Bb):String(i)}function cN(i,e,n,s,a){return Ge.isFunction(s)?s.call(this,e,n):(a&&(e=n),Ge.isString(e)?Ge.isString(s)?e.indexOf(s)!==-1:Ge.isRegExp(s)?s.test(e):void 0:void 0)}class Wb{constructor(e){e&&this.set(e)}set(e,n,s){const a=this;function l(p,m,g){const E=OE(m);if(!E)throw new Error("header name must be a non-empty string");const y=Ge.findKey(a,E);(!y||a[y]===void 0||g===!0||g===void 0&&a[y]!==!1)&&(a[y||m]=Bb(p))}const u=(p,m)=>Ge.forEach(p,(g,E)=>l(g,E,m));return Ge.isPlainObject(e)||e instanceof this.constructor?u(e,n):Ge.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?u((p=>{const m={};let g,E,y;return p&&p.split(`
`).forEach(function(C){y=C.indexOf(":"),g=C.substring(0,y).trim().toLowerCase(),E=C.substring(y+1).trim(),!g||m[g]&&Qre[g]||(g==="set-cookie"?m[g]?m[g].push(E):m[g]=[E]:m[g]=m[g]?m[g]+", "+E:E)}),m})(e),n):e!=null&&l(n,e,s),this}get(e,n){if(e=OE(e)){const s=Ge.findKey(this,e);if(s){const a=this[s];if(!n)return a;if(n===!0)return function(l){const u=Object.create(null),p=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let m;for(;m=p.exec(l);)u[m[1]]=m[2];return u}(a);if(Ge.isFunction(n))return n.call(this,a,s);if(Ge.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=OE(e)){const s=Ge.findKey(this,e);return!(!s||this[s]===void 0||n&&!cN(0,this[s],s,n))}return!1}delete(e,n){const s=this;let a=!1;function l(u){if(u=OE(u)){const p=Ge.findKey(s,u);!p||n&&!cN(0,s[p],p,n)||(delete s[p],a=!0)}}return Ge.isArray(e)?e.forEach(l):l(e),a}clear(e){const n=Object.keys(this);let s=n.length,a=!1;for(;s--;){const l=n[s];e&&!cN(0,this[l],l,e,!0)||(delete this[l],a=!0)}return a}normalize(e){const n=this,s={};return Ge.forEach(this,(a,l)=>{const u=Ge.findKey(s,l);if(u)return n[u]=Bb(a),void delete n[l];const p=e?function(m){return m.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(g,E,y)=>E.toUpperCase()+y)}(l):String(l).trim();p!==l&&delete n[l],n[p]=Bb(a),s[p]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return Ge.forEach(this,(s,a)=>{s!=null&&s!==!1&&(n[a]=e&&Ge.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(a=>s.set(a)),s}static accessor(e){const n=(this[T4]=this[T4]={accessors:{}}).accessors,s=this.prototype;function a(l){const u=OE(l);n[u]||(function(p,m){const g=Ge.toCamelCase(" "+m);["get","set","has"].forEach(E=>{Object.defineProperty(p,E+g,{value:function(y,C,I){return this[E].call(this,m,y,C,I)},configurable:!0})})}(s,l),n[u]=!0)}return Ge.isArray(e)?e.forEach(a):a(e),this}}Wb.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ge.reduceDescriptors(Wb.prototype,({value:i},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(s){this[n]=s}}}),Ge.freezeMethods(Wb);var td=Wb;function lN(i,e){const n=this||aN,s=e||n,a=td.from(s.headers);let l=s.data;return Ge.forEach(i,function(u){l=u.call(n,l,a.normalize(),e?e.status:void 0)}),a.normalize(),l}function C4(i){return!(!i||!i.__CANCEL__)}function NE(i,e,n){Wn.call(this,i??"canceled",Wn.ERR_CANCELED,e,n),this.name="CanceledError"}Ge.inherits(NE,Wn,{__CANCEL__:!0});var Zre=sl.hasStandardBrowserEnv?{write(i,e,n,s,a,l){const u=[i+"="+encodeURIComponent(e)];Ge.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),Ge.isString(s)&&u.push("path="+s),Ge.isString(a)&&u.push("domain="+a),l===!0&&u.push("secure"),document.cookie=u.join("; ")},read(i){const e=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function w4(i,e){return i&&!function(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}(e)?function(n,s){return s?n.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):n}(i,e):e}var eie=sl.hasStandardBrowserEnv?function(){const i=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function s(a){let l=a;return i&&(e.setAttribute("href",l),l=e.href),e.setAttribute("href",l),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=s(window.location.href),function(a){const l=Ge.isString(a)?s(a):a;return l.protocol===n.protocol&&l.host===n.host}}():function(){return!0};function R4(i,e){let n=0;const s=function(a,l){a=a||10;const u=new Array(a),p=new Array(a);let m,g=0,E=0;return l=l!==void 0?l:1e3,function(y){const C=Date.now(),I=p[E];m||(m=C),u[g]=y,p[g]=C;let j=E,P=0;for(;j!==g;)P+=u[j++],j%=a;if(g=(g+1)%a,g===E&&(E=(E+1)%a),C-m<l)return;const U=I&&C-I;return U?Math.round(1e3*P/U):void 0}}(50,250);return a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,p=l-n,m=s(p);n=l;const g={loaded:l,total:u,progress:u?l/u:void 0,bytes:p,rate:m||void 0,estimated:m&&u&&l<=u?(u-l)/m:void 0,event:a};g[e?"download":"upload"]=!0,i(g)}}var tie=typeof XMLHttpRequest<"u"&&function(i){return new Promise(function(e,n){let s=i.data;const a=td.from(i.headers).normalize();let l,u,{responseType:p,withXSRFToken:m}=i;function g(){i.cancelToken&&i.cancelToken.unsubscribe(l),i.signal&&i.signal.removeEventListener("abort",l)}if(Ge.isFormData(s)){if(sl.hasStandardBrowserEnv||sl.hasStandardBrowserWebWorkerEnv)a.setContentType(!1);else if((u=a.getContentType())!==!1){const[j,...P]=u?u.split(";").map(U=>U.trim()).filter(Boolean):[];a.setContentType([j||"multipart/form-data",...P].join("; "))}}let E=new XMLHttpRequest;if(i.auth){const j=i.auth.username||"",P=i.auth.password?unescape(encodeURIComponent(i.auth.password)):"";a.set("Authorization","Basic "+btoa(j+":"+P))}const y=w4(i.baseURL,i.url);function C(){if(!E)return;const j=td.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders());(function(P,U,q){const J=q.config.validateStatus;q.status&&J&&!J(q.status)?U(new Wn("Request failed with status code "+q.status,[Wn.ERR_BAD_REQUEST,Wn.ERR_BAD_RESPONSE][Math.floor(q.status/100)-4],q.config,q.request,q)):P(q)})(function(P){e(P),g()},function(P){n(P),g()},{data:p&&p!=="text"&&p!=="json"?E.response:E.responseText,status:E.status,statusText:E.statusText,headers:j,config:i,request:E}),E=null}if(E.open(i.method.toUpperCase(),_4(y,i.params,i.paramsSerializer),!0),E.timeout=i.timeout,"onloadend"in E?E.onloadend=C:E.onreadystatechange=function(){E&&E.readyState===4&&(E.status!==0||E.responseURL&&E.responseURL.indexOf("file:")===0)&&setTimeout(C)},E.onabort=function(){E&&(n(new Wn("Request aborted",Wn.ECONNABORTED,i,E)),E=null)},E.onerror=function(){n(new Wn("Network Error",Wn.ERR_NETWORK,i,E)),E=null},E.ontimeout=function(){let j=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const P=i.transitional||v4;i.timeoutErrorMessage&&(j=i.timeoutErrorMessage),n(new Wn(j,P.clarifyTimeoutError?Wn.ETIMEDOUT:Wn.ECONNABORTED,i,E)),E=null},sl.hasStandardBrowserEnv&&(m&&Ge.isFunction(m)&&(m=m(i)),m||m!==!1&&eie(y))){const j=i.xsrfHeaderName&&i.xsrfCookieName&&Zre.read(i.xsrfCookieName);j&&a.set(i.xsrfHeaderName,j)}s===void 0&&a.setContentType(null),"setRequestHeader"in E&&Ge.forEach(a.toJSON(),function(j,P){E.setRequestHeader(P,j)}),Ge.isUndefined(i.withCredentials)||(E.withCredentials=!!i.withCredentials),p&&p!=="json"&&(E.responseType=i.responseType),typeof i.onDownloadProgress=="function"&&E.addEventListener("progress",R4(i.onDownloadProgress,!0)),typeof i.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",R4(i.onUploadProgress)),(i.cancelToken||i.signal)&&(l=j=>{E&&(n(!j||j.type?new NE(null,i,E):j),E.abort(),E=null)},i.cancelToken&&i.cancelToken.subscribe(l),i.signal&&(i.signal.aborted?l():i.signal.addEventListener("abort",l)));const I=function(j){const P=/^([-+\w]{1,25})(:?\/\/|:)/.exec(j);return P&&P[1]||""}(y);I&&sl.protocols.indexOf(I)===-1?n(new Wn("Unsupported protocol "+I+":",Wn.ERR_BAD_REQUEST,i)):E.send(s||null)})};const dN={http:null,xhr:tie};Ge.forEach(dN,(i,e)=>{if(i){try{Object.defineProperty(i,"name",{value:e})}catch{}Object.defineProperty(i,"adapterName",{value:e})}});const I4=i=>`- ${i}`,nie=i=>Ge.isFunction(i)||i===null||i===!1;var A4={getAdapter:i=>{i=Ge.isArray(i)?i:[i];const{length:e}=i;let n,s;const a={};for(let l=0;l<e;l++){let u;if(n=i[l],s=n,!nie(n)&&(s=dN[(u=String(n)).toLowerCase()],s===void 0))throw new Wn(`Unknown adapter '${u}'`);if(s)break;a[u||"#"+l]=s}if(!s){const l=Object.entries(a).map(([u,p])=>`adapter ${u} `+(p===!1?"is not supported by the environment":"is not available in the build"));throw new Wn("There is no suitable adapter to dispatch the request "+(e?l.length>1?`since :
`+l.map(I4).join(`
`):" "+I4(l[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return s},adapters:dN};function uN(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new NE(null,i)}function O4(i){return uN(i),i.headers=td.from(i.headers),i.data=lN.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),A4.getAdapter(i.adapter||aN.adapter)(i).then(function(e){return uN(i),e.data=lN.call(i,i.transformResponse,e),e.headers=td.from(e.headers),e},function(e){return C4(e)||(uN(i),e&&e.response&&(e.response.data=lN.call(i,i.transformResponse,e.response),e.response.headers=td.from(e.response.headers))),Promise.reject(e)})}const N4=i=>i instanceof td?i.toJSON():i;function em(i,e){e=e||{};const n={};function s(g,E,y){return Ge.isPlainObject(g)&&Ge.isPlainObject(E)?Ge.merge.call({caseless:y},g,E):Ge.isPlainObject(E)?Ge.merge({},E):Ge.isArray(E)?E.slice():E}function a(g,E,y){return Ge.isUndefined(E)?Ge.isUndefined(g)?void 0:s(void 0,g,y):s(g,E,y)}function l(g,E){if(!Ge.isUndefined(E))return s(void 0,E)}function u(g,E){return Ge.isUndefined(E)?Ge.isUndefined(g)?void 0:s(void 0,g):s(void 0,E)}function p(g,E,y){return y in e?s(g,E):y in i?s(void 0,g):void 0}const m={url:l,method:l,data:l,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:p,headers:(g,E)=>a(N4(g),N4(E),!0)};return Ge.forEach(Object.keys(Object.assign({},i,e)),function(g){const E=m[g]||a,y=E(i[g],e[g],g);Ge.isUndefined(y)&&E!==p||(n[g]=y)}),n}const k4="1.6.7",hN={};["object","boolean","number","function","string","symbol"].forEach((i,e)=>{hN[i]=function(n){return typeof n===i||"a"+(e<1?"n ":" ")+i}});const x4={};hN.transitional=function(i,e,n){function s(a,l){return"[Axios v"+k4+"] Transitional option '"+a+"'"+l+(n?". "+n:"")}return(a,l,u)=>{if(i===!1)throw new Wn(s(l," has been removed"+(e?" in "+e:"")),Wn.ERR_DEPRECATED);return e&&!x4[l]&&(x4[l]=!0,console.warn(s(l," has been deprecated since v"+e+" and will be removed in the near future"))),!i||i(a,l,u)}};var pN={assertOptions:function(i,e,n){if(typeof i!="object")throw new Wn("options must be an object",Wn.ERR_BAD_OPTION_VALUE);const s=Object.keys(i);let a=s.length;for(;a-- >0;){const l=s[a],u=e[l];if(u){const p=i[l],m=p===void 0||u(p,l,i);if(m!==!0)throw new Wn("option "+l+" must be "+m,Wn.ERR_BAD_OPTION_VALUE)}else if(n!==!0)throw new Wn("Unknown option "+l,Wn.ERR_BAD_OPTION)}},validators:hN};const cu=pN.validators;let $b=class{constructor(i){this.defaults=i,this.interceptors={request:new E4,response:new E4}}async request(i,e){try{return await this._request(i,e)}catch(n){if(n instanceof Error){let s;Error.captureStackTrace?Error.captureStackTrace(s={}):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}throw n}}_request(i,e){typeof i=="string"?(e=e||{}).url=i:e=i||{},e=em(this.defaults,e);const{transitional:n,paramsSerializer:s,headers:a}=e;n!==void 0&&pN.assertOptions(n,{silentJSONParsing:cu.transitional(cu.boolean),forcedJSONParsing:cu.transitional(cu.boolean),clarifyTimeoutError:cu.transitional(cu.boolean)},!1),s!=null&&(Ge.isFunction(s)?e.paramsSerializer={serialize:s}:pN.assertOptions(s,{encode:cu.function,serialize:cu.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let l=a&&Ge.merge(a.common,a[e.method]);a&&Ge.forEach(["delete","get","head","post","put","patch","common"],I=>{delete a[I]}),e.headers=td.concat(l,a);const u=[];let p=!0;this.interceptors.request.forEach(function(I){typeof I.runWhen=="function"&&I.runWhen(e)===!1||(p=p&&I.synchronous,u.unshift(I.fulfilled,I.rejected))});const m=[];let g;this.interceptors.response.forEach(function(I){m.push(I.fulfilled,I.rejected)});let E,y=0;if(!p){const I=[O4.bind(this),void 0];for(I.unshift.apply(I,u),I.push.apply(I,m),E=I.length,g=Promise.resolve(e);y<E;)g=g.then(I[y++],I[y++]);return g}E=u.length;let C=e;for(y=0;y<E;){const I=u[y++],j=u[y++];try{C=I(C)}catch(P){j.call(this,P);break}}try{g=O4.call(this,C)}catch(I){return Promise.reject(I)}for(y=0,E=m.length;y<E;)g=g.then(m[y++],m[y++]);return g}getUri(i){return _4(w4((i=em(this.defaults,i)).baseURL,i.url),i.params,i.paramsSerializer)}};Ge.forEach(["delete","get","head","options"],function(i){$b.prototype[i]=function(e,n){return this.request(em(n||{},{method:i,url:e,data:(n||{}).data}))}}),Ge.forEach(["post","put","patch"],function(i){function e(n){return function(s,a,l){return this.request(em(l||{},{method:i,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}$b.prototype[i]=e(),$b.prototype[i+"Form"]=e(!0)});var Gb=$b;class fN{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const s=this;this.promise.then(a=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](a);s._listeners=null}),this.promise.then=a=>{let l;const u=new Promise(p=>{s.subscribe(p),l=p}).then(a);return u.cancel=function(){s.unsubscribe(l)},u},e(function(a,l,u){s.reason||(s.reason=new NE(a,l,u),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new fN(function(n){e=n}),cancel:e}}}var rie=fN;const mN={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(mN).forEach(([i,e])=>{mN[e]=i});var iie=mN;const Gi=function i(e){const n=new Gb(e),s=t4(Gb.prototype.request,n);return Ge.extend(s,Gb.prototype,n,{allOwnKeys:!0}),Ge.extend(s,n,null,{allOwnKeys:!0}),s.create=function(a){return i(em(e,a))},s}(aN);Gi.Axios=Gb,Gi.CanceledError=NE,Gi.CancelToken=rie,Gi.isCancel=C4,Gi.VERSION=k4,Gi.toFormData=Vb,Gi.AxiosError=Wn,Gi.Cancel=Gi.CanceledError,Gi.all=function(i){return Promise.all(i)},Gi.spread=function(i){return function(e){return i.apply(null,e)}},Gi.isAxiosError=function(i){return Ge.isObject(i)&&i.isAxiosError===!0},Gi.mergeConfig=em,Gi.AxiosHeaders=td,Gi.formToJSON=i=>b4(Ge.isHTMLForm(i)?new FormData(i):i),Gi.getAdapter=A4.getAdapter,Gi.HttpStatusCode=iie,Gi.default=Gi;var Ls=Gi;function P4(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function D4(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?P4(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):P4(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}let Hb,zb=0,gN=0;function _N(i,e,n,s){return new pe((a,l)=>{e.responseType=e.responseType||"json",e.data&&!n?(e.data=JSON.stringify(e.data),zb+=rl(e.data)):n&&(e.data.size?zb+=e.data.size:e.data instanceof FormData?zb+=X5(e.data):zb+=rl(JSON.stringify(e.data))),e.headers=e.headers||{},e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.method="POST",e.url=i,Ls.request(e).then(u=>{typeof u.data=="string"?gN+=rl(u.data):u.data instanceof ArrayBuffer||u.data instanceof Uint8Array?gN+=u.data.byteLength:gN+=rl(JSON.stringify(u.data)),s&&a({data:u.data,headers:u.headers}),a(u.data)}).catch(u=>{Ls.isCancel(u)?l(new ye(z.OPERATION_ABORTED,"cancel token canceled")):u.code==="ECONNABORTED"?l(new ye(z.NETWORK_TIMEOUT,u.message)):u.response?l(new ye(z.NETWORK_RESPONSE_ERROR,u.response.status)):l(new ye(z.NETWORK_ERROR,u.message))})})}async function sie(i,e){const n=new Blob([e.data],{type:"buffer"});return await _N(i,D4(D4({},e),{},{data:n,headers:{"Content-Type":"application/octet-stream"}}),!0)}const oie=()=>(Hb||Hb||(Hb=(window.location.protocol.split(":")[0]||"").toUpperCase(),Hb))==="HTTPS",L4=()=>window.isSecureContext!==void 0,qo=function(i){if(i.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return i;const e=i.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(e&&e[1]&&e[2]){const s=e[1],a=e[2];return"".concat(s,".").concat(a)}const n=i.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(n&&n[1]&&n[2]){const s=n[1],a=n[2];return"".concat(s,".").concat(100*(Number(a)+1))}return"4.0.0.999"}("4.20.2"),EN=function(){try{return JSON.parse("true")===!0}catch{return!0}}();var nd;(function(i){i.Default="default",i.Auto="auto",i.Relay="relay",i.SdRtn="sd-rtn"})(nd||(nd={}));const vN="v4.20.2-0-g8ae7fdad(3/20/2024, 4:48:46 PM)",rs={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!1,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!1,USE_SUB_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:100,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,DISABLE_FEC:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,ENABLE_DATASTREAM_2:!1,DATASTREAM_MAX_RETRANSMITS:10,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_INSTANT_VIDEO:!1,ENABLE_NTP_REPORT:!1,USE_XR:!1,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],PLUGIN_INFO:[]};function fn(i,e,n){var s,a;je(s=Object.keys(rs)).call(s,i)&&(!n&&je(a=Object.keys(lu)).call(a,i)||(rs[i]=e,i==="ENABLE_VIDEO_SEI"&&e===!0&&(rs.ENABLE_ENCODED_TRANSFORM=!0)))}function Z(i){return rs[i]}const lu={};function M4(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Je(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?M4(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):M4(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}var kt;(function(i){i.SET_SESSION_ID="SET_SESSION_ID",i.SET_P2P_ID="SET_P2P_id",i.SET_DC_ID="SET_DC_id",i.SET_UID="SET_UID",i.SET_INT_UID="SET_INT_UID",i.SET_PUB_ID="SET_PUB_ID",i.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",i.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",i.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",i.AVOID_JOIN_START="AVOID_JOIN_START",i.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",i.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",i.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",i.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",i.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",i.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",i.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",i.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",i.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",i.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",i.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",i.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",i.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",i.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",i.RESET_KEY_METRICS="RESET_KEY_METRICS",i.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL",i.SET_USE_P2P="SET_USE_P2P",i.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE"})(kt||(kt={}));class aie{constructor(e,n,s,a){R(this,"state",void 0),this.state={codec:e,audioCodec:n,mode:s,clientId:a,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1,useP2P:!1,p2pTransport:nd.Default}}dispatch(e){this.state=function(n,s){switch(s.type){case kt.SET_SESSION_ID:return Je(Je({},n),{},{sessionId:s.sessionId});case kt.SET_P2P_ID:return Je(Je({},n),{},{p2pId:s.p2pId});case kt.SET_UID:return Je(Je({},n),{},{uid:s.uid});case kt.SET_INT_UID:return Je(Je({},n),{},{intUid:s.intUid});case kt.SET_PUB_ID:return Je(Je({},n),{},{pubId:s.pubId});case kt.KEY_METRIC_CLIENT_CREATED:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{clientCreated:s.metric})});case kt.KEY_METRIC_JOIN_START:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{joinStart:s.metric})});case kt.AVOID_JOIN_START:return Je(Je({},n),{},{avoidJoinStart:s.avoidJoinStart});case kt.KEY_METRIC_JOIN_END:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{joinEnd:s.metric})});case kt.KEY_METRIC_REQUEST_AP_START:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{requestAPStart:s.metric})});case kt.KEY_METRIC_REQUEST_AP_END:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{requestAPEnd:s.metric})});case kt.KEY_METRIC_JOIN_GATEWAY_START:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{joinGatewayStart:s.metric})});case kt.KEY_METRIC_JOIN_GATEWAY_END:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{joinGatewayEnd:s.metric})});case kt.KEY_METRIC_PEER_CONNECTION_START:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{peerConnectionStart:s.metric})});case kt.KEY_METRIC_PEER_CONNECTION_END:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{peerConnectionEnd:s.metric})});case kt.KEY_METRIC_DESCRIPTION_START:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{descriptionStart:s.metric})});case kt.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{signalChannelOpen:s.metric})});case kt.KEY_METRIC_ICE_CONNECTION_END:return Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{iceConnectionEnd:s.metric})});case kt.KEY_METRIC_PUBLISH:{const a=n.keyMetrics.publish,l=a.findIndex(u=>u.trackId===s.metric.trackId);return l!==-1?(a[l]=Je(Je({},a[l]),s.metric),Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{publish:[...a]})})):Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{publish:[...n.keyMetrics.publish,s.metric]})})}case kt.KEY_METRIC_SUBSCRIBE:{const a=n.keyMetrics.subscribe,l=a.findIndex(u=>u.userId===s.metric.userId&&u.type===s.metric.type);return l!==-1?(a[l]=Je(Je({},a[l]),s.metric),Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{subscribe:[...a]})})):Je(Je({},n),{},{keyMetrics:Je(Je({},n.keyMetrics),{},{subscribe:[...n.keyMetrics.subscribe,s.metric]})})}case kt.SET_CLOUD_PROXY_SERVER_MODE:return n.cloudProxyServerMode=s.mode,n;case kt.RECORD_JOIN_CHANNEL_SERVICE:return typeof s.index!="number"?n.joinChannelServiceRecords=[...n.joinChannelServiceRecords,s.record]:(n.joinChannelServiceRecords[s.index]=Je(Je({},n.joinChannelServiceRecords[s.index]),s.record),n.joinChannelServiceRecords=[...n.joinChannelServiceRecords]),n;case kt.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return n.joinChannelServiceRecords=[],n;case kt.RESET_KEY_METRICS:return n.keyMetrics={publish:[],subscribe:[]},n;case kt.SET_USE_DATACHANNEL:return Je(Je({},n),{},{useDataChannel:s.val});case kt.SET_USE_P2P:return Je(Je({},n),{},{useP2P:s.val});case kt.SET_TRANSPORT_TYPE:return Je(Je({},n),{},{p2pTransport:s.val});default:return n}}(this.state,e)}set sessionId(e){this.dispatch({type:kt.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.state.sessionId}set codec(e){this.state.codec=e}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(e){this.dispatch({type:kt.SET_P2P_ID,p2pId:e})}get p2pId(){return this.state.p2pId}set dcId(e){this.dispatch({type:kt.SET_DC_ID,dcId:e})}get dcId(){return this.state.dcId}set uid(e){this.dispatch({type:kt.SET_UID,uid:e})}get uid(){return this.state.uid}set intUid(e){this.dispatch({type:kt.SET_INT_UID,intUid:e})}get intUid(){return this.state.intUid}set pubId(e){this.dispatch({type:kt.SET_PUB_ID,pubId:e})}get pubId(){return this.state.pubId}set cloudProxyServerMode(e){this.dispatch({type:kt.SET_CLOUD_PROXY_SERVER_MODE,mode:e})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(e){this.dispatch({type:kt.SET_USE_DATACHANNEL,val:e})}get useDataChannel(){return this.state.useDataChannel}set useP2P(e){this.dispatch({type:kt.SET_USE_P2P,val:e})}get useP2P(){return this.state.useP2P}set p2pTransport(e){this.dispatch({type:kt.SET_TRANSPORT_TYPE,val:e})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:kt.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:kt.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:kt.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:kt.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:kt.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:kt.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:kt.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:kt.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:kt.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:kt.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:kt.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:kt.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(e,n,s,a){this.dispatch({type:kt.KEY_METRIC_PUBLISH,metric:Je(Je({trackId:e,type:n},s&&{publishStart:s}),a&&{publishEnd:a})})}subscribe(e,n,s,a,l,u,p){this.dispatch({type:kt.KEY_METRIC_SUBSCRIBE,metric:Je(Je(Je(Je(Je({userId:e,type:n},s&&{subscribeStart:s}),a&&{subscribeEnd:a}),l&&{firstFrame:l}),u&&{streamAdded:u}),p&&{firstDecoded:p})})}massSubscribe(e,n,s,a){e.forEach(l=>{this.dispatch({type:kt.KEY_METRIC_SUBSCRIBE,metric:Je(Je(Je({userId:l.userId,type:l.type},n&&{subscribeStart:n}),s&&{subscribeEnd:s}),a&&{firstFrame:a})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(e,n){e.service==="gateway"&&Array.isArray(e.urls)&&(e.urls=e.urls.map(s=>s.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof n!="number"?(this.dispatch({type:kt.RECORD_JOIN_CHANNEL_SERVICE,record:Je(Je({},e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(n<0||n>=this.state.joinChannelServiceRecords.length||this.dispatch({type:kt.RECORD_JOIN_CHANNEL_SERVICE,record:e,index:n}),n)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:kt.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:kt.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(e){this.dispatch({type:kt.AVOID_JOIN_START,avoidJoinStart:e})}}var du,U4;(function(i){i.h264="h264",i.h265="h265",i.vp8="vp8",i.vp9="vp9",i.av1="av1"})(du||(du={})),function(i){i.opus="opus",i.pcma="pcma",i.pcmu="pcmu",i.g722="g722"}(U4||(U4={}));const j4=128,cie=96,F4=1e3,tm=10;let lie=0;const Kb=new class extends jn{reportLogUploadError(i){this.emit("REPORT_LOG_UPLOAD",i)}};class die{constructor(e){R(this,"logger",void 0),R(this,"prefixLists",[]),this.logger=e}debug(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];this.logger.debug(...this.prefixLists,...n)}info(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];this.logger.info(...this.prefixLists,...n)}warning(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];this.logger.warning(...this.prefixLists,...n)}error(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];this.logger.error(...this.prefixLists,...n)}prefix(e){return this.prefixLists.push(e),this}popPrefix(){return this.prefixLists.pop(),this}}function yN(){const i=new Date;return i.toTimeString().split(" ")[0]+":"+i.getMilliseconds()}function V4(){const i=new Date,e=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return e?(e==null?void 0:e[0])+":"+i.getUTCMilliseconds():i.toTimeString().split(" ")[0]+":"+i.getMilliseconds()}const Xo={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Yb=Date.now(),kE=i=>{for(const e in Xo)if(Object.prototype.hasOwnProperty.call(Xo,e)&&Xo[e]===i)return e;return"DEFAULT"},N=new class{constructor(){R(this,"proxyServerURL",void 0),R(this,"logLevel",Xo.DEBUG),R(this,"uploadState","collecting"),R(this,"uploadLogWaitingList",[]),R(this,"uploadLogUploadingList",[]),R(this,"uploadErrorCount",0),R(this,"currentLogID",0),R(this,"url",void 0),R(this,"extLog",(i,e)=>{this.appendLogToWaitingList(i,...e)})}debug(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];const s=[Xo.DEBUG].concat(e);this.log.apply(this,s)}info(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];const s=[Xo.INFO].concat(e);this.log.apply(this,s)}warning(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];const s=[Xo.WARNING].concat(e);this.log.apply(this,s)}warn(){this.warning(...arguments)}error(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];const s=[Xo.ERROR].concat(e);this.log.apply(this,s)}upload(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];const s=[Xo.DEBUG].concat(e);this.uploadLog.apply(this,s)}setLogLevel(i){i=Math.min(Math.max(0,i),4),this.logLevel=i}enableLogUpload(){fn("UPLOAD_LOG",!0)}disableLogUpload(){fn("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(i){this.proxyServerURL=i}prefix(i){return new die(this).prefix(i)}log(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];if(Date.now()-Yb<100)return void setTimeout(()=>{this.log(...e)},Date.now()-Yb);const s=Math.max(0,Math.min(4,e[0]));if(e[0]=yN()+" Agora-SDK [".concat(kE(s),"]:"),this.appendLogToWaitingList(s,...e),s<this.logLevel)return;const a=yN()+" %cAgora-SDK [".concat(kE(s),"]:");let l=[];if(!Z("USE_NEW_LOG"))switch(s){case Xo.DEBUG:l=[a,"color: #64B5F6;"].concat(e.slice(1)),console.log.apply(console,l);break;case Xo.INFO:l=[a,"color: #1E88E5; font-weight: bold;"].concat(e.slice(1)),console.log.apply(console,l);break;case Xo.WARNING:l=[a,"color: #FB8C00; font-weight: bold;"].concat(e.slice(1)),console.warn.apply(console,l);break;case Xo.ERROR:l=[a,"color: #B00020; font-weight: bold;"].concat(e.slice(1)),console.error.apply(console,l)}}uploadLog(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];if(Date.now()-Yb<100)return void setTimeout(()=>{this.uploadLog(...e)},Date.now()-Yb);const s=Math.max(0,Math.min(4,e[0]));e[0]=yN()+" Agora-SDK [".concat(kE(s),"]:"),this.appendLogToWaitingList(s,...e)}appendLogToWaitingList(i){if(!Z("UPLOAD_LOG"))return;for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];Array.isArray(n[0])?n[0][0]=V4()+" Agora-SDK [".concat(kE(i),"]:"):n[0]=V4()+" Agora-SDK [".concat(kE(i),"]:");let a="";n.forEach(l=>{typeof l=="object"&&(l=JSON.stringify(l)),a+="".concat(l," ")}),this.uploadLogWaitingList.push({payload_str:a,log_level:i,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const i=this.uploadLogUploadingList,e={sdk_version:qo,process_id:Z("PROCESS_ID"),payload:JSON.stringify(i)};return vc(async()=>{const n=await Ls.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(Z("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Z("LOG_UPLOAD_SERVER"),"/upload/v1")),e,{responseType:"text"});if(n.data!=="OK"){const s=new Error("unexpected upload log response");throw s.response=n,s}},()=>(this.uploadLogUploadingList=[],!1),n=>(n.response?Kb.reportLogUploadError({status:n.response.status,data:n.response.data,headers:n.response.headers,message:n.message}):n.request?Kb.reportLogUploadError({status:n.request.status,message:n.message}):Kb.reportLogUploadError({status:-1,message:n.message}),!0),{timeout:Z("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:Z("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,Z("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_INTERVAL"))}).catch(i=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var B4,W4;function uie(i){return xi(i.reportId,"params.reportId",0,100,!1),xi(i.category,"params.category",0,100,!1),xi(i.event,"params.event",0,100,!1),xi(i.label,"params.label",0,100,!1),pn(i.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(function(i){i.FREE="free",i.UPLOADING="uploading"})(B4||(B4={})),function(i){i[i.MISC=0]="MISC",i[i.INTERNAL_EVENT=1]="INTERNAL_EVENT",i[i.PUBLIC_EVENT=2]="PUBLIC_EVENT",i[i.WEB_EVENT=3]="WEB_EVENT",i[i.INTERNAL_API=4]="INTERNAL_API",i[i.WEB_API=5]="WEB_API",i[i.PUBLIC_API=6]="PUBLIC_API"}(W4||(W4={}));const hie={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var Mr,kn,$4,G4;function H4(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Tt(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H4(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):H4(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}(function(i){i.PUBLISH="publish",i.SUBSCRIBE="subscribe",i.WS_COMPRESSOR_INIT="ws_compressor_init",i.SESSION_INIT="session_init",i.JOIN_CHOOSE_SERVER="join_choose_server",i.REQ_USER_ACCOUNT="req_user_account",i.JOIN_GATEWAY="join_gateway",i.REJOIN_GATEWAY="rejoin_gateway",i.STREAM_SWITCH="stream_switch",i.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",i.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",i.FIRST_VIDEO_RECEIVED="first_video_received",i.FIRST_AUDIO_RECEIVED="first_audio_received",i.FIRST_VIDEO_DECODE="first_video_decode",i.FIRST_AUDIO_DECODE="first_audio_decode",i.ON_ADD_AUDIO_STREAM="on_add_audio_stream",i.ON_ADD_VIDEO_STREAM="on_add_video_stream",i.ON_UPDATE_STREAM="on_update_stream",i.ON_REMOVE_STREAM="on_remove_stream",i.USER_ANALYTICS="req_user_analytics",i.PC_STATS="pc_stats",i.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities"})(Mr||(Mr={})),function(i){i.SESSION="io.agora.pb.Wrtc.Session",i.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",i.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",i.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",i.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",i.PUBLISH="io.agora.pb.Wrtc.Publish",i.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",i.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",i.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",i.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",i.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",i.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",i.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",i.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",i.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",i.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",i.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",i.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",i.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",i.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",i.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",i.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",i.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",i.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",i.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",i.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",i.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",i.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",i.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",i.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",i.PC_STATS="io.agora.pb.Wrtc.PCStats",i.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities"}(kn||(kn={})),function(i){i[i.WORKER_EVENT=156]="WORKER_EVENT",i[i.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}($4||($4={})),function(i){i[i.SESSION=26]="SESSION",i[i.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",i[i.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",i[i.JOIN_GATEWAY=28]="JOIN_GATEWAY",i[i.PUBLISH=30]="PUBLISH",i[i.SUBSCRIBE=29]="SUBSCRIBE",i[i.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",i[i.STREAM_SWITCH=32]="STREAM_SWITCH",i[i.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",i[i.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",i[i.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",i[i.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",i[i.API_INVOKE=41]="API_INVOKE",i[i.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",i[i.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",i[i.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",i[i.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",i[i.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",i[i.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",i[i.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",i[i.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",i[i.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",i[i.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",i[i.WORKER_EVENT=156]="WORKER_EVENT",i[i.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",i[i.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",i[i.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",i[i.USER_ANALYTICS=1e4]="USER_ANALYTICS",i[i.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(G4||(G4={}));class xE{constructor(){R(this,"baseInfoMap",new Map),R(this,"proxyServer",void 0),R(this,"eventUploadTimer",void 0),R(this,"setSessionIdTimer",void 0),R(this,"url",void 0),R(this,"backupUrl",void 0),R(this,"_appId",void 0),R(this,"keyEventUploadPendingItems",[]),R(this,"normalEventUploadPendingItems",[]),R(this,"apiInvokeUploadPendingItems",[]),R(this,"apiInvokeCount",0),R(this,"ltsList",[]),R(this,"lastSendNormalEventTime",Date.now()),R(this,"customReportCounterTimer",void 0),R(this,"customReportCount",0),R(this,"extApiInvoke",async e=>{for(const n of e){const s=Tt(Tt({},n),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Bn.TRACER});this.sendApiInvoke(s)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),Z("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),Z("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}adjustSessionStartTime(e){if(!this.baseInfoMap.has(e)&&!this.baseInfoMap.get(e))return void N.error("adjust session ".concat(e," start time, sid is not exist or info is undefined"));const n=this.baseInfoMap.get(e),s=Date.now(),a=n.startTime;n.startTime=s,N.debug("rewrite session ".concat(e," startTime: ").concat(s," , ").concat(s-a,"ms")),this.baseInfoMap.set(e,n)}setAppId(e){this._appId=e}reportApiInvoke(e,n,s){n.timeout=n.timeout||6e4,n.reportResult=n.reportResult===void 0||n.reportResult;const a=Date.now();this.apiInvokeCount+=1;const l=this.apiInvokeCount,u=()=>({tag:n.tag,invokeId:l,sid:e,name:n.name,apiInvokeTime:a,options:n.options,states:n.states||null}),p=!!Z("SHOW_REPORT_INVOKER_LOG");p&&N.info("".concat(n.name," start"),n.options);let m=!1;ri(n.timeout).then(()=>{m||(this.sendApiInvoke(Tt(Tt({},u()),{},{error:z.API_INVOKE_TIMEOUT,success:!1})),N.debug("".concat(n.name," timeout")))});const g=new ye(z.UNEXPECTED_ERROR,"".concat(n.name,": this api invoke is end"));return{onSuccess:E=>{const y=()=>{if(m)throw g;return m=!0,this.sendApiInvoke(Tt(Tt({},u()),{},{success:!0},n.reportResult&&{result:E})),p&&N.info("".concat(n.name," onSuccess")),E};return s?Q5(y,n.name+"Success",s,()=>m=!0):y()},onError:E=>{const y=()=>{if(m)throw E;m=!0,this.sendApiInvoke(Tt(Tt({},u()),{},{success:!1,error:E})),p&&N.info("".concat(n.name," onFailure"),E.toString())};return s?Q5(y,n.name+"Error",s,()=>m=!0):y()}}}sessionInit(e,n){if(this.baseInfoMap.has(e))return;const s=Date.now(),a=this.createBaseInfo(e,s);a.cname=n.cname;const l=Object.assign({},{willUploadConsoleLog:Z("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:EN?"global":"oversea",areas:Z("AREAS")&&Z("AREAS").join(",")},n.extend),{stringUid:u,channelProfile:p,channelMode:m,isABTestSuccess:g,lsid:E,clientRole:y}=n,C=Date.now(),I=Tt(Tt({},a),{},{eventType:Mr.SESSION_INIT,appid:n.appid,browser:navigator.userAgent,build:vN,lts:C,elapse:C-s,extend:JSON.stringify(l),mode:n.mode,process:Z("PROCESS_ID"),appType:Z("APP_TYPE"),success:!0,version:qo,stringUid:u,channelProfile:p,channelMode:m,isABTestSuccess:g,lsid:E,clientType:20,clientRole:y,serviceId:Z("PROCESS_ID"),extensionID:Z("PLUGIN_INFO").join(",")||""});this.send({type:kn.SESSION,data:I},!0)}joinChooseServer(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt({},a),{},{eventType:Mr.JOIN_CHOOSE_SERVER,lts:l,eventElapse:l-n.lts,chooseServerAddr:n.csAddr,errorCode:n.ec,elapse:l-s.startTime,success:n.succ,chooseServerAddrList:JSON.stringify(n.serverList),uid:n.uid?parseInt(n.uid):null,cid:n.cid?parseInt(n.cid):null,chooseServerIp:n.csIp||"",opid:n.opid,unilbsServerIds:n.unilbsServerIds,extend:n.extend||void 0,isHttp3:n.isHttp3});this.send({type:kn.JOIN_CHOOSE_SERVER,data:u},!0)}reqUserAccount(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt({},a),{},{eventType:Mr.REQ_USER_ACCOUNT,lts:l,success:n.success,serverAddress:n.serverAddr,stringUid:n.stringUid,uid:n.uid,errorCode:n.errorCode,elapse:l-s.startTime,eventElapse:l-n.lts,extend:JSON.stringify(n.extend)});this.send({type:kn.REQ_USER_ACCOUNT,data:u},!0)}joinGateway(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info;n.vid&&(a.vid=n.vid),a.uid=n.uid,a.cid=n.cid;const l=Date.now(),{firstSuccess:u,avoidJoinStartTime:p,isProxy:m,addr:g}=n,E=l-(u&&p?p:s.startTime),y=Tt(Tt({},a),{},{eventType:Mr.JOIN_GATEWAY,lts:l,gatewayAddr:n.addr,success:n.succ,errorCode:n.ec,elapse:E,eventElapse:l-n.lts,firstSuccess:u,signalChannel:n.signalChannel}),C=y.success?1:0;if(n.succ&&(s.lastJoinSuccessTime=l),u)this.send({type:kn.JOIN_GATEWAY,data:y},!0);else{let I;if(g)if(m){const P=g.match(/h=(\d{1,3}-){3}\d{1,3}/g),U=g.match(/p=[0-9]{1,6}/g);I={isSuccess:C,gatewayIp:P&&P.length?P[0].split("=")[1].replace(/-/g,"."):"",port:U&&U.length?U[0].split("=")[1]:"",isProxy:m?1:0}}else{const P=g.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),U=g.match(/(:|p=)[0-9]{1,6}/g);I={isSuccess:C,gatewayIp:P&&P.length?P[0].split("//")[1].replace(/-/g,"."):"",port:U&&U.length?U[0].split(/:|p=/g)[1]:"",isProxy:m?1:0}}else I={isSuccess:C,gatewayIp:"",port:"",isProxy:m?1:0};delete y.success,delete y.eventType,delete y.firstSuccess,y.vid=Number(y.vid);const j=Object.assign({},y,I,{eventType:Mr.REJOIN_GATEWAY});this.send({type:kn.RE_JOIN_GATEWAY,data:j},!0)}}joinChannelTimeout(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=Date.now(),l=Tt(Tt({},s.info),{},{lts:a,timeout:n,elapse:a-s.startTime});this.send({type:kn.JOIN_CHANNEL_TIMEOUT,data:l},!0)}publish(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt({},a),{},{eventType:Mr.PUBLISH,lts:l,eventElapse:n.eventElapse,elapse:l-s.startTime,success:n.succ,errorCode:n.ec,videoName:n.videoName,audioName:n.audioName,screenName:n.screenName,screenshare:n.screenshare,audio:n.audio,video:n.video,p2pid:n.p2pid,publishRequestid:n.publishRequestid});this.send({type:kn.PUBLISH,data:u},!0)}subscribe(e,n,s){const a=this.baseInfoMap.get(e);if(!a)return;const l=a.info,u=Date.now(),p=Tt(Tt({},l),{},{eventType:Mr.SUBSCRIBE,lts:u,eventElapse:n.eventElapse,elapse:u-a.startTime,success:n.succ,errorCode:n.ec,video:n.video,audio:n.audio,subscribeRequestid:n.subscribeRequestid,p2pid:n.p2pid},s&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof n.peerid=="string"?p.peerSuid=n.peerid:p.peer=n.peerid,this.send({type:kn.SUBSCRIBE,data:p},!0)}wsCompressorInit(e){var n;const s=[...vo(n=this.baseInfoMap).call(n)],a=s.length?s[0]:"UnableToGetSid",l=this.baseInfoMap.get(a);if(!l)return;const u=l.info,p=Date.now(),m=Tt(Tt({},u),{},{eventType:Mr.WS_COMPRESSOR_INIT,lts:p,eventElapse:e.eventElapse,elapse:p-l.startTime,status:e.status?1:2});this.send({type:kn.WS_COMPRESSOR_INIT,data:m},!0)}firstRemoteVideoDecode(e,n,s,a){const l=this.baseInfoMap.get(e);if(!l)return;const u=l.info,p=Date.now(),m=Tt(Tt(Tt({},u),a),{},{elapse:p-l.startTime,eventType:n,lts:p,firstDecodeFrame:Math.max(p-l.startTime,0),apEnd:Math.max(a.apEnd-l.startTime,0),apStart:Math.max(a.apStart-l.startTime,0),joinGwEnd:Math.max(a.joinGwEnd-l.startTime,0),joinGwStart:Math.max(a.joinGwStart-l.startTime,0),pcEnd:Math.max(a.pcEnd-l.startTime,0),pcStart:Math.max(a.pcStart-l.startTime,0),subscriberEnd:Math.max(a.subscriberEnd-l.startTime,0),subscriberStart:Math.max(a.subscriberStart-l.startTime,0),videoAddNotify:Math.max(a.videoAddNotify-l.startTime,0)});this.send({type:s,data:m},!0)}firstRemoteFrame(e,n,s,a){const l=this.baseInfoMap.get(e);if(!l)return;const u=l.info,p=Date.now(),m=Tt(Tt(Tt({},u),a),{},{elapse:p-l.startTime,eventType:n,lts:p});this.send({type:s,data:m},!0)}pcStats(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt(Tt({},a),n),{},{vid:a.vid===void 0?0:Number(a.vid),elapse:l-s.startTime,eventType:Mr.PC_STATS,lts:l});this.send({type:kn.PC_STATS,data:u},!0)}updateRemoteRTPCapabilities(e,n){if(e){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt(Tt({},a),n),{},{vid:a.vid===void 0?0:Number(a.vid),eventType:Mr.UPDATE_REMOTE_RTPCAPABILITIES,lts:l});this.send({type:kn.UPDATE_REMOTE_RTPCAPABILITIES,data:u},!0)}}onGatewayStream(e,n,s,a){const l=this.baseInfoMap.get(e);if(!l)return;const u=l.info,p=Date.now(),m=Tt(Tt(Tt({},u),a),{},{eventType:n,lts:p});this.send({type:s,data:m},!0)}streamSwitch(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt({},a),{},{eventType:Mr.STREAM_SWITCH,lts:l,isDual:n.isdual,elapse:l-s.startTime,success:n.succ});this.send({type:kn.STREAM_SWITCH,data:u},!0)}requestProxyAppCenter(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt({},a),{},{eventType:Mr.REQUEST_PROXY_APPCENTER,lts:l,eventElapse:l-n.lts,elapse:l-s.startTime,APAddr:n.APAddr,workerManagerList:n.workerManagerList,response:n.response,errorCode:n.ec,success:n.succ});this.send({type:kn.REQUEST_PROXY_APPCENTER,data:u},!0)}requestProxyWorkerManager(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt({},a),{},{eventType:Mr.REQUEST_PROXY_WORKER_MANAGER,lts:l,eventElapse:l-n.lts,elapse:l-s.startTime,workerManagerAddr:n.workerManagerAddr,response:n.response,errorCode:n.ec,success:n.succ});this.send({type:kn.REQUEST_PROXY_WORKER_MANAGER,data:u},!0)}setProxyServer(e){this.proxyServer=e,e?N.debug("reportProxyServerurl: ".concat(e)):N.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt({},a),{},{subscribeElapse:n.subscribeElapse,peer:n.peer,peerPublishDuration:Math.max(n.audioPublishDuration,n.videoPublishDuration),audiotag:n.audioPublishDuration>0?1:-1,videotag:n.videoPublishDuration>0?1:-1,lts:l,elapse:l-s.startTime,joinChannelSuccessElapse:l-(s.lastJoinSuccessTime||l),peerPublishDurationVideo:n.videoPublishDuration,peerPublishDurationAudio:n.audioPublishDuration});this.send({type:kn.PEER_PUBLISH_STATUS,data:u},!0)}workerEvent(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now();(function(p,m,g){const E=p[m];if(!E||typeof E!="string")return[p];p[m]="";const y=rl(JSON.stringify(p));let C=0;const I=[];let j=0;for(let P=0;P<E.length;P++)j+=E.charCodeAt(P)<=127?1:3,j<=g-y||(I[I.length]=Zh(Zh({},p),{},{[m]:E.substring(C,P)}),C=P,j=E.charCodeAt(P)<=127?1:3);return C!==E.length-1&&(I[I.length]=Zh(Zh({},p),{},{[m]:E.substring(C)})),I})(Tt(Tt(Tt({},a),n),{},{elapse:l-s.startTime,lts:l,productType:"WebRTC"}),"payload",1300).forEach(p=>this.send({type:kn.WORKER_EVENT,data:p},!0))}apworkerEvent(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt(Tt({},a),n),{},{elapse:l-s.startTime,lts:l});this.send({type:kn.AP_WORKER_EVENT,data:u},!0)}joinWebProxyAP(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt(Tt({},a),n),{},{elapse:l-s.startTime,lts:l,extend:n.extend||void 0});this.send({type:kn.JOIN_WEB_PROXY_AP,data:u},!0)}WebSocketQuit(e,n){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Tt(Tt(Tt({},a),n),{},{elapse:l-s.startTime,lts:l});this.send({type:kn.WEBSOCKET_QUIT,data:u},!0)}async sendCustomReportMessage(e,n){if(this.customReportCount+=n.length,this.customReportCount>Z("CUSTOM_REPORT_LIMIT"))throw new ye(z.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const s=Date.now(),a=n.map(l=>({type:kn.USER_ANALYTICS,data:Tt(Tt({sid:e},l),{},{lts:s})}));try{Z("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(a):await this.postDataToStatsCollector(a)}catch(l){throw N.error("send custom report message failed",l.toString()),new ye(z.CUSTOM_REPORT_SEND_FAILED,l.message)}}sendApiInvoke(e){const n=Z("NOT_REPORT_EVENT");if(e.tag&&je(n)&&je(n).call(n,e.tag))return!1;if(e.sid===null)return this.apiInvokeUploadPendingItems.push(e),!1;const s=this.baseInfoMap.get(e.sid);if(!s)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:a,uid:l,cid:u}=s.info;let p;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof ye){const{code:g,message:E}=e.error;p=g||E||e.error.toString()}else p=e.error.toString();const m={invokeId:e.invokeId,sid:e.sid,cname:a,cid:u,uid:l,lts:e.lts,success:e.success,elapse:e.lts-s.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?p:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:kn.API_INVOKE,data:m},!1),!0}appendSessionId(){xE.__CLIENT_LIST__.forEach(e=>{if(e._sessionId){const n=this.apiInvokeUploadPendingItems.length;for(let s=0;s<n;s++){const a=this.apiInvokeUploadPendingItems.shift();a&&(a.sid=e._sessionId,this.sendApiInvoke(Object.assign({},a)))}}})}send(e,n){if(n)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>Z("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,n){const s=[],a=[];for(;e.length;){const u=e.shift();s.length<20?s.push(u):a.push(u)}e.push(...a);for(const u of[...s]){var l;this.ltsList.indexOf(u.data.lts)!==-1?(u.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(u.data.lts)):(this.ltsList.push(u.data.lts),fE(l=this.ltsList).call(l,(p,m)=>p-m))}return n||(this.lastSendNormalEventTime=Date.now()),Z("ENABLE_EVENT_REPORT")&&s.length&&(Z("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(s):this.postDataToStatsCollector(s)).catch((u=>p=>{Z("EVENT_REPORT_RETRY")&&(n?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(u):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(u),this.normalEventUploadPendingItems.length>Z("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-Z("NORMAL_EVENT_QUEUE_CAPACITY")),N.warning("report: drop normal events"))))})(s)),e}async postDataToStatsCollector2(e){Cr.networkState===ns.OFFLINE&&await pe.race([Cr.onlineWaiter,ri(2*wr.maxRetryTimeout)]);const n=l=>{let u=new Uint8Array;return l.forEach(p=>{const m=KO(JSON.stringify(p.data)),g=new ArrayBuffer(5),E=(C=>{let I=0;return Object.entries(kn).forEach(j=>{let[P,U]=j;U===C.type&&(I=EventNameToID[P])}),I})(p),y=new DataView(g);y.setUint16(0,m.byteLength,!0),y.setUint8(2,255&E),y.setUint8(3,E>>>8&255),y.setUint8(4,E>>>16&255),u=B5(u,new Uint8Array(g)),u=B5(u,m)}),u},s="event";let a=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(s):"https://".concat(Z("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(s);for(let l=0;l<2;l+=1){l===1&&(a=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(s):"https://".concat(Z("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(s));try{await _N(a,{timeout:1e4,data:n(e),headers:Tt(Tt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(u){if(l===1)throw u;continue}return}}async postDataToStatsCollector(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map(u=>JSON.stringify(u)),vid:(u=>{const p=u&&u.data.sid&&this.baseInfoMap.get(u.data.sid);return p&&p.info.vid&&+p.info.vid||0})(e[0])};Cr.networkState===ns.OFFLINE&&await pe.race([Cr.onlineWaiter,ri(2*wr.maxRetryTimeout)]);const a=n?"/events/proto-raws":"/events/messages";let l=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("EVENT_REPORT_DOMAIN"),"&p=").concat(Z("STATS_COLLECTOR_PORT"),"&d=").concat(a):"https://".concat(Z("EVENT_REPORT_DOMAIN"),":").concat(Z("STATS_COLLECTOR_PORT")).concat(a));for(let u=0;u<2;u+=1){u===1&&(l=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(Z("STATS_COLLECTOR_PORT"),"&d=").concat(a):"https://".concat(Z("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(Z("STATS_COLLECTOR_PORT")).concat(a)));try{n?await sie(l,{timeout:1e4,data:s}):await _N(l,{timeout:1e4,data:s})}catch(p){if(u===1)throw p;continue}return}}createBaseInfo(e,n){const s=Object.assign({},hie);return s.sid=e,this.baseInfoMap.set(e,{info:s,startTime:n}),s}reportResourceTiming(e,n){const s=performance.getEntriesByName(e),a=s[s.length-1];a&&this.reportApiInvoke(n,{name:"Client.resourceTiming",options:a,tag:Bn.TRACER}).onSuccess()}}function it(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(e,n,s){const a=s.value;if(typeof a=="function"){const l=i.className||e.__className__||(e.constructor.name==="AgoraRTCClient"?"Client":e.constructor.name);s.value=function(){for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];let g=p;if(i.argsMap)try{g=i.argsMap(this,...p)}catch(y){N.warning(y),g=[]}try{JSON.stringify(g)}catch{N.warning("arguments for method ".concat(l,".").concat(String(n)," not serializable for apiInvoke.")),g=[]}const E=(i.report||qe).reportApiInvoke(this._sessionId||null,{name:"".concat(l,".").concat(String(n)),options:g,tag:Bn.TRACER,reportResult:i.reportResult},i.throttleTime);try{const y=a.apply(this,p);return y instanceof pe?y.then(C=>(E.onSuccess(i.reportResult&&C),C)).catch(C=>{throw E.onError(C),C}):(E.onSuccess(i.reportResult&&y),y)}catch(y){throw E.onError(y),y}}}return s}}R(xE,"__CLIENT_LIST__",[]);const qe=new xE;Kb.on("REPORT_LOG_UPLOAD",i=>{i.networkState=Cr.networkState,qe.reportApiInvoke(null,{name:"logUploadError",options:i,tag:Bn.TRACER})});const pie=["CHINA","GLOBAL"],us=function(){const i="us".concat("erna","me"),e="pa".concat("sswo","rd"),n=["t","s","t"];n.splice(1,0,"e");const s=n.join(""),a=[];for(let p=0;p<6;p++)a.push("1");const l=a.join(""),u={};return u[i]=s,u[e]=l,Object.assign(u,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=us,EN||(rs.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],rs.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],rs.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],rs.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],rs.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],rs.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],rs.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",rs.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",rs.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",rs.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",rs.AREAS=["NORTH_AMERICA","OVERSEA"]);const z4=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],uu=[];function tp(i,e){return!!e&&uu.some(n=>n.uid===i&&n.channelName===e)}xE.__CLIENT_LIST__=uu;var SN,Ms,nm,PE,yo,Hi,et,Ot,We,Xe,rd,ht,K4,zi,ct,Ur,hu,fie=qc("Array").values,mie=Xc,gie=Ei,_ie=x,Eie=fie,bN=Array.prototype,vie={DOMTokenList:!0,NodeList:!0},yc=d(function(i){var e=i.values;return i===bN||_ie(bN,i)&&e===bN.values||gie(vie,mie(i))?Eie:e});function be(i,e,n,s){var a,l=arguments.length,u=l<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,n):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,e,n,s);else for(var p=i.length-1;p>=0;p--)(a=i[p])&&(u=(l<3?a(u):l>3?a(e,n,u):a(e,n))||u);return l>3&&u&&Object.defineProperty(e,n,u),u}function $(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}(function(i){i.L1T1="L1T1",i.L1T2="L1T2",i.L1T3="L1T3",i.L2T1_KEY="L2T1_KEY",i.L2T2_KEY="L2T2_KEY",i.L2T3_KEY="L2T3_KEY",i.L3T1_KEY="L3T1_KEY",i.L3T2_KEY="L3T2_KEY",i.L3T3_KEY="L3T3_KEY"})(SN||(SN={})),function(i){i.CERTIFICATE="certificate",i.CODEC="codec",i.CANDIDATE_PAIR="candidate-pair",i.LOCAL_CANDIDATE="local-candidate",i.REMOTE_CANDIDATE="remote-candidate",i.INBOUND="inbound-rtp",i.TRACK="track",i.OUTBOUND="outbound-rtp",i.PC="peer-connection",i.REMOTE_INBOUND="remote-inbound-rtp",i.REMOTE_OUTBOUND="remote-outbound-rtp",i.TRANSPORT="transport",i.CSRC="csrc",i.DATA_CHANNEL="data-channel",i.STREAM="stream",i.SENDER="sender",i.RECEIVER="receiver"}(Ms||(Ms={})),function(i){i[i.ACCESS_POINT=101]="ACCESS_POINT",i[i.UNILBS=201]="UNILBS",i[i.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(nm||(nm={})),function(i){i[i.IIIEGAL_APPID=1]="IIIEGAL_APPID",i[i.IIIEGAL_UID=2]="IIIEGAL_UID",i[i.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(PE||(PE={})),function(i){i[i.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",i[i.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",i[i.INTERNAL_ERROR=8]="INTERNAL_ERROR",i[i.NO_AUTHORIZED=9]="NO_AUTHORIZED",i[i.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",i[i.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",i[i.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",i[i.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",i[i.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",i[i.USER_OVERLOAD=16]="USER_OVERLOAD",i[i.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",i[i.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(yo||(yo={})),function(i){i[i.NO_FLAG_SET=100]="NO_FLAG_SET",i[i.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",i[i.INVALID_FALG_SET=102]="INVALID_FALG_SET",i[i.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",i[i.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",i[i.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",i[i.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",i[i.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",i[i.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",i[i.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",i[i.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",i[i.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",i[i.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",i[i.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",i[i.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",i[i.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",i[i.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",i[i.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",i[i.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(Hi||(Hi={})),function(i){i[i.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",i[i.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",i[i.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",i[i.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",i[i.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",i[i.K_TICKET_INVALID=7]="K_TICKET_INVALID",i[i.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",i[i.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",i[i.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",i[i.K_UID_BANNED=14]="K_UID_BANNED",i[i.K_IP_BANNED=15]="K_IP_BANNED",i[i.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",i[i.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",i[i.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",i[i.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",i[i.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",i[i.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",i[i.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",i[i.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",i[i.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",i[i.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",i[i.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",i[i.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",i[i.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",i[i.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",i[i.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",i[i.ERR_INVALID_UID=117]="ERR_INVALID_UID",i[i.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",i[i.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",i[i.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",i[i.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",i[i.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",i[i.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",i[i.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",i[i.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",i[i.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",i[i.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",i[i.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",i[i.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",i[i.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",i[i.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",i[i.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",i[i.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",i[i.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",i[i.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",i[i.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",i[i.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",i[i.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",i[i.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",i[i.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",i[i.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",i[i.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",i[i.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",i[i.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",i[i.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",i[i.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",i[i.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",i[i.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",i[i.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",i[i.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",i[i.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",i[i.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",i[i.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",i[i.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(et||(et={})),function(i){i.CONNECTING="connecting",i.CONNECTED="connected",i.RECONNECTING="reconnecting",i.CLOSED="closed"}(Ot||(Ot={})),function(i){i.WS_CONNECTED="ws_connected",i.WS_RECONNECTING="ws_reconnecting",i.WS_CLOSED="ws_closed",i.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",i.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",i.ON_BINARY_DATA="on_binary_data",i.REQUEST_RECOVER="request_recover",i.REQUEST_JOIN_INFO="request_join_info",i.REQUEST_REJOIN_INFO="req_rejoin_info",i.IS_P2P_DISCONNECTED="is_p2p_dis",i.DISCONNECT_P2P="dis_p2p",i.ABORT_P2P_EXECUTION="abort_p2p_execution",i.NEED_RENEW_SESSION="need-sid",i.REPORT_JOIN_GATEWAY="report_join_gateway",i.REQUEST_TIMEOUT="request_timeout",i.REQUEST_SUCCESS="request_success",i.JOIN_RESPONSE="join_response",i.DATACHANNEL_PRECONNECT="datachannel_preconnect",i.DATACHANNEL_CONNECTING="datachannel_connecting",i.DATACHANNEL_FAILBACK="datachannel_failback",i.P2P_CONNECTION="p2p_connection",i.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",i.P2P_SUBSCRIBE="p2p_subscribe",i.P2P_UNSUBSCRIBE="p2p_unsubscribe",i.P2P_EXCHANGE_SDP="p2p_exchange_sdp",i.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",i.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream"}(We||(We={})),function(i){i.PING="ping",i.PING_BACK="ping_back",i.JOIN="join_v3",i.REJOIN="rejoin_v3",i.LEAVE="leave",i.SET_CLIENT_ROLE="set_client_role",i.PUBLISH="publish",i.PUBLISH_DATASTREAM="publish_datastream",i.UNPUBLISH="unpublish",i.UNPUBLISH_DATASTREAM="unpublish_datastream",i.SUBSCRIBE="subscribe",i.PRE_SUBSCRIBE="pre_subscribe",i.SUBSCRIBE_DATASTREAM="subscribe_datastream",i.SUBSCRIBE_STREAMS="subscribe_streams",i.UNSUBSCRIBE="unsubscribe",i.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",i.UNSUBSCRIBE_STREAMS="unsubscribe_streams",i.SUBSCRIBE_CHANGE="subscribe_change",i.TRAFFIC_STATS="traffic_stats",i.RENEW_TOKEN="renew_token",i.SWITCH_VIDEO_STREAM="switch_video_stream",i.DEFAULT_VIDEO_STREAM="default_video_stream",i.SET_FALLBACK_OPTION="set_fallback_option",i.GATEWAY_INFO="gateway_info",i.CONTROL="control",i.SEND_METADATA="send_metadata",i.DATA_STREAM="data_stream",i.PICK_SVC_LAYER="pick_svc_layer",i.RESTART_ICE="restart_ice",i.CONNECT_PC="connect_pc",i.SET_VIDEO_PROFILE="set_video_profile",i.SET_PARAMETER="set_parameter",i.SET_RTM2_FLAG="set_rtm2_flag"}(Xe||(Xe={})),function(i){i.WRTC_STATS="wrtc_stats",i.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",i.DENOISER_STATS="denoiser_stats",i.EXTENSION_USAGE_STATS="extension_usage_stats"}(rd||(rd={})),function(i){i.ON_USER_ONLINE="on_user_online",i.ON_USER_OFFLINE="on_user_offline",i.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",i.ON_PUBLISH_STREAM="on_publish_stream",i.ON_UPLINK_STATS="on_uplink_stats",i.ON_P2P_LOST="on_p2p_lost",i.ON_REMOVE_STREAM="on_remove_stream",i.ON_ADD_AUDIO_STREAM="on_add_audio_stream",i.ON_ADD_VIDEO_STREAM="on_add_video_stream",i.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",i.ON_USER_BANNED="on_user_banned",i.ON_USER_LICENSE_BANNED="on_user_license_banned",i.ON_NOTIFICATION="on_notification",i.ON_CRYPT_ERROR="on_crypt_error",i.MUTE_AUDIO="mute_audio",i.MUTE_VIDEO="mute_video",i.UNMUTE_AUDIO="unmute_audio",i.UNMUTE_VIDEO="unmute_video",i.ON_P2P_OK="on_p2p_ok",i.RECEIVE_METADATA="receive_metadata",i.ON_DATA_STREAM="on_data_stream",i.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",i.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",i.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",i.ENABLE_LOCAL_VIDEO="enable_local_video",i.DISABLE_LOCAL_VIDEO="disable_local_video",i.ENABLE_LOCAL_AUDIO="enable_local_audio",i.DISABLE_LOCAL_AUDIO="disable_local_audio",i.ON_PUBLISHED_USER_LIST="on_published_user_list"}(ht||(ht={})),function(i){i.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",i.NEED_ANSWER="NEED_ANSWER",i.NEED_RENEGOTIATE="NEED_RENEGOTIATE",i.P2P_LOST="P2P_LOST",i.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",i.NEED_UNPUB="NEED_UNPUB",i.NEED_UNSUB="NEED_UNSUB",i.NEED_UPLOAD="NEED_UPLOAD",i.NEED_CONTROL="NEED_CONTROL",i.START_RECONNECT="START_RECONNECT",i.END_RECONNECT="END_RECONNECT",i.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(K4||(K4={})),function(i){i.SEND_ONLY="SEND_ONLY",i.RECEIVE_ONLY="RECEIVE_ONLY"}(zi||(zi={})),function(i){i.CONNECTED="websocket:connected",i.RECONNECTING="websocket:reconnecting",i.WILL_RECONNECT="websocket:will_reconnect",i.CLOSED="websocket:closed",i.FAILED="websocket:failed",i.ON_MESSAGE="websocket:on_message",i.REQUEST_NEW_URLS="websocket:request_new_urls",i.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",i.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"}(ct||(ct={}));class le extends ye{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),R(this,"name","AgoraRTCException")}print(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(e,N)}throw(){super.throw(N)}}function TN(i){if(typeof i!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(i))throw N.error("Invalid Channel Name ".concat(i)),new le(z.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function CN(i){if(e=i,!(typeof e=="number"&&Math.floor(e)===e&&0<=e&&e<=4294967295||U5(i,1,255)))throw new le(z.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var e;typeof i=="string"&&N.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}(function(i){i.TRANSCODE="mix_streaming",i.RAW="raw_streaming",i.INJECT="inject_streaming"})(Ur||(Ur={})),function(i){i[i.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",i[i.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",i[i.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",i[i.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",i[i.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",i[i.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",i[i.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",i[i.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",i[i.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",i[i.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",i[i.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(hu||(hu={}));const yie={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},wN={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function RN(i,e){xi(i.url,"".concat(e,".url"),1,1e3,!1),Xn(i.x)||pn(i.x,"".concat(e,".x"),0,1e4),Xn(i.y)||pn(i.y,"".concat(e,".y"),0,1e4),Xn(i.width)||pn(i.width,"".concat(e,".width"),0,1e4),Xn(i.height)||pn(i.height,"".concat(e,".height"),0,1e4),Xn(i.zOrder)||pn(i.zOrder,"".concat(e,".zOrder"),0,255),Xn(i.alpha)||pn(i.alpha,"".concat(e,".alpha"),0,1,!1)}const Sie={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},bie={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};var Ca,rm,_r,Y4,Ki,Sc,hs,pu,Qt,er,np,Or,qb,$t;function q4(i){if(!i.channelName)throw new le(z.INVALID_PARAMS,"invalid channelName in info");if(typeof i.uid!="number")throw new le(z.INVALID_PARAMS,"invalid uid in info, uid must be a number");return i.token&&xi(i.token,"info.token",1,2047),CN(i.uid),TN(i.channelName),!0}(function(i){i.WARNING="@live_uap-warning",i.ERROR="@line_uap-error",i.PUBLISH_STREAM_STATUS="@live_uap-publish-status",i.INJECT_STREAM_STATUS="@live_uap-inject-status",i.WORKER_STATUS="@live_uap-worker-status",i.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(Ca||(Ca={})),function(i){i.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(rm||(rm={})),function(i){i[i.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",i[i.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",i[i.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",i[i.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",i[i.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",i[i.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",i[i.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",i[i.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",i[i.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",i[i.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",i[i.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",i[i.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",i[i.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",i[i.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",i[i.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",i[i.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",i[i.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",i[i.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(_r||(_r={})),function(i){i.CONNECT_FAILED="connect failed",i.CONNECT_TIMEOUT="connect timeout",i.WS_DISCONNECTED="websocket disconnected",i.REQUEST_TIMEOUT="request timeout",i.REQUEST_FAILED="request failed",i.WAIT_STATUS_TIMEOUT="wait status timeout",i.WAIT_STATUS_ERROR="wait status error",i.BAD_STATE="bad state",i.WS_ABORT="ws abort",i.AP_REQUEST_TIMEOUT="AP request timeout",i.AP_JSON_PARSE_ERROR="AP json parse error",i.AP_REQUEST_ERROR="AP request error",i.AP_REQUEST_ABORT="AP request abort"}(Y4||(Y4={})),function(i){i[i.SetSdkProfile=0]="SetSdkProfile",i[i.SetSourceChannel=1]="SetSourceChannel",i[i.SetSourceUserId=2]="SetSourceUserId",i[i.SetDestChannel=3]="SetDestChannel",i[i.StartPacketTransfer=4]="StartPacketTransfer",i[i.StopPacketTransfer=5]="StopPacketTransfer",i[i.UpdateDestChannel=6]="UpdateDestChannel",i[i.Reconnect=7]="Reconnect",i[i.SetVideoProfile=8]="SetVideoProfile"}(Ki||(Ki={})),function(i){i.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",i.NETWORK_CONNECTED="NETWORK_CONNECTED",i.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",i.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",i.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",i.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",i.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",i.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",i.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",i.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(Sc||(Sc={})),function(i){i.RELAY_STATE_IDLE="RELAY_STATE_IDLE",i.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",i.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",i.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(hs||(hs={})),function(i){i.RELAY_OK="RELAY_OK",i.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",i.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",i.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(pu||(pu={})),function(i){i.High="high",i.Low="low",i.Audio="audio",i.Screen="screen",i.ScreenLow="screen_low"}(Qt||(Qt={})),function(i){i.DISCONNECT="disconnect",i.CONNECTION_STATE_CHANGE="connection-state-change",i.NETWORK_QUALITY="network-quality",i.STREAM_TYPE_CHANGE="stream-type-change",i.IS_P2P_DISCONNECTED="is-p2p-dis",i.DISCONNECT_P2P="dis-p2p",i.REQUEST_NEW_GATEWAY_LIST="req-gate-url",i.NEED_RENEW_SESSION="need-sid",i.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",i.JOIN_RESPONSE="join-response",i.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",i.RESET_CONNECTION_EVENTS="reset-connection-events",i.DATACHANNEL_PRECONNECT="datachannel_preconnect",i.DATACHANNEL_FAILBACK="datachannel_failback",i.RESET_SIGNAL="reset-signal"}(er||(er={})),function(i){i.P2P_DISCONNECTED="P2P_DISCONNECTED",i.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",i.TIMEOUT="TIMEOUT",i.UNKNOWN_REASON="UNKNOWN_REASON"}(np||(np={})),function(i){i[i.Nothing=0]="Nothing",i[i.Audio=1]="Audio",i[i.LwoVideo=2]="LwoVideo",i[i.Video=4]="Video",i[i.Data=8]="Data",i[i.DataStream0=256]="DataStream0",i[i.DataStream1=512]="DataStream1",i[i.DataStream2=1024]="DataStream2",i[i.DataStream3=2048]="DataStream3",i[i.DataStream4=4096]="DataStream4",i[i.DataStream5=8192]="DataStream5",i[i.DataStream6=16384]="DataStream6",i[i.DataStream7=32768]="DataStream7"}(Or||(Or={})),function(i){i[i.websocket=0]="websocket",i[i.datachannel=1]="datachannel"}(qb||(qb={})),function(i){i.CHINA="CHINA",i.ASIA="ASIA",i.NORTH_AMERICA="NORTH_AMERICA",i.EUROPE="EUROPE",i.JAPAN="JAPAN",i.INDIA="INDIA",i.KOREA="KOREA",i.HKMC="HKMC",i.US="US",i.OCEANIA="OCEANIA",i.SOUTH_AMERICA="SOUTH_AMERICA",i.AFRICA="AFRICA",i.OVERSEA="OVERSEA",i.GLOBAL="GLOBAL",i.EXTENSIONS="EXTENSIONS"}($t||($t={}));const X4=[$t.AFRICA,$t.ASIA,$t.CHINA,$t.EUROPE,$t.GLOBAL,$t.INDIA,$t.JAPAN,$t.NORTH_AMERICA,$t.OCEANIA,$t.OVERSEA,$t.SOUTH_AMERICA];var yi;(function(i){i.CHINA="CN",i.ASIA="AS",i.NORTH_AMERICA="NA",i.EUROPE="EU",i.JAPAN="JP",i.INDIA="IN",i.KOREA="KR",i.HKMC="HK",i.US="US",i.OCEANIA="OC",i.SOUTH_AMERICA="SA",i.AFRICA="AF",i.OVERSEA="OVERSEA",i.GLOBAL="GLOBAL",i.EXTENSIONS="GLOBAL"})(yi||(yi={}));const Xb={CHINA:{},ASIA:{CODE:yi.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:yi.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:yi.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:yi.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:yi.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:yi.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:yi.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:yi.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:yi.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:yi.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:yi.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:yi.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:yi.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};var DE,J4,ze,Pi,bc,Ie,en,st,Q4,So,bo,jr,ol,dr,wa,Z4,Zs,Jo,fu,tr,mu,al,e3,IN;EN&&(Xb.CHINA={CODE:yi.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(i){i.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(DE||(DE={}));class t3 extends jn{constructor(e,n){super(),R(this,"onICEConnectionStateChange",void 0),R(this,"onConnectionStateChange",void 0),R(this,"onDTLSTransportStateChange",void 0),R(this,"onDTLSTransportError",void 0),R(this,"onICETransportStateChange",void 0),R(this,"onFirstAudioReceived",void 0),R(this,"onFirstVideoReceived",void 0),R(this,"onFirstAudioDecoded",void 0),R(this,"onFirstVideoDecoded",void 0),R(this,"onFirstVideoDecodedTimeout",void 0),R(this,"onSelectedLocalCandidateChanged",void 0),R(this,"onSelectedRemoteCandidateChanged",void 0)}}class Jb extends t3{constructor(e,n){super(e,n)}}(function(i){i.SEND="sendonly",i.RECV="recvonly",i.SENDRECV="sendrecv",i.INACTIVE="inactive"})(J4||(J4={})),function(i){i.VIDEO="video",i.AUDIO="audio"}(ze||(ze={})),function(i){i[i.UDP=0]="UDP",i[i.TCP=1]="TCP",i[i.RELAY=2]="RELAY"}(Pi||(Pi={})),function(i){i[i.FIRST_CONNECTION=0]="FIRST_CONNECTION",i[i.TCP_RESTART=1]="TCP_RESTART",i[i.RELAY_RESTART=2]="RELAY_RESTART",i[i.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",i[i.OLD_RESTART=11]="OLD_RESTART",i[i.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED"}(bc||(bc={})),function(i){i.LocalVideoTrack="videoTrack",i.LocalAudioTrack="audioTrack",i.LocalVideoLowTrack="videoLowTrack"}(Ie||(Ie={})),function(i){i.New="new",i.Connected="connected",i.Reconnecting="reconnecting",i.Disconnected="disconnected"}(en||(en={})),function(i){i.StateChange="stateChange",i.IceConnectionStateChange="iceConnectionStateChange",i.RequestMuteLocal="requestMuteLocal",i.RequestUnmuteLocal="requestUnmuteLocal",i.RequestRePublish="requestRePublish",i.RequestRePublishDataChannel="requestRePublishDataChannel",i.RequestReSubscribe="requestReSubscribe",i.RequestUploadStats="requestUploadStats",i.RequestUpload="requestUpload",i.MediaReconnectStart="MediaReconnectStart",i.MediaReconnectEnd="MediaReconnectEnd",i.NeedSignalRTT="NeedSignalRTT",i.RequestRestartICE="RequestRestartIce",i.PeerConnectionStateChange="PeerConnectionStateChange",i.RequestReconnect="RequestReconnect",i.RequestReconnectPC="RequestReconnectPC",i.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",i.P2PLost="P2PLost",i.UpdateVideoEncoder="UpdateVideoEncoder",i.ConnectionTypeChange="ConnectionTypeChange",i.RequestLowStreamParameter="RequestLowStreamParameter",i.QueryClientConnectionState="QueryClientConnectionState",i.LocalCandidate="LocalCandidate",i.RequestP2PMuteLocal="requestP2PMuteLocal",i.RequestP2PUnPublish="RequestP2PUnPublish",i.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",i.RequestP2PMuteRemote="RequestP2PMuteRemote",i.RequestP2PRestartICE="RequestP2PRestartICE"}(st||(st={})),function(i){i.MUTE_LOCAL_VIDEO="mute_local_video",i.MUTE_LOCAL_AUDIO="mute_local_audio",i.UNMUTE_LOCAL_VIDEO="unmute_local_video",i.UNMUTE_LOCAL_AUDIO="unmute_local_audio",i.MUTE_REMOTE_VIDEO="mute_remote_video",i.MUTE_REMOTE_AUDIO="mute_remote_audio",i.UNMUTE_REMOTE_VIDEO="unmute_remote_video",i.UNMUTE_REMOTE_AUDIO="unmute_remote_audio"}(Q4||(Q4={})),function(i){i.CONNECTING="CONNECTING",i.RECONNECTING="RECONNECTING",i.CONNECTED="CONNECTED",i.CLOSED="CLOSED"}(So||(So={})),function(i){i[i.CONNECT_AP=0]="CONNECT_AP",i[i.AP_CONNECTED=1]="AP_CONNECTED",i[i.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",i[i.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",i[i.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",i[i.CONNECT_WORKER=5]="CONNECT_WORKER",i[i.WORKER_CONNECTED=6]="WORKER_CONNECTED",i[i.CLOSED=7]="CLOSED"}(bo||(bo={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.STATE_CHANGE="state-change",i.INSPECT_RESULT="inspect-result",i.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",i.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(jr||(jr={})),function(i){i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.MULTI_IP="MULTI_IP",i.TIMEOUT="TIMEOUT",i.OFFLINE="OFFLINE",i.LEAVE="LEAVE",i.P2P_FAILED="P2P_FAILED",i.FALLBACK="FALLBACK"}(ol||(ol={})),function(i){i.CONNECTED="transmitter:connected",i.RECONNECTING="transmitter:reconnecting",i.WILL_RECONNECT="transmitter:will_reconnect",i.CLOSED="transmitter:closed",i.FAILED="transmitter:failed",i.ON_MESSAGE="transmitter:on_message",i.REQUEST_NEW_URLS="transmitter:request_new_urls",i.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",i.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",i.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",i.FAILBACK="transmitter:failback"}(dr||(dr={})),function(i){i.CAMERA_CHANGED="camera-changed",i.MICROPHONE_CHANGED="microphone-changed",i.PLAYBACK_DEVICE_CHANGED="playback-device-changed",i.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",i.AUTOPLAY_FAILED="autoplay-failed",i.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",i.SECURITY_POLICY_VIOLATION="security-policy-violation"}(wa||(wa={})),function(i){i[i.APP_TYPE_INVALID_VALUE=-1]="APP_TYPE_INVALID_VALUE",i[i.APP_TYPE_NATIVE=0]="APP_TYPE_NATIVE",i[i.APP_TYPE_NATIVE_COCOS=1]="APP_TYPE_NATIVE_COCOS",i[i.APP_TYPE_NATIVE_UNITY=2]="APP_TYPE_NATIVE_UNITY",i[i.APP_TYPE_NATIVE_ELECTRON=3]="APP_TYPE_NATIVE_ELECTRON",i[i.APP_TYPE_NATIVE_FLUTTER=4]="APP_TYPE_NATIVE_FLUTTER",i[i.APP_TYPE_NATIVE_UNREAL=5]="APP_TYPE_NATIVE_UNREAL",i[i.APP_TYPE_NATIVE_XAMARIN=6]="APP_TYPE_NATIVE_XAMARIN",i[i.APP_TYPE_NATIVE_API_CLOUD=7]="APP_TYPE_NATIVE_API_CLOUD",i[i.APP_TYPE_NATIVE_REACT_NATIVE=8]="APP_TYPE_NATIVE_REACT_NATIVE",i[i.APP_TYPE_NATIVE_PYTHON=9]="APP_TYPE_NATIVE_PYTHON",i[i.APP_TYPE_NATIVE_COCOS_CREATOR=10]="APP_TYPE_NATIVE_COCOS_CREATOR",i[i.APP_TYPE_NATIVE_RUST=11]="APP_TYPE_NATIVE_RUST",i[i.APP_TYPE_NATIVE_C_SHARP=12]="APP_TYPE_NATIVE_C_SHARP",i[i.APP_TYPE_NATIVE_CEF=13]="APP_TYPE_NATIVE_CEF",i[i.APP_TYPE_NATIVE_UNI_APP=14]="APP_TYPE_NATIVE_UNI_APP",i[i.APP_TYPE_WEBRTC=1e3]="APP_TYPE_WEBRTC",i[i.APP_TYPE_WEBRTC_REACT=1001]="APP_TYPE_WEBRTC_REACT",i[i.APP_TYPE_WEBRTC_VUE=1002]="APP_TYPE_WEBRTC_VUE",i[i.APP_TYPE_WEBRTC_ANGULAR=1003]="APP_TYPE_WEBRTC_ANGULAR"}(Z4||(Z4={})),function(i){i.CONNECTING="CONNECTING",i.RECONNECTING="RECONNECTING",i.CONNECTED="CONNECTED",i.CLOSED="CLOSED"}(Zs||(Zs={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.STATE_CHANGE="state-change",i.INSPECT_RESULT="inspect-result",i.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",i.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(Jo||(Jo={})),function(i){i[i.CONNECT_AP=0]="CONNECT_AP",i[i.AP_CONNECTED=1]="AP_CONNECTED",i[i.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",i[i.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",i[i.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",i[i.CONNECT_WORKER=5]="CONNECT_WORKER",i[i.WORKER_CONNECTED=6]="WORKER_CONNECTED",i[i.CLOSED=7]="CLOSED"}(fu||(fu={})),function(i){i.CALL="call",i.CANDIDATE="candidate",i.PUBLISH="publish",i.UNPUBLISH="unpublish",i.CONTROL="control",i.RESTART_ICE="restart_ice",i.ACK="ack",i.RESPONSE="response",i.JOIN="join",i.CHECK="check"}(tr||(tr={})),function(i){i.ABORT="abort"}(mu||(mu={})),function(i){i.MUTE_LOCAL_AUDIO="mute_local_audio",i.MUTE_LOCAL_VIDEO="mute_local_video",i.UNMUTE_LOCAL_AUDIO="unmute_local_audio",i.UNMUTE_LOCAL_VIDEO="unmute_local_video"}(al||(al={})),function(i){i[i.SUCCESS=1]="SUCCESS",i[i.FAILED=0]="FAILED"}(e3||(e3={})),function(i){i.P2P_TOKEN_TIMEOUT="p2p_token_timeout",i.P2P_TOKEN_CHANGED="p2p_token_changed"}(IN||(IN={}));const Tie={[nm.ACCESS_POINT]:{[Hi.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Hi.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Hi.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Hi.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Hi.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Hi.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Hi.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[nm.UNILBS]:{[yo.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[yo.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[yo.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[yo.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[yo.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[yo.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[yo.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[yo.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[yo.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[yo.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[yo.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[yo.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[nm.STRING_UID_ALLOCATOR]:{[PE.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[PE.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[PE.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Qb(i){const e=Tie[Math.floor(i/1e4)];if(!e)return{desc:"unkonw error",retry:!1};const n=e[i%1e4];if(!n){if(Math.floor(i/1e4)===nm.ACCESS_POINT){const s=i%1e4;if(s.toString()[0]==="1")return{desc:i.toString(),retry:!1};if(s.toString()[0]==="2")return{desc:i.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return n}const Cie={[et.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[et.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[et.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[et.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[et.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[et.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[et.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[et.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[et.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[et.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[et.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[et.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[et.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[et.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[et.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[et.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[et.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[et.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[et.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[et.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[et.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[et.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[et.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[et.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[et.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[et.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[et.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[et.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[et.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[et.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[et.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[et.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[et.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[et.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[et.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[et.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[et.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[et.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[et.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[et.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[et.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[et.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[et.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[et.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[et.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[et.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[et.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[et.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[et.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[et.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[et.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[et.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[et.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[et.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[et.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[et.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[et.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[et.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[et.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[et.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[et.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[et.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[et.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function rp(i){return Cie[i]||{desc:"UNKNOW_ERROR_".concat(i),action:"failed"}}function n3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function AN(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?n3(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):n3(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function r3(i){return i.every(e=>e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING)}function i3(i,e){if(typeof i=="string")return i;const{proxy:n,host:s,port:a}=i;if(e){const l=Z("JOIN_GATEWAY_FALLBACK_PORT")||443;return l===443?"wss://".concat(s,"/ws/?p=").concat(Number(a)+150):"wss://".concat(s,":").concat(l,"/ws/?p=").concat(Number(a)+150)}return n?"wss://".concat(n,"/ws/?h=").concat(s,"&p=").concat(a):"wss://".concat(s,":").concat(a)}const wie=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,Rie=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,Iie=/wss:\/\/(.+):([0-9]+)\/?/,Aie=/wss:\/\/(.[^\/]+)\/?/;let Oie=0;class Nie{constructor(e,n){R(this,"id",0),R(this,"store",void 0),R(this,"recordIndex",void 0),R(this,"websockets",[]),R(this,"try443PortDuration",2e3),R(this,"forceCloseWSDuration",5e3),R(this,"try443PortTimeout",null),R(this,"forceCloseTimeout",null),R(this,"isTry443PortFailed",!1),R(this,"isNormalPortFailed",!1),R(this,"useDoubleDomain",!1),R(this,"useProxy",!1),R(this,"startTime",Date.now()),this.id=++Oie,this.try443PortDuration=Z("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=e||5e3,this.store=n}closeAllWebsockets(){this.websockets.forEach(e=>{e.onopen=null,e.onclose=null,e.onmessage=null,e.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var e;const n=Date.now()-this.startTime;for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];N.debug("[choose-best-ws ".concat((e=this.store)===null||e===void 0?void 0:e.clientId," ").concat(this.id,"] ").concat(n,"ms:"),...a)}createWebSocket(e,n,s){this.logger("createWebSocket:",e,{isTry443Port:n,hasTimeoutDetection:s});const a=Z("GATEWAY_DOMAINS"),l=Date.now(),u=[],p=a.find(E=>{var y;return je(y=e.host).call(y,E)});p||(this.useDoubleDomain=!1);const m=[];if(this.useDoubleDomain)a.forEach(E=>{m.push(i3(AN(AN({},e),{},{host:e.host.replace(p,E)}),n))});else{const E=AN({},e);if(n&&p){const y=a.find(C=>C!==p);y&&(E.host=E.host.replace(p,y))}m.push(i3(E,n))}try{m.forEach(E=>{const y=new WebSocket(E);y.binaryType="arraybuffer",u.push(y),this.logger("ws is connecting:",y.url)})}catch(E){if(this.logger("ws create failed"),u.forEach(y=>y.close()),u.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(e,n,s);if(!n&&Number(e.port)!==443)return this.createWebSocket(e,!0,s);throw new le(z.WS_ERR,"init websocket failed! Error: ".concat(E.toString()))}const g=TE();return this.store&&this.store.recordJoinChannelService({urls:u.map(E=>E.url),service:"gateway"},this.recordIndex),u.forEach(E=>{E.onopen=()=>{this.logger("onopen: ws ".concat(E.url," open cost ").concat(Date.now()-l,"ms")),this.websockets.forEach(y=>{y!==E&&(y.onopen=null,y.onclose=null,y.onmessage=null,y.close(),this.logger("close backup websocket: ".concat(y.url)))}),this.websockets.length=0,g.resolve(E)},E.onclose=y=>{this.logger("onclose: ws ".concat(E.url," closed cost ").concat(Date.now()-l,"ms state: ").concat(E.readyState)),n?this.isTry443PortFailed=r3(u):this.isNormalPortFailed=r3(u),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(n&&this.isTry443PortFailed||!n&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(y.reason)),g.reject({code:y.code,reason:np.A_ROUND_WS_FAILED}))},E.onmessage=y=>this.logger("".concat(E.url," onmessage: ").concat(y.data))}),this.websockets.push(...u),s||(()=>{const E=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",g.isResolved),this.websockets.forEach(y=>y.readyState!==WebSocket.OPEN&&y.close())};if(n||this.useProxy)return this.logger("add 5s timeout at ".concat(n?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(E,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",g.isResolved),g.isResolved)return E();zt().os===Dr.MAC_OS&&mn()&&E(),this.createWebSocket(e,!0,!0).then(y=>g.resolve(y)).catch(y=>{this.isNormalPortFailed&&g.reject(y),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(E,this.forceCloseWSDuration)},this.try443PortDuration)})(),g.promise}chooseBestWebsocket(e,n,s,a){return this.useDoubleDomain=!!n,typeof e=="string"&&(e=function(l){let u,p,m;return[,u,p,m]=l.match(wie)||[],u||([,p,m]=l.match(Rie)||[]),p&&m||([,p,m]=l.match(Iie)||[]),p&&m||([,p]=l.match(Aie)||[]),p||N.warning("un-destructible url: ",l),{proxy:u,host:p,port:m||"443"}}(e)),this.recordIndex=a,this.useProxy=!!e.proxy,s&&this.useProxy&&(N.warn("cannot use 443 only when use proxy"),s=!1),this.createWebSocket(e,!!s,!1).finally(()=>this.clearTimeout())}}function s3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}class o3 extends jn{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var n;je(n=["tryNext","recover"]).call(n,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._state==="reconnecting"?this.emit(ct.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(ct.CONNECTED):this._state==="closed"?this.emit(ct.CLOSED):this._state==="failed"&&this.emit(ct.FAILED))}resetReconnectCount(e){N.debug("websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=arguments.length>3&&arguments[3]!==void 0&&arguments[3],l=arguments.length>4&&arguments[4]!==void 0&&arguments[4],u=arguments.length>5?arguments[5]:void 0;super(),R(this,"connectionID",0),R(this,"currentURLIndex",0),R(this,"urls",[]),R(this,"_reconnectMode","tryNext"),R(this,"reconnectReason",void 0),R(this,"_initMutex",new ii("websocket")),R(this,"name",void 0),R(this,"_state","closed"),R(this,"reconnectInterrupter",void 0),R(this,"websocket",void 0),R(this,"retryConfig",void 0),R(this,"reconnectCount",0),R(this,"forceCloseTimeout",5e3),R(this,"onlineReconnectListener",void 0),R(this,"useCompress",void 0),R(this,"tryDoubleDomain",!1),R(this,"use443PortOnly",!1),R(this,"wsInflateLength",0),R(this,"wsDeflateLength",0),R(this,"closeEstablishingWs",()=>{}),R(this,"store",void 0),R(this,"joinGatewayRecordIndex",void 0),this.store=u,this.name=e,this.retryConfig=function(y){for(var C=1;C<arguments.length;C++){var I=arguments[C]!=null?arguments[C]:{};C%2?s3(Object(I),!0).forEach(function(j){R(y,j,I[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(I)):s3(Object(I)).forEach(function(j){Object.defineProperty(y,j,Object.getOwnPropertyDescriptor(I,j))})}return y}({},n),this.useCompress=s,this.tryDoubleDomain=a,this.use443PortOnly=l;const{timeout:p,timeoutFactor:m}=n,g=Math.max(300,Math.floor(3*p/5)),E=Math.max(1.2,Math.floor(8*m)/10);ns.ONLINE&&(this.retryConfig.timeout=g,this.retryConfig.timeoutFactor=E),Cr.on(Zl.NETWORK_STATE_CHANGE,(y,C)=>{y!==C&&(this.resetReconnectCount("network state change: ".concat(C," -> ").concat(y)),y===ns.ONLINE?(this.retryConfig.timeout=g,this.retryConfig.timeoutFactor=E):(this.retryConfig.timeout=p,this.retryConfig.timeoutFactor=m))})}getConnection(){return this.websocket||void 0}async init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=await this._initMutex.lock();this.forceCloseTimeout=n,this.urls=e,this.state="connecting";try{const a=TE(),l=this.urls[this.currentURLIndex];this.createWebSocketConnection(l).then(a.resolve).catch(a.reject),this.once(ct.CLOSED,()=>{a.reject(new ye(z.WS_DISCONNECT))}),this.once(ct.CONNECTED,a.resolve),await a.promise}catch{}finally{s()}}close(e,n){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const s=this.websocket;n?setTimeout(()=>s.close(),500):s.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,n){if(!this.websocket)return void N.warning("[".concat(this.name,"] can not reconnect, no websocket"));e!==void 0&&(this.reconnectMode=e),N.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(n)]},this.joinGatewayRecordIndex);const s=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),s&&s.bind(this.websocket)({code:9999,reason:n})}sendMessage(e){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new ye(z.WS_ABORT,"websocket is not ready");try{n||(e=JSON.stringify(e)),this.websocket.send(e)}catch(s){throw new ye(z.WS_ERR,"send websocket message error"+s.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,n=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:n}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e){var n;const s=TE();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const a=E=>{var y;(y=this.store)===null||y===void 0||y.signalChannelOpen(),N.debug("[".concat(this.name,"] websocket opened:"),E),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),s.resolve()},l=async E=>{var y;if(N.debug("[".concat(this.name,"] websocket close ").concat((y=this.websocket)===null||y===void 0?void 0:y.url,", code: ").concat(E.code,", reason: ").concat(E.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)s.reject(new ye(z.WS_DISCONNECT,"websocket close: ".concat(E.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=E.reason,this.state="reconnecting");const C=Qs(this,ct.WILL_RECONNECT,this.reconnectMode,E.reason)||this.reconnectMode,I=await this.reconnectWithAction(C);if(this.state==="closed")return void N.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!I)return s.reject(new ye(z.WS_DISCONNECT,"websocket reconnect failed: ".concat(E.code))),this.close(!0);s.resolve()}},u=E=>{this.emit(ct.ON_MESSAGE,E)},p=E=>{N.warn("[".concat(this.connectionID,"] ws open error ").concat(E))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),Z("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=Z("GATEWAY_WSS_ADDRESS")),N.debug("[".concat(this.name,"] start connect, url:"),e);const m=(n=this.store)===null||n===void 0?void 0:n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var g;const E=await this.chooseBestWebsocketConnection(e);this.websocket=E,a&&a(this.websocket.url),this.websocket.onclose=l,this.websocket.onmessage=u,this.websocket.onerror=p,(g=this.store)===null||g===void 0||g.recordJoinChannelService({endTs:Date.now(),status:"success"},m),this.joinGatewayRecordIndex=m}catch(E){const y=this.state==="closed",C=E instanceof ye,I=C&&E.code===z.WS_ABORT,j=C&&E.code===z.WS_ERR,P=C?E.message:E&&(E.reason||E.toString());N.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(P)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:I?"aborted":"error",errors:[E]},m),y||j?(s.reject(y?new ye(z.WS_DISCONNECT,"websocket is closed: ".concat(P)):new ye(z.WS_ERR,"init websocket failed: ".concat(P))),j&&N.error("[".concat(this.name,"] init websocket failed: ").concat(P))):l&&l(E)}return s.promise}async reconnectWithAction(e){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;N.warning("[choose-best-ws] action: =>",e),this.onlineReconnectListener||Cr.isOnline||!Cr.onlineWaiter||(this.onlineReconnectListener=Cr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let s=!0;if(this.reconnectInterrupter=()=>s=!1,n){const u=Lb(this.reconnectCount,this.retryConfig);N.debug("[".concat(this.name,"] wait ").concat(u,"ms to reconnect websocket, mode: ").concat(e)),await pe.race([ri(u),this.onlineReconnectListener||new pe(()=>{})])}if(this._state==="closed"||!s)return!1;this.reconnectCount+=1;const a=async(u,p)=>{this.emit(ct.RECONNECT_CREATE_CONNECTION,p),await this.createWebSocketConnection(u)};try{if(e==="retry")this.emit(ct.RECONNECT_WAITTING_FINISH,e),await a(this.urls[this.currentURLIndex],e);else if(e==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);N.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(ct.RECONNECT_WAITTING_FINISH,e),await a(this.urls[this.currentURLIndex],e)}else e==="recover"&&(N.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(ct.RECONNECT_WAITTING_FINISH,e),this.urls=await Tr(this,ct.REQUEST_NEW_URLS),this.currentURLIndex=0,await a(this.urls[this.currentURLIndex],e))}catch(u){var l;N.error("[".concat(this.name,"] reconnect failed ").concat(u&&u.toString()));const p=u==null||(l=u.data)===null||l===void 0?void 0:l.desc;return Array.isArray(p)&&je(p).call(p,"dynamic key expired")?(this.emit(ct.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(e,n)}return!0}}class LE extends o3{constructor(e,n){super(e,n,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,n){const s=TE(),a=function(u,p){return new Nie(u,p)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{N.debug("[choose-best-ws] close establishing websockets"),a.closeAllWebsockets(),s.reject(new ye(z.WS_ABORT,"choose best websocket aborted"))};const l=Z("GATEWAY_DOMAINS");return N.debug("[choose-best-ws] currentDomain: ",e,", domains: ",l,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),a.chooseBestWebsocket(e,this.tryDoubleDomain,this.use443PortOnly,n).then(s.resolve).catch(s.reject),s.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class ME extends o3{constructor(e,n){super(e,n,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,n){return new pe((s,a)=>{let l=!1;const u=[];this.closeEstablishingWs=()=>{N.debug("[choose-best-ws] close establishing websockets"),u.forEach(j=>{j.onclose=null,j.onopen=null,j.onmessage=null,j.close()}),a(new ye(z.WS_ABORT,"choose best websocket aborted"))};const p=Z("GATEWAY_DOMAINS");let m;const g=e.indexOf("?h="),E=p.find(j=>g!==-1?je(e).call(e,j,g):je(e).call(e,j));N.debug("[choose-best-ws] currentDomain: ",E,", domains: ",p);let y=!this.tryDoubleDomain||!E;if(!y&&E){var C;const j=Date.now();try{p.forEach(P=>{const U=g===-1?e.replace(E,P):e.substr(0,g)+e.substr(g).replace(E,P),q=new WebSocket(U);q.binaryType="arraybuffer",u.push(q),N.debug("[choose-best-ws] ws is connecting:",q.url)})}catch{for(N.debug("[choose-best-ws] ws create failed, fallback to single url"),u.forEach(U=>U.close());u.length;)u.pop();y=!0}(C=this.store)===null||C===void 0||C.recordJoinChannelService({urls:u.map(P=>P.url),service:"gateway"},n),u.forEach(P=>{P.onopen=()=>{if(l)return;const U=Date.now()-j;N.debug("[choose-best-ws] ws open cost ".concat(U,"ms")),u.filter(q=>q!==P).forEach(q=>{N.debug("[choose-best-ws]close backup websocket: ".concat(q.url)),q.close()}),l=!0,s(P)},P.onclose=U=>{m=U,!l&&(u.find(q=>!(q.readyState===WebSocket.CLOSED||q.readyState===WebSocket.CLOSING))||(N.debug("[choose-best-ws] all websocket is closed"),l=!0,a(m)))},P.onmessage=U=>{N.debug("[choose-best-ws]".concat(P.url," onmessage: ").concat(U.data))}}),ri(this.forceCloseTimeout).then(()=>{u.forEach(P=>{P.readyState!==WebSocket.OPEN&&P.close()})})}if(y){var I;let j;N.debug("[choose-best-ws] use single url: ",e),(I=this.store)===null||I===void 0||I.recordJoinChannelService({urls:[e],service:"gateway"},n);try{j=new WebSocket(e),u.push(j),j.binaryType="arraybuffer"}catch(P){const U=new ye(z.WS_ERR,"init websocket failed! Error: ".concat(P.toString()));return N.error("[".concat(this.name,"]").concat(U)),void a(U)}j.onopen=()=>{s(j)},j.onclose=P=>{a(P)},j.onmessage=P=>{N.debug("[choose-best-ws]".concat(j.url," onmessage: ").concat(P.data))},ri(this.forceCloseTimeout).then(()=>{j&&j.readyState!==WebSocket.OPEN&&j.close()})}}).then(s=>(this.closeEstablishingWs=void 0,s)).catch(s=>{throw this.closeEstablishingWs=void 0,s})}}class a3 extends jn{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Ot.CONNECTED?this.emit(We.WS_CONNECTED):e===Ot.RECONNECTING?this.emit(We.WS_RECONNECTING,this._websocketReconnectReason):e===Ot.CLOSED&&this.emit(We.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,n){super(),R(this,"_disconnectedReason",void 0),R(this,"_websocketReconnectReason",void 0),R(this,"_connectionState",Ot.CLOSED),R(this,"reconnectToken",void 0),R(this,"websocket",void 0),R(this,"openConnectionTime",void 0),R(this,"clientId",void 0),R(this,"lastMsgTime",Date.now()),R(this,"uploadCache",[]),R(this,"uploadCacheInterval",void 0),R(this,"rttRolling",new ZO(5)),R(this,"pingpongTimer",void 0),R(this,"wsInflateDataTimer",void 0),R(this,"pingpongTimeoutCount",0),R(this,"joinResponse",void 0),R(this,"multiIpOption",void 0),R(this,"initError",void 0),R(this,"spec",void 0),R(this,"store",void 0),R(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(We.ON_BINARY_DATA,s.data);const a=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(a,"_id")){const l="res-@".concat(a._id);this.emit(l,a._result,a._message)}else if(Object.prototype.hasOwnProperty.call(a,"_type")){if(this.emit(a._type,a._message),a._type===ht.ON_NOTIFICATION&&this.handleNotification(a._message),a._type===ht.ON_USER_BANNED)switch(a._message.error_code){case 14:this.close(Dt.UID_BANNED);break;case 15:this.close(Dt.IP_BANNED);break;case 16:this.close(Dt.CHANNEL_BANNED)}if(a._type===ht.ON_USER_LICENSE_BANNED)switch(a._message.error_code){case et.ERR_LICENSE_MISSING:this.close(Dt.LICENSE_MISSING);break;case et.ERR_LICENSE_EXPIRED:this.close(Dt.LICENSE_EXPIRED);break;case et.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Dt.LICENSE_MINUTES_EXCEEDED);break;case et.ERR_LICENSE_PERIOD_INVALID:this.close(Dt.LICENSE_PERIOD_INVALID);break;case et.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Dt.LICENSE_MULTIPLE_SDK_SERVICE);break;case et.ERR_LICENSE_ILLEGAL:this.close(Dt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=e.clientId,this.spec=e,this.store=n,this.websocket=new LE("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Ot.CONNECTED&&this.reconnect("retry",ni.OFFLINE)})}async request(e,n,s,a){const l=Sn(6,""),u={_id:l,_type:e,_message:n},p=this.websocket.connectionID,m=()=>new pe((j,P)=>{if(this.connectionState===Ot.CONNECTED)return j();const U=()=>{this.off(We.WS_CLOSED,q),j()},q=()=>{this.off(We.WS_CONNECTED,U),P(new le(z.WS_ABORT))};this.once(We.WS_CONNECTED,U),this.once(We.WS_CLOSED,q),e!==Xe.PUBLISH&&e!==Xe.PUBLISH_DATASTREAM&&e!==Xe.SUBSCRIBE&&e!==Xe.SUBSCRIBE_DATASTREAM&&e!==Xe.UNSUBSCRIBE&&e!==Xe.UNSUBSCRIBE_DATASTREAM&&e!==Xe.UNPUBLISH&&e!==Xe.UNPUBLISH_DATASTREAM&&e!==Xe.CONTROL&&e!==Xe.RESTART_ICE||this.once(We.DISCONNECT_P2P,()=>{P(new le(z.DISCONNECT_P2P))}),e!==Xe.PUBLISH&&e!==Xe.RESTART_ICE||this.once(We.ABORT_P2P_EXECUTION,()=>{P(new le(z.DISCONNECT_P2P))})});if(this.connectionState!==Ot.CONNECTING&&this.connectionState!==Ot.RECONNECTING||e===Xe.JOIN||e===Xe.REJOIN||await m(),this.websocket.sendMessage(u,!0),a)return;const g=new pe((j,P)=>{let U=!1;const q=(se,he)=>{U=!0,j({isSuccess:se==="success",message:he||{}}),this.off(We.WS_CLOSED,J),this.off(We.WS_RECONNECTING,J),this.emit(We.REQUEST_SUCCESS,e,n)};this.once("res-@".concat(l),q);const J=()=>{P(new le(z.WS_ABORT,"type: ".concat(e))),this.off(We.WS_CLOSED,J),this.off(We.WS_RECONNECTING,J),this.off("res-@".concat(l),q)};this.once(We.WS_CLOSED,J),this.once(We.WS_RECONNECTING,J),ri(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||U||(N.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(We.REQUEST_TIMEOUT,e,n))})});let E=null;try{E=await g}catch(j){if(this.connectionState===Ot.CLOSED||e===Xe.LEAVE)throw new le(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?j.throw():e===Xe.JOIN||e===Xe.REJOIN?null:(await m(),await this.request(e,n))}if(E.isSuccess)return E.message;const y=Number(E.message.error_code||E.message.code),C=rp(y),I=new le(z.UNEXPECTED_RESPONSE,"".concat(C.desc,": ").concat(E.message.error_str),{code:y,data:E.message});return C.action==="success"?E.message:(N.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(y,", message: ").concat(C.desc,", action: ").concat(C.action)),y===et.ERR_TOO_MANY_BROADCASTERS?((e===Xe.JOIN||e===Xe.REJOIN)&&(this.initError=I,this.close()),I.throw()):C.action==="failed"?I.throw():C.action==="quit"?(this.initError=I,this.close(),I.throw()):(y===et.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,N.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",ni.MULTI_IP)):this.reconnect(C.action,ni.SERVER_ERROR),e===Xe.JOIN||e===Xe.REJOIN?null:await this.request(e,n)))}waitMessage(e,n){return new pe(s=>{const a=l=>{(!n||n(l))&&(this.off(e,a),s(l))};this.on(e,a)})}uploadWRTCStats(e){if(!this.store.sessionId)return void N.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(rd.WRTC_STATS,n)}upload(e,n){const s={_type:e,_message:n};try{this.websocket.sendMessage(s)}catch{const l=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>l&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Ot.CONNECTED)return;const u=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(u._type,u._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,n){const s={_type:e,_message:n};this.websocket.sendMessage(s)}init(e,n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new pe((s,a)=>{this.once(We.WS_CONNECTED,()=>s(this.joinResponse)),this.once(We.WS_CLOSED,()=>a(this.initError||new le(z.WS_ABORT))),this.connectionState=Ot.CONNECTING,this.websocket.init(e).catch(a),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||Dt.LEAVE,this.connectionState=Ot.CLOSED,N.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),e===Dt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new LE("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(We.ABORT_P2P_EXECUTION);const e=await Tr(this,We.REQUEST_JOIN_INFO),n=await this.request(Xe.JOIN,e);if(!n)return this.emit(We.REPORT_JOIN_GATEWAY,np.TIMEOUT,this.url||""),!1;this.joinResponse=n,this.emit(We.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ot.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new le(z.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=Qh(this,We.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const n=await this.request(Xe.REJOIN,e);return!!n&&(this.connectionState=Ot.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),n.peers&&n.peers.forEach(s=>{this.emit(ht.ON_USER_ONLINE,{uid:s.uid}),s.audio&&this.emit(ht.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&this.emit(ht.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),s.audio_mute?this.emit(ht.MUTE_AUDIO,{uid:s.uid}):this.emit(ht.UNMUTE_AUDIO,{uid:s.uid}),s.video_mute?this.emit(ht.MUTE_VIDEO,{uid:s.uid}):this.emit(ht.UNMUTE_VIDEO,{uid:s.uid}),s.audio_enable_local?this.emit(ht.ENABLE_LOCAL_AUDIO,{uid:s.uid}):this.emit(ht.DISABLE_LOCAL_AUDIO,{uid:s.uid}),s.video_enable_local?this.emit(ht.ENABLE_LOCAL_VIDEO,{uid:s.uid}):this.emit(ht.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||this.emit(ht.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)}reconnect(e,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,n)}handleNotification(e){N.debug("[".concat(this.clientId,"] receive notification: "),e);const n=rp(e.code);if(n.action!=="success"){if(n.action!=="failed")return n.action==="quit"?(n.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Dt.UID_BANNED),void this.close()):void this.reconnect(n.action,ni.SERVER_ERROR);N.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=Z("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=e&&(N.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ni.TIMEOUT):this.request(Xe.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-n;this.rttRolling.add(s),Z("REPORT_STATS")&&this.send(Xe.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:n}=this.websocket.getWsInflateData();e!==0&&n!==0&&this.upload(rd.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:n,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(ct.RECONNECT_WAITTING_FINISH,e=>{this.emit(We.WS_RECONNECT_WAITTING_FINISH,e)}),this.websocket.on(ct.RECONNECT_CREATE_CONNECTION,e=>{this.emit(We.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(ct.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(ct.CLOSED,()=>{this.connectionState=Ot.CLOSED}),this.websocket.on(ct.FAILED,()=>{this._disconnectedReason=Dt.NETWORK_ERROR,this.connectionState=Ot.CLOSED}),this.websocket.on(ct.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Ot.CONNECTED?this.connectionState=Ot.RECONNECTING:this.connectionState=Ot.CONNECTING}),this.websocket.on(ct.WILL_RECONNECT,(e,n,s)=>{const a=Qh(this,We.IS_P2P_DISCONNECTED),l=a||e!=="retry";a&&e==="retry"&&(N.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),e="tryNext",n=np.P2P_DISCONNECTED),l&&(N.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(e)),this.emit(We.REPORT_JOIN_GATEWAY,n||np.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(We.NEED_RENEW_SESSION),this.emit(We.DISCONNECT_P2P)),s(e)}),this.websocket.on(ct.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(e=>{N.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",ni.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(We.REPORT_JOIN_GATEWAY,e.message||e.code||np.UNKNOWN_REASON,this.url||""),e instanceof le&&e.code===z.UNEXPECTED_RESPONSE&&e.data.code===et.ERR_NO_AUTHORIZED)return N.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ni.SERVER_ERROR);N.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ni.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(ct.REQUEST_NEW_URLS,(e,n)=>{Tr(this,We.REQUEST_RECOVER,this.multiIpOption).then(e).catch(n)}),this.websocket.on(ct.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ht.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}var c3=`	
\v\f\r                　\u2028\u2029\uFEFF`,kie=rt,xie=Ds,ON=c3,l3=w("".replace),Pie=RegExp("^["+ON+"]+"),Die=RegExp("(^|[^"+ON+"])["+ON+"]+$"),NN=function(i){return function(e){var n=xie(kie(e));return 1&i&&(n=l3(n,Pie,"")),2&i&&(n=l3(n,Die,"$1")),n}},Lie={start:NN(1),end:NN(2),trim:NN(3)},Mie=Oj.PROPER,Uie=h,d3=c3,jie=Lie.trim;On({target:"String",proto:!0,forced:function(i){return Uie(function(){return!!d3[i]()||"​᠎"[i]()!=="​᠎"||Mie&&d3[i].name!==i})}("trim")},{trim:function(){return jie(this)}});var si,Qo,Fie=qc("String").trim,Vie=x,Bie=Fie,kN=String.prototype,xN=d(function(i){var e=i.trim;return typeof i=="string"||i===kN||Vie(kN,i)&&e===kN.trim?Bie:e});function u3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Zb(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u3(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):u3(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function gu(i){return i.match(/^[\.\:\d]+$/)?"".concat(i.replace(/[^\d]/g,"-"),".").concat(Z("TURN_DOMAIN")):(N.info("Unidentified as ip: ".concat(i,", use as host")),i)}function h3(i,e){i.addresses||(i.addresses=[]);const n=function(l,u){if(Z("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return l.map(g=>{let{ip:E,port:y}=g;return{address:"".concat(E,":").concat(y)}});const p=Z("GATEWAY_DOMAINS");let m=p[1]&&je(u).call(u,p[1])?1:0;return l.map(g=>{let{domain_prefix:E,port:y,ip:C}=g;if(E)return{address:"".concat(E,".").concat(p[m++%p.length],":").concat(y)};const I=/^[\.\:\d]+$/.test(C),j=I?"".concat(C.replace(/[^\d]/g,"-"),".").concat(p[m++%p.length],":").concat(y):"".concat(C,":").concat(y);return I||N.info("Unidentified as ip: ".concat(C,", use as host")),{ip:C,port:y,address:j}})}(i.addresses,e),s=Array.isArray(i.detail)&&i.detail[18];if(s&&typeof s=="string"){const l=s.split(";");for(let u=0;u<l.length;u++){var a;const p=xN(a=l[u]).call(a);n[u]&&p&&(n[u].ip6=p)}}return{gatewayAddrs:n,uid:i.uid,cid:i.cid,cert:i.cert,vid:i.detail&&i.detail[8],uni_lbs_ip:i.detail&&i.detail[1],res:i,csIp:i.detail&&i.detail[502]}}function To(i){return typeof i=="number"?i:i.exact||i.ideal||i.max||i.min||0}function p3(i){const e=i._encoderConfig;if(!e)return{};const n={resolution:e.width&&e.height?"".concat(To(e.width),"x").concat(To(e.height)):void 0,maxVideoBW:e.bitrateMax,minVideoBW:e.bitrateMin};return typeof e.frameRate=="number"?(n.maxFrameRate=e.frameRate,n.minFrameRate=e.frameRate):e.frameRate&&(n.maxFrameRate=e.frameRate.max||e.frameRate.ideal||e.frameRate.exact||e.frameRate.min,n.minFrameRate=e.frameRate.min||e.frameRate.ideal||e.frameRate.exact||e.frameRate.max),n}function f3(i){return i>=0&&i<.17?1:i>=.17&&i<.36?2:i>=.36&&i<.59?3:i>=.59&&i<=1?4:i>1?5:0}function PN(i,e){let n,s,a;switch(e){case si.CHOOSE_SERVER:s=4096,a="choose server";break;case si.CLOUD_PROXY:s=1048576,a="proxy";break;case si.CLOUD_PROXY_5:s=4194304,a="proxy5";break;case si.CLOUD_PROXY_FALLBACK:s=4194310,a="proxy fallback";break;default:throw new le(z.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:i.detail&&i.detail[502],retry:!1})}if(i.response_body.forEach(l=>{l.buffer&&l.buffer.flag===s&&(n={code:l.buffer.code,addresses:(l.buffer.edges_services||[]).map(u=>Zb(Zb({},u),{},{ticket:l.buffer.cert})),server_ts:i.enter_ts,uid:l.buffer.uid,cid:l.buffer.cid,cname:l.buffer.cname,detail:Zb(Zb({},l.buffer.detail),i.detail),flag:l.buffer.flag,opid:i.opid,cert:l.buffer.cert})}),!n)throw new le(z.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(a," from multi unilbs response"),{csIp:i.detail&&i.detail[502]});return n}async function Wie(i,e){return await pe.all(i.addresses.map(async n=>({address:gu(n.ip),tcpport:n.port,udpport:n.port,username:e&&Z("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?e.toString():us.username,password:e&&Z("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await YO(e.toString()):us.password})))}function DN(i,e){const n=e._videoHeight||e.getMediaStreamTrack(!0).getSettings().height;return n?Math.max(n/To(i.height),1):(N.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function _u(i){let{candidateType:e,relayProtocol:n,type:s,address:a,port:l,protocol:u}=i;return s==="local-candidate"?{candidateType:e,relayProtocol:n,protocol:u}:{candidateType:e,relayProtocol:n,address:a,port:l,protocol:u}}function m3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}(function(i){i[i.CHOOSE_SERVER=11]="CHOOSE_SERVER",i[i.CLOUD_PROXY=18]="CLOUD_PROXY",i[i.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",i[i.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"})(si||(si={}));class $ie extends jn{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var n;je(n=["tryNext","recover"]).call(n,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._state==="reconnecting"?this.emit(dr.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(dr.CONNECTED):this._state==="closed"?this.emit(dr.CLOSED):this._state==="failed"&&this.emit(dr.FAILED))}constructor(e,n,s,a){super(),R(this,"connectionID",0),R(this,"currentURLIndex",0),R(this,"reconnectReason",void 0),R(this,"_reconnectMode","tryNext"),R(this,"_name",void 0),R(this,"_state","closed"),R(this,"_retryConfig",void 0),R(this,"_reconnectCount",0),R(this,"_forceCloseTimeout",5e3),R(this,"_onlineReconnectListener",void 0),R(this,"_closeEstablishingTransmitter",()=>{}),R(this,"_store",void 0),R(this,"_joinChannelServiceRecordIndex",void 0),R(this,"_useCompress",void 0),R(this,"_inflateLength",0),R(this,"_deflateLength",0),this._store=a,this._name=e,this._retryConfig=function(l){for(var u=1;u<arguments.length;u++){var p=arguments[u]!=null?arguments[u]:{};u%2?m3(Object(p),!0).forEach(function(m){R(l,m,p[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(p)):m3(Object(p)).forEach(function(m){Object.defineProperty(l,m,Object.getOwnPropertyDescriptor(p,m))})}return l}({},n),this._useCompress=s}resetReconnectCount(e){N.debug("".concat(this._name," reset reconnect count, reason: ").concat(e)),this._reconnectCount=0}close(e,n){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const s=this._transmitter;n?setTimeout(()=>s.close(),500):s.close(),this._transmitter=void 0}this.state=e?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(e,n){if(!this._transmitter)return void N.warning("[".concat(this._name,"] can not reconnect, no websocket"));var s;e!==void 0&&(this.reconnectMode=e),N.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((s=this._store)===null||s===void 0||s.recordJoinChannelService({status:"error",errors:[new Error(n)]},this._joinChannelServiceRecordIndex));const a=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),a&&a.bind(this._transmitter)({code:9999,reason:n})}getInflateData(){const e=this._inflateLength,n=this._deflateLength;return this.clearInflateData(),{inflateLength:e,deflateLength:n}}setInflateData(e){this._deflateLength=this._deflateLength+e.originLength,this._inflateLength=this._inflateLength+e.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}(function(i){i[i.Default=0]="Default",i[i.Ack=1]="Ack"})(Qo||(Qo={}));class Gie{constructor(e,n,s){R(this,"version",1),R(this,"initialRTO",void 0),R(this,"maxBatchAckCount",void 0),R(this,"maxRTO",void 0),R(this,"initialRTT",void 0),R(this,"ID",void 0),R(this,"rtt",void 0),R(this,"packetNumber",1),R(this,"rtoRatioMap",new Map),R(this,"timeoutMap",new Map),R(this,"unorderedPacketQueue",[]),R(this,"batchAckPacketQueue",[]),R(this,"lastOrderedPacketNumber",0),R(this,"batchAckTimer",void 0),R(this,"sendImpl",void 0),R(this,"receiveImpl",void 0),this.sendImpl=e,this.receiveImpl=n,this.ID=Sn(7,"transmitter-"),this.initialRTO=(s==null?void 0:s.initialRTO)!==void 0?s.initialRTO:Z("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(s==null?void 0:s.initialRTT)!==void 0?s.initialRTT:Z("TRANSMITTER_INITIAL_RTT"),this.rtt=(s==null?void 0:s.initialRTT)!==void 0?s.initialRTT:Z("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(s==null?void 0:s.maxBatchAckCount)!==void 0?s.maxBatchAckCount:Z("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(s==null?void 0:s.maxRTO)!==void 0?s.maxRTO:Z("TRANSMITTER_MAX_RTO")}packetize(e,n){return{type:Qo.Default,version:this.version,packetNumber:n,payload:e}}serialize(e){switch(e.type){case Qo.Default:{let n;typeof e.payload=="string"?n=new TextEncoder().encode(e.payload):n=e.payload;const s=new ArrayBuffer(n.length+15),a=new DataView(s);return a.setUint16(0,e.version),a.setUint8(2,e.type),a.setUint32(3,e.packetNumber),F5(a,7,BigInt(e.sendTs)),new Uint8Array(a.buffer).set(n,15),s}case Qo.Ack:{const n=new ArrayBuffer(16),s=new DataView(n);return s.setUint16(0,e.version),s.setUint8(2,e.type),s.setUint32(3,e.maxAckPacketNumber),s.setUint8(7,e.shift),F5(s,8,BigInt(e.ackSendTs)),n}}}deserialize(e){const n=new DataView(e),s=n.getUint16(0),a=n.getUint8(2);switch(a){case Qo.Default:{const l=n.getUint32(3),u=j5(n,7),p=e.slice(15),m=new TextDecoder().decode(p);return{version:s,type:a,packetNumber:l,sendTs:Number(u),payload:m}}case Qo.Ack:{const l=n.getUint32(3),u=n.getUint8(7),p=j5(n,8);return{version:s,type:a,maxAckPacketNumber:l,shift:u,ackSendTs:Number(p)}}default:throw N.error("[".concat(this.ID,"] Unrecognized packet type ").concat(a)),new Error("Unrecognized packet type ".concat(a))}}sendMessage(e){const n=this.packetize(e,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const s=this.calculateRTO(n),a=window.setTimeout(()=>{this.resendMessage(n)},s);this.timeoutMap.set(n.packetNumber,a),this.sendPacket(n)}onData(e){const n=this.deserialize(e);n.type===Qo.Default?this.ack(n):n.type===Qo.Ack&&(this.updateRTT(n,Math.round(performance.now())),this.clearRTO(n))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(e=>{let[n,s]=e;window.clearTimeout(s)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(e){const n=this.calculateRTO(e),s=window.setTimeout(()=>{this.resendMessage(e)},n);this.timeoutMap.set(e.packetNumber,s),this.sendPacket(e)}calculateRTO(e){const n=this.rtoRatioMap.get(e.packetNumber);if(n===void 0)return this.rtoRatioMap.set(e.packetNumber,1),this.initialRTO;{const s=9*this.rtt/8*n;return this.rtoRatioMap.set(e.packetNumber,n+1),s>this.maxRTO?this.maxRTO:s}}updateRTT(e,n){const s=e.ackSendTs;this.rtt=this.rtt*(7/8)+(n-s-this.rtt)/8}ack(e){if(e.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(e):(this.batchAckPacketQueue.push(e),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(e.payload);;){const n=this.unorderedPacketQueue[0];if(!n){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(n.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(e.packetNumber<=this.lastOrderedPacketNumber){const n={ackSendTs:e.sendTs,maxAckPacketNumber:e.packetNumber,shift:0,type:Qo.Ack,version:this.version};this.sendPacket(n)}else if(e.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[e.packetNumber-this.lastOrderedPacketNumber-2]=e;const n={ackSendTs:e.sendTs,maxAckPacketNumber:e.packetNumber,shift:0,type:Qo.Ack,version:this.version};this.sendPacket(n)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const e={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:Qo.Ack,version:this.version};this.sendPacket(e),this.batchAckPacketQueue=[]}sendPacket(e){e.type===Qo.Default&&(e.sendTs=Math.round(performance.now()));const n=this.serialize(e);this.sendImpl(n)}clearRTO(e){for(let n=e.maxAckPacketNumber-e.shift;n<=e.maxAckPacketNumber;n++){const s=this.timeoutMap.get(n);s!==void 0&&window.clearTimeout(s),this.timeoutMap.delete(n),this.rtoRatioMap.delete(n)}}}class g3 extends $ie{constructor(e,n){super(e,n,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),R(this,"_initMutex",void 0),R(this,"_reconnectInterrupter",void 0),R(this,"_url",void 0),R(this,"_transmitter",void 0),R(this,"_addresses",void 0),R(this,"_reliableTransmission",void 0),this._initMutex=new ii("datachannel");const{timeout:s,timeoutFactor:a}=n,l=Math.max(300,Math.floor(3*s/5)),u=Math.max(1.2,Math.floor(8*a)/10);ns.ONLINE&&(this._retryConfig.timeout=l,this._retryConfig.timeoutFactor=u),Cr.on(Zl.NETWORK_STATE_CHANGE,(p,m)=>{p!==m&&(this.resetReconnectCount("network state change: ".concat(m," -> ").concat(p)),p===ns.ONLINE?(this._retryConfig.timeout=l,this._retryConfig.timeoutFactor=u):(this._retryConfig.timeout=s,this._retryConfig.timeoutFactor=a))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=n;const s=(a,l)=>{this._addresses=e,this.currentURLIndex=this._addresses.findIndex(p=>p.fingerprint||Z("FINGERPRINT"));const u=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(u).then(a).catch(l),this.once(dr.CLOSED,()=>l(new le(z.WS_DISCONNECT))),this.once(dr.CONNECTED,()=>a())};return this._initMutex.lock().then(a=>new pe((l,u)=>{s(l,u)}).then(()=>{a()}).catch(()=>{a()}))}sendMessage(e){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new le(z.WS_ABORT,"datachannel is not ready");try{n||(e=JSON.stringify(e)),this._reliableTransmission.sendMessage(e)}catch(s){throw new le(z.WS_ERR,"send datachannel signal message error"+s.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(e){const n=JSON.stringify(e);return{compressed:n,compressedLength:n.length,origin:e}}sendMessageWithUint8Array(e){return{compressed:e,compressedLength:e.byteLength,origin:e}}createTransmitterConnection(e){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(e.ip,":").concat(e.port),new pe((n,s)=>{var a;const l=()=>{N.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),n()},u=async E=>{var y;if((y=this._closeEstablishingTransmitter)===null||y===void 0||y.call(this),N.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(E.code,", reason: ").concat(E.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=E.reason,this.state="reconnecting");const C=Qs(this,dr.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,I=await this.reconnectWithAction(C);if(this.state==="closed")return void N.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!I)return s(new le(z.WS_DISCONNECT,"datachannel reconnect failed: ".concat(E.code))),void this.close(!0);n()}else s(new le(z.WS_DISCONNECT,"datachannel close: ".concat(E.code))),this.close()},p=E=>{var y;(y=this._reliableTransmission)===null||y===void 0||y.onData(E.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),N.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(e)));const m=(a=this._store)===null||a===void 0?void 0:a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),g=Date.now();Tr(this,dr.TO_CONNECT_DATACHANNEL,e).then(E=>{var y,C;if(!E)throw new Error("transmissonInfo not exist yet");const{transmitter:I,close:j}=E;this._transmitter=I,(y=this._store)===null||y===void 0||y.signalChannelOpen();const P=Date.now()-g;N.debug("[choose dc] dc open cost ".concat(P,"ms")),this._reliableTransmission=new Gie(U=>{var q;this._transmitter&&this._transmitter.readyState==="open"&&((q=this._transmitter)===null||q===void 0||q.send(U))},U=>{typeof U=="string"&&this.emit(dr.ON_MESSAGE,U)}),this._closeEstablishingTransmitter=()=>{var U;(U=this._reliableTransmission)===null||U===void 0||U.close(),this._reliableTransmission=void 0,j()},l&&l(),I.onclose=u,I.onmessage=p,(C=this._store)===null||C===void 0||C.recordJoinChannelService({endTs:Date.now(),status:"success"},m),this._joinChannelServiceRecordIndex=m}).catch(E=>{var y;if((y=this._store)===null||y===void 0||y.recordJoinChannelService({endTs:Date.now(),status:E instanceof le&&E.code===z.WS_ABORT?"aborted":"error",errors:[E]},m),this.state!=="closed"){if(E instanceof le&&E.code===z.WS_ERR){const C=new le(z.WS_ERR,"init datachannel failed! Error: ".concat(E.toString()));return N.error("[".concat(this._name,"]").concat(C)),void s(C)}u&&u(E)}else s(new le(z.WS_DISCONNECT,"datachannel is closed: ".concat(E.toString())))})})}async reconnectWithAction(e){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||Cr.networkState!==ns.OFFLINE||(this._onlineReconnectListener=Cr.onlineWaiter&&Cr.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let s=!0;if(this._reconnectInterrupter=()=>{s=!1},n){const p=Lb(this._reconnectCount,this._retryConfig);N.debug("[".concat(this._name,"] wait ").concat(p,"ms to reconnect datachannel, mode: ").concat(e)),await pe.race([ri(p),this._onlineReconnectListener||new pe(()=>{})])}if(this.state==="closed"||!s)return!1;this._reconnectCount+=1;const a=async(p,m)=>{this.emit(dr.RECONNECT_CREATE_CONNECTION,m),await this.createTransmitterConnection(p)};try{if(e==="retry"){const p=this._addresses[this.currentURLIndex];this.emit(dr.RECONNECT_WAITTING_FINISH,e),await a(p,e)}else if(e==="tryNext"){this.currentURLIndex+=1;for(let m=this.currentURLIndex;m<this._addresses.length;m++){if(this._addresses[m].fingerprint||Z("FINGERPRINT")){this.currentURLIndex=m;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return N.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);N.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const p=this._addresses[this.currentURLIndex];this.emit(dr.RECONNECT_WAITTING_FINISH,e),await a(p,e)}else e==="recover"&&(N.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(dr.RECONNECT_WAITTING_FINISH,e),this.emit(dr.FAILBACK));return!0}catch(p){var l,u;return N.error("[".concat(this._name,"] reconnect failed"),p.toString()),p!=null&&(l=p.data)!==null&&l!==void 0&&l.desc&&Array.isArray(p.data.desc)&&p.data.desc.length&&je(u=p.data.desc).call(u,"dynamic key expired")?(this.emit(dr.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(e,n)}}}class id extends jn{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Ot.CONNECTED?this.emit(We.WS_CONNECTED):e===Ot.RECONNECTING?this.emit(We.WS_RECONNECTING,this._websocketReconnectReason):e===Ot.CLOSED&&this.emit(We.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(e,n){super(),R(this,"_disconnectedReason",void 0),R(this,"_websocketReconnectReason",void 0),R(this,"_connectionState",Ot.CLOSED),R(this,"reconnectToken",void 0),R(this,"websocket",void 0),R(this,"openConnectionTime",void 0),R(this,"clientId",void 0),R(this,"lastMsgTime",Date.now()),R(this,"uploadCache",[]),R(this,"uploadCacheInterval",void 0),R(this,"rttRolling",new ZO(5)),R(this,"pingpongTimer",void 0),R(this,"inflateDataTimer",void 0),R(this,"pingpongTimeoutCount",0),R(this,"joinResponse",void 0),R(this,"multiIpOption",void 0),R(this,"initError",void 0),R(this,"spec",void 0),R(this,"store",void 0),R(this,"onWebsocketMessage",s=>{if(s instanceof ArrayBuffer)return void this.emit(We.ON_BINARY_DATA,s);const a=JSON.parse(s);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(a,"_id")){const l="res-@".concat(a._id);this.emit(l,a._result,a._message)}else if(Object.prototype.hasOwnProperty.call(a,"_type")&&(this.emit(a._type,a._message),a._type===ht.ON_NOTIFICATION&&this.handleNotification(a._message),a._type===ht.ON_USER_BANNED))switch(a._message.error_code){case 14:this.close(Dt.UID_BANNED);break;case 15:this.close(Dt.IP_BANNED);break;case 16:this.close(Dt.CHANNEL_BANNED)}}),this.clientId=e.clientId,this.spec=e,this.store=n,this.websocket=new g3("gateway-".concat(this.clientId),this.spec.retryConfig,!0,n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Ot.CONNECTED&&this.reconnect("retry",ol.OFFLINE)})}async request(e,n,s,a){const l=Sn(6,""),u={_id:l,_type:e,_message:n},p=this.websocket.connectionID,m=()=>new pe((j,P)=>{if(this.connectionState===Ot.CONNECTED)return j();const U=()=>{this.off(We.WS_CLOSED,q),j()},q=()=>{this.off(We.WS_CONNECTED,U),P(new le(z.WS_ABORT))};this.once(We.WS_CONNECTED,U),this.once(We.WS_CLOSED,q),e!==Xe.PUBLISH&&e!==Xe.SUBSCRIBE&&e!==Xe.UNSUBSCRIBE&&e!==Xe.UNPUBLISH&&e!==Xe.CONTROL&&e!==Xe.RESTART_ICE||this.once(We.DISCONNECT_P2P,()=>{P(new le(z.DISCONNECT_P2P))}),e!==Xe.PUBLISH&&e!==Xe.RESTART_ICE||this.once(We.ABORT_P2P_EXECUTION,()=>{P(new le(z.DISCONNECT_P2P))})});if(this.connectionState!==Ot.CONNECTING&&this.connectionState!==Ot.RECONNECTING||e===Xe.JOIN||e===Xe.REJOIN||await m(),e===Xe.LEAVE&&(this.websocket.unbindDcCloseEventListener(),a=!0),this.websocket.sendMessage(u,!0,!1),a)return;const g=new pe((j,P)=>{let U=!1;const q=(se,he)=>{U=!0,j({isSuccess:se==="success",message:he||{}}),this.off(We.WS_CLOSED,J),this.off(We.WS_RECONNECTING,J),this.emit(We.REQUEST_SUCCESS,e,n)};this.once("res-@".concat(l),q);const J=()=>{P(new le(z.WS_ABORT,"type: ".concat(e))),this.off(We.WS_CLOSED,J),this.off(We.WS_RECONNECTING,J),this.off("res-@".concat(l),q)};this.once(We.WS_CLOSED,J),this.once(We.WS_RECONNECTING,J),ri(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||U||(N.warning("dc request timeout, type: ".concat(e)),this.emit(We.REQUEST_TIMEOUT,e,n))})});let E=null;try{E=await g}catch(j){if(this.connectionState===Ot.CLOSED||e===Xe.LEAVE)throw new le(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?j.throw():e===Xe.JOIN||e===Xe.REJOIN?null:(await m(),await this.request(e,n))}if(E.isSuccess)return E.message;const y=Number(E.message.error_code||E.message.code),C=rp(y),I=new le(z.UNEXPECTED_RESPONSE,"".concat(C.desc,": ").concat(E.message.error_str),{code:y,data:E.message});return C.action==="success"?E.message:(N.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(y,", message: ").concat(C.desc,", action: ").concat(C.action)),y===et.ERR_TOO_MANY_BROADCASTERS?((e===Xe.JOIN||e===Xe.REJOIN)&&(this.initError=I,this.close()),I.throw()):C.action==="failed"?I.throw():C.action==="quit"?(this.initError=I,this.close(),I.throw()):(y===et.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,N.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",ol.MULTI_IP)):this.reconnect(C.action,ol.SERVER_ERROR),e===Xe.JOIN||e===Xe.REJOIN?null:await this.request(e,n)))}waitMessage(e,n){return new pe(s=>{const a=l=>{(!n||n(l))&&(this.off(e,a),s(l))};this.on(e,a)})}uploadWRTCStats(e){if(!this.store.sessionId)return void N.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(rd.WRTC_STATS,n)}upload(e,n){const s={_type:e,_message:n};try{this.websocket.sendMessage(s)}catch{const l=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>l&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Ot.CONNECTED)return;const u=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(u._type,u._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,n){const s={_type:e,_message:n};this.websocket.sendMessage(s)}init(e,n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new pe((s,a)=>{this.once(We.WS_CONNECTED,()=>s(this.joinResponse)),this.once(We.WS_CLOSED,()=>a(this.initError||new le(z.WS_ABORT))),this.connectionState=Ot.CONNECTING,this.websocket.init(e).catch(a),this.websocket.once(dr.FAILBACK,()=>{this.openConnectionTime===void 0&&a(new le(z.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{n&&this.openConnectionTime===void 0&&(N.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),a(new le(z.INIT_DATACHANNEL_TIMEOUT)))},Z("DC_JOIN_WITH_FAILBACK"))})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||Dt.LEAVE,this.connectionState=Ot.CLOSED,N.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),e===Dt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new g3("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(We.ABORT_P2P_EXECUTION);const e=await Tr(this,We.DATACHANNEL_CONNECTING),n=await this.request(Xe.JOIN,e);if(!n)return this.emit(We.REPORT_JOIN_GATEWAY,z.TIMEOUT,this.url||""),!1;this.joinResponse=n,this.emit(We.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ot.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new le(z.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=Qh(this,We.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const n=await this.request(Xe.REJOIN,e);return!!n&&(this.connectionState=Ot.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),n.peers&&n.peers.forEach(s=>{this.emit(ht.ON_USER_ONLINE,{uid:s.uid}),s.audio&&this.emit(ht.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&this.emit(ht.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),s.audio_mute?this.emit(ht.MUTE_AUDIO,{uid:s.uid}):this.emit(ht.UNMUTE_AUDIO,{uid:s.uid}),s.video_mute?this.emit(ht.MUTE_VIDEO,{uid:s.uid}):this.emit(ht.UNMUTE_VIDEO,{uid:s.uid}),s.audio_enable_local?this.emit(ht.ENABLE_LOCAL_AUDIO,{uid:s.uid}):this.emit(ht.DISABLE_LOCAL_AUDIO,{uid:s.uid}),s.video_enable_local?this.emit(ht.ENABLE_LOCAL_VIDEO,{uid:s.uid}):this.emit(ht.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||this.emit(ht.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)}reconnect(e,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,n)}handleNotification(e){N.debug("[".concat(this.clientId,"] receive notification: "),e);const n=rp(e.code);if(n.action!=="success"){if(n.action!=="failed")return n.action==="quit"?(n.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Dt.UID_BANNED),void this.close()):void this.reconnect(n.action,ol.SERVER_ERROR);N.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=Z("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=e&&(N.warning("PINGPONG Timeout. Last Socket Message: ".concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ol.TIMEOUT):this.request(Xe.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-n;this.rttRolling.add(s),Z("REPORT_STATS")&&this.send(Xe.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleInflateData(){const{inflateLength:e,deflateLength:n}=this.websocket.getInflateData();e!==0&&n!==0&&this.upload(rd.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:n,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(dr.RECONNECT_WAITTING_FINISH,e=>{this.emit(We.WS_RECONNECT_WAITTING_FINISH,e)}),this.websocket.on(dr.RECONNECT_CREATE_CONNECTION,e=>{this.emit(We.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(dr.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(dr.CLOSED,()=>{this.connectionState=Ot.CLOSED}),this.websocket.on(dr.FAILED,()=>{this._disconnectedReason=Dt.NETWORK_ERROR,this.connectionState=Ot.CLOSED}),this.websocket.on(dr.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Ot.CONNECTED?this.connectionState=Ot.RECONNECTING:this.connectionState=Ot.CONNECTING}),this.websocket.on(dr.WILL_RECONNECT,(e,n)=>{if(Qh(this,We.IS_P2P_DISCONNECTED)&&e==="retry")return N.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(We.NEED_RENEW_SESSION),this.emit(We.DISCONNECT_P2P),n("tryNext");e!=="retry"&&(N.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(We.NEED_RENEW_SESSION),this.emit(We.DISCONNECT_P2P)),n(e)}),this.websocket.on(dr.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(e=>{N.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",ol.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(We.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof le&&e.code===z.UNEXPECTED_RESPONSE&&e.data.code===et.ERR_NO_AUTHORIZED)return N.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ol.SERVER_ERROR);N.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ol.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(dr.REQUEST_NEW_URLS,(e,n)=>{Tr(this,We.REQUEST_RECOVER,this.multiIpOption).then(e).catch(n)}),this.websocket.on(dr.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ht.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(dr.TO_CONNECT_DATACHANNEL,async(e,n,s)=>Tr(this,We.DATACHANNEL_PRECONNECT,e).then(n).catch(s)),this.websocket.on(dr.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(We.DATACHANNEL_FAILBACK)})}}class ip extends jn{constructor(e,n){super(),R(this,"signal",void 0),R(this,"token",void 0),R(this,"tokenTimeout",void 0),R(this,"tokenInterval",void 0),R(this,"_sequence",0),R(this,"userMap",new Map),R(this,"encoder",new TextEncoder),this.signal=e,this.token=n;const s=()=>{this.signal.connectionState===Ot.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(s,1e3):this.tokenInterval=window.setTimeout(s,3*Z("P2P_TOKEN_INTERVAL"))};s()}async send(e,n,s,a,l){var u,p,m;if(this.userMap.size===0)return;const g=Array.from(yc(u=this.userMap).call(u))[0].token;typeof n!="string"&&(n=JSON.stringify(n)),a=(p=a)!==null&&p!==void 0?p:Sn(6,""),l=(m=l)!==null&&m!==void 0?m:this._sequence++;const E={_id:a,_type:e,_seq:l,_message:n,token:"".concat(this.token,"_").concat(g)};Z("SHOW_P2P_LOG")&&N.debug("send message",E,"noNeedResponse : ".concat(s)),this.splitMessage(JSON.stringify(E)).forEach(C=>{this.signal.request(Xe.DATA_STREAM,{payload:Jf(this.encoder.encode(C))})});const y=new pe((C,I)=>{const j=window.setTimeout(()=>{this.off("res-@".concat(a,"_ack"),P),this.off("res-@".concat(a),q),this.off(mu.ABORT,U),N.debug("[external-signal] request timeout, type: ".concat(e,", requestId: ").concat(a)),this.userMap.size===0?I(new ye(z.INVALID_REMOTE_USER)):I(new ye(z.TIMEOUT))},Z("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),P=()=>{j&&window.clearTimeout(j),this.off(mu.ABORT,U),s&&C()},U=()=>{j&&window.clearTimeout(j),this.off("res-@".concat(a,"_ack"),P),this.off("res-@".concat(a),q),I(new ye(z.EXTERNAL_SIGNAL_ABORT,"type: ".concat(e,", requestId: ").concat(a)))};this.once(mu.ABORT,U),this.once("res-@".concat(a,"_ack"),P);const q=(se,he)=>{J=!0,j&&window.clearTimeout(j),this.off("res-@".concat(a,"_ack"),P),this.off(mu.ABORT,U),se==="success"?C(he):I(new ye(z.P2P_MESSAGE_FAILED,"request ".concat(e," failed, requestId: ").concat(a)))};let J=!1;s||(this.once("res-@".concat(a),q),ri(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{J||N.warning("external_signal request timeout, type: ".concat(e,", requestId: ").concat(a,", ").concat(E))}))});try{return await y}catch(C){if(C.code===z.TIMEOUT)return await this.send(e,n,s,a,l);throw C}}onMessage(e){var n;const{_uid:s}=e;let a,l=this.userMap.get(s);if(l)a=l.splitMessageMap;else{if(this.userMap.size>0||!("_type"in e)||e._type!==tr.CHECK)return;const{token:g}=e;a=new Map,l={uid:s,isStart:!0,token:g,splitMessageMap:a,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(s,l),this.signal.emit(ht.ON_USER_ONLINE,{uid:s}),this.handleUserOnline()}if("id"in e&&"total"in e){var u;const{id:g,total:E}=e,y=(u=a.get(g))!==null&&u!==void 0?u:[];if(y.push(e),a.has(g)||a.set(g,y),y.length!==E)return;{const C=fE(y).call(y,(I,j)=>I.index-j.index).map(I=>I.payload).join("");a.delete(g),(e=JSON.parse(C))._uid=s}}const{_type:p,token:m}=e;if(je(n=[tr.ACK,tr.CHECK]).call(n,p))return p===tr.CHECK&&this.handleCheckToken(l,m),void this.receiveMessage(e);m==="".concat(l.token,"_").concat(this.token)?this.handleReceivedMessage(e):N.debug('Receive unexpected message", '.concat(m,", cur_token: ").concat(l.token,"_").concat(this.token),e)}check(){const e={_id:Sn(6,""),token:this.token,_type:tr.CHECK};Z("SHOW_P2P_LOG")&&N.debug("send message",e),this.signal.request(Xe.DATA_STREAM,{payload:Jf(this.encoder.encode(JSON.stringify(e)))})}ack(e){const n={_id:e,_type:tr.ACK,token:this.token};Z("SHOW_P2P_LOG")&&N.debug("send message",n),this.signal.request(Xe.DATA_STREAM,{payload:Jf(this.encoder.encode(JSON.stringify(n)))})}response(e,n,s){this.send(tr.RESPONSE,JSON.stringify({success:!s,message:n}),!0,e)}handleReceivedMessage(e){const n=()=>{this.userMap.forEach(g=>{const{receivedMessagesMap:E,nextExpectedSequenceNumber:y}=g;for(;E.has(y);){const C=E.get(y);E.delete(y),this.receiveMessage(C),g.nextExpectedSequenceNumber++}})};if(!e)return void n();const{_uid:s,_seq:a}=e,l=this.userMap.get(s),{receivedMessagesMap:u,isStart:p,nextExpectedSequenceNumber:m}=l;if(a<m)return this.ack(e._id),void N.debug("[external-signal] receive old message, seq: ".concat(a,", ").concat(e._message));u.set(a,e),p&&a===m&&(this.receiveMessage(e),u.delete(m),l.nextExpectedSequenceNumber++,n())}receiveMessage(e){const{_id:n,_type:s,_message:a,_uid:l}=e;if(Z("SHOW_P2P_LOG")&&N.debug("receive message",e),n){let u;switch(e._type!==tr.ACK&&(a&&(u=JSON.parse(a)),this.ack(e._id)),e._type){case tr.CANDIDATE:case tr.CONTROL:this.signal.emit(s,u,l);break;case tr.PUBLISH:case tr.UNPUBLISH:case tr.RESTART_ICE:case tr.CALL:u.uid=l,Tr(this.signal,s,u).then(p=>{this.response(e._id,p)}).catch(()=>{this.response(e._id,void 0,!0)});break;case tr.ACK:this.getListeners("res-@".concat(n,"_ack")).length>0&&this.emit("res-@".concat(n,"_ack"));break;case tr.RESPONSE:{const{success:p,message:m}=u;this.emit("res-@".concat(n),p?"success":"failed",m);break}}}}splitMessage(e){if(e.length<ip.MAX_MESSAGE_SIZE)return[e];const n=[],{remoteToken:s}=JSON.parse(e),a=Sn(6,"");let l=0,u=800;const p=Math.ceil(e.length/u);for(;e.length>0;){l++;const m={id:a,index:l,total:p,payload:e.slice(0,u),token:"".concat(this.token,"_").concat(s)};JSON.stringify(m).length>ip.MAX_MESSAGE_SIZE?u-=50:(n.push(m),e=e.slice(u))}return n.map(m=>JSON.stringify(m))}handleCheckToken(e,n){return e.token!==n?(N.debug("token changed, from ".concat(e.token," to ").concat(n)),this.reset(e.uid,n),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{N.debug("token timeout, ".concat(n)),this.reset(e.uid)},Z("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const e=await Tr(this.signal,tr.CALL,void 0),n=await this.send(tr.CALL,e);this.signal.emit(We.P2P_CONNECTION,n,!0)}async reset(e,n){const s=this.userMap.get(e);s&&(this.emit(mu.ABORT),this.signal.emit(ht.ON_USER_OFFLINE,{uid:s.uid,reason:IN.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),n||(N.debug("change local token from ".concat(n," to ").concat(n)),this.token=Sn(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(mu.ABORT)}}R(ip,"MAX_SIZE",1),R(ip,"MAX_MESSAGE_SIZE",1024);class _3 extends jn{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Ot.CONNECTED?this.emit(We.WS_CONNECTED):e===Ot.RECONNECTING?this.emit(We.WS_RECONNECTING,this._websocketReconnectReason):e===Ot.CLOSED&&this.emit(We.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,n){super(),R(this,"_disconnectedReason",void 0),R(this,"_websocketReconnectReason",void 0),R(this,"_connectionState",Ot.CLOSED),R(this,"reconnectToken",void 0),R(this,"p2pToken",void 0),R(this,"websocket",void 0),R(this,"openConnectionTime",void 0),R(this,"clientId",void 0),R(this,"lastMsgTime",Date.now()),R(this,"uploadCache",[]),R(this,"uploadCacheInterval",void 0),R(this,"rttRolling",new ZO(5)),R(this,"pingpongTimer",void 0),R(this,"pingpongTimeoutCount",0),R(this,"joinResponse",void 0),R(this,"multiIpOption",void 0),R(this,"initError",void 0),R(this,"spec",void 0),R(this,"store",void 0),R(this,"_external_signal",void 0),R(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(We.ON_BINARY_DATA,s.data);const a=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(a,"_id")){const l="res-@".concat(a._id);this.emit(l,a._result,a._message)}else if(Object.prototype.hasOwnProperty.call(a,"_type")){switch(a._type){case ht.ON_DATA_STREAM:return void this.handleDataStream(a._message);case ht.MUTE_AUDIO:case ht.MUTE_VIDEO:case ht.ON_P2P_LOST:case ht.ON_USER_ONLINE:return;case ht.ON_USER_OFFLINE:const{uid:l}=a._message;return N.debug("[".concat(this.clientId,"] user-offline uid: ").concat(l)),void this._external_signal.reset(l)}if(this.emit(a._type,a._message),a._type===ht.ON_NOTIFICATION&&this.handleNotification(a._message),a._type===ht.ON_USER_BANNED)switch(a._message.error_code){case 14:this.close(Dt.UID_BANNED);break;case 15:this.close(Dt.IP_BANNED);break;case 16:this.close(Dt.CHANNEL_BANNED)}if(a._type===ht.ON_USER_LICENSE_BANNED)switch(a._message.error_code){case et.ERR_LICENSE_MISSING:this.close(Dt.LICENSE_MISSING);break;case et.ERR_LICENSE_EXPIRED:this.close(Dt.LICENSE_EXPIRED);break;case et.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Dt.LICENSE_MINUTES_EXCEEDED);break;case et.ERR_LICENSE_PERIOD_INVALID:this.close(Dt.LICENSE_PERIOD_INVALID);break;case et.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Dt.LICENSE_MULTIPLE_SDK_SERVICE);break;case et.ERR_LICENSE_ILLEGAL:this.close(Dt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=e.clientId,this.spec=e,this.store=n,this.websocket=new LE("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Ot.CONNECTED&&this.reconnect("retry",ni.OFFLINE)}),this.p2pToken=Sn(6,""),this._external_signal=new ip(this,this.p2pToken)}async request(e,n,s,a){const l=Sn(6,""),u={_id:l,_type:e,_message:n},p=this.websocket.connectionID,m=()=>new pe((j,P)=>{if(this.connectionState===Ot.CONNECTED)return j();const U=()=>{this.off(We.WS_CLOSED,q),j()},q=()=>{this.off(We.WS_CONNECTED,U),P(new ye(z.WS_ABORT))};this.once(We.WS_CONNECTED,U),this.once(We.WS_CLOSED,q)});if(this.connectionState!==Ot.CONNECTING&&this.connectionState!==Ot.RECONNECTING||e===Xe.JOIN||e===Xe.REJOIN||await m(),this.websocket.sendMessage(u,!0),a)return;const g=new pe((j,P)=>{let U=!1;const q=(se,he)=>{U=!0,j({isSuccess:se==="success",message:he||{}}),this.off(We.WS_CLOSED,J),this.off(We.WS_RECONNECTING,J),this.emit(We.REQUEST_SUCCESS,e,n)};this.once("res-@".concat(l),q);const J=()=>{P(new ye(z.WS_ABORT,"type: ".concat(e))),this.off(We.WS_CLOSED,J),this.off(We.WS_RECONNECTING,J),this.off("res-@".concat(l),q)};this.once(We.WS_CLOSED,J),this.once(We.WS_RECONNECTING,J),ri(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||U||(N.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(We.REQUEST_TIMEOUT,e,n))})});let E=null;try{E=await g}catch(j){if(this.connectionState===Ot.CLOSED||e===Xe.LEAVE)throw new ye(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?j.throw():e===Xe.JOIN||e===Xe.REJOIN?null:(await m(),await this.request(e,n))}if(E.isSuccess)return E.message;const y=Number(E.message.error_code||E.message.code),C=rp(y),I=new ye(z.UNEXPECTED_RESPONSE,"".concat(C.desc,": ").concat(E.message.error_str),{code:y,data:E.message});return C.action==="success"?E.message:(N.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(y,", message: ").concat(C.desc,", action: ").concat(C.action)),y===et.ERR_TOO_MANY_BROADCASTERS?((e===Xe.JOIN||e===Xe.REJOIN)&&(this.initError=I,this.close()),I.throw()):C.action==="failed"?I.throw():C.action==="quit"?(this.initError=I,this.close(),I.throw()):(y===et.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,N.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",ni.MULTI_IP)):this.reconnect(C.action,ni.SERVER_ERROR),e===Xe.JOIN||e===Xe.REJOIN?null:await this.request(e,n)))}waitMessage(e,n){return new pe(s=>{const a=l=>{(!n||n(l))&&(this.off(e,a),s(l))};this.on(e,a)})}uploadWRTCStats(e){if(!this.store.sessionId)return void N.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(rd.WRTC_STATS,n)}upload(e,n){const s={_type:e,_message:n};try{this.websocket.sendMessage(s)}catch{const l=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>l&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Ot.CONNECTED)return;const u=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(u._type,u._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,n){const s={_type:e,_message:n};this.websocket.sendMessage(s)}async sendExtensionMessage(e,n,s){return await this._external_signal.send(e,n,s)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new pe((n,s)=>{this.once(We.WS_CONNECTED,()=>n(this.joinResponse)),this.once(We.WS_CLOSED,()=>s(this.initError||new ye(z.WS_ABORT))),this.connectionState=Ot.CONNECTING,this.websocket.init(e).catch(s)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=e||Dt.LEAVE,this.connectionState=Ot.CLOSED,N.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),e===Dt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new LE("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents()),this.p2pToken=Sn(6,""),this._external_signal.clear(),this._external_signal=new ip(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(We.ABORT_P2P_EXECUTION);const e=await Tr(this,We.REQUEST_JOIN_INFO),n=await this.request(Xe.JOIN,e);if(!n)return this.emit(We.REPORT_JOIN_GATEWAY,z.TIMEOUT,this.url||""),!1;this.joinResponse=n,this.emit(We.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ot.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(e,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,n)}handleDataStream(e){try{var n;const s=RE(e.payload),a=new TextDecoder().decode(s),l=JSON.parse(a);"total"in l&&"id"in l||je(n=Object.values(tr)).call(n,l._type)?(l._uid=e.uid,this._external_signal.onMessage(l)):this.emit(ht.ON_DATA_STREAM,e)}catch{this.emit(ht.ON_DATA_STREAM,e)}}handleNotification(e){N.debug("[".concat(this.clientId,"] receive notification: "),e);const n=rp(e.code);if(n.action!=="success"){if(n.action!=="failed")return n.action==="quit"?(n.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Dt.UID_BANNED),void this.close()):void this.reconnect(n.action,ni.SERVER_ERROR);N.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=Z("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=e&&(N.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ni.TIMEOUT):this.request(Xe.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-n;this.rttRolling.add(s),Z("REPORT_STATS")&&this.send(Xe.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWebsocketEvents(){this.websocket.on(ct.RECONNECT_WAITTING_FINISH,e=>{this.emit(We.WS_RECONNECT_WAITTING_FINISH,e)}),this.websocket.on(ct.RECONNECT_CREATE_CONNECTION,e=>{this.emit(We.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(ct.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(ct.CLOSED,()=>{this.connectionState=Ot.CLOSED}),this.websocket.on(ct.FAILED,()=>{this._disconnectedReason=Dt.NETWORK_ERROR,this.connectionState=Ot.CLOSED}),this.websocket.on(ct.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Ot.CONNECTED?this.connectionState=Ot.RECONNECTING:this.connectionState=Ot.CONNECTING}),this.websocket.on(ct.WILL_RECONNECT,(e,n,s)=>{e!=="retry"?(N.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(We.NEED_RENEW_SESSION)):N.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),s(e)}),this.websocket.on(ct.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(e=>{if(this.emit(We.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof ye&&e.code===z.UNEXPECTED_RESPONSE&&e.data.code===et.ERR_NO_AUTHORIZED)return N.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ni.SERVER_ERROR);N.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ni.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(ct.REQUEST_NEW_URLS,(e,n)=>{Tr(this,We.REQUEST_RECOVER,this.multiIpOption).then(e).catch(n)}),this.websocket.on(ct.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ht.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}function E3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Ra(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?E3(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):E3(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}const LN=new Map;class Hie extends jn{get state(){return this._state}set state(e){if(e===this._state)return;const n=this._state;this._state=e,e==="DISCONNECTED"&&this._disconnectedReason?this.emit(er.CONNECTION_STATE_CHANGE,e,n,this._disconnectedReason):this.emit(er.CONNECTION_STATE_CHANGE,e,n)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){N.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,n){super(),R(this,"store",void 0),R(this,"joinInfo",void 0),R(this,"key",void 0),R(this,"ntpOffset",0),R(this,"signal",void 0),R(this,"role",void 0),R(this,"inChannelInfo",{joinAt:null,duration:0}),R(this,"spec",void 0),R(this,"_state","DISCONNECTED"),R(this,"_statsCollector",void 0),R(this,"_disconnectedReason",void 0),R(this,"isSignalRecover",!1),R(this,"hasChangeBGPAddress",!1),R(this,"trafficStatsInterval",void 0),R(this,"networkQualityInterval",void 0),R(this,"_joinGatewayStartTime",0),R(this,"_signalTimeout",!1),R(this,"_clientRoleOptions",void 0),R(this,"_isProactiveJoin",!1),this.store=e,this.spec=n,this.signal=this.store.useP2P?new _3(Ra(Ra({},n),{},{retryConfig:n.websocketRetryConfig}),e):this.store.useDataChannel?new id(Ra(Ra({},n),{},{retryConfig:n.websocketRetryConfig}),e):new a3(Ra(Ra({},n),{},{retryConfig:n.websocketRetryConfig}),e),this._statsCollector=n.statsCollector,this.role=n.role||"audience",this._clientRoleOptions=n.clientRoleOptions,this.handleSignalEvents()}async join(e,n,s){if(this.signal instanceof id){let m=!1;e.cloudProxyServer!=="disabled"?(N.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(e.cloudProxyServer,")")),m=!0):"".concat(e.apResponse.cid,"_").concat(e.apResponse.cert).length>255||"".concat(e.apResponse.cid,"_").concat(e.apResponse.cert).length<22?(N.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),m=!0):e.apResponse.addresses.some(g=>g.fingerprint)||Z("FINGERPRINT")||(N.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),m=!0),m&&this.resetSignal()}this.store.joinGatewayStart(),e.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const a=Date.now();let l=LN.get(e.cname);if(l||(l=new Map,LN.set(e.cname,l)),this._isProactiveJoin=!0,l.has(e.uid)){const m=new le(z.UID_CONFLICT);throw qe.joinGateway(e.sid,{lts:a,succ:!1,ec:m.message,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer,signalChannel:this.signal instanceof id?"1":"0"}),this._isProactiveJoin=!1,m}l.set(e.uid,!0),this.joinInfo=e,this.key=n;let u=0;this.joinGatewayStartTime=a;const p=e.proxyServer;try{let m;if(N.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof id?"datachannel":"websocket"," join uid ").concat(u)),this.signal instanceof id)m=await this.signal.init(e.apResponse.addresses,s);else{const g=e.gatewayAddrs.map(E=>{let{address:y}=E;const[C,I]=y.split(":"),j={host:C,port:I};return e.proxyServer&&(j.proxy=e.proxyServer),j});m=await this.signal.init(g,s)}u=m.uid,N.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof id?"datachannel":"websocket"," join uid ").concat(u," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(m){throw m&&m.code===z.INIT_WEBSOCKET_TIMEOUT?(N.warning("[".concat(this.store.clientId,"] User join failed"),m.toString()),m):m&&m.code===z.INIT_DATACHANNEL_TIMEOUT?(N.warning("[".concat(this.store.clientId,"] User join datachannel failed"),m.toString()),this.resetSignal(),m):(N.error("[".concat(this.store.clientId,"] User join failed"),m.toString()),qe.joinGateway(e.sid,{lts:a,succ:!1,ec:m.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!p,signalChannel:this.signal instanceof id?"1":"0"}),this._isProactiveJoin=!1,l.delete(e.uid),this.signal.close(),m)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),N.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(m=>{N.warning("[".concat(this.store.clientId,"] get traffic stats error"),m.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(er.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(er.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(er.NETWORK_QUALITY,{uplinkNetworkQuality:f3(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:f3(this._statsCollector.trafficStats.B_dnq)}):this.emit(er.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),u}async leave(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){n!==Dt.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==Ot.CONNECTED||await function(s,a){return a===1/0?s:pe.race([s,Dre(a)])}(this.signal.request(Xe.LEAVE,void 0,!0),3e3)}catch(s){N.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),s)}this.signal.close(n),n!==Dt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,n,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const a={state:"offer",p2p_id:this.store.p2pId,ortc:n,mode:this.spec.mode,extend:Z("PUB_EXTEND"),twcc:!!Z("PUBLISH_TWCC"),rtx:!!Z("USE_PUB_RTX")};try{return(await this.signal.request(Xe.PUBLISH,a,!0))._message}catch(l){if(s&&l.data&&l.data.code===et.ERR_PUBLISH_REQUEST_INVALID)return N.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),l.toString()),await this.tryUnpubBeforeRepub(e,n),this.publish(e,n,!1);throw l}}async publishDataChannel(e,n,s){var a;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const l={stream_id:n.streamId,ordered:n.ordered?1:0,max_retrans_times:(a=n.maxRetransmits)!==null&&a!==void 0?a:10,channel_id:n.channelId,metadata:n.metadata};try{await this.signal.request(Xe.PUBLISH_DATASTREAM,l,!0)}catch(u){if(s&&u.data&&u.data.code===et.ERR_PUBLISH_REQUEST_INVALID)return N.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),u.toString()),await this.tryUnpubDataChannelBeforeRepub(e,n),this.publishDataChannel(e,n,!1);throw u}}async unpublish(e,n){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(Xe.UNPUBLISH,{stream_id:n,ortc:e},!0)}catch(s){N.warning("[".concat(this.store.clientId,"] unpublish warning: "),s)}}async unpublishDataChannel(e){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await pe.all(e.map(n=>this.signal.request(Xe.UNPUBLISH_DATASTREAM,{channel_id:n},!0)))}catch(n){N.warning("unpublish datachannels warning: ",n)}}async presubscribe(e,n,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const a={stream_id:e,stream_type:n,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Z("SUBSCRIBE_TWCC"),rtx:!!Z("USE_SUB_RTX")||void 0,extend:Z("SUB_EXTEND"),svc:Array.isArray(Z("SVC"))&&Z("SVC").length!==0?Z("SVC"):void 0};try{return await this.signal.request(Xe.PRE_SUBSCRIBE,a,!0)}catch(l){if(s&&l.data&&l.data.code===et.ERR_SUBSCRIBE_REQUEST_INVALID)return N.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),l.toString()),this.presubscribe(e,n,!1);throw l}}async subscribe(e,n,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const a={stream_id:e,stream_type:n.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Z("SUBSCRIBE_TWCC"),rtx:!!Z("USE_SUB_RTX"),extend:Z("SUB_EXTEND"),ssrcId:n.ssrcId,svc:Array.isArray(Z("SVC"))&&Z("SVC").length!==0?Z("SVC"):void 0};try{return(await this.signal.request(Xe.SUBSCRIBE,a,!0))._message}catch(l){if(s&&l.data&&l.data.code===et.ERR_SUBSCRIBE_REQUEST_INVALID)return N.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),l.toString()),await this.tryUnsubBeforeResub(e,n),await this.subscribe(e,n,!1);throw l}}async subscribeDataChannel(e,n,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const a={uid:e,stream_id:n.id,channel_id:n.datachannelId};try{return void await this.signal.request(Xe.SUBSCRIBE_DATASTREAM,a,!0)}catch(l){if(s&&l.data&&l.data.code===et.ERR_SUBSCRIBE_REQUEST_INVALID)return N.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),l.toString()),await this.tryUnsubDataChannelBeforeResub(e,n),await this.subscribeDataChannel(e,n,!1);throw l}}async subscribeAll(e,n){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const s={p2p_id:this.store.p2pId,users:e,dtx:!1,rtx:!!Z("USE_SUB_RTX")};try{return await this.signal.request(Xe.SUBSCRIBE_STREAMS,s,!0)}catch(a){if(n&&a.data&&a.data.code===et.ERR_SUBSCRIBE_REQUEST_INVALID)return N.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),a.toString()),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw a}}async setVideoProfile(e){const n=function(s){if(!(s.bitrateMax&&s.bitrateMin&&s.frameRate&&s.height&&s.width))return;let a=s.frameRate,l=s.width,u=s.height,p=!0;return typeof a!="number"&&(a=a.exact||a.ideal||a.max||a.min||0,a||(p=!1)),typeof l!="number"&&(l=l.exact||l.ideal||l.max||l.min||0,l||(p=!1)),typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,a||(p=!1)),p?{stream_type:0,width:l,height:u,fps:a,start_bps:1e3*s.bitrateMax,min_bps:1e3*s.bitrateMin,target_bps:1e3*s.bitrateMax}:void 0}(e);if(n)return this.signal.request(Xe.SET_VIDEO_PROFILE,n);N.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(e,n){try{await this.signal.request(Xe.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:n},!0)}catch(s){N.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),s)}}async unsubscribeDataChannel(e,n){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await pe.all(e.map(s=>this.signal.request(Xe.UNSUBSCRIBE_DATASTREAM,{stream_id:s,uid:n},!0)))}catch(s){N.warning("unsubscribeDataChannel warning: ",s)}}async massUnsubscribe(e){try{await this.signal.request(Xe.UNSUBSCRIBE_STREAMS,e,!0)}catch(n){N.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),n)}}async reconnectPC(e){const{iceParameters:n,dtlsParameters:s,rtpCapabilities:a}=e;return{gatewayEstablishParams:await this.signal.request(Xe.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:n,dtlsParameters:s,rtpCapabilities:a}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(Xe.GATEWAY_INFO)}async renewToken(e){await this.signal.request(Xe.RENEW_TOKEN,e),this.key=e.token}async setClientRole(e,n){if(n&&(this._clientRoleOptions=Object.assign({},n)),this.state!=="CONNECTED")return void(this.role=e);let s,a=0;e==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(s=this._clientRoleOptions.delay,a=1):a=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:a=0,await this.signal.request(Xe.SET_CLIENT_ROLE,{role:e,level:a,delay:s,client_ts:Date.now()}),this.role=e}async setRemoteVideoStreamType(e,n){await this.signal.request(Xe.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:n})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(Xe.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,n){await this.signal.request(Xe.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:n})}async pickSVCLayer(e,n){await this.signal.request(Xe.PICK_SVC_LAYER,{stream_id:e,spatial_layer:n.spatialLayer,temporal_layer:n.temporalLayer})}async setRTM2Flag(e){await this.signal.request(Xe.SET_RTM2_FLAG,{rtm2_flag:e})}async sendExtensionMessage(e,n,s){if(this.signal instanceof _3)return this.signal.sendExtensionMessage(e,n,s)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Ra({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(Xe.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=LN.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(n){let s;return s=n.startsWith("dc")?n.match(/(dc\:\/\/)?([^:]+):(\d+)/):n.match(/(wss\:\/\/)?([^:]+):(\d+)/),s?{username:us.username,password:us.password,turnServerURL:s[2],tcpport:parseInt(s[3])+30,udpport:parseInt(s[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(Ra(Ra({},us),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const e=await this.signal.request(Xe.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),e.ntp_offset!=null&&(this.ntpOffset=e.ntp_offset),e.peer_delay.forEach(n=>{const s=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(a=>a.peer_uid===n.peer_uid);s&&s.B_st!==n.B_st&&xb(()=>{this.emit(er.STREAM_TYPE_CHANGE,n.peer_uid,n.B_st)})}),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new le(z.UNEXPECTED_ERROR,"can not generate join message, no join info");const n=Object.assign({},this.joinInfo.apResponse);let s=Z("REPORT_APP_SCENARIO");if(typeof s!="string")try{s=JSON.stringify(s)}catch{s=void 0}s&&s.length>128&&(s=void 0);const a=Ra({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:qo,browser:navigator.userAgent,process_id:Z("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:n,extend:Z("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:s,attributes:{userAttributes:{enablePublishedUserList:Z("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:Z("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof Z("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?Z("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof Z("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?Z("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof Z("ENABLE_USER_LICENSE_CHECK")=="boolean"?Z("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:Z("USE_PUB_RTX")===!0||Z("USE_SUB_RTX")===!0||void 0,disableFEC:Z("DISABLE_FEC"),enableNTPReport:!!Z("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!Z("ENABLE_INSTANT_VIDEO")||void 0,enableDataStream2:typeof Z("ENABLE_DATASTREAM_2")=="boolean"?Z("ENABLE_DATASTREAM_2"):void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!Z("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:typeof Z("USE_XR")=="boolean"?Z("USE_XR"):void 0}},join_ts:this.joinGatewayStartTime},e);return this.joinInfo.stringUid&&(a.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(a.aes_mode=this.joinInfo.aesmode,Z("ENCRYPT_AES")?(a.aes_secret=this.joinInfo.aespassword,a.aes_encrypt=!0):a.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(a.aes_salt=this.joinInfo.aessalt)),n.addresses[this.signal.websocket.currentURLIndex]&&(a.ap_response.ticket=n.addresses[this.signal.websocket.currentURLIndex].ticket,delete n.addresses),this.joinInfo.defaultVideoStream!==void 0&&(a.default_video_stream=this.joinInfo.defaultVideoStream),a}getRejoinMessage(){if(!this.joinInfo)throw new le(z.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(We.WS_RECONNECT_WAITTING_FINISH,e=>{var n;je(n=["tryNext","recover"]).call(n,e)&&this.joinInfo&&qe.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(We.WS_RECONNECT_CREATE_CONNECTION,e=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(We.WS_RECONNECTING,e=>{this.joinInfo&&qe.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||ni.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",qe.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(We.WS_CLOSED,e=>{let n;switch(e){case Dt.LEAVE:n=ni.LEAVE;break;case Dt.UID_BANNED:case Dt.IP_BANNED:case Dt.CHANNEL_BANNED:case Dt.SERVER_ERROR:n=ni.SERVER_ERROR;break;case Dt.FALLBACK:n=ni.FALLBACK;break;case Dt.LICENSE_MISSING:case Dt.LICENSE_EXPIRED:case Dt.LICENSE_MINUTES_EXCEEDED:case Dt.LICENSE_PERIOD_INVALID:case Dt.LICENSE_MULTIPLE_SDK_SERVICE:case Dt.LICENSE_ILLEGAL:case Dt.TOKEN_EXPIRE:n=e;break;default:n=ni.NETWORK_ERROR}N.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(n||"undefined -> "+ni.NETWORK_ERROR)),this.joinInfo&&qe.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===Dt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:n}),this._disconnectedReason=e,e!==Dt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(We.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(N.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),qe.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof id?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return void N.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e));fn("EVENT_REPORT_DOMAIN",e[1]),fn("EVENT_REPORT_BACKUP_DOMAIN",e[1]),fn("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}),this.signal.on(ht.ON_UPLINK_STATS,e=>{this._statsCollector.updateUplinkStats(e)}),this.signal.on(We.REQUEST_RECOVER,(e,n,s)=>{if(!this.joinInfo)return s(new le(z.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Tr(this,er.REQUEST_NEW_GATEWAY_LIST).then(n).catch(s)}),this.signal.on(We.REQUEST_JOIN_INFO,async e=>{var n;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void e(this.getJoinMessage({ortc:{}}));const{iceParameters:s,dtlsParameters:a,rtpCapabilities:l}=await Tr(this,er.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(n=this.joinInfo)===null||n===void 0?void 0:n.turnServer});e(this.getJoinMessage({ortc:{iceParameters:s,dtlsParameters:a,rtpCapabilities:l,version:"2"}}))}),this.signal.on(We.REQUEST_REJOIN_INFO,e=>{e(this.getRejoinMessage())}),this.signal.on(We.REPORT_JOIN_GATEWAY,(e,n)=>{this.joinInfo&&(qe.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:e,addr:n,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof id?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(We.IS_P2P_DISCONNECTED,e=>{e(Qh(this,er.IS_P2P_DISCONNECTED))}),this.signal.on(We.DISCONNECT_P2P,()=>{this.emit(er.DISCONNECT_P2P)}),this.signal.on(We.NEED_RENEW_SESSION,()=>{this.emit(er.NEED_RENEW_SESSION)}),this.signal.on(We.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(We.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(We.JOIN_RESPONSE,e=>{const n=this.getCurrentGatewayAddress();this.emit(er.JOIN_RESPONSE,e,n)}),this.signal.on(We.DATACHANNEL_PRECONNECT,async(e,n,s)=>{this.updateTurnConfigFromSignal();const a=this.getCurrentGatewayAddress();return Tr(this,er.DATACHANNEL_PRECONNECT,e,a).then(n).catch(s)}),this.signal.on(We.DATACHANNEL_CONNECTING,async e=>{const{iceParameters:n,dtlsParameters:s,rtpCapabilities:a}=await Tr(this,er.REQUEST_DC_CONNECTION_PARAMS);e(this.getJoinMessage({ortc:{iceParameters:n,dtlsParameters:s,rtpCapabilities:a,version:"2"}}))}),this.signal.on(We.DATACHANNEL_FAILBACK,()=>{N.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(er.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(e,n){try{await this.signal.request(Xe.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[n]},!0)}catch(s){throw N.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),s),s}}async tryUnsubDataChannelBeforeResub(e,n){try{await this.signal.request(Xe.UNSUBSCRIBE,{stream_id:n.id},!0)}catch(s){throw N.warning("unsubscribe datachannel warning",s),s}}async tryUnpubBeforeRepub(e,n){try{await this.signal.request(Xe.UNPUBLISH,{stream_id:e,ortc:n},!0)}catch(s){throw N.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),s),s}}async tryUnpubDataChannelBeforeRepub(e,n){try{await this.signal.request(Xe.UNPUBLISH_DATASTREAM,{channnel_id:n.channelId},!0)}catch(s){throw N.warning("unpublish datastream warning: ",s),s}}async tryMassUnsubBeforeResub(e){const n={users:e.map(s=>({stream_id:s.stream_id,stream_type:s.stream_type}))};try{await this.signal.request(Xe.UNSUBSCRIBE_STREAMS,n,!0)}catch(s){throw N.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),s),s}}async muteLocal(e,n){const s={action:e.find(a=>a.stream_type===Qt.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:n};try{await this.signal.request(Xe.CONTROL,s,!0,!0)}catch(a){throw N.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),a),a}}async unmuteLocal(e,n){const s={action:e.find(a=>a.stream_type===Qt.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:n};try{await this.signal.request(Xe.CONTROL,s,!0,!0)}catch(a){throw N.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),a),a}}async muteRemote(e,n){const s={action:e===ze.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:n};try{await this.signal.request(Xe.CONTROL,s,!0,!0)}catch(a){throw N.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),a),a}}async unmuteRemote(e,n){const s={action:e===ze.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:n};try{await this.signal.request(Xe.CONTROL,s,!0,!0)}catch(a){throw N.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),a),a}}uploadWRTCStats(e){this.signal.uploadWRTCStats(e)}upload(e,n){this.signal.upload(e,n)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const n={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return await this.signal.request(Xe.RESTART_ICE,n,!0)}catch(s){throw N.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),s),s}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,ni.P2P_FAILED)}getCurrentGatewayAddress(){var e;if(!Z("GATEWAY_WSS_ADDRESS"))return(e=this.joinInfo)!==null&&e!==void 0&&e.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(e){await this.signal.request(Xe.SET_PARAMETER,{enablePublishAudioFilter:e})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(Dt.FALLBACK)),this.store.useDataChannel=!1,this.signal=new a3(Ra(Ra({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(er.RESET_SIGNAL,qb.websocket)}}let eT=0,MN=0;function sd(i,e,n,s){return new pe((a,l)=>{e.timeout=e.timeout||Z("HTTP_CONNECT_TIMEOUT"),e.responseType=e.responseType||"json",e.data&&!n?(e.data=JSON.stringify(e.data),eT+=rl(e.data)):n&&(e.data.size?eT+=e.data.size:e.data instanceof FormData?eT+=X5(e.data):eT+=rl(JSON.stringify(e.data))),e.headers=e.headers||{},e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.method="POST",e.url=i,Ls.request(e).then(u=>{typeof u.data=="string"?MN+=rl(u.data):u.data instanceof ArrayBuffer||u.data instanceof Uint8Array?MN+=u.data.byteLength:MN+=rl(JSON.stringify(u.data)),s&&a({data:u.data,headers:u.headers}),a(u.data)}).catch(u=>{Ls.isCancel(u)?l(new le(z.OPERATION_ABORTED,"cancel token canceled")):u.code==="ECONNABORTED"?l(new le(z.NETWORK_TIMEOUT,u.message)):u.response?l(new le(z.NETWORK_RESPONSE_ERROR,u.response.status)):l(new le(z.NETWORK_ERROR,u.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var i;function e(Te){var xe=0;return function(){return xe<Te.length?{done:!1,value:Te[xe++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(Te,xe,Ke){return Te==Array.prototype||Te==Object.prototype||(Te[xe]=Ke.value),Te},s,a=function(Te){Te=[typeof globalThis=="object"&&globalThis,Te,typeof window=="object"&&window,typeof self=="object"&&self,typeof c=="object"&&c];for(var xe=0;xe<Te.length;++xe){var Ke=Te[xe];if(Ke&&Ke.Math==Math)return Ke}throw Error("Cannot find global object")}(this);function l(Te,xe){if(xe)e:{var Ke=a;Te=Te.split(".");for(var ft=0;ft<Te.length-1;ft++){var Yt=Te[ft];if(!(Yt in Ke))break e;Ke=Ke[Yt]}(xe=xe(ft=Ke[Te=Te[Te.length-1]]))!=ft&&xe!=null&&n(Ke,Te,{configurable:!0,writable:!0,value:xe})}}function u(Te){return(Te={next:Te})[Symbol.iterator]=function(){return this},Te}function p(Te){var xe=typeof Symbol<"u"&&Symbol.iterator&&Te[Symbol.iterator];return xe?xe.call(Te):{next:e(Te)}}if(l("Symbol",function(Te){function xe(Yt,Me){this.A=Yt,n(this,"description",{configurable:!0,writable:!0,value:Me})}if(Te)return Te;xe.prototype.toString=function(){return this.A};var Ke="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ft=0;return function Yt(Me){if(this instanceof Yt)throw new TypeError("Symbol is not a constructor");return new xe(Ke+(Me||"")+"_"+ft++,Me)}}),l("Symbol.iterator",function(Te){if(Te)return Te;Te=Symbol("Symbol.iterator");for(var xe="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ke=0;Ke<xe.length;Ke++){var ft=a[xe[Ke]];typeof ft=="function"&&typeof ft.prototype[Te]!="function"&&n(ft.prototype,Te,{configurable:!0,writable:!0,value:function(){return u(e(this))}})}return Te}),typeof Object.setPrototypeOf=="function")s=Object.setPrototypeOf;else{var m;e:{var g={};try{g.__proto__={a:!0},m=g.a;break e}catch{}m=!1}s=m?function(Te,xe){if(Te.__proto__=xe,Te.__proto__!==xe)throw new TypeError(Te+" is not extensible");return Te}:null}var E=s;function y(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function C(Te){if(Te.m)throw new TypeError("Generator is already running");Te.m=!0}function I(Te,xe){return Te.h=3,{value:xe}}function j(Te){this.g=new y,this.G=Te}function P(Te,xe,Ke,ft){try{var Yt=xe.call(Te.g.j,Ke);if(!(Yt instanceof Object))throw new TypeError("Iterator result "+Yt+" is not an object");if(!Yt.done)return Te.g.m=!1,Yt;var Me=Yt.value}catch(D){return Te.g.j=null,Te.g.s(D),U(Te)}return Te.g.j=null,ft.call(Te.g,Me),U(Te)}function U(Te){for(;Te.g.h;)try{var xe=Te.G(Te.g);if(xe)return Te.g.m=!1,{value:xe.value,done:!1}}catch(Ke){Te.g.v=void 0,Te.g.s(Ke)}if(Te.g.m=!1,Te.g.l){if(xe=Te.g.l,Te.g.l=null,xe.F)throw xe.D;return{value:xe.return,done:!0}}return{value:void 0,done:!0}}function q(Te){this.next=function(xe){return Te.o(xe)},this.throw=function(xe){return Te.s(xe)},this.return=function(xe){return function(Ke,ft){C(Ke.g);var Yt=Ke.g.j;return Yt?P(Ke,"return"in Yt?Yt.return:function(Me){return{value:Me,done:!0}},ft,Ke.g.return):(Ke.g.return(ft),U(Ke))}(Te,xe)},this[Symbol.iterator]=function(){return this}}function J(Te,xe){return xe=new q(new j(xe)),E&&Te.prototype&&E(xe,Te.prototype),xe}if(y.prototype.o=function(Te){this.v=Te},y.prototype.s=function(Te){this.l={D:Te,F:!0},this.h=this.C||this.u},y.prototype.return=function(Te){this.l={return:Te},this.h=this.u},j.prototype.o=function(Te){return C(this.g),this.g.j?P(this,this.g.j.next,Te,this.g.o):(this.g.o(Te),U(this))},j.prototype.s=function(Te){return C(this.g),this.g.j?P(this,this.g.j.throw,Te,this.g.o):(this.g.s(Te),U(this))},l("Array.prototype.entries",function(Te){return Te||function(){return function(xe,Ke){xe instanceof String&&(xe+="");var ft=0,Yt=!1,Me={next:function(){if(!Yt&&ft<xe.length){var D=ft++;return{value:Ke(D,xe[D]),done:!1}}return Yt=!0,{done:!0,value:void 0}}};return Me[Symbol.iterator]=function(){return Me},Me}(this,function(xe,Ke){return[xe,Ke]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var se=function(Te,xe){for(var Ke=0;Ke<Te.length;Ke++)xe(Te[Ke])},he=function(Te){return Te.replace(/\r?\n|\r/g,`\r
`)},ae=function(Te,xe,Ke){return xe instanceof Blob?(Ke=Ke!==void 0?Ke+"":typeof xe.name=="string"?xe.name:"blob",xe.name===Ke&&Object.prototype.toString.call(xe)!=="[object Blob]"||(xe=new File([xe],Ke)),[String(Te),xe]):[String(Te),String(xe)]},de=function(Te,xe){if(Te.length<xe)throw new TypeError(xe+" argument required, but only "+Te.length+" present.")},me=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,ge=me.FormData,Oe=me.XMLHttpRequest&&me.XMLHttpRequest.prototype.send,De=me.Request&&me.fetch,_t=me.navigator&&me.navigator.sendBeacon,Pt=me.Element&&me.Element.prototype,Rn=me.Symbol&&Symbol.toStringTag;Rn&&(Blob.prototype[Rn]||(Blob.prototype[Rn]="Blob"),"File"in me&&!File.prototype[Rn]&&(File.prototype[Rn]="File"));try{new File([],"")}catch{me.File=function(xe,Ke,ft){return xe=new Blob(xe,ft||{}),Object.defineProperties(xe,{name:{value:Ke},lastModified:{value:+(ft&&ft.lastModified!==void 0?new Date(ft.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Rn&&Object.defineProperty(xe,Rn,{value:"File"}),xe}}var kr=function(Te){return Te.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},xn=function(Te){this.i=[];var xe=this;Te&&se(Te.elements,function(Ke){if(Ke.name&&!Ke.disabled&&Ke.type!=="submit"&&Ke.type!=="button"&&!Ke.matches("form fieldset[disabled] *"))if(Ke.type==="file"){var ft=Ke.files&&Ke.files.length?Ke.files:[new File([],"",{type:"application/octet-stream"})];se(ft,function(Yt){xe.append(Ke.name,Yt)})}else Ke.type==="select-multiple"||Ke.type==="select-one"?se(Ke.options,function(Yt){!Yt.disabled&&Yt.selected&&xe.append(Ke.name,Yt.value)}):Ke.type==="checkbox"||Ke.type==="radio"?Ke.checked&&xe.append(Ke.name,Ke.value):(ft=Ke.type==="textarea"?he(Ke.value):Ke.value,xe.append(Ke.name,ft))})};if((i=xn.prototype).append=function(Te,xe,Ke){de(arguments,2),this.i.push(ae(Te,xe,Ke))},i.delete=function(Te){de(arguments,1);var xe=[];Te=String(Te),se(this.i,function(Ke){Ke[0]!==Te&&xe.push(Ke)}),this.i=xe},i.entries=function Te(){var xe,Ke=this;return J(Te,function(ft){if(ft.h==1&&(xe=0),ft.h!=3)return xe<Ke.i.length?ft=I(ft,Ke.i[xe]):(ft.h=0,ft=void 0),ft;xe++,ft.h=2})},i.forEach=function(Te,xe){de(arguments,1);for(var Ke=p(this),ft=Ke.next();!ft.done;ft=Ke.next()){var Yt=p(ft.value);ft=Yt.next().value,Yt=Yt.next().value,Te.call(xe,Yt,ft,this)}},i.get=function(Te){de(arguments,1);var xe=this.i;Te=String(Te);for(var Ke=0;Ke<xe.length;Ke++)if(xe[Ke][0]===Te)return xe[Ke][1];return null},i.getAll=function(Te){de(arguments,1);var xe=[];return Te=String(Te),se(this.i,function(Ke){Ke[0]===Te&&xe.push(Ke[1])}),xe},i.has=function(Te){de(arguments,1),Te=String(Te);for(var xe=0;xe<this.i.length;xe++)if(this.i[xe][0]===Te)return!0;return!1},i.keys=function Te(){var xe,Ke,ft,Yt,Me=this;return J(Te,function(D){if(D.h==1&&(xe=p(Me),Ke=xe.next()),D.h!=3)return Ke.done?void(D.h=0):(ft=Ke.value,Yt=p(ft),I(D,Yt.next().value));Ke=xe.next(),D.h=2})},i.set=function(Te,xe,Ke){de(arguments,2),Te=String(Te);var ft=[],Yt=ae(Te,xe,Ke),Me=!0;se(this.i,function(D){D[0]===Te?Me&&(Me=!ft.push(Yt)):ft.push(D)}),Me&&ft.push(Yt),this.i=ft},i.values=function Te(){var xe,Ke,ft,Yt,Me=this;return J(Te,function(D){if(D.h==1&&(xe=p(Me),Ke=xe.next()),D.h!=3)return Ke.done?void(D.h=0):(ft=Ke.value,(Yt=p(ft)).next(),I(D,Yt.next().value));Ke=xe.next(),D.h=2})},xn.prototype._asNative=function(){for(var Te=new ge,xe=p(this),Ke=xe.next();!Ke.done;Ke=xe.next()){var ft=p(Ke.value);Ke=ft.next().value,ft=ft.next().value,Te.append(Ke,ft)}return Te},xn.prototype._blob=function(){var Te="----formdata-polyfill-"+Math.random(),xe=[],Ke="--"+Te+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(ft,Yt){return typeof ft=="string"?xe.push(Ke+kr(he(Yt))+`"\r
\r
`+he(ft)+`\r
`):xe.push(Ke+kr(he(Yt))+'"; filename="'+kr(ft.name)+`"\r
Content-Type: `+(ft.type||"application/octet-stream")+`\r
\r
`,ft,`\r
`)}),xe.push("--"+Te+"--"),new Blob(xe,{type:"multipart/form-data; boundary="+Te})},xn.prototype[Symbol.iterator]=function(){return this.entries()},xn.prototype.toString=function(){return"[object FormData]"},Pt&&!Pt.matches&&(Pt.matches=Pt.matchesSelector||Pt.mozMatchesSelector||Pt.msMatchesSelector||Pt.oMatchesSelector||Pt.webkitMatchesSelector||function(Te){for(var xe=(Te=(this.document||this.ownerDocument).querySelectorAll(Te)).length;0<=--xe&&Te.item(xe)!==this;);return-1<xe}),Rn&&(xn.prototype[Rn]="FormData"),Oe){var io=me.XMLHttpRequest.prototype.setRequestHeader;me.XMLHttpRequest.prototype.setRequestHeader=function(Te,xe){io.call(this,Te,xe),Te.toLowerCase()==="content-type"&&(this.B=!0)},me.XMLHttpRequest.prototype.send=function(Te){Te instanceof xn?(Te=Te._blob(),this.B||this.setRequestHeader("Content-Type",Te.type),Oe.call(this,Te)):Oe.call(this,Te)}}De&&(me.fetch=function(Te,xe){return xe&&xe.body&&xe.body instanceof xn&&(xe.body=xe.body._blob()),De.call(this,Te,xe)}),_t&&(me.navigator.sendBeacon=function(Te,xe){return xe instanceof xn&&(xe=xe._asNative()),_t.call(this,Te,xe)}),me.FormData=xn}})();const tT=()=>{const i=Z("AREAS");return i.length===0&&i.push($t.GLOBAL),ed(i).call(i,(e,n,s)=>{const a=v3(n);return a?s===0?a:"".concat(e,",").concat(a):e},"")},v3=i=>i===$t.OVERSEA?"".concat(yi.ASIA,",").concat(yi.EUROPE,",").concat(yi.AFRICA,",").concat(yi.NORTH_AMERICA,",").concat(yi.SOUTH_AMERICA,",").concat(yi.OCEANIA):yi[i],zie=i=>{const e={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return i.map(n=>{const s=Xb[n],a=Object.keys(s);a&&a.map(l=>{l!=="CODE"&&(e[l]=e[l].concat(s[l]))})}),e},nT={GLOBAL:{ASIA:[$t.CHINA,$t.JAPAN,$t.INDIA,$t.KOREA,$t.HKMC],EUROPE:[],NORTH_AMERICA:[$t.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},rT=Object.keys(nT[$t.GLOBAL]),UN=[$t.CHINA,$t.NORTH_AMERICA,$t.EUROPE,$t.ASIA,$t.JAPAN,$t.INDIA,$t.OCEANIA,$t.SOUTH_AMERICA,$t.AFRICA,$t.KOREA,$t.HKMC,$t.US],Kie=function(i,e){let n=[];if(je(i).call(i,$t.GLOBAL)){const l=[$t.GLOBAL,$t.OVERSEA],u=Object.keys(Xb);if(e===$t.GLOBAL)throw new le(z.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(e===$t.CHINA)n=[$t.OVERSEA];else if(a=e,je(rT).call(rT,a)){const p=(s=e,nT[$t.GLOBAL][s]||[]),m=[...l,e,...p];n=u.filter(g=>!je(m).call(m,g))}else if(function(p){let m=!1;return rT.forEach(g=>{var E;je(E=nT[$t.GLOBAL][g]).call(E,p)&&(m=!0)}),m}(e)){const p=function(g){let E;return rT.forEach(y=>{var C;je(C=nT[$t.GLOBAL][y]).call(C,g)&&(E=y)}),E}(e),m=[...l,p,e];n=u.filter(g=>!je(m).call(m,g))}else n=i;n=function(p){const m=[];return UN.forEach(g=>{je(p).call(p,g)&&m.push(g)}),m.concat(p.filter(g=>!je(UN).call(UN,g)))}(n)}else n=i;var s,a;return n};function y3(i){var e,n;if(!i&&je(e=Z("AREAS")).call(e,$t.EXTENSIONS))return N.debug("update area from ap : reset"),void jN(pie,!0);if(!je(n=Z("AREAS")).call(n,$t.GLOBAL)||!i)return;let s=Xb.EXTENSIONS;s&&(s={CODE:v3($t.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(i,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(i,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(i,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(i,".agora.io"),"cds-ap-web-2-".concat(i,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(i,".agora.io"),"sua-ap-web-2-".concat(i,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(i,".agora.io"),"uap-ap-web-2-".concat(i,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(i,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(i,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(i,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(i,".agora.io")]},N.debug("update area from ap success: ".concat(i,",config is "),s),fn("AREAS",[$t.EXTENSIONS],!0),Object.keys(s).map(a=>{a==="LOG_UPLOAD_SERVER"||a==="EVENT_REPORT_DOMAIN"||a==="EVENT_REPORT_BACKUP_DOMAIN"||a==="PROXY_SERVER_TYPE3"?fn(a,s[a][0]):fn(a,s[a])}))}function jN(i){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=qe.reportApiInvoke(null,{name:br.SET_AREA,options:i,tag:Bn.TRACER});try{let s=[];if(typeof i=="string"&&(s=[i]),Array.isArray(i)&&(i.forEach(l=>{if(!je(X4).call(X4,l))throw new le(z.INVALID_PARAMS,"invalid area code")}),s=i),Object.prototype.toString.call(i)==="[object Object]"){const{areaCode:l,excludedArea:u}=i;if(!l)throw new le(z.INVALID_PARAMS,"area code is needed");let p=l;typeof l=="string"&&(p=[l]),s=u?Kie(p,u):p}if(!e){if(lu.AREAS){const l=new le(z.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return n.onError(l),void N.warning("setArea is prohibited because of config-distribute")}if(je(s).call(s,$t.GLOBAL)&&Z("AREAS")===$t.EXTENSIONS){const l=new le(z.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return n.onError(l),void N.warning("setArea is prohibited because of ap extensions")}}fn("AREAS",s,e);const a=zie(s);Object.keys(a).map(l=>{l==="LOG_UPLOAD_SERVER"||l==="EVENT_REPORT_DOMAIN"||l==="EVENT_REPORT_BACKUP_DOMAIN"||l==="PROXY_SERVER_TYPE3"?fn(l,a[l][0]):fn(l,a[l])}),N.debug("set area success:",s.join(","))}catch(s){throw n.onError(s),s}n.onSuccess()}function S3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function FN(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?S3(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):S3(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}let VN=1;function Yie(i,e,n,s,a){VN+=1;const l={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(Date.now()/1e3),seq:VN,requestId:VN,version:qo,cname:n.cname},u={service_name:e,json_body:JSON.stringify(l)};let p,m,g=i[0];return vc(async()=>{p=Date.now();const E=await sd(g,{data:u,cancelToken:s,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(m=Date.now()-p,E.code!==0){const I=new le(z.UNEXPECTED_RESPONSE,"live streaming ap error, code"+E.code,{retry:!0,responseTime:m});throw N.error(I.toString()),I}const y=JSON.parse(E.json_body);if(y.code!==200){const I=new le(z.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(y.code,", reason: ").concat(y.reason),{code:y.code,responseTime:m});throw N.error(I.toString()),I}if(!y.servers||y.servers.length===0){const I=new le(z.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:y.code,responseTime:m});throw N.error(I.toString()),I}const C=function(I,j){return{addressList:I.servers.map(P=>"wss://".concat(P.address.replace(/\./g,"-"),".").concat(Z("WORKER_DOMAIN"),":").concat(P.wss,"?serviceName=").concat(encodeURIComponent(j))),workerToken:I.workerToken,vid:I.vid}}(y,e);return Z("LIVE_STREAMING_ADDRESS")&&(C.addressList=Z("LIVE_STREAMING_ADDRESS")instanceof Array?Z("LIVE_STREAMING_ADDRESS"):[Z("LIVE_STREAMING_ADDRESS")]),FN(FN({},C),{},{responseTime:m})},(E,y)=>(qe.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:e,responseDetail:JSON.stringify(E.addressList),firstSuccess:y===0,responseTime:m,serverIp:i[y%i.length]}),!1),(E,y)=>(qe.apworkerEvent(n.sid,{success:!1,sc:E.data&&E.data.code||200,serviceName:e,responseTime:m,serverIp:i[y%i.length]}),!!(E.code!==z.OPERATION_ABORTED&&E.code!==z.UNEXPECTED_RESPONSE||E.data&&E.data.retry)&&(g=i[(y+1)%i.length],!0)),a)}let BN=1;function b3(i,e,n,s){let{url:a,areaCode:l}=i;const u=Date.now();let p;const[m,g]=R3(e,l,[si.CHOOSE_SERVER]);let E=Cr.networkState;return vc(async()=>{E&&Cr.networkState===ns.OFFLINE&&Cr.onlineWaiter&&await pe.race([Cr.onlineWaiter,ri(s&&s.maxRetryTimeout||wr.maxRetryTimeout)]),E=Cr.networkState;const{data:y,headers:C}=await sd(a,{data:m,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);p=C.http3==="1"?1:-1,qe.reportResourceTiming(a,e.sid),C3(y,a,e,u,[si.CHOOSE_SERVER],p);const I=PN(y,si.CHOOSE_SERVER);return w3(I),h3(I,a)},y=>(y&&qe.joinChooseServer(e.sid,{lts:u,succ:!0,csAddr:a,opid:g,serverList:y.gatewayAddrs.map(C=>C.address),ec:null,cid:y.cid.toString(),uid:y.uid.toString(),csIp:y.csIp,unilbsServerIds:[si.CHOOSE_SERVER].toString(),isHttp3:p}),!1),y=>y.code!==z.OPERATION_ABORTED&&(y.code===z.CAN_NOT_GET_GATEWAY_SERVER?y.data.retry:(qe.joinChooseServer(e.sid,{lts:u,succ:!1,csAddr:a,serverList:null,opid:g,ec:y.code,csIp:y.data&&y.data.csIp,unilbsServerIds:[si.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:E}),isHttp3:p}),N.warning("[".concat(e.clientId,"] Choose server network error, retry"),y),!0)),s)}function T3(i,e,n,s){let a,{url:l,areaCode:u,serviceIds:p}=i;const m=Date.now(),[g,E]=R3(e,u,p);let y;return vc(async()=>{y&&Cr.networkState===ns.OFFLINE&&Cr.onlineWaiter&&await pe.race([Cr.onlineWaiter,ri(s&&s.maxRetryTimeout||wr.maxRetryTimeout)]),y=Cr.networkState;const{data:C,headers:I}=await sd(l,{data:g,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);a=I.http3==="1"?1:-1,qe.reportResourceTiming(l,e.sid),C3(C,l,e,m,p,a);const j=PN(C,si.CHOOSE_SERVER),P=PN(C,e.cloudProxyServer==="proxy5"?si.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?si.CLOUD_PROXY:si.CLOUD_PROXY_FALLBACK);return w3(j),{gatewayInfo:h3(j,l),proxyInfo:P,url:l}},C=>(C.gatewayInfo&&qe.joinChooseServer(e.sid,{lts:m,succ:!0,csAddr:l,serverList:C.gatewayInfo.gatewayAddrs.map(I=>I.address),ec:null,opid:E,cid:C.gatewayInfo.cid.toString(),uid:C.gatewayInfo.uid.toString(),csIp:C.gatewayInfo.csIp,unilbsServerIds:p.toString(),isHttp3:a}),C.proxyInfo&&qe.joinWebProxyAP(e.sid,{lts:m,sucess:1,apServerAddr:l,turnServerAddrList:C.proxyInfo.addresses.map(I=>I.ip).join(","),errorCode:null,eventType:e.cloudProxyServer,unilbsServerIds:p.toString()}),!1),C=>C.code!==z.OPERATION_ABORTED&&(C.code===z.CAN_NOT_GET_GATEWAY_SERVER?C.data.retry:(qe.joinWebProxyAP(e.sid,{lts:m,sucess:0,apServerAddr:l,turnServerAddrList:null,errorCode:C.code,eventType:e.cloudProxyServer,unilbsServerIds:p.toString(),extend:JSON.stringify({networkState:y})}),N.warning("[".concat(e.clientId,"] multi unilbs network error, retry"),C),!0)),s)}const C3=(i,e,n,s,a,l)=>{const u=[],p=m=>{m.flag===4096?qe.joinChooseServer(n.sid,{lts:s,succ:!1,csAddr:e,opid:i.opid,serverList:null,ec:m.error.message,csIp:m.error.data&&m.error.data.csIp,unilbsServerIds:a.toString(),isHttp3:l}):m.flag!==1048576&&m.flag!==4194304&&m.flag!==4194310||qe.joinWebProxyAP(n.sid,{lts:s,sucess:0,apServerAddr:e,turnServerAddrList:null,errorCode:m.error.code,eventType:n.cloudProxyServer,unilbsServerIds:a.toString()})};if(i.response_body.forEach(m=>{const g=m.buffer.code;if(m.uri===23&&g===0&&!m.buffer.edges_services)if(m.buffer.flag===4194310)N.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),m.buffer.edges_services=[];else{const E={error:new le(z.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:i.detail[502]}),flag:m.buffer.flag};u.push(E),p(E)}if(g!==0){const E=Qb(g),y={error:new le(z.CAN_NOT_GET_GATEWAY_SERVER,E.desc,{desc:E.desc,retry:E.retry,csIp:i.detail[502]}),flag:m.buffer.flag};m.buffer.flag===4194310?N.warning(y.error.toString()):u.push(y),p(y)}}),u.length)throw N.warning("[".concat(n.clientId,"] multi unilbs ").concat(e," failed, ").concat(u.map(m=>"flag: ".concat(m.flag,", message: ").concat(m.error.message,", retry: ").concat(m.error.data.retry)).join(" | "))),new le(z.CAN_NOT_GET_GATEWAY_SERVER,u.map(m=>"flag: ".concat(m.flag,", message: ").concat(m.error.message)).join(" | "),{retry:!!u.find(m=>m.error.data.retry),csIp:i.detail[502],desc:[...new Set(u.map(m=>{var g;return m==null||(g=m.error)===null||g===void 0||(g=g.data)===null||g===void 0?void 0:g.desc}).filter(m=>!!m))]})},w3=i=>{var e,n,s,a;if(i.addresses&&i.addresses.length===0&&i.code===0)throw new le(z.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:i.detail&&i.detail[502]});if(Z("AP_AREA")&&((s=i.detail)!==null&&s!==void 0&&s[23]&&typeof((a=i.detail)===null||a===void 0?void 0:a[23])=="string"?y3(i.detail[23].toLowerCase()):y3()),(e=i.detail)!==null&&e!==void 0&&e[19]&&typeof((n=i.detail)===null||n===void 0?void 0:n[19])=="string"){const u=i.detail[19],p=u==null?void 0:u.split(";");for(let m=0;m<p.length;m++){var l;const g=xN(l=p[m]).call(l);i.addresses[m]&&p&&(i.addresses[m].fingerprint=g)}}if(Z("GATEWAY_ADDRESS")&&Z("GATEWAY_ADDRESS").length>0){N.debug("assign gateway address to",Z("GATEWAY_ADDRESS"));const u=Z("GATEWAY_ADDRESS").map(p=>{var m,g;const E=(m=(g=i.addresses.find(y=>y.ip===p.ip&&y.port===p.port))===null||g===void 0?void 0:g.fingerprint)!==null&&m!==void 0?m:"";return{ip:p.ip,port:p.port,ticket:i.addresses[0]&&i.addresses[0].ticket,fingerprint:E}});i.addresses=u}},qie=(i,e)=>{if(i.response_body&&i.response_body.length){const n=i.response_body[0];if(n.buffer.code!==0){const s=Qb(n.buffer.code);throw new le(z.UPDATE_TICKET_FAILED,"[".concat(n.buffer.code,"]: ").concat(s.desc),{retry:s.retry})}return n.buffer.ticket}throw N.debug("update ticket request received ap response without response body:",e),new le(z.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},R3=(i,e,n)=>{const s=Math.floor(Math.random()*1e12),a={appid:i.appId,client_ts:Date.now(),opid:s,sid:i.sid,request_bodies:[{uri:22,buffer:{cname:i.cname,detail:FN({6:i.stringUid,11:e,12:Z("USE_NEW_TOKEN")?"1":void 0,22:e},i.apRTM?{26:"RTM2"}:{}),key:i.token,service_ids:n,uid:i.uid||0}}]};a.request_bodies.forEach(u=>{i.multiIP&&i.multiIP.gateway_ip&&(u.buffer.detail[5]=JSON.stringify({vocs_ip:[i.multiIP.uni_lbs_ip],vos_ip:[i.multiIP.gateway_ip]}))});const l=new FormData;return l.append("request",JSON.stringify(a)),[l,s]},Xie=(i,e)=>{const n=Math.floor(Math.random()*1e12),s={appid:i.appId,client_ts:Date.now(),opid:n,sid:i.sid,request_bodies:[{uri:28,buffer:{cname:i.cname,detail:{1:"",6:i.stringUid,12:"1"},token:i.token,service_ids:e,uid:i.uid||0,edges_services:i.apResponse.addresses.map(l=>({ip:l.ip,port:l.port}))}}]},a=new FormData;return a.append("request",JSON.stringify(s)),[a,n]};let im=0;function sm(i){return pe.all(i.map(e=>e.then(n=>{throw n},n=>n))).then(e=>{throw e},e=>e)}const UE=async i=>{let{fragementLength:e,referenceList:n,asyncMapHandler:s,allFailedhandler:a,promisesCollector:l}=i,u=0;const p=e;let m,g=0;const E=async()=>{const y=(()=>{const C=u*p,I=C+p;return n.slice(C,I).map(s)})();l&&l.push(...y);try{m=await sm(y)}catch(C){if(g+=p,u++,!(g>=n.length))return void await E();a(C)}y.forEach(C=>C.cancel())};return await E(),m};async function WN(i,e,n,s){return{gatewayInfo:await async function(l,u,p,m){let g=null;const E=[],y=async()=>{const I=Z("WEBCS_DOMAIN").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(U=>({url:l.proxyServer?"https://".concat(l.proxyServer,"/ap/?url=").concat(U+"/api/v2/transpond/webrtc?v=2"):"https://".concat(U,"/api/v2/transpond/webrtc?v=2"),areaCode:tT()})),j=m.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:I.map(U=>U.url)}),P=await UE({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:I,asyncMapHandler:U=>(N.debug("[".concat(l.clientId,"] Connect to choose_server:"),U.url),b3(U,l,u,p)),allFailedhandler:U=>{throw m.recordJoinChannelService({endTs:Date.now(),status:"error",errors:U},j),U[0]},promisesCollector:E});return m.recordJoinChannelService({endTs:Date.now(),status:"success"},j),P},C=async()=>{if(await ri(1e3),g!==null)return g;const I=Z("WEBCS_DOMAIN_BACKUP_LIST").map(U=>({url:l.proxyServer?"https://".concat(l.proxyServer,"/ap/?url=").concat(U+"/api/v2/transpond/webrtc?v=2"):"https://".concat(U,"/api/v2/transpond/webrtc?v=2"),areaCode:tT()})),j=m.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:I.map(U=>U.url)}),P=await UE({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:I,asyncMapHandler:U=>(N.debug("[".concat(l.clientId,"] Connect to backup choose_server:"),U.url),b3(U,l,u,p)),allFailedhandler:U=>{throw m.recordJoinChannelService({endTs:Date.now(),status:"error",errors:U},j),U[0]},promisesCollector:E});return m.recordJoinChannelService({endTs:Date.now(),status:"success"},j),P};try{return g=await sm([y(),C()]),E.length&&E.forEach(I=>I.cancel&&typeof I.cancel=="function"&&I.cancel()),g}catch(I){throw I[0]}}(i,e,n,s)}}async function I3(i,e,n,s,a){const l=i.cloudProxyServer;if(l==="disabled"){if(!s)return;if(i.useLocalAccessPoint)return await WN(i,e,n,a);if(Z("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:C,proxyInfo:I}=await O3(i,e,n,a);if(i.turnServer&&i.turnServer.mode!=="auto")return{gatewayInfo:C};const j=I.map(P=>({turnServerURL:P.address,tcpport:P.tcpport||us.tcpport,udpport:P.udpport||us.udpport,username:P.username||us.username,password:P.password||us.password,forceturn:!1,security:!0}));if(a.useP2P){var u;const P=(u=i.uid)!==null&&u!==void 0?u:C.uid,U="glb:".concat(P.toString()),q=await YO(U),J=I.map(se=>({turnServerURL:se.address,tcpport:se.tcpport||us.tcpport,udpport:se.udpport||us.udpport,username:U,password:q,forceturn:!1,security:!0}));j.push(...J)}return i.turnServer={mode:"manual",servers:j},{gatewayInfo:C}}return await WN(i,e,n,a)}const{proxyInfo:p,gatewayInfo:m}=await O3(i,e,n,a),g={gatewayInfo:m},E=p.map(C=>({turnServerURL:C.address,tcpport:l==="proxy3"?void 0:C.tcpport?C.tcpport:us.tcpport,udpport:l==="proxy4"?void 0:C.udpport?C.udpport:us.udpport,username:C.username||us.username,password:C.password||us.password,forceturn:l!=="proxy4",security:l==="proxy5"}));if(a.useP2P){var y;const C=(y=i.uid)!==null&&y!==void 0?y:m.uid,I="glb:".concat(C.toString()),j=await YO(I),P=p.map(U=>({turnServerURL:U.address,tcpport:l==="proxy3"?void 0:U.tcpport||us.tcpport,udpport:l==="proxy4"?void 0:U.udpport||us.udpport,username:I,password:j,forceturn:l!=="proxy4",security:l==="proxy5"}));E.push(...P)}return i.turnServer={mode:"manual",servers:E},N.debug("[".concat(i.clientId,"] set proxy server: ").concat(i.proxyServer,", mode: ").concat(l)),g}async function A3(i,e,n,s,a){const l=Z("ACCOUNT_REGISTER").slice(0,Z("AJAX_REQUEST_CONCURRENT"));let u=[];u=e.proxyServer?l.map(m=>"https://".concat(e.proxyServer,"/ap/?url=").concat(m+"/api/v1")):l.map(m=>"https://".concat(m,"/api/v1"));const p=a==null?void 0:a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:u});try{const m=await async function(g,E,y,C,I){const j=Date.now(),P={sid:y.sid,opid:10,appid:y.appId,string_uid:E};let U=g[0];const q=await vc(()=>sd(U+"".concat(U.indexOf("?")===-1?"?":"&","action=stringuid"),{data:P,cancelToken:C,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(J,se)=>{if(J.code===0){if(J.uid<=0||J.uid>=Math.pow(2,32))throw N.error("Invalid Uint Uid ".concat(E," => ").concat(J.uid),J),qe.reqUserAccount(P.sid,{lts:j,success:!1,serverAddr:U,stringUid:P.string_uid,uid:J.uid,errorCode:z.INVALID_UINT_UID_FROM_STRING_UID,extend:P}),new le(z.INVALID_UINT_UID_FROM_STRING_UID);return qe.reqUserAccount(P.sid,{lts:j,success:!0,serverAddr:U,stringUid:P.string_uid,uid:J.uid,errorCode:null,extend:P}),!1}const he=Qb(J.code);return he.retry&&(U=g[(se+1)%g.length]),qe.reqUserAccount(P.sid,{lts:j,success:!1,serverAddr:U,stringUid:P.string_uid,uid:J.uid,errorCode:he.desc,extend:P}),he.retry},(J,se)=>J.code!==z.OPERATION_ABORTED&&(qe.reqUserAccount(P.sid,{lts:j,success:!1,serverAddr:U,stringUid:P.string_uid,uid:null,errorCode:J.code,extend:P}),U=g[(se+1)%g.length],!0),I);if(q.code!==0){const J=Qb(q.code);throw new le(z.UNEXPECTED_RESPONSE,J.desc)}return q}(u,i,e,n,s);return a==null||a.recordJoinChannelService({status:"success",endTs:Date.now()},p),m.uid}catch(m){throw a==null||a.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[m]},p),m}}async function Jie(i,e,n){const s=Z("CDS_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(m=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(m+"/api/v1"):"https://".concat(m,"/api/v1?action=config")),a=s.map(m=>function(g,E,y,C){const I=zt(),j={flag:64,cipher_method:0,features:{device:I.name,system:I.os,system_general:navigator.userAgent,vendor:E.appId,version:qo,cname:E.cname,sid:E.sid,session_id:E.sid,detail:"",proxyServer:E.proxyServer}};return vc(()=>sd(g,{data:j,timeout:1e3,cancelToken:y,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,P=>P.code!==z.OPERATION_ABORTED,C)}(m,i,e,n));let l=null,u=null,p={};try{l=await sm(a)}catch(m){if(m.code===z.OPERATION_ABORTED)throw m;u=m}if(a.forEach(m=>m.cancel()),qe.reportApiInvoke(i.sid,{name:br.REQUEST_CONFIG_DISTRIBUTE,options:{error:u,res:l}}).onSuccess(),l&&l.test_tags)try{p=function(m){if(!m.test_tags)return{};const g=m.test_tags,E=Object.keys(g),y={};return E.forEach(C=>{var I;const j=xN(I=C.slice(4)).call(I),P=JSON.parse(g[C])[1];y[j]=P}),y}(l)}catch{}return p}async function O3(i,e,n,s){const a=Z("PROXY_SERVER_TYPE3"),l=(I,j,P)=>{let U=P||a;return Array.isArray(U)&&(U=j%2==0?a[1]:a[0]),"https://".concat(U,"/ap/?url=").concat(I)};let u=null;const p=[],m=async()=>{const I=Z("WEBCS_DOMAIN").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map((U,q)=>{let J;return J=i.cloudProxyServer==="disabled"&&i.proxyServer?l("".concat(U,"/api/v2/transpond/webrtc?v=2"),q,i.proxyServer):i.cloudProxyServer==="disabled"||i.cloudProxyServer==="fallback"?"https://".concat(U,"/api/v2/transpond/webrtc?v=2"):l("".concat(U,"/api/v2/transpond/webrtc?v=2"),q),{url:J,areaCode:tT(),serviceIds:[si.CHOOSE_SERVER,i.cloudProxyServer==="proxy5"?si.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?si.CLOUD_PROXY:si.CLOUD_PROXY_FALLBACK]}}),j=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:I.map(U=>U.url)}),P=await UE({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:I,asyncMapHandler:U=>(N.debug("[".concat(i.clientId,"] Connect to choose_server:"),U.url),T3(U,i,e,n)),allFailedhandler:U=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:U},j),U[0]},promisesCollector:p});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},j),P},g=async()=>{if(await ri(1e3),u!==null)return u;const I=Z("WEBCS_DOMAIN_BACKUP_LIST").map((U,q)=>{let J;return J=i.cloudProxyServer==="disabled"&&i.proxyServer?l("".concat(U,"/api/v2/transpond/webrtc?v=2"),q,i.proxyServer):i.cloudProxyServer==="disabled"||i.cloudProxyServer==="fallback"?"https://".concat(U,"/api/v2/transpond/webrtc?v=2"):l("".concat(U,"/api/v2/transpond/webrtc?v=2"),q),{url:J,areaCode:tT(),serviceIds:[si.CHOOSE_SERVER,i.cloudProxyServer==="proxy5"?si.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?si.CLOUD_PROXY:si.CLOUD_PROXY_FALLBACK]}}),j=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:I.map(U=>U.url)}),P=await UE({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:I,asyncMapHandler:U=>(N.debug("[".concat(i.clientId,"] Connect to backup choose_server:"),U.url),T3(U,i,e,n)),allFailedhandler:U=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:U},j),U[0]},promisesCollector:p});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},j),P};let E,y,C;try{({gatewayInfo:E,proxyInfo:y,url:C}=await sm([m(),g()]))}catch(I){throw I[0]}if(p.length&&p.forEach(I=>I.cancel&&typeof I.cancel=="function"&&I.cancel()),!E||!y)throw new le(z.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(i.apUrl=C,i.cloudProxyServer!=="disabled"&&Array.isArray(a)&&C){const I=/^https?:\/\/(.+?)(\/.*)?$/.exec(C)[1];je(a).call(a,I)&&(i.proxyServer=I,N.setProxyServer(I),qe.setProxyServer(I))}return u={gatewayInfo:E,proxyInfo:await Wie(y,E.uid)},u}async function N3(i,e,n,s){const a=Z("UAP_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(l=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(l+"/api/v1?action=uap"):"https://".concat(l,"/api/v1?action=uap"));return await Yie(a,i,e,n,s)}async function Qie(i,e,n){const s=Z("UAP_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(l=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(l+"/api/v1?action=uap"):"https://".concat(l,"/api/v1?action=uap")),a=s.map(l=>function(u,p,m,g){const E={command:"convergeAllocateEdge",sid:p.sid,appId:p.appId,token:p.token,ts:Date.now(),version:qo,cname:p.cname,uid:p.uid.toString(),requestId:BN,seq:BN};BN+=1;const y={service_name:"tele_channel",json_body:JSON.stringify(E)};return vc(async()=>{const C=await sd(u,{data:y,cancelToken:m,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(C.code!==0){const j=new le(z.UNEXPECTED_RESPONSE,"cross channel ap error, code"+C.code,{retry:!0});throw N.error(j.toString()),j}const I=JSON.parse(C.json_body);if(I.code!==200){const j=new le(z.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(I.code,", reason: ").concat(I.reason));throw N.error(j.toString()),j}if(!I.servers||I.servers.length===0){const j=new le(z.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw N.error(j.toString()),j}return{vid:I.vid,workerToken:I.workerToken,addressList:(Z("CHANNEL_MEDIA_RELAY_SERVERS")||I.servers).map(j=>"wss://".concat(j.address.replace(/\./g,"-"),".").concat(Z("WORKER_DOMAIN"),":").concat(j.wss))}},void 0,C=>!!(C.code!==z.OPERATION_ABORTED&&C.code!==z.UNEXPECTED_RESPONSE||C.data&&C.data.retry),g)}(l,i,e,n));try{const l=await sm(a);return a.forEach(u=>u.cancel()),l}catch(l){throw l[0]}}async function Zie(i,e,n){let s=null;const a=[],l=async u=>{const p=Z(u?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(m=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(m+"/api/v2/transpond/webrtc?v=2"):"https://".concat(m,"/api/v2/transpond/webrtc?v=2"));return u&&(await ri(1e3),s!==null)?s:await UE({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:p,asyncMapHandler:m=>(N.debug("[".concat(i.clientId,"] update ticket, Connect to ").concat(u?"backup":""," choose_server:"),m),function(g,E,y,C){const[I]=Xie(E,[si.CHOOSE_SERVER]);let j=Cr.networkState;return vc(async()=>{j&&Cr.networkState===ns.OFFLINE&&Cr.onlineWaiter&&await pe.race([Cr.onlineWaiter,ri(C&&C.maxRetryTimeout||wr.maxRetryTimeout)]),j=Cr.networkState;const P=await sd(g,{data:I,cancelToken:y,headers:{"Content-Type":"multipart/form-data;"}},!0);return qie(P,g)},()=>!1,P=>P.code!==z.OPERATION_ABORTED&&(P.code===z.UPDATE_TICKET_FAILED?P.data.retry:(N.warning("[".concat(E.clientId,"] update ticket network error, retry"),P),!0)),C)}(m,i,e,n)),allFailedhandler:m=>{throw m[0]},promisesCollector:a})};try{return s=await sm([l(!1),l(!0)]),a.length&&a.forEach(u=>u.cancel&&typeof u.cancel=="function"&&u.cancel()),s}catch(u){throw u[0]}}function k3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function x3(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?k3(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):k3(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class ese extends jn{get isSuccess(){return!!this.configs}constructor(){super(),R(this,"configs",void 0),R(this,"joinInfo",void 0),R(this,"cancelToken",void 0),R(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),R(this,"interval",void 0),R(this,"mutex",new ii("config-distribute")),R(this,"mutableParamsRead",!1)}startGetConfigDistribute(e,n){this.joinInfo=e,this.cancelToken=n,this.interval&&this.stopGetConfigDistribute(),Z("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},Z("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,qe.reportApiInvoke(null,{options:void 0,name:br.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Bn.TRACER}).onSuccess(JSON.stringify(lu))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void N.debug("[config-distribute] get config distribute interrupted have no joininfo");let e;const n=await this.mutex.lock();try{e=await Jie(this.joinInfo,this.cancelToken,this.retryConfig),N.debug("[config-distribute] get config distribute",JSON.stringify(e)),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(s){const a=new le(z.NETWORK_RESPONSE_ERROR,s);N.warning("[config-distribute] ".concat(a.toString()))}finally{n()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var n;(n=e)&&n.uplink&&n.id&&n.uplink.max_bitrate!==void 0&&n.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(DE.UPDATE_BITRATE_LIMIT,e):this.emit(DE.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&x3({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var n;const s=fE(n=Object.keys(e).filter(l=>/^webrtc_ng_global_parameter/.test(l))).call(n);for(let l=0;l<s.length;l++)for(let u=s.length-1;u>l;u--){const p=s[u];if(typeof e[p].__priority=="number"){const m=e[p].__priority,g=s[u-1];if(typeof e[g].__priority=="number"){if(!(m>e[g].__priority))continue;{const E=p;s[u]=s[u-1],s[u-1]=E}}else{const E=p;s[u]=s[u-1],s[u-1]=E}}}const a={};s.forEach(l=>{const u=e[l],p=u.__expires;Object.keys(u).forEach(m=>{m==="__priority"||m==="__expires"||Object.prototype.hasOwnProperty.call(a,m)||(a[m]=x3({value:u[m]},p&&{expires:p}))})});try{(function(p){try{const m=Date.now();Object.keys(p).forEach(g=>{switch(g){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":if(Object.prototype.hasOwnProperty.call(rs,g)){const{value:E,expires:y}=p[g];if(y&&y<=m)return;lu[g]=E,rs[g]=E,N.debug("Update global parameters from config distribute",g,E)}}})}catch(m){N.error("Error update config immediately: ".concat(p),m.message)}})(a);const l=JSON.stringify(a),u=window.btoa(l);window.localStorage.setItem("websdk_ng_global_parameter",u),N.debug("Caching global parameters ".concat(l))}catch(l){N.error("Error caching global parameters:",l.message)}}}const Yi={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1};function Kt(){return Yi}var Kr;function om(i,e,n){return{sampleRate:i,stereo:e,bitrate:n}}function Bt(i,e,n,s,a){return{width:i,height:e,frameRate:n,bitrateMin:s,bitrateMax:a}}function Ia(i,e,n,s,a){return{width:{max:i},height:{max:e},frameRate:n,bitrateMin:s,bitrateMax:a}}function $N(i,e){return{numSpatialLayers:i,numTemporalLayers:e}}(function(i){i.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",i.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",i.IOS_INTERRUPTION_START="ios-interruption-start",i.IOS_INTERRUPTION_END="ios-interruption-end",i.STATE_CHANGE="state-change"})(Kr||(Kr={}));const tse={"90p":Bt(160,90),"90p_1":Bt(160,90),"120p":Bt(160,120,15,30,65),"120p_1":Bt(160,120,15,30,65),"120p_3":Bt(120,120,15,30,50),"120p_4":Bt(212,120),"180p":Bt(320,180,15,30,140),"180p_1":Bt(320,180,15,30,140),"180p_3":Bt(180,180,15,30,100),"180p_4":Bt(240,180,15,30,120),"240p":Bt(320,240,15,40,200),"240p_1":Bt(320,240,15,40,200),"240p_3":Bt(240,240,15,40,140),"240p_4":Bt(424,240,15,40,220),"360p":Bt(640,360,15,80,400),"360p_1":Bt(640,360,15,80,400),"360p_3":Bt(360,360,15,80,260),"360p_4":Bt(640,360,30,80,600),"360p_6":Bt(360,360,30,80,400),"360p_7":Bt(480,360,15,80,320),"360p_8":Bt(480,360,30,80,490),"360p_9":Bt(640,360,15,80,800),"360p_10":Bt(640,360,24,80,800),"360p_11":Bt(640,360,24,80,1e3),"480p":Bt(640,480,15,100,500),"480p_1":Bt(640,480,15,100,500),"480p_2":Bt(640,480,30,100,1e3),"480p_3":Bt(480,480,15,100,400),"480p_4":Bt(640,480,30,100,750),"480p_6":Bt(480,480,30,100,600),"480p_8":Bt(848,480,15,100,610),"480p_9":Bt(848,480,30,100,930),"480p_10":Bt(640,480,10,100,400),"720p":Bt(1280,720,15,120,1130),"720p_auto":Bt(1280,720,30,900,3e3),"720p_1":Bt(1280,720,15,120,1130),"720p_2":Bt(1280,720,30,120,2e3),"720p_3":Bt(1280,720,30,120,1710),"720p_5":Bt(960,720,15,120,910),"720p_6":Bt(960,720,30,120,1380),"1080p":Bt(1920,1080,15,120,2080),"1080p_1":Bt(1920,1080,15,120,2080),"1080p_2":Bt(1920,1080,30,120,3e3),"1080p_3":Bt(1920,1080,30,120,3150),"1080p_5":Bt(1920,1080,60,120,4780),"1440p":Bt(2560,1440,30,120,4850),"1440p_1":Bt(2560,1440,30,120,4850),"1440p_2":Bt(2560,1440,60,120,7350),"4k":Bt(3840,2160,30,120,8910),"4k_1":Bt(3840,2160,30,120,8910),"4k_3":Bt(3840,2160,60,120,13500)},iT=[{scaleResolutionDownBy:2,width:1280,height:720,frameRate:30,bitrateMin:300,bitrateMax:900},{scaleResolutionDownBy:1.333333,width:1280,height:720,frameRate:30,bitrateMin:600,bitrateMax:2e3},{scaleResolutionDownBy:1,width:1280,height:720,frameRate:30,bitrateMin:900,bitrateMax:3e3}],nse={"480p":Ia(640,480,5),"480p_1":Ia(640,480,5),"480p_2":Ia(640,480,30),"480p_3":Ia(640,480,15),"720p":Ia(1280,720,5),"720p_auto":Bt(1280,720,30,900,3e3),"720p_1":Ia(1280,720,5),"720p_2":Ia(1280,720,30),"720p_3":Ia(1280,720,15),"1080p":Ia(1920,1080,5),"1080p_1":Ia(1920,1080,5),"1080p_2":Ia(1920,1080,30),"1080p_3":Ia(1920,1080,15)},rse={"1SL1TL":$N(1,1),"3SL3TL":$N(3,3),"2SL3TL":$N(2,3)};function cl(i){return i||(i="480p_1"),typeof i=="string"?Object.assign({},tse[i]):i}function GN(i){return typeof i=="string"?Object.assign({},nse[i]):i}function sT(i){return typeof i=="string"?Object.assign({},rse[i]):i}const ise={speech_low_quality:om(16e3,!1),speech_standard:om(32e3,!1,18),music_standard:om(48e3,!1),standard_stereo:om(48e3,!0,56),high_quality:om(48e3,!1,128),high_quality_stereo:om(48e3,!0,192)};function oT(i){return typeof i=="string"?Object.assign({},ise[i]):i}const am=[];function P3(i){return Lr(i,"mediaSource",["screen","window","application"]),!0}var Ve,wn,Eu,HN,zN,vu,yu,Su,Us,D3;(function(i){i.NEED_RENEGOTIATE="@need_renegotiate",i.NEED_REPLACE_TRACK="@need_replace_track",i.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",i.NEED_CLOSE="@need_close",i.NEED_ENABLE_TRACK="@need_enable_track",i.NEED_DISABLE_TRACK="@need_disable_track",i.NEED_SESSION_ID="@need_sid",i.SET_OPTIMIZATION_MODE="@set_optimization_mode",i.GET_STATS="@get_stats",i.GET_RTC_STATS="@get_rtc_stats",i.GET_LOW_VIDEO_TRACK="@get_low_video_track",i.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",i.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",i.NEED_MUTE_TRACK="@need_mute_track",i.NEED_UNMUTE_TRACK="@need_unmute_track"})(Ve||(Ve={})),function(i){i.SCREEN_TRACK="screen_track",i.CUSTOM_TRACK="custome_track",i.LOW_STREAM="low_stream"}(wn||(wn={})),function(i){i[i.HIGH_STREAM=0]="HIGH_STREAM",i[i.LOW_STREAM=1]="LOW_STREAM"}(Eu||(Eu={})),function(i){i[i.HIGH_STREAM=0]="HIGH_STREAM",i[i.LOW_STREAM=1]="LOW_STREAM"}(HN||(HN={})),function(i){i[i.DISABLE=0]="DISABLE",i[i.LOW_STREAM=1]="LOW_STREAM",i[i.AUDIO_ONLY=2]="AUDIO_ONLY"}(zN||(zN={})),function(i){i.TRANSCEIVER_UPDATED="transceiver-updated",i.SEI_TO_SEND="sei-to-send",i.SEI_RECEIVED="sei-received"}(vu||(vu={})),function(i){i.SOURCE_STATE_CHANGE="source-state-change",i.TRACK_ENDED="track-ended",i.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",i.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",i.CLOSED="closed"}(yu||(yu={})),function(i){i.FIRST_FRAME_DECODED="first-frame-decoded",i.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",i.VIDEO_STATE_CHANGED="video-state-changed"}(Su||(Su={})),function(i){i.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",i.RECEIVE_TRACK_BUFFER="receive_track_buffer",i.ON_AUDIO_BUFFER="on_audio_buffer",i.UPDATE_SOURCE="update_source"}(Us||(Us={})),function(i){i.UPDATE_TRACK_SOURCE="update-track-source"}(D3||(D3={}));const KN={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},YN={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},L3={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},sse={uplinkNetworkQuality:0,downlinkNetworkQuality:0},M3={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var qi,js,sp,od,Xi,Aa;(function(i){i.ON_TRACK="on_track",i.ON_NODE="on_node"})(qi||(qi={})),function(i){i.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",i.REQUEST_CONSTRAINTS="request_constraints"}(js||(js={})),function(i){i.IDLE="IDLE",i.INITING="INITING",i.INITEND="INITEND"}(sp||(sp={})),function(i){i.STATE_CHANGE="state_change",i.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",i.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",i.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(od||(od={})),function(i){i.NONE="none",i.INIT="init",i.CANPLAY="canplay",i.PLAYING="playing",i.PAUSED="paused",i.SUSPEND="suspend",i.STALLED="stalled",i.WAITING="waiting",i.ERROR="error",i.DESTROYED="destroyed",i.ABORT="abort",i.ENDED="ended",i.EMPTIED="emptied",i.LOADEDDATA="loadeddata"}(Xi||(Xi={})),function(i){i[i.VideoStateStopped=0]="VideoStateStopped",i[i.VideoStateStarting=1]="VideoStateStarting",i[i.VideoStateDecoding=2]="VideoStateDecoding",i[i.VideoStateFrozen=3]="VideoStateFrozen"}(Aa||(Aa={}));const qN={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};var cm;(function(i){i.OPEN="open",i.MESSAGE="message",i.CLOSE="close",i.CLOSING="closing",i.ERROR="error"})(cm||(cm={}));class U3 extends jn{constructor(e,n){super(),R(this,"_ID",void 0),R(this,"_rtpTransceiver",void 0),R(this,"_lowRtpTransceiver",void 0),R(this,"_hints",[]),R(this,"_isClosed",!1),R(this,"_originMediaStreamTrack",void 0),R(this,"_mediaStreamTrack",void 0),R(this,"_external",{}),this._ID=n||Sn(8,"track-"),this._originMediaStreamTrack=e,this._mediaStreamTrack=e,function(s){je(am).call(am,s)||am.push(s)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){if(!e){const n=qe.reportApiInvoke(null,{name:br.GET_MEDIA_STREAM_TRACK,options:[],tag:Bn.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?n.onSuccess(this._mediaStreamTrack.label):n.onSuccess("")}return this._mediaStreamTrack}getRTCRtpTransceiver(e){return e===Eu.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(e){const n=am.indexOf(e);n!==-1&&am.splice(n,1)}(this),this.emit(yu.CLOSED),this.removeAllListeners(vu.SEI_RECEIVED)}_updateRtpTransceiver(e,n){if(n===Eu.LOW_STREAM){if(this._lowRtpTransceiver===e)return;this._lowRtpTransceiver=e}else{if(this._rtpTransceiver===e)return;this._rtpTransceiver=e}this.emit(vu.TRANSCEIVER_UPDATED,e,n)}}class Di extends U3{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(e,n){super(e,n),R(this,"_enabled",!0),R(this,"_muted",!1),R(this,"_isExternalTrack",!1),R(this,"_isClosed",!1),R(this,"_enabledMutex",void 0),R(this,"processor",void 0),R(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new ii("".concat(this.getTrackId())),e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var e,n;return(e=(n=this._originMediaStreamTrack)===null||n===void 0?void 0:n.label)!==null&&e!==void 0?e:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,N.debug("[".concat(this.getTrackId(),"] close")),this.emit(Ve.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(e,n){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=s,e!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),n&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,Ve.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){N.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(yu.TRACK_ENDED)}stateCheck(e,n){if(N.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(e,": ").concat(n,"]")),Jl(n,e),this._enabled&&this._muted&&e==="enabled"&&n===!1)throw new ye(z.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",N);if(!this._enabled&&!this._muted&&e==="muted"&&n===!0)throw new ye(z.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",N)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():pe.resolve([])}}function j3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}const F3=window.AudioContext||window.webkitAudioContext;let Co=null;const cn=new class extends jn{constructor(){super(...arguments),R(this,"prevState",void 0),R(this,"curState",void 0),R(this,"currentTime",void 0),R(this,"currentTimeStuckAt",void 0),R(this,"interruptDetectorTrack",void 0),R(this,"onLocalAudioTrackMute",()=>{N.info("ios15-interruption-start"),this.emit(Kr.IOS_15_16_INTERRUPTION_START)}),R(this,"onLocalAudioTrackUnmute",async()=>{N.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?N.info("ios15-interruption-end-canceled"):(Co&&await Co.suspend(),this.emit(Kr.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(i){N.debug("webaudio bindInterruptDetectorTrack ".concat(i.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=i,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(i){N.debug("webaudio unbindInterruptDetectorTrack ".concat(i.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===i&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function ose(){if(!F3)return void N.error("your browser is not support web audio");N.info("create audio context");const i=function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?j3(Object(s),!0).forEach(function(a){R(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):j3(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}({},Z("WEBAUDIO_INIT_OPTIONS"));N.debug("audio context init option:",JSON.stringify(i)),Co=new F3(i),cn.curState=Co.state,Co.onstatechange=()=>{cn.prevState=cn.curState,cn.curState=Co?Co.state:void 0;const{prevState:e,curState:n}=cn,s=n==="running",a=n==="interrupted",l=e==="running",u=e==="suspended",p=e==="interrupted",m=zt().osVersion;(ts()||nl())&&l&&a&&(N.info("ios".concat(m,"-interruption-start")),cn.emit(Kr.IOS_INTERRUPTION_START)),(ts()||nl())&&(u||p)&&s&&(N.info("ios".concat(m,"-interruption-end")),cn.emit(Kr.IOS_INTERRUPTION_END)),e!==n&&cn.emit(Kr.STATE_CHANGE,n,e)},setInterval(()=>{var e;const n=(e=Co)===null||e===void 0?void 0:e.currentTime;cn.currentTime!==n?(cn.currentTimeStuckAt&&(N.debug("AudioContext current time resume at ".concat(n)),cn.currentTimeStuckAt=void 0),cn.currentTime=n):(n!==cn.currentTimeStuckAt&&(qe.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:n},tag:Bn.TRACER}).onSuccess(),N.warning("AudioContext current time stuck at ".concat(n))),cn.currentTimeStuckAt=n)},5e3),async function(e){const n=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let s,a=!1,l=!1,u=!1;function p(U){e.state==="running"?m(!1):ts()||nl()?e.state==="suspended"&&(m(!0),U&&e.resume().then(E,E)):e.state!=="closed"&&(m(!0),U&&e.resume().then(E,E))}function m(U){if(a!==U){a=U;for(let q=0,J=n;q<J.length;q+=1){const se=J[q];U?window.addEventListener(se,y,{capture:!0,passive:!0}):window.removeEventListener(se,y,{capture:!0,passive:!0})}}}function g(){p(!0)}function E(){p(!1)}function y(){p(!0)}function C(U){if(!u)if(s.paused)if(U){let q;I(!1),u=!0;try{q=s.play(),q?q.then(j,j):(s.addEventListener("playing",j),s.addEventListener("abort",j),s.addEventListener("error",j))}catch{j()}}else I(!0);else I(!1)}function I(U){if(l!==U){l=U;for(let q=0,J=n;q<J.length;q++){const se=J[q];U?window.addEventListener(se,P,{capture:!0,passive:!0}):window.removeEventListener(se,P,{capture:!0,passive:!0})}}}function j(){s.removeEventListener("playing",j),s.removeEventListener("abort",j),s.removeEventListener("error",j),u=!1,C(!1)}function P(){C(!0)}if(ts()){const U=e.createMediaStreamDestination(),q=document.createElement("div");q.innerHTML="<audio x-webkit-airplay='deny'></audio>",s=q.children.item(0),s.controls=!1,s.disableRemotePlayback=!0,s.preload="auto",s.srcObject=U.stream,C(!0)}cn.on(Kr.STATE_CHANGE,g),p(!1)}(Co)}function lm(){if(!Co){if(ose(),!Co)throw new ye(z.NOT_SUPPORTED,"can not create audio context");return Co}return Co}function op(i){if(function(){if(XN!==null)return XN;const s=lm(),a=s.createBufferSource(),l=s.createGain(),u=s.createGain();a.connect(l),a.connect(u),a.disconnect(l);let p=!1;try{a.disconnect(l)}catch{p=!0}return a.disconnect(),XN=p,p}())return;const e=i.connect,n=i.disconnect;i.connect=(s,a,l)=>{var u;return i._inputNodes||(i._inputNodes=[]),je(u=i._inputNodes).call(u,s)||(s instanceof AudioNode?(i._inputNodes.push(s),e.call(i,s,a,l)):e.call(i,s,a)),i},i.disconnect=(s,a,l)=>{n.call(i),s?kb(i._inputNodes,s):i._inputNodes=[];for(const u of i._inputNodes)e.call(i,u)}}let XN=null;function JN(i,e){let n=!1;const s=1/e;if(Z("DISABLE_WEBAUDIO")){const a=window.setInterval(()=>{n?window.clearInterval(a):i(performance.now()/1e3)},1e3*s)}else{const a=lm();let l=a.createGain();l.gain.value=0,l.connect(a.destination);const u=()=>{if(n)return void(l=null);const p=a.createOscillator();p.onended=u,p.connect(l),p.start(0),p.stop(a.currentTime+s),i(a.currentTime)};u()}return()=>{n=!0}}class V3{constructor(){R(this,"context",void 0),R(this,"analyserNode",void 0),R(this,"sourceNode",void 0),this.context=lm(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(e){if(e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=e,e==null||e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||ts()||nl()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(e);else{const s=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(s);for(let a=0;a<e.length;++a)e[a]=s[a]/128-1}const n=ed(e).call(e,(s,a)=>s+a*a,0)/e.length;return Math.max(10*Math.log10(n)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var e,n;(e=this.sourceNode)===null||e===void 0||e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(n=this.sourceNode)===null||n===void 0||n.connect(this.analyserNode)}catch{N.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class B3 extends jn{get processSourceNode(){return this.sourceNode}set processedNode(e){var n;if(!this.isDestroyed&&this._processedNode!==e){try{var s;(s=this.sourceNode)===null||s===void 0||s.disconnect(this.outputNode)}catch{}(n=this._processedNode)===null||n===void 0||n.disconnect(),this._processedNode=e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),R(this,"outputNode",void 0),R(this,"outputTrack",void 0),R(this,"isPlayed",!1),R(this,"context",void 0),R(this,"audioBufferNode",void 0),R(this,"destNode",void 0),R(this,"audioOutputLevel",0),R(this,"volumeLevelAnalyser",void 0),R(this,"_processedNode",void 0),R(this,"playNode",void 0),R(this,"isDestroyed",!1),R(this,"onNoAudioInput",void 0),R(this,"isNoAudioInput",!1),R(this,"_noAudioInputCount",0),this.context=lm(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),op(this.outputNode),this.volumeLevelAnalyser=new V3}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=n=>{this.emit(Us.ON_AUDIO_BUFFER,function(s){for(let a=0;a<s.outputBuffer.numberOfChannels;a+=1){const l=s.outputBuffer.getChannelData(a);for(let u=0;u<l.length;u+=1)l[u]=0}return s.inputBuffer}(n))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Kt().webAudioMediaStreamDest)throw new ye(z.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){this.context.state!=="running"&&xb(()=>{cn.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;ts()||nl()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const n=this.volumeLevelAnalyser.getAnalyserNode();let s;n.getFloatTimeDomainData?(s=new Float32Array(n.fftSize),n.getFloatTimeDomainData(s)):(s=new Uint8Array(n.fftSize),n.getByteTimeDomainData(s));let a=!1;for(let l=0;l<s.length;l++)s[l]!==0&&(a=!0);return a?(this.isNoAudioInput=!1,!0):(await ri(200),await this.checkHasAudioInput(e?e+1:1)&&a)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var e,n;(e=this.processedNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var e;this.processedNode?(e=this.processedNode)===null||e===void 0||e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class W3 extends B3{get isFreeze(){return!1}constructor(e,n,s){var a;if(super(),R(this,"sourceNode",void 0),R(this,"track",void 0),R(this,"clonedTrack",void 0),R(this,"audioElement",void 0),R(this,"isCurrentTrackCloned",!1),R(this,"isRemoteTrack",!1),R(this,"originVolumeLevelAnalyser",void 0),R(this,"rebuildWebAudio",async()=>{if(N.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void N.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>N.info("resume success")),N.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const p=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?p.stop():this.isCurrentTrackCloned=!0;const m=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(m),op(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const g=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(g,this.context.currentTime),op(this.outputNode),this.emit(Us.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=m,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),e.kind!=="audio")throw new ye(z.UNEXPECTED_ERROR);this.track=e;const l=new MediaStream([this.track]);if(this.isRemoteTrack=!!n,this.sourceNode=this.context.createMediaStreamSource(l),op(this.sourceNode),s){const p=s.clone();p.enabled=!0,this.clonedTrack=p,N.debug("create an unmuted track ".concat(p.id," from the original track ").concat(s.id," to get the volume"));const m=this.context.createMediaStreamSource(new MediaStream([p]));op(m),this.originVolumeLevelAnalyser=new V3,this.originVolumeLevelAnalyser.updateSource(m)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=l;const u=zt();n&&u.os===Dr.IOS&&Number((a=u.osVersion)===null||a===void 0?void 0:a.split(".")[0])<15&&(cn.on(Kr.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(p=>{p||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;const n=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(n),op(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Us.UPDATE_SOURCE),this.audioElement.srcObject=n}destroy(){var e;this.audioElement.srcObject=null,this.audioElement.remove(),cn.off("state-change",this.rebuildWebAudio),(e=this.originVolumeLevelAnalyser)===null||e===void 0||e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(e){return this.context.createMediaStreamSource(new MediaStream([e]))}updateOriginTrack(e){const n=e.clone();n.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=n),N.debug("create an unmuted track ".concat(n.id," from the original track ").concat(e.id," to get the volume"));const s=this.context.createMediaStreamSource(new MediaStream([n]));op(s),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(s)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function $3(i,e,n){const s=(l,u)=>l?typeof l!="number"?l.max||l.exact||l.ideal||l.min||u:l:u,a={audio:!!n&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxHeight:s(e.height,1080),maxWidth:s(e.width,1920)}}};return e.frameRate&&typeof e.frameRate!="number"?(a.video.mandatory.maxFrameRate=e.frameRate.max,a.video.mandatory.minFrameRate=e.frameRate.min):typeof e.frameRate=="number"&&(a.video.mandatory.maxFrameRate=e.frameRate),await navigator.mediaDevices.getUserMedia(a)}async function ase(i,e){const n=await G3(i.mediaSource),{sourceId:s,audio:a}=await function(l){let u=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new pe((p,m)=>{const g=document.createElement("div");g.innerText="share screen",g.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const E=document.createElement("div");E.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const y=document.createElement("div");y.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",y.setAttribute("style","height: 12%;");const C=document.createElement("div");C.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const I=document.createElement("div");I.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const j=document.createElement("button");j.innerHTML="cancel",j.setAttribute("style","width: 85px;"),j.onclick=()=>{document.body.removeChild(q);const J=new Error("NotAllowedError");J.name="NotAllowedError",m(J)};let P=u;const U=document.createElement("div");if(u){const J=document.createElement("input");J.setAttribute("type","checkbox");const se=document.createElement("span");J.setAttribute("style","margin-right: 6px;"),se.innerText="Share audio",J.checked=P,J.onchange=()=>{P=J.checked},U.appendChild(J),U.appendChild(se)}I.appendChild(U),I.appendChild(j),E.appendChild(y),E.appendChild(C),E.appendChild(I);const q=document.createElement("div");q.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),q.appendChild(g),q.appendChild(E),document.body.appendChild(q),l.map(J=>{if(J.id){const se=document.createElement("div");se.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let he=J.thumbnail;try{const{width:ae}=he.getSize();ae>1920&&(he=he.resize({width:1920}))}catch(ae){throw ae&&ae.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),ae}se.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+he.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+J.name.replace(/[\u00A0-\u9999<>\&]/g,function(ae){return"&#"+ae.charCodeAt(0)+";"})+"</span>",se.onclick=()=>{document.body.removeChild(q),p({sourceId:J.id,audio:P})},C.appendChild(se)}})})}(n,e);return await $3(s,i,a)}async function G3(i){let e=["window","screen"];i!=="application"&&i!=="window"||(e=["window"]),i==="screen"&&(e=["screen"]);const n=W5();if(!n)throw console.error("failed to fetch electron, please mount it to window"),new ye(z.ELECTRON_IS_NULL);let s=null;try{var a;s=((a=n.desktopCapturer)===null||a===void 0?void 0:a.getSources({types:e}))||n.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:e})}catch{s=null}s&&s.then||(s=new pe((l,u)=>{n.desktopCapturer.getSources({types:e},(p,m)=>{p?u(p):l(m)})}));try{return await s}catch(l){throw new ye(z.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,l.toString())}}function H3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}const QN=new ii("safari");let z3=!1,K3=!1;async function wo(i,e){let n=0,s=null;for(;n<2;)try{s=await cse(i,e,n>0);break}catch(a){if(a instanceof ye)throw N.error("[".concat(e,"] ").concat(a.toString())),a;const l=aT(a.name||a.code||a,a.message);if(l.code===z.MEDIA_OPTION_INVALID){N.debug("[".concat(e,"] detect media option invalid, retry")),n+=1,await ri(500);continue}throw N.error("[".concat(e,"] ").concat(l.toString())),l}if(!s)throw new ye(z.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return s}async function cse(i,e,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new ye(z.NOT_SUPPORTED,"can not find getUserMedia");n&&(i.video&&(delete i.video.width,delete i.video.height),i.screen&&(delete i.screen.width,delete i.screen.height));const s=Kt(),a=new MediaStream;if(i.audioSource&&a.addTrack(i.audioSource),i.videoSource&&a.addTrack(i.videoSource),!i.audio&&!i.video&&!i.screen)return N.debug("Using Video Source/ Audio Source"),a;if(i.screen)if(W5())i.screen.sourceId?dm(a,await $3(i.screen.sourceId,i.screen,i.screenAudio)):dm(a,await ase(i.screen,i.screenAudio));else if(Xl()&&i.screen.extensionId&&i.screen.mandatory){if(!s.getStreamFromExtension)throw new ye(z.NOT_SUPPORTED,"This browser does not support screen sharing");N.debug("[".concat(e,'] Screen access on chrome stable, looking for extension"'));const C=await(u=i.screen.extensionId,p=e,new pe((I,j)=>{try{chrome.runtime.sendMessage(u,{getStream:!0},P=>{if(!P||!P.streamId)return N.error("[".concat(p,"] No response from Chrome Plugin. Plugin not installed properly"),P),void j(new ye(z.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));I(P.streamId)})}catch(P){N.error("[".concat(p,"] AgoraRTC screensharing plugin is not accessible(").concat(u,")"),P.toString()),j(new ye(z.CHROME_PLUGIN_NOT_INSTALL))}}));i.screen.mandatory.chromeMediaSourceId=C,dm(a,await navigator.mediaDevices.getUserMedia({video:{mandatory:i.screen.mandatory}}))}else if(s.getDisplayMedia){var l;i.screen.mediaSource&&P3(i.screen.mediaSource);const C={width:i.screen.width,height:i.screen.height,frameRate:i.screen.frameRate,displaySurface:(l=i.screen.displaySurface)!==null&&l!==void 0?l:i.screen.mediaSource==="screen"?"monitor":i.screen.mediaSource},{selfBrowserSurface:I,surfaceSwitching:j,systemAudio:P}=i.screen,U={selfBrowserSurface:I,surfaceSwitching:j,systemAudio:P};!I&&delete U.selfBrowserSurface,!j&&delete U.surfaceSwitching,!P&&delete U.systemAudio,N.debug("[".concat(e,"] getDisplayMedia:"),JSON.stringify({video:C,audio:!!i.screenAudio,controls:U}));const q=await navigator.mediaDevices.getDisplayMedia(function(J){for(var se=1;se<arguments.length;se++){var he=arguments[se]!=null?arguments[se]:{};se%2?H3(Object(he),!0).forEach(function(ae){R(J,ae,he[ae])}):Object.getOwnPropertyDescriptors?Object.defineProperties(J,Object.getOwnPropertyDescriptors(he)):H3(Object(he)).forEach(function(ae){Object.defineProperty(J,ae,Object.getOwnPropertyDescriptor(he,ae))})}return J}({video:C,audio:!!i.screenAudio},U));dm(a,q)}else{if(!mn())throw N.error("[".concat(e,"] This browser does not support screenSharing")),new ye(z.NOT_SUPPORTED,"This browser does not support screen sharing");{i.screen.mediaSource&&P3(i.screen.mediaSource);const C={video:{mediaSource:i.screen.mediaSource,width:i.screen.width,height:i.screen.height,frameRate:i.screen.frameRate}};N.debug("[".concat(e,"] getUserMedia: ").concat(JSON.stringify(C))),dm(a,await navigator.mediaDevices.getUserMedia(C))}}var u,p;if(!i.video&&!i.audio)return a;let m={video:i.video,audio:i.audio},g=Z("MEDIA_DEVICE_CONSTRAINTS");if(g)try{typeof g=="string"&&(g=JSON.parse(g)),m=QO(m,g)}catch{}N.debug("[".concat(e,"] GetUserMedia"),JSON.stringify(m)),zt();let E,y=null;(vi()||ts()||Ab())&&(y=await QN.lock());try{E=await navigator.mediaDevices.getUserMedia(m)}catch(C){throw y&&y(),C}return m.audio&&(z3=!0),m.video&&(K3=!0),dm(a,E),y&&y(),a}function aT(i,e){switch(i){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new ye(z.MEDIA_OPTION_INVALID,"".concat(i,": ").concat(e));case"NotFoundError":case"DevicesNotFoundError":return new ye(z.DEVICE_NOT_FOUND,"".concat(i,": ").concat(e));case"NotSupportedError":return new ye(z.NOT_SUPPORTED,"".concat(i,": ").concat(e));case"NotReadableError":return new ye(z.NOT_READABLE,"".concat(i,": ").concat(e));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new ye(z.PERMISSION_DENIED,"".concat(i,": ").concat(e));case"ConstraintNotSatisfiedError":return new ye(z.CONSTRAINT_NOT_SATISFIED,"".concat(i,": ").concat(e));default:return N.error("getUserMedia unexpected error",i),new ye(z.UNEXPECTED_ERROR,"".concat(i,": ").concat(e))}}function dm(i,e){const n=i.getVideoTracks()[0],s=i.getAudioTracks()[0],a=e.getVideoTracks()[0],l=e.getAudioTracks()[0];l&&(s&&i.removeTrack(s),i.addTrack(l)),a&&(n&&i.removeTrack(n),i.addTrack(a))}const Ro=new class extends jn{get state(){return this._state}set state(i){i!==this._state&&(this.emit(od.STATE_CHANGE,i),this._state=i)}constructor(){super(),R(this,"_state",sp.IDLE),R(this,"isAccessMicrophonePermission",!1),R(this,"isAccessCameraPermission",!1),R(this,"lastAccessMicrophonePermission",!1),R(this,"lastAccessCameraPermission",!1),R(this,"checkdeviceMatched",!1),R(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(Z("ENUMERATE_DEVICES_INTERVAL")||(Ob()||Ib()===Dr.HARMONY_OS)&&au())&&this.updateDevicesInfo()},Z("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(i=>N.error(i.toString()))}async enumerateDevices(i,e){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new ye(z.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const s=await navigator.mediaDevices.enumerateDevices(),a=this.checkMediaDeviceInfoIsOk(s);let l=!this.isAccessMicrophonePermission&&i,u=!this.isAccessCameraPermission&&e;a.audio&&(l=!1),a.video&&(u=!1);let p=null,m=null,g=null;if(!n&&(l||u)){if(QN.isLocked&&(N.debug("[device manager] wait GUM lock"),(await QN.lock())(),N.debug("[device manager] GUM unlock")),z3&&(l=!1,this.isAccessMicrophonePermission=!0),K3&&(u=!1,this.isAccessCameraPermission=!0),N.debug("[device manager] check media device permissions",i,e,l,u),l&&u){try{g=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(E){const y=aT(E.name||E.code||E,E.message);if(y.code===z.PERMISSION_DENIED)throw y;N.warning("getUserMedia failed in getDevices",y)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(l){try{p=await navigator.mediaDevices.getUserMedia({audio:i})}catch(E){const y=aT(E.name||E.code||E,E.message);if(y.code===z.PERMISSION_DENIED)throw y;N.warning("getUserMedia failed in getDevices",y)}this.isAccessMicrophonePermission=!0}else if(u){try{m=await navigator.mediaDevices.getUserMedia({video:e})}catch(E){const y=aT(E.name||E.code||E,E.message);if(y.code===z.PERMISSION_DENIED)throw y;N.warning("getUserMedia failed in getDevices",y)}this.isAccessCameraPermission=!0}N.debug("[device manager] mic permission",i,"cam permission",e)}try{const E=await navigator.mediaDevices.enumerateDevices();return p&&p.getTracks().forEach(y=>y.stop()),m&&m.getTracks().forEach(y=>y.stop()),g&&g.getTracks().forEach(y=>y.stop()),p=null,m=null,g=null,E}catch(E){return p&&p.getTracks().forEach(y=>y.stop()),m&&m.getTracks().forEach(y=>y.stop()),g&&g.getTracks().forEach(y=>y.stop()),p=null,m=null,g=null,new ye(z.ENUMERATE_DEVICES_FAILED,E.toString()).throw()}}async getRecordingDevices(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,i)).filter(e=>e.kind==="audioinput")}async getCamerasDevices(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,i)).filter(e=>e.kind==="videoinput")}async getSpeakers(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,i)).filter(e=>e.kind==="audiooutput")}searchDeviceIdByName(i){let e=null;return this.deviceInfoMap.forEach(n=>{n.device.label===i&&(e=n.device.deviceId)}),e}async getDeviceById(i){const e=(await this.enumerateDevices(!0,!0,!0)).find(n=>n.deviceId===i);if(!e)throw new ye(z.DEVICE_NOT_FOUND,"deviceId: ".concat(i));return e}async init(){this.state=sp.INITING;try{await this.updateDevicesInfo(),this.state=sp.INITEND}catch(i){throw N.warning("Device Detection functionality cannot start properly.",i.toString()),this.state=sp.IDLE,!(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")&&new ye(z.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),i}}async updateDevicesInfo(){const i=await this.enumerateDevices(!0,!0,!0),e=Date.now(),n=[];if(i[0]&&i[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const a=i.find(u=>u.kind==="audioinput"&&u.deviceId==="default"),l=i.find(u=>u.kind==="audiooutput"&&u.deviceId==="default");a&&l?l.groupId===a.groupId?N.debug("[device-check] default input ".concat(a.label," and output ").concat(l.label," is the same group")):N.warning("[device-check] default input ".concat(a.label," and output ").concat(l.label," is not the same group")):N.debug("[device-check] default input or output not found")}const s=this.checkMediaDeviceInfoIsOk(i);if(i.forEach(a=>{if(!a.deviceId)return;const l=this.deviceInfoMap.get("".concat(a.kind,"_").concat(a.deviceId));if((l?l.state:"INACTIVE")!=="ACTIVE"){const u={initAt:e,updateAt:e,device:a,state:"ACTIVE"};this.deviceInfoMap.set("".concat(a.kind,"_").concat(a.deviceId),u),n.push(u)}l&&(l.updateAt=e)}),this.deviceInfoMap.forEach((a,l)=>{a.state==="ACTIVE"&&a.updateAt!==e&&(a.state="INACTIVE",n.push(a))}),this.state!==sp.INITEND)return s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));n.forEach(a=>{switch(a.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(od.RECORDING_DEVICE_CHANGED,a);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(od.CAMERA_DEVICE_CHANGED,a);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(od.PLAYOUT_DEVICE_CHANGED,a)}}),s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(i){const e=i.filter(a=>a.kind==="audioinput"),n=i.filter(a=>a.kind==="videoinput"),s={audio:!1,video:!1};for(const a of e)if(a.label&&a.deviceId){s.audio=!0;break}for(const a of n)if(a.label&&a.deviceId){s.video=!0;break}return s}};let ZN=!1;const Io=new class extends jn{constructor(){super(...arguments),R(this,"onAutoplayFailed",void 0),R(this,"onAudioAutoplayFailed",void 0)}};function Y3(){if(zt(),!ZN){const i=e=>{e.preventDefault(),ZN=!1,CE()?document.body.removeEventListener("click",i,!0):(document.body.removeEventListener("touchstart",i,!0),document.body.removeEventListener("mousedown",i,!0))};ZN=!0,CE()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0)),N.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Io.onAutoplayFailed?Io.onAutoplayFailed():Io.onAudioAutoplayFailed?N.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):N.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),Io.emit("autoplay-failed")}}function q3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function X3(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?q3(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):q3(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function J3(i,e,n,s){if(!i)return;const a=qe.getBaseInfoBySessionId(i);if(!a)return;const l=a.info,u=Date.now(),p=X3(X3({},l),{},{vid:l.vid===void 0?0:Number(l.vid),lts:u,elapse:u-a.startTime,cbRegistered:Io.onAutoplayFailed||Io.onAudioAutoplayFailed?1:-1,errorMsg:n,mediaType:e,trackId:s,extend:void 0});qe.send({type:kn.AUTOPLAY_FAILED,data:p},!0)}const lse=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Ss=new class{constructor(){R(this,"onAutoplayFailed",void 0),R(this,"elementMap",new Map),R(this,"elementStateMap",new Map),R(this,"elementsNeedToResume",[]),R(this,"sinkIdMap",new Map),R(this,"autoResumeAfterInterruption",i=>{Array.from(this.elementMap.entries()).forEach(e=>{let[n,s]=e;const a=this.elementStateMap.get(n),l=s.srcObject.getAudioTracks()[0],u=l&&l.readyState;if(N.debug("resume after interrupted, ele: ".concat(a," audio: ").concat(u," ").concat(i)),u==="live"){if(i)return s.pause(),void s.play();if(cn.curState==="running")return zf()?(s.pause(),void s.play()):void(a&&a==="paused"&&s.play())}})}),R(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(i=>{let[e,n]=i;const s=n.srcObject.getAudioTracks()[0];s&&s.readyState==="live"&&(N.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),n.pause(),n.play())})}),this.autoResumeAudioElement(),cn.on(Kr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),cn.on(Kr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),cn.on(Kr.STATE_CHANGE,()=>{ts()&&cn.prevState==="suspended"&&cn.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(i,e){const n=this.elementMap.get(i);if(this.sinkIdMap.set(i,e),n)try{await n.setSinkId(e)}catch(s){throw new ye(z.PERMISSION_DENIED,"can not set sink id: "+s.toString())}}play(i,e,n,s){if(this.elementMap.has(e))return;const a=document.createElement("audio");a.autoplay=!0,a.srcObject=new MediaStream([i]),this.bindAudioElementEvents(e,a),this.elementMap.set(e,a),this.elementStateMap.set(e,Xi.INIT),this.setVolume(e,n);const l=this.sinkIdMap.get(e);if(l)try{a.setSinkId(l).catch(p=>{N.warning("[".concat(e,"] set sink id failed"),p.toString())})}catch(p){N.warning("[".concat(e,"] set sink id failed"),p.toString())}const u=a.play();u&&u.then&&u.catch(p=>{s&&J3(s,"audio",p.message,e),N.warning("audio element play warning",p.toString()),this.elementMap.has(e)&&p.name==="NotAllowedError"&&(N.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(a),xb(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),Y3()}))})}updateTrack(i,e){const n=this.elementMap.get(i);n&&(n.srcObject=new MediaStream([e]))}isPlaying(i){return this.elementMap.has(i)&&this.elementStateMap.get(i)==="playing"}setVolume(i,e){const n=this.elementMap.get(i);n&&(e=Math.max(0,Math.min(100,e)),n.volume=e/100)}stop(i){const e=this.elementMap.get(i);if(this.sinkIdMap.delete(i),!e)return;const n=this.elementsNeedToResume.indexOf(e);this.elementsNeedToResume.splice(n,1),e.srcObject=null,e.remove(),this.elementMap.delete(i),this.elementStateMap.delete(i)}bindAudioElementEvents(i,e){lse.forEach(n=>{e.addEventListener(n,s=>{const a=this.elementStateMap.get(i),l=s.type==="pause"?"paused":s.type;if(N.debug("[".concat(i,"] audio-element-status change ").concat(a," => ").concat(l)),s.type==="error"){const u=e==null?void 0:e.error;u&&N.error("[".concat(i,"] media error, code: ").concat(u.code,", message: ").concat(u.message))}this.elementStateMap.set(i,l)})})}getPlayerState(i){return this.elementStateMap.get(i)||"uninit"}autoResumeAudioElement(){const i=()=>{this.elementsNeedToResume.forEach(e=>{e.play().then(n=>{N.debug("Auto resume audio element success")}).catch(n=>{N.warning("Auto resume audio element failed!",n)})}),this.elementsNeedToResume=[]};new pe(e=>{document.body?e():window.addEventListener("load",()=>e())}).then(()=>{CE()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0))})}};function ur(){return function(i,e,n){const s=n.value;return typeof s=="function"&&(n.value=function(){this._isClosed&&new ye(z.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",N);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];const p=s.apply(this,l);return p instanceof pe?new pe((m,g)=>{p.then(m).catch(g)}):p}),n}}function Q3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function cT(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Q3(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):Q3(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class Z3 extends jn{constructor(e){super(),R(this,"name","VideoProcessorDestination"),R(this,"ID","0"),R(this,"_source",void 0),R(this,"videoContext",void 0),R(this,"inputTrack",void 0),this.videoContext=e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new ye(z.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new ye(z.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(e){if(e.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);e.track&&e.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=e.track,this.emit(qi.ON_TRACK,e.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(qi.ON_TRACK,void 0)}}class eV extends jn{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,n){super(),R(this,"constraintsMap",new Map),R(this,"statsRegistry",[]),R(this,"usageRegistry",[]),R(this,"trackId",void 0),R(this,"direction",void 0),R(this,"_chained",!1),this.trackId=e,this.direction=n}async getConstraints(){return await Tr(this,js.REQUEST_CONSTRAINTS)}async requestApplyConstraints(e,n){var s;return N.info("processor ".concat(n.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(n,e),gn(this,js.REQUEST_UPDATE_CONSTRAINTS,Array.from(yc(s=this.constraintsMap).call(s)))}async requestRevertConstraints(e){var n;if(this.constraintsMap.has(e))return N.info("processor ".concat(e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(e),gn(this,js.REQUEST_UPDATE_CONSTRAINTS,Array.from(yc(n=this.constraintsMap).call(n)))}registerStats(e,n,s){this.statsRegistry.find(a=>a.processorID===e.ID&&a.processorName===e.name&&a.type===n)||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:n,cb:s})}unregisterStats(e,n){const s=this.statsRegistry.findIndex(a=>a.processorID===e.ID&&a.processorName===e.name&&a.type===n);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const e=[];for(const{processorID:n,processorName:s,type:a,cb:l}of this.statsRegistry)try{const u=l();e.push({processorID:n,processorName:s,type:a,stats:u})}catch(u){N.error(new ye(z.UNEXPECTED_ERROR,u.message))}return e}registerUsage(e,n){this.usageRegistry.find(s=>s.processorID===e.ID&&s.processorName===e.name)||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:n})}unregisterUsage(e){const n=this.usageRegistry.findIndex(s=>s.processorID===e.ID&&s.processorName===e.name);n!==-1&&this.usageRegistry.splice(n,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:n}of this.usageRegistry)try{let s=n();s instanceof pe&&(s=await s),e.push(cT(cT({},s),{},{direction:this.direction}))}catch(s){N.error("gather extension usage error",s)}return e}getDirection(){return this.direction}}class tV extends jn{constructor(e){super(),R(this,"name","AudioProcessorDestination"),R(this,"ID","0"),R(this,"inputTrack",void 0),R(this,"inputNode",void 0),R(this,"audioProcessorContext",void 0),R(this,"_source",void 0),this.audioProcessorContext=e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new ye(z.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new ye(z.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(qi.ON_TRACK,void 0),this.emit(qi.ON_NODE,void 0)}updateInput(e){if(e.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);e.track&&this.inputTrack!==e.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=e.track,this.emit(qi.ON_TRACK,this.inputTrack)),e.node&&this.inputNode!==e.node&&(this.audioProcessorContext.chained=!0,this.inputNode=e.node,this.emit(qi.ON_NODE,this.inputNode))}}class nV extends jn{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,n,s){super(),R(this,"constraintsMap",new Map),R(this,"statsRegistry",[]),R(this,"audioContext",void 0),R(this,"trackId",void 0),R(this,"direction",void 0),R(this,"usageRegistry",[]),R(this,"_chained",!1),this.audioContext=e,this.trackId=n,this.direction=s}async getConstraints(){return Tr(this,js.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(e,n){var s;return N.info("processor ".concat(n.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(n,e),gn(this,js.REQUEST_UPDATE_CONSTRAINTS,Array.from(yc(s=this.constraintsMap).call(s)))}async requestRevertConstraints(e){var n;if(this.constraintsMap.has(e))return this.constraintsMap.delete(e),gn(this,js.REQUEST_UPDATE_CONSTRAINTS,Array.from(yc(n=this.constraintsMap).call(n)))}registerStats(e,n,s){this.statsRegistry.find(a=>a.processorID===e.ID&&a.processorName===e.name&&a.type===n)||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:n,cb:s})}unregisterStats(e,n){const s=this.statsRegistry.findIndex(a=>a.processorID===e.ID&&a.processorName===e.name&&a.type===n);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const e=[];for(const{processorID:n,processorName:s,type:a,cb:l}of this.statsRegistry)try{const u=l();e.push({processorID:n,processorName:s,type:a,stats:u})}catch(u){N.error(new ye(z.UNEXPECTED_ERROR,u.message))}return e}registerUsage(e,n){this.usageRegistry.find(s=>s.processorID===e.ID&&s.processorName===e.name)||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:n})}unregisterUsage(e){const n=this.usageRegistry.findIndex(s=>s.processorID===e.ID&&s.processorName===e.name);n!==-1&&this.usageRegistry.splice(n,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:n}of this.usageRegistry)try{let s=n();s instanceof pe&&(s=await s),e.push(cT(cT({},s),{},{direction:this.direction}))}catch(s){N.error("gather extension usage error",s)}return e}getDirection(){return this.direction}}class ek extends jn{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),R(this,"context",void 0),R(this,"processSourceNode",void 0),R(this,"outputTrack",void 0),R(this,"processedNode",void 0),R(this,"clonedTrack",void 0),R(this,"outputNode",void 0),this.outputNode=new dse}setVolume(){}createOutputTrack(){throw new ye(z.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class dse{disconnect(){}connect(){}}function rV(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function tk(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rV(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):rV(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class ln extends Di{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?Ss.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,n,s,a){super(e,s),R(this,"trackMediaType","audio"),R(this,"_encoderConfig",void 0),R(this,"_trackSource",void 0),R(this,"_enabled",!0),R(this,"_volume",100),R(this,"_useAudioElement",!0),R(this,"_bypassWebAudio",!1),R(this,"processor",void 0),R(this,"_processorContext",void 0),R(this,"_processorDestination",void 0),R(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=n,this._getOriginVolumeLevel=!!a,this._trackSource=new ek,Z("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),Z("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),vi()&&!Co?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(e){pn(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&Ss.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void N.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const n=this._source.createOutputTrack();this._mediaStreamTrack!==n&&(this._mediaStreamTrack=n,gn(this,Ve.NEED_REPLACE_TRACK,this).then(()=>{N.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(s=>{N.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),s)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!Xl()&&Z("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new ye(z.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Ss.setSinkID(this.getTrackId(),e)}async setEnabled(e,n,s){return this._setEnabled(e,n,s)}async _setEnabled(e,n,s){if(!s){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(N.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{s||(this._enabled=!0),await gn(this,Ve.NEED_ENABLE_TRACK,this),N.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(a){throw s||(this._enabled=!1),N.error("[".concat(this.getTrackId(),"] setEnabled to true error"),a.toString()),a}}else{this._originMediaStreamTrack.enabled=!1,s||(this._enabled=!1);try{await gn(this,Ve.NEED_DISABLE_TRACK,this)}catch(a){throw s||(this._enabled=!0),N.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,N.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await gn(this,Ve.NEED_MUTE_TRACK,this):await gn(this,Ve.NEED_UNMUTE_TRACK,this))}getStats(){return Xf(()=>{N.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),Qs(this,Ve.GET_STATS)||tk({},KN)}setAudioFrameCallback(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Us.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(n),this._source.removeAllListeners(Us.ON_AUDIO_BUFFER),this._source.on(Us.ON_AUDIO_BUFFER,s=>e(s))}play(){N.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(N.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Ss.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){N.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Ss.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];N.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Ss.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,n){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),n&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,Ve.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return pe.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new ye(z.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new ye(z.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const n=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(e){e.on(qi.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(n),await gn(this,Ve.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,Ve.NEED_REPLACE_TRACK,this))}),e.on(qi.ON_NODE,n=>{this._source.processedNode=n})}unbindProcessorDestinationEvents(e){e.removeAllListeners(qi.ON_TRACK),e.removeAllListeners(qi.ON_NODE)}bindProcessorContextEvents(e){e.on(js.REQUEST_CONSTRAINTS,async n=>{n(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(e){e.removeAllListeners(js.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof ek&&(this._trackSource=new W3(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new nV(this._source.context,this.getTrackId(),"local"),n=new tV(e);return this._processorContext=e,this._processorDestination=n,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(n),this._source.on(Us.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(Ss.stop(this.getTrackId()),this._source.play()),gn(this,Ve.NEED_REPLACE_MIXING_TRACK,this).then(()=>{N.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(s=>{N.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),s)})),{processorContext:e,processorDestination:n}}}be([it({argsMap:(i,e)=>[i.getTrackId(),e],throttleTime:300}),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",void 0)],ln.prototype,"setVolume",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],ln.prototype,"setPlaybackDevice",null),be([Qf("LocalAudioTrack","_enabledMutex"),it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Boolean,Object,Boolean]),$("design:returntype",pe)],ln.prototype,"setEnabled",null),be([Qf("LocalAudioTrack","_enabledMutex"),it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Boolean]),$("design:returntype",pe)],ln.prototype,"setMuted",null),be([ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",Object)],ln.prototype,"getStats",null),be([ur(),$("design:type",Function),$("design:paramtypes",[Object,Number]),$("design:returntype",void 0)],ln.prototype,"setAudioFrameCallback",null),be([it({argsMap:i=>[i.getTrackId()]}),ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ln.prototype,"play",null),be([it({argsMap:i=>[i.getTrackId()]}),ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ln.prototype,"stop",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ln.prototype,"close",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e.name]}),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Object)],ln.prototype,"pipe",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ln.prototype,"unpipe",null);class ap extends ln{get __className__(){return"MicrophoneAudioTrack"}constructor(e,n,s,a){super(e,n.encoderConfig?oT(n.encoderConfig):{},a,Z("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),R(this,"_config",void 0),R(this,"_deviceName","default"),R(this,"_constraints",void 0),R(this,"_originalConstraints",void 0),R(this,"_enabled",!0),this._config=n,this._constraints=s,this._originalConstraints=s,this._deviceName=e.label,typeof n.bypassWebAudio=="boolean"&&(this._bypassWebAudio=n.bypassWebAudio),(zf()||HO())&&cn.bindInterruptDetectorTrack(this)}async setDevice(e){if(N.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const n=await Ro.getDeviceById(e),s={};s.audio=tk({},this._constraints),s.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let a=null;try{a=await wo(s,this.getTrackId())}catch(l){throw N.error("[".concat(this.getTrackId(),"] setDevice failed"),l.toString()),a=await wo({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!1),this._deviceName=n.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(n){throw N.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}else try{const n=await Ro.getDeviceById(e);this._deviceName=n.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(n){throw N.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}N.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,n,s){if(n)return N.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!s){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(N.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){var a;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(a=this._source.clonedTrack)===null||a===void 0||a.stop(),s||(this._enabled=!1);try{await gn(this,Ve.NEED_DISABLE_TRACK,this)}catch(p){throw N.error("[".concat(this.getTrackId(),"] setEnabled false failed"),p.toString()),p}return}const l=tk({},this._constraints),u=Ro.searchDeviceIdByName(this._deviceName);u&&!l.deviceId&&(l.deviceId=u);try{s||(this._enabled=!0);const p=await wo({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(p.getAudioTracks()[0],!1),await gn(this,Ve.NEED_ENABLE_TRACK,this)}catch(p){throw s||(this._enabled=!1),N.error("[".concat(this.getTrackId(),"] setEnabled true failed"),p.toString()),p}N.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(zf()||HO())&&cn.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((ts()||nl())&&this._enabled&&!this._isClosed&&cn.duringInterruption){const e=async()=>{cn.off(Kr.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(N.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};cn.on(Kr.IOS_INTERRUPTION_END,e)}else N.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(yu.TRACK_ENDED)}async renewMediaStreamTrack(e){const n=e||this._constraints,s=Ro.searchDeviceIdByName(this._deviceName);if(s&&!n.deviceId&&(n.deviceId=s),this._constraints=n,this._enabled){this._originMediaStreamTrack.stop();const a=await wo({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(js.REQUEST_UPDATE_CONSTRAINTS,async(n,s,a)=>{try{const l=Object.assign({},this._originalConstraints,...n);await this.renewMediaStreamTrack(l),s()}catch(l){a(l)}})}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(js.REQUEST_UPDATE_CONSTRAINTS)}}be([it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],ap.prototype,"setDevice",null),be([Qf("MicrophoneAudioTrack","_enabledMutex"),it({argsMap:(i,e,n)=>[i.getTrackId(),e,n]}),ur(),$("design:type",Function),$("design:paramtypes",[Boolean,Boolean,Boolean]),$("design:returntype",pe)],ap.prototype,"setEnabled",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ap.prototype,"close",null);class bu extends ln{get __className__(){return"BufferSourceAudioTrack"}constructor(e,n,s,a){super(n.createOutputTrack(),s,a),R(this,"source",void 0),R(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=n,this._bufferSource.on(Us.AUDIO_SOURCE_STATE_CHANGE,l=>{this.safeEmit(yu.SOURCE_STATE_CHANGE,l)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){pn(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}be([it({argsMap:(i,e)=>[i.getTrackId(),e,i.duration]}),ur(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",void 0)],bu.prototype,"startProcessAudioBuffer",null),be([it({argsMap:i=>[i.getTrackId()]}),ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],bu.prototype,"pauseProcessAudioBuffer",null),be([it({argsMap:i=>[i.getTrackId()]}),ur(),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",void 0)],bu.prototype,"seekAudioBuffer",null),be([it({argsMap:i=>[i.getTrackId()]}),ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],bu.prototype,"resumeProcessAudioBuffer",null),be([it({argsMap:i=>[i.getTrackId()]}),ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],bu.prototype,"stopProcessAudioBuffer",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],bu.prototype,"close",null),be([it({argsMap:i=>[i.getTrackId()]}),ur(),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",void 0)],bu.prototype,"setAudioBufferPlaybackSpeed",null);class Nr extends ln{get __className__(){return"MixingAudioTrack"}get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=lm().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,Sn(8,"track-mix-")),R(this,"trackList",void 0),R(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return this.trackList.indexOf(e)!==-1}addAudioTrack(e){this.trackList.indexOf(e)===-1?(N.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):N.debug("track ".concat(e.getTrackId()," is already added"))}removeAudioTrack(e){if(this.trackList.indexOf(e)!==-1){N.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch{}kb(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach(n=>{n._encoderConfig&&((n._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=n._encoderConfig.bitrate),(n._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=n._encoderConfig.sampleRate),(n._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=n._encoderConfig.sampleSize),n._encoderConfig.stereo&&(e.stereo=!0))}),this._encoderConfig=e}_updateRtpTransceiver(e){this._rtpTransceiver!==e&&(this._rtpTransceiver=e,this.trackList.forEach(n=>{n instanceof Nr?n.emit(vu.TRANSCEIVER_UPDATED,e):n._updateRtpTransceiver(e)}))}}function lT(i){const e={};i.facingMode&&(e.facingMode=i.facingMode),i.cameraId&&(e.deviceId={exact:i.cameraId});const n=cl(i.encoderConfig);return n.width!=null&&(e.width=n.width),n.height!=null&&(e.height=n.height),!M5()&&n.frameRate&&(e.frameRate=n.frameRate),zt().name===Zt.EDGE&&typeof e.frameRate=="object"&&(e.frameRate.max=60),mn()&&(e.frameRate={ideal:30,max:30}),e}function iV(i){const e={};if(M5()||(i.AGC!==void 0&&(e.autoGainControl=i.AGC),i.AEC!==void 0&&(e.echoCancellation=i.AEC),i.ANS!==void 0&&(e.noiseSuppression=i.ANS,Xl()&&i.ANS&&(e.googHighpassFilter=i.ANS))),i.encoderConfig){const n=oT(i.encoderConfig);e.channelCount=n.stereo?2:1,e.sampleRate=n.sampleRate,e.sampleSize=n.sampleSize}return i.microphoneId&&(e.deviceId={exact:i.microphoneId}),Ob()&&(e.sampleRate=void 0),e}class use extends B3{set currentState(e){e!==this._currentState&&(this._currentState=e,this.safeEmit(Us.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),R(this,"audioBuffer",void 0),R(this,"sourceNode",void 0),R(this,"startPlayTime",0),R(this,"startPlayOffset",0),R(this,"pausePlayTime",0),R(this,"options",void 0),R(this,"currentLoopCount",0),R(this,"currentPlaybackSpeed",100),R(this,"_currentState","stopped"),this.audioBuffer=e,this.options=n,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(e){this.currentState==="stopped"?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):N.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=e,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(e){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=e/100),this.currentPlaybackSpeed=e}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e.playbackRate.value=this.currentPlaybackSpeed/100,e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const sV=new Map;async function hse(i,e){let n=null;if(typeof i=="string"){const a=sV.get(i);if(a)return N.debug("use cached audio resource: ",i),a;try{n=(await vc(()=>Ls.get(i,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(l){throw new ye(z.FETCH_AUDIO_FILE_FAILED,l.toString())}}else n=await new pe((l,u)=>{const p=new FileReader;p.onload=m=>{m.target?l(m.target.result):u(new ye(z.READ_LOCAL_AUDIO_FILE_ERROR))},p.onerror=()=>{u(new ye(z.READ_LOCAL_AUDIO_FILE_ERROR))},p.readAsArrayBuffer(i)});const s=await function(a){const l=lm();return new pe((u,p)=>{l.decodeAudioData(a,m=>{u(m)},m=>{p(new ye(z.DECODE_AUDIO_FILE_FAILED,m.toString()))})})}(n);return typeof i=="string"&&e&&sV.set(i,s),s}const nk=i=>{const e=document.createElement("canvas");return e.width=2,e.height=2,new pe((n,s)=>{e.toBlob(async a=>{if(e.remove(),a){const l=await oV(a);n({buffer:l,width:e.width,height:e.height})}else s(new ye(z.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},i,1)})},oV=async i=>{const e=await i.arrayBuffer();return new Uint8Array(e)};function aV(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function cV(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aV(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):aV(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class rk{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(N.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}get videoState(){return this._videoState}set videoState(e){var n;e!==this._videoState&&(N.debug("[".concat(this.trackId,"] video-status change ").concat(this._videoState," => ").concat(e)),this._videoState=e,(n=this.onVideoStateChanged)===null||n===void 0||n.call(this,this.videoState))}constructor(e){R(this,"trackId",void 0),R(this,"config",void 0),R(this,"onFirstVideoFrameDecoded",void 0),R(this,"onVideoStateChanged",void 0),R(this,"freezeTimeCounterList",[]),R(this,"renderFreezeAccTime",0),R(this,"isKeepLastFrame",!1),R(this,"timeUpdatedCount",0),R(this,"freezeTime",0),R(this,"playbackTime",0),R(this,"lastTimeUpdatedTime",0),R(this,"autoplayFailed",!1),R(this,"videoTrack",void 0),R(this,"videoElement",void 0),R(this,"cacheVideoElement",void 0),R(this,"_videoState",Aa.VideoStateStopped),R(this,"videoElementCheckInterval",void 0),R(this,"videoElementFreezeTimeout",void 0),R(this,"_videoElementStatus",Xi.NONE),R(this,"isGettingVideoDimensions",!1),R(this,"startGetVideoDimensions",()=>{const n=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return N.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(n,500)};!this.isGettingVideoDimensions&&n()}),R(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&cn.curState==="running"&&(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(O5())),D5()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),R(this,"handleVideoEvents",n=>{switch(n.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=Xi.PLAYING;break;case"loadeddata":if(this.videoState=Aa.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=Xi.CANPLAY;break;case"stalled":this.videoElementStatus=Xi.STALLED;break;case"suspend":this.videoElementStatus=Xi.SUSPEND;break;case"pause":this.videoElementStatus=Xi.PAUSED,ts()||nl()||vi()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=Xi.WAITING;break;case"abort":this.videoElementStatus=Xi.ABORT;break;case"ended":this.videoElementStatus=Xi.ENDED;break;case"emptied":this.videoElementStatus=Xi.EMPTIED;break;case"error":{this.videoElementStatus=Xi.ERROR;const s=this.videoElement.error;s&&N.error("[".concat(this.trackId,"] media error, code: ").concat(s.code,", message: ").concat(s.message));break}case"timeupdate":{const s=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=s);const a=s-this.lastTimeUpdatedTime,l=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=s,ad.lastVisibleTime<ad.lastHiddenTime||l<ad.lastHiddenTime||l<ad.lastVisibleTime)return;for(a>Z("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=a),this.playbackTime+=a;this.playbackTime>=6e3;){this.playbackTime-=6e3;const u=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(u),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),R(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(N.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(O5())),D5()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=e.trackId,this.config=e,e.element instanceof HTMLVideoElement?this.videoElement=e.element:this.videoElement=document.createElement("video"),cn.on(Kr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),cn.on(Kr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var e;return(e=this.videoElement.parentElement)!==null&&e!==void 0?e:void 0}updateConfig(e){this.config=e,this.trackId=e.trackId,e.element!==this.videoElement&&(this.destroy(),this.videoElement=e.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.initVideoElement())}play(e){const n=this.videoElement.play();n&&n.catch&&n.catch(a=>{e&&J3(e,"video",a.message,this.trackId),a.name==="NotAllowedError"?(N.warning("detected video element autoplay failed",a),this.autoplayFailed=!0,this.handleAutoPlayFailed()):N.warning("[".concat(this.trackId,"] play warning: "),a)});const s=zt();if((s.name==="Safari"&&Number(s.version)===15||zf())&&n&&n.then){const a=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};n.then(a).catch(a)}}getCurrentFrame(){const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const n=e.getContext("2d");if(!n)return N.error("create canvas context failed!"),new ImageData(2,2);n.drawImage(this.videoElement,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height);return e.remove(),s}async getCurrentFrameToUint8Array(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=document.createElement("canvas");s.width=this.videoElement.videoWidth,s.height=this.videoElement.videoHeight;const a=s.getContext("2d");return a?(a.drawImage(this.videoElement,0,0,s.width,s.height),new pe((l,u)=>{s.toBlob(async p=>{if(s.remove(),p){const m=await oV(p);l({buffer:m,width:s.width,height:s.height})}else u(new ye(z.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,n<0?.1:n>1?1:n)})):await nk(e)}destroy(){cn.off(Kr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),cn.off(Kr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=Aa.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=Xi.INIT,!this.videoElementCheckInterval&&(lV.forEach(l=>{this.videoElement.addEventListener(l,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(l){return l!==document.body&&document.body.contains(l)})(this.videoElement)||(this.videoElementStatus=Xi.DESTROYED)},1e3),Z("ENABLE_VIDEO_FRAME_CALLBACK"))){var e,n;let l;const u=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",u),this.videoElementFreezeTimeout=window.setTimeout(p,Z("VIDEO_FREEZE_DURATION")))},p=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===Aa.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=Aa.VideoStateFrozen:document.addEventListener("visibilitychange",u))},m=(g,E)=>{if(this.videoElementStatus===Xi.PLAYING){if(l){const I=E.presentationTime-l.presentationTime;this.videoState===Aa.VideoStateStarting&&(this.videoState=Aa.VideoStateDecoding),this.videoState===Aa.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(p,Z("VIDEO_FREEZE_DURATION"))),I<Z("VIDEO_FREEZE_DURATION")&&this.videoState===Aa.VideoStateFrozen&&(this.videoState=Aa.VideoStateDecoding),I>Z("VIDEO_FREEZE_DURATION")&&ad.lastVisibleTime>=ad.lastHiddenTime&&l.timestamp>ad.lastVisibleTime&&l.timestamp>ad.lastHiddenTime&&(this.renderFreezeAccTime+=I)}l=cV(cV({},E),{},{timestamp:g})}var y,C;Z("ENABLE_VIDEO_FRAME_CALLBACK")&&((y=(C=this.videoElement).requestVideoFrameCallback)===null||y===void 0||y.call(C,m))};(e=(n=this.videoElement).requestVideoFrameCallback)===null||e===void 0||e.call(n,m)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Ob()&&(this.videoElement.poster="noposter");const s=zt();s.name==="Safari"&&Number(s.version)===15||zf()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,mn()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,mn()&&this.videoElement.load());const a=this.videoElement.play();a!==void 0&&a.catch(l=>{N.debug("[".concat(this.trackId,"] playback interrupted"),l.toString())})}resetVideoElement(){lV.forEach(e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=Xi.NONE}handleAutoPlayFailed(){const e=n=>{n.preventDefault(),this.videoElement.play().then(()=>{N.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(s=>{N.error(s)}),this.autoplayFailed=!1,CE()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};CE()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),Y3()}}const lV=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class dV extends rk{constructor(e){super(e),R(this,"container",void 0),R(this,"slot",void 0),this.slot=e.element,this.updateConfig(e)}updateConfig(e){this.config=e,this.trackId=e.trackId;const n=e.element;n!==this.slot&&(this.destroy(),this.slot=n),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){var n;(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)&&super.play(e)}getCurrentFrame(){var e;return(e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(e){var n;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(e,s):await nk(e)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",Z("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var e;!this.container||(e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var e;if((e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var e;(e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}function uV(i){return new pe((e,n)=>{let s=!1;const a=document.createElement("video");a.setAttribute("autoplay",""),a.setAttribute("muted",""),a.muted=!0,a.autoplay=!0,a.setAttribute("playsinline",""),a.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(a);const l=ts()?"canplay":"playing";a.addEventListener(l,()=>{const u=a.videoWidth,p=a.videoHeight;!u&&mn()||(s=!0,a.srcObject=null,a.remove(),e([u,p]))}),a.srcObject=new MediaStream([i]),a.play().catch(Pb),setTimeout(()=>{s||(a.srcObject=null,a.remove(),e([a.videoWidth,a.videoHeight]))},4e3)})}const pse=async(i,e,n)=>{const s=function(u){const p=[];for(let m=0;m<u.length;m+=2)p.push(parseInt(u.slice(m,m+2),16));return Uint8Array.from(p)}(function(u){const p="0123456789abcdef";function m(Oe){let De,_t="";for(De=0;De<=3;De++)_t+=p.charAt(Oe>>8*De+4&15)+p.charAt(Oe>>8*De&15);return _t}function g(Oe,De){const _t=(65535&Oe)+(65535&De);return(Oe>>16)+(De>>16)+(_t>>16)<<16|65535&_t}function E(Oe,De,_t,Pt,Rn,kr){return g(function(xn,io){return xn<<io|xn>>>32-io}(g(g(De,Oe),g(Pt,kr)),Rn),_t)}function y(Oe,De,_t,Pt,Rn,kr,xn){return E(De&_t|~De&Pt,Oe,De,Rn,kr,xn)}function C(Oe,De,_t,Pt,Rn,kr,xn){return E(De&Pt|_t&~Pt,Oe,De,Rn,kr,xn)}function I(Oe,De,_t,Pt,Rn,kr,xn){return E(De^_t^Pt,Oe,De,Rn,kr,xn)}function j(Oe,De,_t,Pt,Rn,kr,xn){return E(_t^(De|~Pt),Oe,De,Rn,kr,xn)}const P=function(Oe){let De;const _t=1+(Oe.length+8>>6),Pt=new Array(16*_t);for(De=0;De<16*_t;De++)Pt[De]=0;for(De=0;De<Oe.length;De++)Pt[De>>2]|=Oe.charCodeAt(De)<<De%4*8;return Pt[De>>2]|=128<<De%4*8,Pt[16*_t-2]=8*Oe.length,Pt}(u);let U,q,J,se,he,ae=1732584193,de=-271733879,me=-1732584194,ge=271733878;for(U=0;U<P.length;U+=16)q=ae,J=de,se=me,he=ge,ae=y(ae,de,me,ge,P[U+0],7,-680876936),ge=y(ge,ae,de,me,P[U+1],12,-389564586),me=y(me,ge,ae,de,P[U+2],17,606105819),de=y(de,me,ge,ae,P[U+3],22,-1044525330),ae=y(ae,de,me,ge,P[U+4],7,-176418897),ge=y(ge,ae,de,me,P[U+5],12,1200080426),me=y(me,ge,ae,de,P[U+6],17,-1473231341),de=y(de,me,ge,ae,P[U+7],22,-45705983),ae=y(ae,de,me,ge,P[U+8],7,1770035416),ge=y(ge,ae,de,me,P[U+9],12,-1958414417),me=y(me,ge,ae,de,P[U+10],17,-42063),de=y(de,me,ge,ae,P[U+11],22,-1990404162),ae=y(ae,de,me,ge,P[U+12],7,1804603682),ge=y(ge,ae,de,me,P[U+13],12,-40341101),me=y(me,ge,ae,de,P[U+14],17,-1502002290),de=y(de,me,ge,ae,P[U+15],22,1236535329),ae=C(ae,de,me,ge,P[U+1],5,-165796510),ge=C(ge,ae,de,me,P[U+6],9,-1069501632),me=C(me,ge,ae,de,P[U+11],14,643717713),de=C(de,me,ge,ae,P[U+0],20,-373897302),ae=C(ae,de,me,ge,P[U+5],5,-701558691),ge=C(ge,ae,de,me,P[U+10],9,38016083),me=C(me,ge,ae,de,P[U+15],14,-660478335),de=C(de,me,ge,ae,P[U+4],20,-405537848),ae=C(ae,de,me,ge,P[U+9],5,568446438),ge=C(ge,ae,de,me,P[U+14],9,-1019803690),me=C(me,ge,ae,de,P[U+3],14,-187363961),de=C(de,me,ge,ae,P[U+8],20,1163531501),ae=C(ae,de,me,ge,P[U+13],5,-1444681467),ge=C(ge,ae,de,me,P[U+2],9,-51403784),me=C(me,ge,ae,de,P[U+7],14,1735328473),de=C(de,me,ge,ae,P[U+12],20,-1926607734),ae=I(ae,de,me,ge,P[U+5],4,-378558),ge=I(ge,ae,de,me,P[U+8],11,-2022574463),me=I(me,ge,ae,de,P[U+11],16,1839030562),de=I(de,me,ge,ae,P[U+14],23,-35309556),ae=I(ae,de,me,ge,P[U+1],4,-1530992060),ge=I(ge,ae,de,me,P[U+4],11,1272893353),me=I(me,ge,ae,de,P[U+7],16,-155497632),de=I(de,me,ge,ae,P[U+10],23,-1094730640),ae=I(ae,de,me,ge,P[U+13],4,681279174),ge=I(ge,ae,de,me,P[U+0],11,-358537222),me=I(me,ge,ae,de,P[U+3],16,-722521979),de=I(de,me,ge,ae,P[U+6],23,76029189),ae=I(ae,de,me,ge,P[U+9],4,-640364487),ge=I(ge,ae,de,me,P[U+12],11,-421815835),me=I(me,ge,ae,de,P[U+15],16,530742520),de=I(de,me,ge,ae,P[U+2],23,-995338651),ae=j(ae,de,me,ge,P[U+0],6,-198630844),ge=j(ge,ae,de,me,P[U+7],10,1126891415),me=j(me,ge,ae,de,P[U+14],15,-1416354905),de=j(de,me,ge,ae,P[U+5],21,-57434055),ae=j(ae,de,me,ge,P[U+12],6,1700485571),ge=j(ge,ae,de,me,P[U+3],10,-1894986606),me=j(me,ge,ae,de,P[U+10],15,-1051523),de=j(de,me,ge,ae,P[U+1],21,-2054922799),ae=j(ae,de,me,ge,P[U+8],6,1873313359),ge=j(ge,ae,de,me,P[U+15],10,-30611744),me=j(me,ge,ae,de,P[U+6],15,-1560198380),de=j(de,me,ge,ae,P[U+13],21,1309151649),ae=j(ae,de,me,ge,P[U+4],6,-145523070),ge=j(ge,ae,de,me,P[U+11],10,-1120210379),me=j(me,ge,ae,de,P[U+2],15,718787259),de=j(de,me,ge,ae,P[U+9],21,-343485551),ae=g(ae,q),de=g(de,J),me=g(me,se),ge=g(ge,he);return m(ae)+m(de)+m(me)+m(ge)}(""+e+n)).slice(0,16),a=s.slice(0,12),l=await window.crypto.subtle.importKey("raw",s,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:a},l,i))},hV=async(i,e,n)=>await pse(i.buffer,e,n);function pV(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Ao(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pV(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):pV(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class At extends Di{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Xi.PLAYING)}get processorContext(){return this._processorContext}set processorContext(e){this._processorContext=e}get __className__(){return"LocalVideoTrack"}constructor(e,n,s,a,l,u){if(super(e,l),R(this,"trackMediaType","video"),R(this,"_player",void 0),R(this,"isUseScaleResolutionDownBy",!1),R(this,"_videoVisibleTimer",null),R(this,"_statsTimer",null),R(this,"_previousVideoVisibleStatus",void 0),R(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),R(this,"_encoderConfig",void 0),R(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),R(this,"_optimizationMode",void 0),R(this,"_videoHeight",void 0),R(this,"_videoWidth",void 0),R(this,"_forceBitrateLimit",void 0),R(this,"_enabled",!0),R(this,"processorDestination",void 0),R(this,"_processorContext",void 0),vi()){const{width:p,height:m}=e.getSettings();this._videoWidth=p,this._videoHeight=m}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=n,this._scalabilityMode=s,this._optimizationMode=a,this._hints=u||[],this._hints.indexOf(wn.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(function(p,m,g){const E=zt();return!(E.name!==p||!E.osVersion)&&(g?Number(E.version)>=m&&Number(E.version)<=g:Number(E.version)===m)}(Zt.CHROME,115)&&Ib().indexOf("Windows")!==-1){const p=function(m,g){if("VideoFrame"in window&&"TransformStream"in window&&Kt().supportWebRTCInsertableStream){const E=new MediaStreamTrackProcessor(m),y=new MediaStreamTrackGenerator({kind:"video"});let C,I,j=Date.now();const P=()=>{U&&(clearInterval(U),U=void 0),C&&(C.close(),C=void 0),m.stop(),I=void 0,y.removeEventListener("ended",P)};let U=window.setInterval(()=>{if(I&&C&&Date.now()-j>(g??1e3))try{y.readyState==="live"?I.enqueue(C.clone()):P()}catch{P()}},g??1e3);const q=new TransformStream({transform:(J,se)=>{y.readyState==="live"?(I=se,j=Date.now(),C===void 0?(C=J,se.enqueue(J.clone())):(se.enqueue(C),C=J)):J.close()}});return y.addEventListener("ended",P),E.readable.pipeThrough(q).pipeTo(y.writable),y}}(e);p&&(N.info("local screen video track begin to inject frame"),this._mediaStreamTrack=p)}n&&this._hints.indexOf(wn.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(n),this._processorContext=new eV(this.getTrackId(),"local"),this.processorDestination=new Z3(this.processorContext),this.bindProcessorDestinationEvents()}play(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){const a=document.getElementById(e);a?e=a:(N.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}N.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(n));const s=Ao(Ao(Ao({},this._getDefaultPlayerConfig()),n),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(s):(e instanceof HTMLVideoElement?this._player=new rk(s):this._player=new dV(s),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const a=this.getVideoElementVisibleStatus();this.safeEmit(yu.VIDEO_ELEMENT_VISIBLE_STATUS,a)}catch{}},Z("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._statsTimer&&(this.isUseScaleResolutionDownBy=!1,window.clearInterval(this._statsTimer),this._statsTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,N.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(e,n){if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(N.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.enabled=!1;try{await gn(this,Ve.NEED_DISABLE_TRACK,this)}catch(s){throw N.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}return n||(this._enabled=!1),void N.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await gn(this,Ve.NEED_ENABLE_TRACK,this)}catch(s){throw N.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}N.info("[".concat(this.getTrackId(),"] setEnabled to true success")),n||(this._enabled=!0)}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,N.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await gn(this,Ve.NEED_MUTE_TRACK,this):await gn(this,Ve.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(e,n){if(!this._enabled)throw new ye(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(e==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),e=cl(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),e.width||e.height||e.frameRate){const s=lT({encoderConfig:e});(vi()||ts()||nl())&&(s.deviceId=void 0),N.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(s));try{await this._originMediaStreamTrack.applyConstraints(s),this.updateMediaStreamTrackResolution()}catch(a){const l=new ye(z.UNEXPECTED_ERROR,a.toString());throw N.error("[".concat(this.getTrackId(),"] applyConstraints error"),l.toString()),l}}this._encoderConfig=e,this._hints.indexOf(wn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await gn(this,Ve.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(N)}}getStats(){return Xf(()=>{N.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),Qs(this,Ve.GET_STATS)||Ao({},YN)}async setBeautyEffect(e){N.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(e,n):await nk(e)}async setBitrateLimit(e){if(N.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(e))),e){this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate);try{await gn(this,Ve.NEED_UPDATE_VIDEO_ENCODER,this)}catch(n){return n.throw(N)}}}async setOptimizationMode(e){if(e!=="motion"&&e!=="detail"&&e!=="balanced")return void N.error(z.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const n=this._optimizationMode;try{this._optimizationMode=e,await gn(this,Ve.SET_OPTIMIZATION_MODE,this)}catch(s){throw this._optimizationMode=n,N.error("[".concat(this.getTrackId(),"] set optimization mode failed"),s.toString()),s}N.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(e,")"))}setScalabiltyMode(e){if(e.numSpatialLayers===1&&e.numTemporalLayers!==1)return N.error(z.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=e,N.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(e,")"))}updateMediaStreamTrackResolution(){uV(this._originMediaStreamTrack).then(e=>{let[n,s]=e;this._videoHeight=s,this._videoWidth=n}).catch(Pb)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(e){if(!this._enabled)throw new ye(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");N.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(e)),e=cl(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),this._encoderConfig=e,this._hints.indexOf(wn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await gn(this,Ve.NEED_UPDATE_VIDEO_ENCODER,this)}catch(n){return n.throw(N)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:e,height:n,frameRate:s}=this.getMediaStreamTrackSettings();if(!e||!n||!s)return;const{bitrateMax:a,bitrateMin:l}=this._encoderConfig;if(l==null||a==null){const{max:u,min:p}=function(m,g,E,y,C){const I=Z("BITRATE_ADAPTER_TYPE");if(I==="DEFAULT_BITRATE")return{min:y,max:C};if(C===void 0){var j;const U=Math.floor(200*Math.pow(E/15,.6)*Math.pow(m*g/640/360,.75));C=I==="STANDARD_BITRATE"?4*U:2*U,y=(j=y)!==null&&j!==void 0?j:U}else{var P;y=(P=y)!==null&&P!==void 0?P:Math.floor(C/10)}return{min:y,max:C}}(e,n,s,l,a);this._encoderConfig.bitrateMin=p,this._encoderConfig.bitrateMax=u,N.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(e,", h: ").concat(n,", fps: ").concat(s,"] => [brMax: ").concat(u,", brMin: ").concat(p,"]"))}}getVideoElementVisibleStatus(){try{var e,n;const s=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),a={track:this,element:this==null||(n=this._player)===null||n===void 0?void 0:n.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:l,slot:u}=a;if(this.isPlaying&&l instanceof HTMLVideoElement&&u instanceof HTMLElement){const p=V5.checkOneElementVisible(l),m=Object.assign({},p);if(m.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=m.visible;const g=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});m.visible?g.onSuccess("Video is visible"):g.onSuccess("Invisible because of ".concat(m.reason))}return m}return}catch(s){throw new ye(z.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}async renewMediaStreamTrack(e){}pipe(e){if(this.processor===e)return e;if(e._source)throw new ye(z.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(e){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;e&&(s=Ao(Ao({},s),cl(e))),s=ep(s);const a=Sn(8,"track-video-cloned-"),l=new At(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,s,ep(this._scalabilityMode),this._optimizationMode,a,ep(this._hints));return e&&s&&l.setEncoderConfiguration(s),N.debug("clone video track from ".concat(this.getTrackId()," to ").concat(a,", clone ").concat(n)),l}async replaceTrack(e,n){if(!(e instanceof MediaStreamTrack))throw new ye(z.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(e.kind!=="video")throw new ye(z.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(e,n,!0),this.updateMediaStreamTrackResolution()}startMonitorStats(){if(!vi()&&!ts())return;this._statsTimer&&window.clearInterval(this._statsTimer);let e=2,n=iT[e],s=-1,a=Date.now();const l=u=>{u>2||u<0||(a=Date.now(),n=iT[u],this.setSenderConfiguration(n))};this.isUseScaleResolutionDownBy=!0,this._statsTimer=window.setInterval(()=>{const u=this.getStats(),p=Qs(this,Ve.GET_RTC_STATS);if(u.sendPackets>0&&p){s===-1&&(s=Date.now());const m=Date.now();if(m-s<1e3||m-a<Z("PROFILE_SWITCH_INTERVAL"))return;const g=u.sendFrameRate,E=.6*n.frameRate,y=.9*n.frameRate;typeof g=="number"&&g>0&&g<E?e>0&&(e--,l(e),N.debug("[".concat(this.getTrackId(),"] step down for fps ").concat(g,", switchProfile to ").concat(e))):p.OutgoingAvailableBandwidth<n.bitrateMin?e>0&&(e--,l(e),N.debug("[".concat(this.getTrackId(),"] step down for OutgoingAvailableBandwidth ").concat(p.OutgoingAvailableBandwidth,", bitrateMin ").concat(n.bitrateMin,", switchProfile to ").concat(e))):typeof g=="number"&&g>y&&e<iT.length-1&&p.OutgoingAvailableBandwidth>1.2*iT[e+1].bitrateMin&&(e++,l(e),N.debug("[".concat(this.getTrackId(),"] step up for fps ").concat(g,", OutgoingAvailableBandwidth ").concat(p.OutgoingAvailableBandwidth,", switchProfile to ").concat(e)))}},Z("CHECK_LOCAL_STATS_INTERVAL"))}sendSeiData(e){if(Xf(()=>{qe.reportApiInvoke(null,{name:br.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:Bn.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!Z("ENABLE_VIDEO_SEI")||!Z("ENABLE_ENCODED_TRANSFORM"))return void N.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(!(e instanceof Uint8Array))return new ye(z.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const n=this.getRTCRtpTransceiver();if(!n)return void N.warning("Video track is not published, SEI can not be send");const s=n.sender.getParameters();if(s.codecs.length===0)return;const a=s.codecs[0].mimeType.toLocaleLowerCase();a==="video/h264"?this.safeEmit("sei-to-send",e):N.warning("SEI is not supported by ".concat(a))}bindProcessorDestinationEvents(){this.processorDestination.on(qi.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await gn(this,Ve.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,Ve.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(qi.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(js.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(js.REQUEST_CONSTRAINTS)}}be([it({argsMap:(i,e,n)=>[i.getTrackId(),typeof e=="string"?e:e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),ur(),$("design:type",Function),$("design:paramtypes",[Object,Object]),$("design:returntype",void 0)],At.prototype,"play",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],At.prototype,"stop",null),be([Qf("LocalVideoTrack","_enabledMutex"),it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Boolean,Boolean]),$("design:returntype",pe)],At.prototype,"setEnabled",null),be([Qf("LocalVideoTrack","_enabledMutex"),it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Boolean]),$("design:returntype",pe)],At.prototype,"setMuted",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Object,Boolean]),$("design:returntype",pe)],At.prototype,"setEncoderConfiguration",null),be([ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",Object)],At.prototype,"getStats",null),be([it({argsMap:(i,e,n)=>[i.getTrackId(),e,n]}),ur(),$("design:type",Function),$("design:paramtypes",[Boolean,Object]),$("design:returntype",pe)],At.prototype,"setBeautyEffect",null),be([ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",ImageData)],At.prototype,"getCurrentFrameData",null),be([ur(),$("design:type",Function),$("design:paramtypes",[String,Number]),$("design:returntype",pe)],At.prototype,"getCurrentFrameImage",null),be([ur(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],At.prototype,"setBitrateLimit",null),be([ur(),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],At.prototype,"setOptimizationMode",null),be([ur(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",void 0)],At.prototype,"setScalabiltyMode",null),be([ur(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],At.prototype,"updateMediaStreamTrackResolution",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e.name]}),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Object)],At.prototype,"pipe",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],At.prototype,"unpipe",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],At.prototype,"close",null),be([it({argsMap:(i,e,n)=>[i.getTrackId(),e.label,n]}),$("design:type",Function),$("design:paramtypes",[MediaStreamTrack,Boolean]),$("design:returntype",pe)],At.prototype,"replaceTrack",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],At.prototype,"startMonitorStats",null);class Tu extends At{get __className__(){return"CameraVideoTrack"}constructor(e,n,s,a,l,u){super(e,cl(n.encoderConfig),a,l,u),R(this,"_config",void 0),R(this,"_originalConstraints",void 0),R(this,"_constraints",void 0),R(this,"_enabled",!0),R(this,"_deviceName","default"),R(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(zf()||HO())&&!function(){const p=zt();if(p.os!==Dr.IOS||!p.osVersion)return!1;const m=p.osVersion.split(".");return Number(m[0])===15&&Number(m[1])>=2}()&&L5()&&this._enabled&&!this._isClosed&&(N.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=n,this._originalConstraints=s,this._constraints=s,this._deviceName=e.label,this._encoderConfig=cl(this._config.encoderConfig),cn.on(Kr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),cn.on(Kr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(e){return typeof e=="string"?this._setDeviceById(e):e.deviceId?this._setDeviceById(e.deviceId):e.facingMode?this._setDeviceByFacingModel(e.facingMode):void 0}async _setDeviceById(e){if(N.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),this._enabled)try{const n=await Ro.getDeviceById(e),s={};s.video=Ao({},this._constraints),s.video.deviceId={exact:e},s.video.facingMode=void 0,this._originMediaStreamTrack.stop();let a=null;try{a=await wo(s,this.getTrackId())}catch(l){throw N.error("[".concat(this.getTrackId(),"] setDevice failed"),l.toString()),a=await wo({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=n.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(n){throw N.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}else try{const n=await Ro.getDeviceById(e);this._deviceName=n.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(n){throw N.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}N.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(e){N.info("[".concat(this.getTrackId(),"] set facingMode ").concat(e));const n={video:Ao(Ao({},this._constraints),{},{deviceId:void 0,facingMode:{exact:e}})};if(this._enabled){this._originMediaStreamTrack.stop();let s=null;try{s=await wo(n,this.getTrackId())}catch(a){throw N.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),a.toString()),s=await wo({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),a}await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=e,this._config.cameraId=void 0,this._constraints=Ao({},n.video),N.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(e,n){if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(N.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const s=await wo({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1)}await gn(this,Ve.NEED_ENABLE_TRACK,this)}catch(s){throw N.error("[".concat(this.getTrackId(),"] setEnabled true error"),s.toString()),s}this.updateMediaStreamTrackResolution(),N.info("[".concat(this.getTrackId(),"] setEnabled to true success")),n||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),n||(this._enabled=!1);try{await gn(this,Ve.NEED_DISABLE_TRACK,this)}catch(s){throw N.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}N.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(e,n){if(!this._enabled)throw new ye(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");e==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),e=cl(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin);const s=Cn(this._config);s.encoderConfig=e;const a=lT(s);(vi()||ts()||nl())&&(a.deviceId=void 0),N.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(a));try{await this._originMediaStreamTrack.applyConstraints(a),this.updateMediaStreamTrackResolution()}catch(l){const u=new ye(z.UNEXPECTED_ERROR,l.toString());throw N.error("[".concat(this.getTrackId(),"] applyConstraints error"),u.toString()),u}this._config=s,this._constraints=a,this._originalConstraints=a,this._encoderConfig=e,this._hints.indexOf(wn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await gn(this,Ve.NEED_UPDATE_VIDEO_ENCODER,this)}catch(l){return l.throw(N)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((ts()||nl())&&this._enabled&&!this._isClosed&&cn.duringInterruption){const e=async()=>{cn.off(Kr.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(N.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};cn.on(Kr.IOS_INTERRUPTION_END,e)}else N.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(yu.TRACK_ENDED)}async renewMediaStreamTrack(e){const n=e||this._constraints,s=Ro.searchDeviceIdByName(this._deviceName);if(s&&!n.deviceId&&(n.deviceId={exact:s}),this._enabled){const a=await wo({video:n},this.getTrackId());this._constraints=n,await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),cn.off(Kr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),cn.off(Kr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(e){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;e&&(s=Ao(Ao({},s),cl(e))),s=ep(s);const a=Sn(8,"track-cam-cloned-"),l=new Tu(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,ep(Ao(Ao({},this._config),{},{encoderConfig:s})),ep(this._constraints),ep(this._scalabilityMode),this._optimizationMode,a);return e&&s&&l.setEncoderConfiguration(s),N.debug("clone track from ".concat(this.getTrackId()," to ").concat(a,", clone ").concat(n)),l}bindProcessorContextEvents(){this.processorContext.on(js.REQUEST_UPDATE_CONSTRAINTS,async(e,n,s)=>{try{const a=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(a),n()}catch(a){s(a)}}),this.processorContext.on(js.REQUEST_CONSTRAINTS,async e=>{e(this._originMediaStreamTrack.getSettings())})}}function fV(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function dT(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?fV(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):fV(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function ik(i,e,n,s){n.optimizationMode&&(s&&s.width&&s.height?(n.encoderConfig=dT(dT({},s),{},{bitrateMin:s.bitrateMin,bitrateMax:s.bitrateMax}),n.optimizationMode!=="motion"&&n.optimizationMode!=="detail"||(e.contentHint=n.optimizationMode,e.contentHint===n.optimizationMode?N.debug("[".concat(i,"] set content hint to"),n.optimizationMode):N.debug("[".concat(i,"] set content hint failed")))):N.warning("[".concat(i,"] can not apply optimization mode bitrate config, no encoderConfig")))}function mV(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function uT(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?mV(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):mV(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}be([it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],Tu.prototype,"setDevice",null),be([Qf("CameraVideoTrack","_enabledMutex"),it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Boolean,Boolean]),$("design:returntype",pe)],Tu.prototype,"setEnabled",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e]}),ur(),$("design:type",Function),$("design:paramtypes",[Object,Boolean]),$("design:returntype",pe)],Tu.prototype,"setEncoderConfiguration",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],Tu.prototype,"close",null);class gV extends U3{getUserId(){return this._userId}constructor(e,n,s,a){super(e,"track-".concat(e.kind,"-").concat(n,"-").concat(a.clientId,"_").concat(Sn(5,""))),R(this,"_userId",void 0),R(this,"_uintId",void 0),R(this,"_isDestroyed",!1),R(this,"store",void 0),R(this,"processor",void 0),this._userId=n,this._uintId=s,this.store=a}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,N.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}class ll extends gV{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Xi.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,n,s,a){super(e,n,s,a),R(this,"_videoVisibleTimer",null),R(this,"_previousVideoVisibleStatus",void 0),R(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),R(this,"trackMediaType","video"),R(this,"_videoWidth",void 0),R(this,"_videoHeight",void 0),R(this,"_player",void 0),R(this,"processorDestination",void 0),R(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new eV(this.getTrackId(),"remote"),this.processorDestination=new Z3(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return Xf(()=>{N.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),Qs(this,Ve.GET_STATS)||uT({},M3)}play(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){const a=document.getElementById(e);a?e=a:(N.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}N.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(n));const s=uT(uT({fit:"cover"},n),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(s):(e instanceof HTMLVideoElement?this._player=new rk(s):this._player=new dV(s),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Su.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=a=>{this.safeEmit(Su.VIDEO_STATE_CHANGED,a)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const a=this.getVideoElementVisibleStatus();this.safeEmit(Su.VIDEO_ELEMENT_VISIBLE_STATUS,a)}catch{}},Z("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,N.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){uV(this._originMediaStreamTrack).then(e=>{let[n,s]=e;this._videoHeight=s,this._videoWidth=n}).catch(Pb)}_updatePlayerSource(){N.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,n;const s=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),a={track:this,element:this==null||(n=this._player)===null||n===void 0?void 0:n.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:l,slot:u}=a;if(this.isPlaying&&l instanceof HTMLVideoElement&&u instanceof HTMLElement){const p=V5.checkOneElementVisible(l),m=Object.assign({},p);if(m.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=m.visible;const g=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});m.visible?g.onSuccess("Video is visible"):g.onSuccess("Invisible because of ".concat(m.reason))}return m}return}catch(s){throw new ye(z.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new ye(z.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(qi.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(qi.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(vu.SEI_RECEIVED,e)}}be([it({argsMap:(i,e,n)=>[i.getTrackId(),typeof e=="string"?e:e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),$("design:type",Function),$("design:paramtypes",[Object,Object]),$("design:returntype",void 0)],ll.prototype,"play",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ll.prototype,"stop",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e.name]}),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Object)],ll.prototype,"pipe",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ll.prototype,"unpipe",null);class Oa extends gV{get isPlaying(){return this._useAudioElement?Ss.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,n,s,a){super(e,n,s,a),R(this,"trackMediaType","audio"),R(this,"_source",void 0),R(this,"_useAudioElement",!0),R(this,"_volume",100),R(this,"processorContext",void 0),R(this,"processorDestination",void 0),R(this,"_played",!1),R(this,"_bypassWebAudio",!1),Z("DISABLE_WEBAUDIO")?(this._source=new ek,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new W3(e,!0),Z("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Us.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Su.FIRST_FRAME_DECODED)}),this.processorContext=new nV(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new tV(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Us.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Us.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(n),this._source.removeAllListeners(Us.ON_AUDIO_BUFFER),this._source.on(Us.ON_AUDIO_BUFFER,s=>e(s))}setVolume(e){this._volume=e,this._useAudioElement?Ss.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!Xl()&&Z("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new ye(z.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Ss.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Xf(()=>{N.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),Qs(this,Ve.GET_STATS)||uT({},L3)}play(){N.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(N.debug("[".concat(this.getTrackId(),"] use audio element to play")),Ss.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){N.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Ss.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];N.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Ss.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new ye(z.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new ye(z.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new ye(z.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const n=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(qi.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(qi.ON_NODE,e=>{this._source.processedNode=e;const n=!e;this._useAudioElement!==n&&(this._played?(this.stop(),this._useAudioElement=n,this.play()):this._useAudioElement=n)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(qi.ON_TRACK),this.processorDestination.removeAllListeners(qi.ON_NODE)}}be([it({argsMap:(i,e)=>[i.getTrackId(),e],throttleTime:300}),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",void 0)],Oa.prototype,"setVolume",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e]}),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],Oa.prototype,"setPlaybackDevice",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],Oa.prototype,"play",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],Oa.prototype,"stop",null),be([it({argsMap:(i,e)=>[i.getTrackId(),e.name]}),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Object)],Oa.prototype,"pipe",null),be([it({argsMap:i=>[i.getTrackId()]}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],Oa.prototype,"unpipe",null);const ad=new class extends jn{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),R(this,"_lastHiddenTime",0),R(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),N.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function um(i){let e=i.length;for(;--e>=0;)i[e]=0}const sk=256,_V=286,jE=30,FE=15,ok=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),hT=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),fse=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),EV=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cd=new Array(576);um(cd);const VE=new Array(60);um(VE);const BE=new Array(512);um(BE);const WE=new Array(256);um(WE);const ak=new Array(29);um(ak);const pT=new Array(jE);function ck(i,e,n,s,a){this.static_tree=i,this.extra_bits=e,this.extra_base=n,this.elems=s,this.max_length=a,this.has_stree=i&&i.length}let vV,yV,SV;function lk(i,e){this.dyn_tree=i,this.max_code=0,this.stat_desc=e}um(pT);const bV=i=>i<256?BE[i]:BE[256+(i>>>7)],$E=(i,e)=>{i.pending_buf[i.pending++]=255&e,i.pending_buf[i.pending++]=e>>>8&255},Oo=(i,e,n)=>{i.bi_valid>16-n?(i.bi_buf|=e<<i.bi_valid&65535,$E(i,i.bi_buf),i.bi_buf=e>>16-i.bi_valid,i.bi_valid+=n-16):(i.bi_buf|=e<<i.bi_valid&65535,i.bi_valid+=n)},dl=(i,e,n)=>{Oo(i,n[2*e],n[2*e+1])},TV=(i,e)=>{let n=0;do n|=1&i,i>>>=1,n<<=1;while(--e>0);return n>>>1},CV=(i,e,n)=>{const s=new Array(16);let a,l,u=0;for(a=1;a<=FE;a++)u=u+n[a-1]<<1,s[a]=u;for(l=0;l<=e;l++){let p=i[2*l+1];p!==0&&(i[2*l]=TV(s[p]++,p))}},wV=i=>{let e;for(e=0;e<_V;e++)i.dyn_ltree[2*e]=0;for(e=0;e<jE;e++)i.dyn_dtree[2*e]=0;for(e=0;e<19;e++)i.bl_tree[2*e]=0;i.dyn_ltree[512]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},RV=i=>{i.bi_valid>8?$E(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},IV=(i,e,n,s)=>{const a=2*e,l=2*n;return i[a]<i[l]||i[a]===i[l]&&s[e]<=s[n]},dk=(i,e,n)=>{const s=i.heap[n];let a=n<<1;for(;a<=i.heap_len&&(a<i.heap_len&&IV(e,i.heap[a+1],i.heap[a],i.depth)&&a++,!IV(e,s,i.heap[a],i.depth));)i.heap[n]=i.heap[a],n=a,a<<=1;i.heap[n]=s},AV=(i,e,n)=>{let s,a,l,u,p=0;if(i.sym_next!==0)do s=255&i.pending_buf[i.sym_buf+p++],s+=(255&i.pending_buf[i.sym_buf+p++])<<8,a=i.pending_buf[i.sym_buf+p++],s===0?dl(i,a,e):(l=WE[a],dl(i,l+sk+1,e),u=ok[l],u!==0&&(a-=ak[l],Oo(i,a,u)),s--,l=bV(s),dl(i,l,n),u=hT[l],u!==0&&(s-=pT[l],Oo(i,s,u)));while(p<i.sym_next);dl(i,256,e)},uk=(i,e)=>{const n=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.has_stree,l=e.stat_desc.elems;let u,p,m,g=-1;for(i.heap_len=0,i.heap_max=573,u=0;u<l;u++)n[2*u]!==0?(i.heap[++i.heap_len]=g=u,i.depth[u]=0):n[2*u+1]=0;for(;i.heap_len<2;)m=i.heap[++i.heap_len]=g<2?++g:0,n[2*m]=1,i.depth[m]=0,i.opt_len--,a&&(i.static_len-=s[2*m+1]);for(e.max_code=g,u=i.heap_len>>1;u>=1;u--)dk(i,n,u);m=l;do u=i.heap[1],i.heap[1]=i.heap[i.heap_len--],dk(i,n,1),p=i.heap[1],i.heap[--i.heap_max]=u,i.heap[--i.heap_max]=p,n[2*m]=n[2*u]+n[2*p],i.depth[m]=(i.depth[u]>=i.depth[p]?i.depth[u]:i.depth[p])+1,n[2*u+1]=n[2*p+1]=m,i.heap[1]=m++,dk(i,n,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],((E,y)=>{const C=y.dyn_tree,I=y.max_code,j=y.stat_desc.static_tree,P=y.stat_desc.has_stree,U=y.stat_desc.extra_bits,q=y.stat_desc.extra_base,J=y.stat_desc.max_length;let se,he,ae,de,me,ge,Oe=0;for(de=0;de<=FE;de++)E.bl_count[de]=0;for(C[2*E.heap[E.heap_max]+1]=0,se=E.heap_max+1;se<573;se++)he=E.heap[se],de=C[2*C[2*he+1]+1]+1,de>J&&(de=J,Oe++),C[2*he+1]=de,he>I||(E.bl_count[de]++,me=0,he>=q&&(me=U[he-q]),ge=C[2*he],E.opt_len+=ge*(de+me),P&&(E.static_len+=ge*(j[2*he+1]+me)));if(Oe!==0){do{for(de=J-1;E.bl_count[de]===0;)de--;E.bl_count[de]--,E.bl_count[de+1]+=2,E.bl_count[J]--,Oe-=2}while(Oe>0);for(de=J;de!==0;de--)for(he=E.bl_count[de];he!==0;)ae=E.heap[--se],ae>I||(C[2*ae+1]!==de&&(E.opt_len+=(de-C[2*ae+1])*C[2*ae],C[2*ae+1]=de),he--)}})(i,e),CV(n,g,i.bl_count)},OV=(i,e,n)=>{let s,a,l=-1,u=e[1],p=0,m=7,g=4;for(u===0&&(m=138,g=3),e[2*(n+1)+1]=65535,s=0;s<=n;s++)a=u,u=e[2*(s+1)+1],++p<m&&a===u||(p<g?i.bl_tree[2*a]+=p:a!==0?(a!==l&&i.bl_tree[2*a]++,i.bl_tree[32]++):p<=10?i.bl_tree[34]++:i.bl_tree[36]++,p=0,l=a,u===0?(m=138,g=3):a===u?(m=6,g=3):(m=7,g=4))},NV=(i,e,n)=>{let s,a,l=-1,u=e[1],p=0,m=7,g=4;for(u===0&&(m=138,g=3),s=0;s<=n;s++)if(a=u,u=e[2*(s+1)+1],!(++p<m&&a===u)){if(p<g)do dl(i,a,i.bl_tree);while(--p!=0);else a!==0?(a!==l&&(dl(i,a,i.bl_tree),p--),dl(i,16,i.bl_tree),Oo(i,p-3,2)):p<=10?(dl(i,17,i.bl_tree),Oo(i,p-3,3)):(dl(i,18,i.bl_tree),Oo(i,p-11,7));p=0,l=a,u===0?(m=138,g=3):a===u?(m=6,g=3):(m=7,g=4)}};let kV=!1;const xV=(i,e,n,s)=>{Oo(i,0+(s?1:0),3),RV(i),$E(i,n),$E(i,~n),n&&i.pending_buf.set(i.window.subarray(e,e+n),i.pending),i.pending+=n};var mse=i=>{kV||((()=>{let e,n,s,a,l;const u=new Array(16);for(s=0,a=0;a<28;a++)for(ak[a]=s,e=0;e<1<<ok[a];e++)WE[s++]=a;for(WE[s-1]=a,l=0,a=0;a<16;a++)for(pT[a]=l,e=0;e<1<<hT[a];e++)BE[l++]=a;for(l>>=7;a<jE;a++)for(pT[a]=l<<7,e=0;e<1<<hT[a]-7;e++)BE[256+l++]=a;for(n=0;n<=FE;n++)u[n]=0;for(e=0;e<=143;)cd[2*e+1]=8,e++,u[8]++;for(;e<=255;)cd[2*e+1]=9,e++,u[9]++;for(;e<=279;)cd[2*e+1]=7,e++,u[7]++;for(;e<=287;)cd[2*e+1]=8,e++,u[8]++;for(CV(cd,287,u),e=0;e<jE;e++)VE[2*e+1]=5,VE[2*e]=TV(e,5);vV=new ck(cd,ok,257,_V,FE),yV=new ck(VE,hT,0,jE,FE),SV=new ck(new Array(0),fse,0,19,7)})(),kV=!0),i.l_desc=new lk(i.dyn_ltree,vV),i.d_desc=new lk(i.dyn_dtree,yV),i.bl_desc=new lk(i.bl_tree,SV),i.bi_buf=0,i.bi_valid=0,wV(i)},gse=(i,e,n,s)=>{let a,l,u=0;i.level>0?(i.strm.data_type===2&&(i.strm.data_type=(p=>{let m,g=4093624447;for(m=0;m<=31;m++,g>>>=1)if(1&g&&p.dyn_ltree[2*m]!==0)return 0;if(p.dyn_ltree[18]!==0||p.dyn_ltree[20]!==0||p.dyn_ltree[26]!==0)return 1;for(m=32;m<sk;m++)if(p.dyn_ltree[2*m]!==0)return 1;return 0})(i)),uk(i,i.l_desc),uk(i,i.d_desc),u=(p=>{let m;for(OV(p,p.dyn_ltree,p.l_desc.max_code),OV(p,p.dyn_dtree,p.d_desc.max_code),uk(p,p.bl_desc),m=18;m>=3&&p.bl_tree[2*EV[m]+1]===0;m--);return p.opt_len+=3*(m+1)+5+5+4,m})(i),a=i.opt_len+3+7>>>3,l=i.static_len+3+7>>>3,l<=a&&(a=l)):a=l=n+5,n+4<=a&&e!==-1?xV(i,e,n,s):i.strategy===4||l===a?(Oo(i,2+(s?1:0),3),AV(i,cd,VE)):(Oo(i,4+(s?1:0),3),((p,m,g,E)=>{let y;for(Oo(p,m-257,5),Oo(p,g-1,5),Oo(p,E-4,4),y=0;y<E;y++)Oo(p,p.bl_tree[2*EV[y]+1],3);NV(p,p.dyn_ltree,m-1),NV(p,p.dyn_dtree,g-1)})(i,i.l_desc.max_code+1,i.d_desc.max_code+1,u+1),AV(i,i.dyn_ltree,i.dyn_dtree)),wV(i),s&&RV(i)},_se=(i,e,n)=>(i.pending_buf[i.sym_buf+i.sym_next++]=e,i.pending_buf[i.sym_buf+i.sym_next++]=e>>8,i.pending_buf[i.sym_buf+i.sym_next++]=n,e===0?i.dyn_ltree[2*n]++:(i.matches++,e--,i.dyn_ltree[2*(WE[n]+sk+1)]++,i.dyn_dtree[2*bV(e)]++),i.sym_next===i.sym_end),Ese={_tr_init:mse,_tr_stored_block:xV,_tr_flush_block:gse,_tr_tally:_se,_tr_align:i=>{Oo(i,2,3),dl(i,256,cd),(e=>{e.bi_valid===16?($E(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(i)}},GE=(i,e,n,s)=>{let a=65535&i|0,l=i>>>16&65535|0,u=0;for(;n!==0;){u=n>2e3?2e3:n,n-=u;do a=a+e[s++]|0,l=l+a|0;while(--u);a%=65521,l%=65521}return a|l<<16|0};const vse=new Uint32Array((()=>{let i,e=[];for(var n=0;n<256;n++){i=n;for(var s=0;s<8;s++)i=1&i?3988292384^i>>>1:i>>>1;e[n]=i}return e})());var ps=(i,e,n,s)=>{const a=vse,l=s+n;i^=-1;for(let u=s;u<l;u++)i=i>>>8^a[255&(i^e[u])];return-1^i},cp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},hm={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:yse,_tr_stored_block:hk,_tr_flush_block:Sse,_tr_tally:Cu,_tr_align:bse}=Ese,{Z_NO_FLUSH:wu,Z_PARTIAL_FLUSH:Tse,Z_FULL_FLUSH:Cse,Z_FINISH:Na,Z_BLOCK:PV,Z_OK:bs,Z_STREAM_END:DV,Z_STREAM_ERROR:ul,Z_DATA_ERROR:wse,Z_BUF_ERROR:pk,Z_DEFAULT_COMPRESSION:Rse,Z_FILTERED:Ise,Z_HUFFMAN_ONLY:fT,Z_RLE:Ase,Z_FIXED:Ose,Z_DEFAULT_STRATEGY:Nse,Z_UNKNOWN:kse,Z_DEFLATED:mT}=hm,fk=286,xse=30,Pse=19,Dse=2*fk+1,Lse=15,lp=258,hl=262,pm=42,dp=113,HE=666,up=(i,e)=>(i.msg=cp[e],e),LV=i=>2*i-(i>4?9:0),Ru=i=>{let e=i.length;for(;--e>=0;)i[e]=0},Mse=i=>{let e,n,s,a=i.w_size;e=i.hash_size,s=e;do n=i.head[--s],i.head[s]=n>=a?n-a:0;while(--e);e=a,s=e;do n=i.prev[--s],i.prev[s]=n>=a?n-a:0;while(--e)};let Iu=(i,e,n)=>(e<<i.hash_shift^n)&i.hash_mask;const Zo=i=>{const e=i.state;let n=e.pending;n>i.avail_out&&(n=i.avail_out),n!==0&&(i.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),i.next_out),i.next_out+=n,e.pending_out+=n,i.total_out+=n,i.avail_out-=n,e.pending-=n,e.pending===0&&(e.pending_out=0))},ea=(i,e)=>{Sse(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,e),i.block_start=i.strstart,Zo(i.strm)},ir=(i,e)=>{i.pending_buf[i.pending++]=e},zE=(i,e)=>{i.pending_buf[i.pending++]=e>>>8&255,i.pending_buf[i.pending++]=255&e},mk=(i,e,n,s)=>{let a=i.avail_in;return a>s&&(a=s),a===0?0:(i.avail_in-=a,e.set(i.input.subarray(i.next_in,i.next_in+a),n),i.state.wrap===1?i.adler=GE(i.adler,e,a,n):i.state.wrap===2&&(i.adler=ps(i.adler,e,a,n)),i.next_in+=a,i.total_in+=a,a)},MV=(i,e)=>{let n,s,a=i.max_chain_length,l=i.strstart,u=i.prev_length,p=i.nice_match;const m=i.strstart>i.w_size-hl?i.strstart-(i.w_size-hl):0,g=i.window,E=i.w_mask,y=i.prev,C=i.strstart+lp;let I=g[l+u-1],j=g[l+u];i.prev_length>=i.good_match&&(a>>=2),p>i.lookahead&&(p=i.lookahead);do if(n=e,g[n+u]===j&&g[n+u-1]===I&&g[n]===g[l]&&g[++n]===g[l+1]){l+=2,n++;do;while(g[++l]===g[++n]&&g[++l]===g[++n]&&g[++l]===g[++n]&&g[++l]===g[++n]&&g[++l]===g[++n]&&g[++l]===g[++n]&&g[++l]===g[++n]&&g[++l]===g[++n]&&l<C);if(s=lp-(C-l),l=C-lp,s>u){if(i.match_start=e,u=s,s>=p)break;I=g[l+u-1],j=g[l+u]}}while((e=y[e&E])>m&&--a!=0);return u<=i.lookahead?u:i.lookahead},fm=i=>{const e=i.w_size;let n,s,a;do{if(s=i.window_size-i.lookahead-i.strstart,i.strstart>=e+(e-hl)&&(i.window.set(i.window.subarray(e,e+e-s),0),i.match_start-=e,i.strstart-=e,i.block_start-=e,i.insert>i.strstart&&(i.insert=i.strstart),Mse(i),s+=e),i.strm.avail_in===0)break;if(n=mk(i.strm,i.window,i.strstart+i.lookahead,s),i.lookahead+=n,i.lookahead+i.insert>=3)for(a=i.strstart-i.insert,i.ins_h=i.window[a],i.ins_h=Iu(i,i.ins_h,i.window[a+1]);i.insert&&(i.ins_h=Iu(i,i.ins_h,i.window[a+3-1]),i.prev[a&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=a,a++,i.insert--,!(i.lookahead+i.insert<3)););}while(i.lookahead<hl&&i.strm.avail_in!==0)},UV=(i,e)=>{let n,s,a,l=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,u=0,p=i.strm.avail_in;do{if(n=65535,a=i.bi_valid+42>>3,i.strm.avail_out<a||(a=i.strm.avail_out-a,s=i.strstart-i.block_start,n>s+i.strm.avail_in&&(n=s+i.strm.avail_in),n>a&&(n=a),n<l&&(n===0&&e!==Na||e===wu||n!==s+i.strm.avail_in)))break;u=e===Na&&n===s+i.strm.avail_in?1:0,hk(i,0,0,u),i.pending_buf[i.pending-4]=n,i.pending_buf[i.pending-3]=n>>8,i.pending_buf[i.pending-2]=~n,i.pending_buf[i.pending-1]=~n>>8,Zo(i.strm),s&&(s>n&&(s=n),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+s),i.strm.next_out),i.strm.next_out+=s,i.strm.avail_out-=s,i.strm.total_out+=s,i.block_start+=s,n-=s),n&&(mk(i.strm,i.strm.output,i.strm.next_out,n),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n)}while(u===0);return p-=i.strm.avail_in,p&&(p>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=p&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-p,i.strm.next_in),i.strstart),i.strstart+=p,i.insert+=p>i.w_size-i.insert?i.w_size-i.insert:p),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),u?4:e!==wu&&e!==Na&&i.strm.avail_in===0&&i.strstart===i.block_start?2:(a=i.window_size-i.strstart,i.strm.avail_in>a&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,a+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),a>i.strm.avail_in&&(a=i.strm.avail_in),a&&(mk(i.strm,i.window,i.strstart,a),i.strstart+=a,i.insert+=a>i.w_size-i.insert?i.w_size-i.insert:a),i.high_water<i.strstart&&(i.high_water=i.strstart),a=i.bi_valid+42>>3,a=i.pending_buf_size-a>65535?65535:i.pending_buf_size-a,l=a>i.w_size?i.w_size:a,s=i.strstart-i.block_start,(s>=l||(s||e===Na)&&e!==wu&&i.strm.avail_in===0&&s<=a)&&(n=s>a?a:s,u=e===Na&&i.strm.avail_in===0&&n===s?1:0,hk(i,i.block_start,n,u),i.block_start+=n,Zo(i.strm)),u?3:1)},gk=(i,e)=>{let n,s;for(;;){if(i.lookahead<hl){if(fm(i),i.lookahead<hl&&e===wu)return 1;if(i.lookahead===0)break}if(n=0,i.lookahead>=3&&(i.ins_h=Iu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),n!==0&&i.strstart-n<=i.w_size-hl&&(i.match_length=MV(i,n)),i.match_length>=3)if(s=Cu(i,i.strstart-i.match_start,i.match_length-3),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=3){i.match_length--;do i.strstart++,i.ins_h=Iu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!=0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Iu(i,i.ins_h,i.window[i.strstart+1]);else s=Cu(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(s&&(ea(i,!1),i.strm.avail_out===0))return 1}return i.insert=i.strstart<2?i.strstart:2,e===Na?(ea(i,!0),i.strm.avail_out===0?3:4):i.sym_next&&(ea(i,!1),i.strm.avail_out===0)?1:2},mm=(i,e)=>{let n,s,a;for(;;){if(i.lookahead<hl){if(fm(i),i.lookahead<hl&&e===wu)return 1;if(i.lookahead===0)break}if(n=0,i.lookahead>=3&&(i.ins_h=Iu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=2,n!==0&&i.prev_length<i.max_lazy_match&&i.strstart-n<=i.w_size-hl&&(i.match_length=MV(i,n),i.match_length<=5&&(i.strategy===Ise||i.match_length===3&&i.strstart-i.match_start>4096)&&(i.match_length=2)),i.prev_length>=3&&i.match_length<=i.prev_length){a=i.strstart+i.lookahead-3,s=Cu(i,i.strstart-1-i.prev_match,i.prev_length-3),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=a&&(i.ins_h=Iu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!=0);if(i.match_available=0,i.match_length=2,i.strstart++,s&&(ea(i,!1),i.strm.avail_out===0))return 1}else if(i.match_available){if(s=Cu(i,0,i.window[i.strstart-1]),s&&ea(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return 1}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(s=Cu(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<2?i.strstart:2,e===Na?(ea(i,!0),i.strm.avail_out===0?3:4):i.sym_next&&(ea(i,!1),i.strm.avail_out===0)?1:2};function pl(i,e,n,s,a){this.good_length=i,this.max_lazy=e,this.nice_length=n,this.max_chain=s,this.func=a}const KE=[new pl(0,0,0,0,UV),new pl(4,4,8,4,gk),new pl(4,5,16,8,gk),new pl(4,6,32,32,gk),new pl(4,4,16,16,mm),new pl(8,16,32,32,mm),new pl(8,16,128,128,mm),new pl(8,32,128,256,mm),new pl(32,128,258,1024,mm),new pl(32,258,258,4096,mm)];function Use(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=mT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Dse),this.dyn_dtree=new Uint16Array(2*(2*xse+1)),this.bl_tree=new Uint16Array(2*(2*Pse+1)),Ru(this.dyn_ltree),Ru(this.dyn_dtree),Ru(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Lse+1),this.heap=new Uint16Array(2*fk+1),Ru(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*fk+1),Ru(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const YE=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.status!==pm&&e.status!==57&&e.status!==69&&e.status!==73&&e.status!==91&&e.status!==103&&e.status!==dp&&e.status!==HE?1:0},jV=i=>{if(YE(i))return up(i,ul);i.total_in=i.total_out=0,i.data_type=kse;const e=i.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?57:e.wrap?pm:dp,i.adler=e.wrap===2?0:1,e.last_flush=-2,yse(e),bs},FV=i=>{const e=jV(i);var n;return e===bs&&((n=i.state).window_size=2*n.w_size,Ru(n.head),n.max_lazy_match=KE[n.level].max_lazy,n.good_match=KE[n.level].good_length,n.nice_match=KE[n.level].nice_length,n.max_chain_length=KE[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),e},VV=(i,e,n,s,a,l)=>{if(!i)return ul;let u=1;if(e===Rse&&(e=6),s<0?(u=0,s=-s):s>15&&(u=2,s-=16),a<1||a>9||n!==mT||s<8||s>15||e<0||e>9||l<0||l>Ose||s===8&&u!==1)return up(i,ul);s===8&&(s=9);const p=new Use;return i.state=p,p.strm=i,p.status=pm,p.wrap=u,p.gzhead=null,p.w_bits=s,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=a+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+3-1)/3),p.window=new Uint8Array(2*p.w_size),p.head=new Uint16Array(p.hash_size),p.prev=new Uint16Array(p.w_size),p.lit_bufsize=1<<a+6,p.pending_buf_size=4*p.lit_bufsize,p.pending_buf=new Uint8Array(p.pending_buf_size),p.sym_buf=p.lit_bufsize,p.sym_end=3*(p.lit_bufsize-1),p.level=e,p.strategy=l,p.method=n,FV(i)};var jse=(i,e)=>{if(YE(i)||e>PV||e<0)return i?up(i,ul):ul;const n=i.state;if(!i.output||i.avail_in!==0&&!i.input||n.status===HE&&e!==Na)return up(i,i.avail_out===0?pk:ul);const s=n.last_flush;if(n.last_flush=e,n.pending!==0){if(Zo(i),i.avail_out===0)return n.last_flush=-1,bs}else if(i.avail_in===0&&LV(e)<=LV(s)&&e!==Na)return up(i,pk);if(n.status===HE&&i.avail_in!==0)return up(i,pk);if(n.status===pm&&n.wrap===0&&(n.status=dp),n.status===pm){let a=mT+(n.w_bits-8<<4)<<8,l=-1;if(l=n.strategy>=fT||n.level<2?0:n.level<6?1:n.level===6?2:3,a|=l<<6,n.strstart!==0&&(a|=32),a+=31-a%31,zE(n,a),n.strstart!==0&&(zE(n,i.adler>>>16),zE(n,65535&i.adler)),i.adler=1,n.status=dp,Zo(i),n.pending!==0)return n.last_flush=-1,bs}if(n.status===57){if(i.adler=0,ir(n,31),ir(n,139),ir(n,8),n.gzhead)ir(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ir(n,255&n.gzhead.time),ir(n,n.gzhead.time>>8&255),ir(n,n.gzhead.time>>16&255),ir(n,n.gzhead.time>>24&255),ir(n,n.level===9?2:n.strategy>=fT||n.level<2?4:0),ir(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(ir(n,255&n.gzhead.extra.length),ir(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(i.adler=ps(i.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(ir(n,0),ir(n,0),ir(n,0),ir(n,0),ir(n,0),ir(n,n.level===9?2:n.strategy>=fT||n.level<2?4:0),ir(n,3),n.status=dp,Zo(i),n.pending!==0)return n.last_flush=-1,bs}if(n.status===69){if(n.gzhead.extra){let a=n.pending,l=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+l>n.pending_buf_size;){let p=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+p),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>a&&(i.adler=ps(i.adler,n.pending_buf,n.pending-a,a)),n.gzindex+=p,Zo(i),n.pending!==0)return n.last_flush=-1,bs;a=0,l-=p}let u=new Uint8Array(n.gzhead.extra);n.pending_buf.set(u.subarray(n.gzindex,n.gzindex+l),n.pending),n.pending+=l,n.gzhead.hcrc&&n.pending>a&&(i.adler=ps(i.adler,n.pending_buf,n.pending-a,a)),n.gzindex=0}n.status=73}if(n.status===73){if(n.gzhead.name){let a,l=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>l&&(i.adler=ps(i.adler,n.pending_buf,n.pending-l,l)),Zo(i),n.pending!==0)return n.last_flush=-1,bs;l=0}a=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,ir(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>l&&(i.adler=ps(i.adler,n.pending_buf,n.pending-l,l)),n.gzindex=0}n.status=91}if(n.status===91){if(n.gzhead.comment){let a,l=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>l&&(i.adler=ps(i.adler,n.pending_buf,n.pending-l,l)),Zo(i),n.pending!==0)return n.last_flush=-1,bs;l=0}a=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,ir(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>l&&(i.adler=ps(i.adler,n.pending_buf,n.pending-l,l))}n.status=103}if(n.status===103){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Zo(i),n.pending!==0))return n.last_flush=-1,bs;ir(n,255&i.adler),ir(n,i.adler>>8&255),i.adler=0}if(n.status=dp,Zo(i),n.pending!==0)return n.last_flush=-1,bs}if(i.avail_in!==0||n.lookahead!==0||e!==wu&&n.status!==HE){let a=n.level===0?UV(n,e):n.strategy===fT?((l,u)=>{let p;for(;;){if(l.lookahead===0&&(fm(l),l.lookahead===0)){if(u===wu)return 1;break}if(l.match_length=0,p=Cu(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++,p&&(ea(l,!1),l.strm.avail_out===0))return 1}return l.insert=0,u===Na?(ea(l,!0),l.strm.avail_out===0?3:4):l.sym_next&&(ea(l,!1),l.strm.avail_out===0)?1:2})(n,e):n.strategy===Ase?((l,u)=>{let p,m,g,E;const y=l.window;for(;;){if(l.lookahead<=lp){if(fm(l),l.lookahead<=lp&&u===wu)return 1;if(l.lookahead===0)break}if(l.match_length=0,l.lookahead>=3&&l.strstart>0&&(g=l.strstart-1,m=y[g],m===y[++g]&&m===y[++g]&&m===y[++g])){E=l.strstart+lp;do;while(m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&g<E);l.match_length=lp-(E-g),l.match_length>l.lookahead&&(l.match_length=l.lookahead)}if(l.match_length>=3?(p=Cu(l,1,l.match_length-3),l.lookahead-=l.match_length,l.strstart+=l.match_length,l.match_length=0):(p=Cu(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++),p&&(ea(l,!1),l.strm.avail_out===0))return 1}return l.insert=0,u===Na?(ea(l,!0),l.strm.avail_out===0?3:4):l.sym_next&&(ea(l,!1),l.strm.avail_out===0)?1:2})(n,e):KE[n.level].func(n,e);if(a!==3&&a!==4||(n.status=HE),a===1||a===3)return i.avail_out===0&&(n.last_flush=-1),bs;if(a===2&&(e===Tse?bse(n):e!==PV&&(hk(n,0,0,!1),e===Cse&&(Ru(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Zo(i),i.avail_out===0))return n.last_flush=-1,bs}return e!==Na?bs:n.wrap<=0?DV:(n.wrap===2?(ir(n,255&i.adler),ir(n,i.adler>>8&255),ir(n,i.adler>>16&255),ir(n,i.adler>>24&255),ir(n,255&i.total_in),ir(n,i.total_in>>8&255),ir(n,i.total_in>>16&255),ir(n,i.total_in>>24&255)):(zE(n,i.adler>>>16),zE(n,65535&i.adler)),Zo(i),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?bs:DV)},Fse=(i,e)=>{let n=e.length;if(YE(i))return ul;const s=i.state,a=s.wrap;if(a===2||a===1&&s.status!==pm||s.lookahead)return ul;if(a===1&&(i.adler=GE(i.adler,e,n,0)),s.wrap=0,n>=s.w_size){a===0&&(Ru(s.head),s.strstart=0,s.block_start=0,s.insert=0);let m=new Uint8Array(s.w_size);m.set(e.subarray(n-s.w_size,n),0),e=m,n=s.w_size}const l=i.avail_in,u=i.next_in,p=i.input;for(i.avail_in=n,i.next_in=0,i.input=e,fm(s);s.lookahead>=3;){let m=s.strstart,g=s.lookahead-2;do s.ins_h=Iu(s,s.ins_h,s.window[m+3-1]),s.prev[m&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=m,m++;while(--g);s.strstart=m,s.lookahead=2,fm(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,i.next_in=u,i.input=p,i.avail_in=l,s.wrap=a,bs},qE={deflateInit:(i,e)=>VV(i,e,mT,15,8,Nse),deflateInit2:VV,deflateReset:FV,deflateResetKeep:jV,deflateSetHeader:(i,e)=>YE(i)||i.state.wrap!==2?ul:(i.state.gzhead=e,bs),deflate:jse,deflateEnd:i=>{if(YE(i))return ul;const e=i.state.status;return i.state=null,e===dp?up(i,wse):bs},deflateSetDictionary:Fse,deflateInfo:"pako deflate (from Nodeca project)"};const Vse=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var gT={assign:function(i){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const s in n)Vse(n,s)&&(i[s]=n[s])}}return i},flattenChunks:i=>{let e=0;for(let s=0,a=i.length;s<a;s++)e+=i[s].length;const n=new Uint8Array(e);for(let s=0,a=0,l=i.length;s<l;s++){let u=i[s];n.set(u,a),a+=u.length}return n}};let BV=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{BV=!1}const XE=new Uint8Array(256);for(let i=0;i<256;i++)XE[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;XE[254]=XE[254]=1;var JE={string2buf:i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,n,s,a,l,u=i.length,p=0;for(a=0;a<u;a++)n=i.charCodeAt(a),(64512&n)==55296&&a+1<u&&(s=i.charCodeAt(a+1),(64512&s)==56320&&(n=65536+(n-55296<<10)+(s-56320),a++)),p+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(p),l=0,a=0;l<p;a++)n=i.charCodeAt(a),(64512&n)==55296&&a+1<u&&(s=i.charCodeAt(a+1),(64512&s)==56320&&(n=65536+(n-55296<<10)+(s-56320),a++)),n<128?e[l++]=n:n<2048?(e[l++]=192|n>>>6,e[l++]=128|63&n):n<65536?(e[l++]=224|n>>>12,e[l++]=128|n>>>6&63,e[l++]=128|63&n):(e[l++]=240|n>>>18,e[l++]=128|n>>>12&63,e[l++]=128|n>>>6&63,e[l++]=128|63&n);return e},buf2string:(i,e)=>{const n=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let s,a;const l=new Array(2*n);for(a=0,s=0;s<n;){let u=i[s++];if(u<128){l[a++]=u;continue}let p=XE[u];if(p>4)l[a++]=65533,s+=p-1;else{for(u&=p===2?31:p===3?15:7;p>1&&s<n;)u=u<<6|63&i[s++],p--;p>1?l[a++]=65533:u<65536?l[a++]=u:(u-=65536,l[a++]=55296|u>>10&1023,l[a++]=56320|1023&u)}}return((u,p)=>{if(p<65534&&u.subarray&&BV)return String.fromCharCode.apply(null,u.length===p?u:u.subarray(0,p));let m="";for(let g=0;g<p;g++)m+=String.fromCharCode(u[g]);return m})(l,a)},utf8border:(i,e)=>{(e=e||i.length)>i.length&&(e=i.length);let n=e-1;for(;n>=0&&(192&i[n])==128;)n--;return n<0||n===0?e:n+XE[i[n]]>e?n:e}},WV=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const $V=Object.prototype.toString,{Z_NO_FLUSH:Bse,Z_SYNC_FLUSH:Wse,Z_FULL_FLUSH:$se,Z_FINISH:Gse,Z_OK:_T,Z_STREAM_END:Hse,Z_DEFAULT_COMPRESSION:zse,Z_DEFAULT_STRATEGY:Kse,Z_DEFLATED:Yse}=hm;function QE(i){this.options=gT.assign({level:zse,method:Yse,chunkSize:16384,windowBits:15,memLevel:8,strategy:Kse},i||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WV,this.strm.avail_out=0;let n=qE.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==_T)throw new Error(cp[n]);if(e.header&&qE.deflateSetHeader(this.strm,e.header),e.dictionary){let s;if(s=typeof e.dictionary=="string"?JE.string2buf(e.dictionary):$V.call(e.dictionary)==="[object ArrayBuffer]"?new Uint8Array(e.dictionary):e.dictionary,n=qE.deflateSetDictionary(this.strm,s),n!==_T)throw new Error(cp[n]);this._dict_set=!0}}function _k(i,e){const n=new QE(e);if(n.push(i,!0),n.err)throw n.msg||cp[n.err];return n.result}QE.prototype.push=function(i,e){const n=this.strm,s=this.options.chunkSize;let a,l;if(this.ended)return!1;for(l=e===~~e?e:e===!0?Gse:Bse,typeof i=="string"?n.input=JE.string2buf(i):$V.call(i)==="[object ArrayBuffer]"?n.input=new Uint8Array(i):n.input=i,n.next_in=0,n.avail_in=n.input.length;;)if(n.avail_out===0&&(n.output=new Uint8Array(s),n.next_out=0,n.avail_out=s),(l===Wse||l===$se)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(a=qE.deflate(n,l),a===Hse)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),a=qE.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===_T;if(n.avail_out!==0){if(l>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(n.avail_in===0)break}else this.onData(n.output)}return!0},QE.prototype.onData=function(i){this.chunks.push(i)},QE.prototype.onEnd=function(i){i===_T&&(this.result=gT.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};var qse={Deflate:QE,deflate:_k,deflateRaw:function(i,e){return(e=e||{}).raw=!0,_k(i,e)},gzip:function(i,e){return(e=e||{}).gzip=!0,_k(i,e)},constants:hm};const ET=16209;var Xse=function(i,e){let n,s,a,l,u,p,m,g,E,y,C,I,j,P,U,q,J,se,he,ae,de,me,ge,Oe;const De=i.state;n=i.next_in,ge=i.input,s=n+(i.avail_in-5),a=i.next_out,Oe=i.output,l=a-(e-i.avail_out),u=a+(i.avail_out-257),p=De.dmax,m=De.wsize,g=De.whave,E=De.wnext,y=De.window,C=De.hold,I=De.bits,j=De.lencode,P=De.distcode,U=(1<<De.lenbits)-1,q=(1<<De.distbits)-1;e:do{I<15&&(C+=ge[n++]<<I,I+=8,C+=ge[n++]<<I,I+=8),J=j[C&U];t:for(;;){if(se=J>>>24,C>>>=se,I-=se,se=J>>>16&255,se===0)Oe[a++]=65535&J;else{if(!(16&se)){if(!(64&se)){J=j[(65535&J)+(C&(1<<se)-1)];continue t}if(32&se){De.mode=16191;break e}i.msg="invalid literal/length code",De.mode=ET;break e}he=65535&J,se&=15,se&&(I<se&&(C+=ge[n++]<<I,I+=8),he+=C&(1<<se)-1,C>>>=se,I-=se),I<15&&(C+=ge[n++]<<I,I+=8,C+=ge[n++]<<I,I+=8),J=P[C&q];n:for(;;){if(se=J>>>24,C>>>=se,I-=se,se=J>>>16&255,!(16&se)){if(!(64&se)){J=P[(65535&J)+(C&(1<<se)-1)];continue n}i.msg="invalid distance code",De.mode=ET;break e}if(ae=65535&J,se&=15,I<se&&(C+=ge[n++]<<I,I+=8,I<se&&(C+=ge[n++]<<I,I+=8)),ae+=C&(1<<se)-1,ae>p){i.msg="invalid distance too far back",De.mode=ET;break e}if(C>>>=se,I-=se,se=a-l,ae>se){if(se=ae-se,se>g&&De.sane){i.msg="invalid distance too far back",De.mode=ET;break e}if(de=0,me=y,E===0){if(de+=m-se,se<he){he-=se;do Oe[a++]=y[de++];while(--se);de=a-ae,me=Oe}}else if(E<se){if(de+=m+E-se,se-=E,se<he){he-=se;do Oe[a++]=y[de++];while(--se);if(de=0,E<he){se=E,he-=se;do Oe[a++]=y[de++];while(--se);de=a-ae,me=Oe}}}else if(de+=E-se,se<he){he-=se;do Oe[a++]=y[de++];while(--se);de=a-ae,me=Oe}for(;he>2;)Oe[a++]=me[de++],Oe[a++]=me[de++],Oe[a++]=me[de++],he-=3;he&&(Oe[a++]=me[de++],he>1&&(Oe[a++]=me[de++]))}else{de=a-ae;do Oe[a++]=Oe[de++],Oe[a++]=Oe[de++],Oe[a++]=Oe[de++],he-=3;while(he>2);he&&(Oe[a++]=Oe[de++],he>1&&(Oe[a++]=Oe[de++]))}break}}break}}while(n<s&&a<u);he=I>>3,n-=he,I-=he<<3,C&=(1<<I)-1,i.next_in=n,i.next_out=a,i.avail_in=n<s?s-n+5:5-(n-s),i.avail_out=a<u?u-a+257:257-(a-u),De.hold=C,De.bits=I};const vT=15,Jse=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Qse=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Zse=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),eoe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ZE=(i,e,n,s,a,l,u,p)=>{const m=p.bits;let g,E,y,C,I,j,P=0,U=0,q=0,J=0,se=0,he=0,ae=0,de=0,me=0,ge=0,Oe=null;const De=new Uint16Array(16),_t=new Uint16Array(16);let Pt,Rn,kr,xn=null;for(P=0;P<=vT;P++)De[P]=0;for(U=0;U<s;U++)De[e[n+U]]++;for(se=m,J=vT;J>=1&&De[J]===0;J--);if(se>J&&(se=J),J===0)return a[l++]=20971520,a[l++]=20971520,p.bits=1,0;for(q=1;q<J&&De[q]===0;q++);for(se<q&&(se=q),de=1,P=1;P<=vT;P++)if(de<<=1,de-=De[P],de<0)return-1;if(de>0&&(i===0||J!==1))return-1;for(_t[1]=0,P=1;P<vT;P++)_t[P+1]=_t[P]+De[P];for(U=0;U<s;U++)e[n+U]!==0&&(u[_t[e[n+U]]++]=U);if(i===0?(Oe=xn=u,j=20):i===1?(Oe=Jse,xn=Qse,j=257):(Oe=Zse,xn=eoe,j=0),ge=0,U=0,P=q,I=l,he=se,ae=0,y=-1,me=1<<se,C=me-1,i===1&&me>852||i===2&&me>592)return 1;for(;;){Pt=P-ae,u[U]+1<j?(Rn=0,kr=u[U]):u[U]>=j?(Rn=xn[u[U]-j],kr=Oe[u[U]-j]):(Rn=96,kr=0),g=1<<P-ae,E=1<<he,q=E;do E-=g,a[I+(ge>>ae)+E]=Pt<<24|Rn<<16|kr|0;while(E!==0);for(g=1<<P-1;ge&g;)g>>=1;if(g!==0?(ge&=g-1,ge+=g):ge=0,U++,--De[P]==0){if(P===J)break;P=e[n+u[U]]}if(P>se&&(ge&C)!==y){for(ae===0&&(ae=se),I+=q,he=P-ae,de=1<<he;he+ae<J&&(de-=De[he+ae],!(de<=0));)he++,de<<=1;if(me+=1<<he,i===1&&me>852||i===2&&me>592)return 1;y=ge&C,a[y]=se<<24|he<<16|I-l|0}}return ge!==0&&(a[I+ge]=P-ae<<24|64<<16|0),p.bits=se,0};const{Z_FINISH:GV,Z_BLOCK:toe,Z_TREES:yT,Z_OK:hp,Z_STREAM_END:noe,Z_NEED_DICT:roe,Z_STREAM_ERROR:ka,Z_DATA_ERROR:HV,Z_MEM_ERROR:zV,Z_BUF_ERROR:ioe,Z_DEFLATED:KV}=hm,ST=16180,bT=16190,ld=16191,Ek=16192,vk=16194,TT=16199,CT=16200,yk=16206,oi=16209,YV=i=>(i>>>24&255)+(i>>>8&65280)+((65280&i)<<8)+((255&i)<<24);function soe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const pp=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.mode<ST||e.mode>16211?1:0},qV=i=>{if(pp(i))return ka;const e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=1&e.wrap),e.mode=ST,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,hp},XV=i=>{if(pp(i))return ka;const e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,qV(i)},JV=(i,e)=>{let n;if(pp(i))return ka;const s=i.state;return e<0?(n=0,e=-e):(n=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ka:(s.window!==null&&s.wbits!==e&&(s.window=null),s.wrap=n,s.wbits=e,XV(i))},QV=(i,e)=>{if(!i)return ka;const n=new soe;i.state=n,n.strm=i,n.window=null,n.mode=ST;const s=JV(i,e);return s!==hp&&(i.state=null),s};let Sk,bk,ZV=!0;const ooe=i=>{if(ZV){Sk=new Int32Array(512),bk=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(ZE(1,i.lens,0,288,Sk,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;ZE(2,i.lens,0,32,bk,0,i.work,{bits:5}),ZV=!1}i.lencode=Sk,i.lenbits=9,i.distcode=bk,i.distbits=5},eB=(i,e,n,s)=>{let a;const l=i.state;return l.window===null&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new Uint8Array(l.wsize)),s>=l.wsize?(l.window.set(e.subarray(n-l.wsize,n),0),l.wnext=0,l.whave=l.wsize):(a=l.wsize-l.wnext,a>s&&(a=s),l.window.set(e.subarray(n-s,n-s+a),l.wnext),(s-=a)?(l.window.set(e.subarray(n-s,n),0),l.wnext=s,l.whave=l.wsize):(l.wnext+=a,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=a))),0};var aoe=(i,e)=>{let n,s,a,l,u,p,m,g,E,y,C,I,j,P,U,q,J,se,he,ae,de,me,ge=0;const Oe=new Uint8Array(4);let De,_t;const Pt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(pp(i)||!i.output||!i.input&&i.avail_in!==0)return ka;n=i.state,n.mode===ld&&(n.mode=Ek),u=i.next_out,a=i.output,m=i.avail_out,l=i.next_in,s=i.input,p=i.avail_in,g=n.hold,E=n.bits,y=p,C=m,me=hp;e:for(;;)switch(n.mode){case ST:if(n.wrap===0){n.mode=Ek;break}for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(2&n.wrap&&g===35615){n.wbits===0&&(n.wbits=15),n.check=0,Oe[0]=255&g,Oe[1]=g>>>8&255,n.check=ps(n.check,Oe,2,0),g=0,E=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&g)<<8)+(g>>8))%31){i.msg="incorrect header check",n.mode=oi;break}if((15&g)!==KV){i.msg="unknown compression method",n.mode=oi;break}if(g>>>=4,E-=4,de=8+(15&g),n.wbits===0&&(n.wbits=de),de>15||de>n.wbits){i.msg="invalid window size",n.mode=oi;break}n.dmax=1<<n.wbits,n.flags=0,i.adler=n.check=1,n.mode=512&g?16189:ld,g=0,E=0;break;case 16181:for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(n.flags=g,(255&n.flags)!==KV){i.msg="unknown compression method",n.mode=oi;break}if(57344&n.flags){i.msg="unknown header flags set",n.mode=oi;break}n.head&&(n.head.text=g>>8&1),512&n.flags&&4&n.wrap&&(Oe[0]=255&g,Oe[1]=g>>>8&255,n.check=ps(n.check,Oe,2,0)),g=0,E=0,n.mode=16182;case 16182:for(;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}n.head&&(n.head.time=g),512&n.flags&&4&n.wrap&&(Oe[0]=255&g,Oe[1]=g>>>8&255,Oe[2]=g>>>16&255,Oe[3]=g>>>24&255,n.check=ps(n.check,Oe,4,0)),g=0,E=0,n.mode=16183;case 16183:for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}n.head&&(n.head.xflags=255&g,n.head.os=g>>8),512&n.flags&&4&n.wrap&&(Oe[0]=255&g,Oe[1]=g>>>8&255,n.check=ps(n.check,Oe,2,0)),g=0,E=0,n.mode=16184;case 16184:if(1024&n.flags){for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}n.length=g,n.head&&(n.head.extra_len=g),512&n.flags&&4&n.wrap&&(Oe[0]=255&g,Oe[1]=g>>>8&255,n.check=ps(n.check,Oe,2,0)),g=0,E=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(I=n.length,I>p&&(I=p),I&&(n.head&&(de=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(s.subarray(l,l+I),de)),512&n.flags&&4&n.wrap&&(n.check=ps(n.check,s,I,l)),p-=I,l+=I,n.length-=I),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(p===0)break e;I=0;do de=s[l+I++],n.head&&de&&n.length<65536&&(n.head.name+=String.fromCharCode(de));while(de&&I<p);if(512&n.flags&&4&n.wrap&&(n.check=ps(n.check,s,I,l)),p-=I,l+=I,de)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(p===0)break e;I=0;do de=s[l+I++],n.head&&de&&n.length<65536&&(n.head.comment+=String.fromCharCode(de));while(de&&I<p);if(512&n.flags&&4&n.wrap&&(n.check=ps(n.check,s,I,l)),p-=I,l+=I,de)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(4&n.wrap&&g!==(65535&n.check)){i.msg="header crc mismatch",n.mode=oi;break}g=0,E=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),i.adler=n.check=0,n.mode=ld;break;case 16189:for(;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}i.adler=n.check=YV(g),g=0,E=0,n.mode=bT;case bT:if(n.havedict===0)return i.next_out=u,i.avail_out=m,i.next_in=l,i.avail_in=p,n.hold=g,n.bits=E,roe;i.adler=n.check=1,n.mode=ld;case ld:if(e===toe||e===yT)break e;case Ek:if(n.last){g>>>=7&E,E-=7&E,n.mode=yk;break}for(;E<3;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}switch(n.last=1&g,g>>>=1,E-=1,3&g){case 0:n.mode=16193;break;case 1:if(ooe(n),n.mode=TT,e===yT){g>>>=2,E-=2;break e}break;case 2:n.mode=16196;break;case 3:i.msg="invalid block type",n.mode=oi}g>>>=2,E-=2;break;case 16193:for(g>>>=7&E,E-=7&E;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if((65535&g)!=(g>>>16^65535)){i.msg="invalid stored block lengths",n.mode=oi;break}if(n.length=65535&g,g=0,E=0,n.mode=vk,e===yT)break e;case vk:n.mode=16195;case 16195:if(I=n.length,I){if(I>p&&(I=p),I>m&&(I=m),I===0)break e;a.set(s.subarray(l,l+I),u),p-=I,l+=I,m-=I,u+=I,n.length-=I;break}n.mode=ld;break;case 16196:for(;E<14;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(n.nlen=257+(31&g),g>>>=5,E-=5,n.ndist=1+(31&g),g>>>=5,E-=5,n.ncode=4+(15&g),g>>>=4,E-=4,n.nlen>286||n.ndist>30){i.msg="too many length or distance symbols",n.mode=oi;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;E<3;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}n.lens[Pt[n.have++]]=7&g,g>>>=3,E-=3}for(;n.have<19;)n.lens[Pt[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,De={bits:n.lenbits},me=ZE(0,n.lens,0,19,n.lencode,0,n.work,De),n.lenbits=De.bits,me){i.msg="invalid code lengths set",n.mode=oi;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;ge=n.lencode[g&(1<<n.lenbits)-1],U=ge>>>24,q=ge>>>16&255,J=65535&ge,!(U<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(J<16)g>>>=U,E-=U,n.lens[n.have++]=J;else{if(J===16){for(_t=U+2;E<_t;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(g>>>=U,E-=U,n.have===0){i.msg="invalid bit length repeat",n.mode=oi;break}de=n.lens[n.have-1],I=3+(3&g),g>>>=2,E-=2}else if(J===17){for(_t=U+3;E<_t;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=U,E-=U,de=0,I=3+(7&g),g>>>=3,E-=3}else{for(_t=U+7;E<_t;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=U,E-=U,de=0,I=11+(127&g),g>>>=7,E-=7}if(n.have+I>n.nlen+n.ndist){i.msg="invalid bit length repeat",n.mode=oi;break}for(;I--;)n.lens[n.have++]=de}}if(n.mode===oi)break;if(n.lens[256]===0){i.msg="invalid code -- missing end-of-block",n.mode=oi;break}if(n.lenbits=9,De={bits:n.lenbits},me=ZE(1,n.lens,0,n.nlen,n.lencode,0,n.work,De),n.lenbits=De.bits,me){i.msg="invalid literal/lengths set",n.mode=oi;break}if(n.distbits=6,n.distcode=n.distdyn,De={bits:n.distbits},me=ZE(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,De),n.distbits=De.bits,me){i.msg="invalid distances set",n.mode=oi;break}if(n.mode=TT,e===yT)break e;case TT:n.mode=CT;case CT:if(p>=6&&m>=258){i.next_out=u,i.avail_out=m,i.next_in=l,i.avail_in=p,n.hold=g,n.bits=E,Xse(i,C),u=i.next_out,a=i.output,m=i.avail_out,l=i.next_in,s=i.input,p=i.avail_in,g=n.hold,E=n.bits,n.mode===ld&&(n.back=-1);break}for(n.back=0;ge=n.lencode[g&(1<<n.lenbits)-1],U=ge>>>24,q=ge>>>16&255,J=65535&ge,!(U<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(q&&!(240&q)){for(se=U,he=q,ae=J;ge=n.lencode[ae+((g&(1<<se+he)-1)>>se)],U=ge>>>24,q=ge>>>16&255,J=65535&ge,!(se+U<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=se,E-=se,n.back+=se}if(g>>>=U,E-=U,n.back+=U,n.length=J,q===0){n.mode=16205;break}if(32&q){n.back=-1,n.mode=ld;break}if(64&q){i.msg="invalid literal/length code",n.mode=oi;break}n.extra=15&q,n.mode=16201;case 16201:if(n.extra){for(_t=n.extra;E<_t;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}n.length+=g&(1<<n.extra)-1,g>>>=n.extra,E-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;ge=n.distcode[g&(1<<n.distbits)-1],U=ge>>>24,q=ge>>>16&255,J=65535&ge,!(U<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(!(240&q)){for(se=U,he=q,ae=J;ge=n.distcode[ae+((g&(1<<se+he)-1)>>se)],U=ge>>>24,q=ge>>>16&255,J=65535&ge,!(se+U<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=se,E-=se,n.back+=se}if(g>>>=U,E-=U,n.back+=U,64&q){i.msg="invalid distance code",n.mode=oi;break}n.offset=J,n.extra=15&q,n.mode=16203;case 16203:if(n.extra){for(_t=n.extra;E<_t;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}n.offset+=g&(1<<n.extra)-1,g>>>=n.extra,E-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){i.msg="invalid distance too far back",n.mode=oi;break}n.mode=16204;case 16204:if(m===0)break e;if(I=C-m,n.offset>I){if(I=n.offset-I,I>n.whave&&n.sane){i.msg="invalid distance too far back",n.mode=oi;break}I>n.wnext?(I-=n.wnext,j=n.wsize-I):j=n.wnext-I,I>n.length&&(I=n.length),P=n.window}else P=a,j=u-n.offset,I=n.length;I>m&&(I=m),m-=I,n.length-=I;do a[u++]=P[j++];while(--I);n.length===0&&(n.mode=CT);break;case 16205:if(m===0)break e;a[u++]=n.length,m--,n.mode=CT;break;case yk:if(n.wrap){for(;E<32;){if(p===0)break e;p--,g|=s[l++]<<E,E+=8}if(C-=m,i.total_out+=C,n.total+=C,4&n.wrap&&C&&(i.adler=n.check=n.flags?ps(n.check,a,C,u-C):GE(n.check,a,C,u-C)),C=m,4&n.wrap&&(n.flags?g:YV(g))!==n.check){i.msg="incorrect data check",n.mode=oi;break}g=0,E=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(4&n.wrap&&g!==(4294967295&n.total)){i.msg="incorrect length check",n.mode=oi;break}g=0,E=0}n.mode=16208;case 16208:me=noe;break e;case oi:me=HV;break e;case 16210:return zV;default:return ka}return i.next_out=u,i.avail_out=m,i.next_in=l,i.avail_in=p,n.hold=g,n.bits=E,(n.wsize||C!==i.avail_out&&n.mode<oi&&(n.mode<yk||e!==GV))&&eB(i,i.output,i.next_out,C-i.avail_out),y-=i.avail_in,C-=i.avail_out,i.total_in+=y,i.total_out+=C,n.total+=C,4&n.wrap&&C&&(i.adler=n.check=n.flags?ps(n.check,a,C,i.next_out-C):GE(n.check,a,C,i.next_out-C)),i.data_type=n.bits+(n.last?64:0)+(n.mode===ld?128:0)+(n.mode===TT||n.mode===vk?256:0),(y===0&&C===0||e===GV)&&me===hp&&(me=ioe),me},dd={inflateReset:XV,inflateReset2:JV,inflateResetKeep:qV,inflateInit:i=>QV(i,15),inflateInit2:QV,inflate:aoe,inflateEnd:i=>{if(pp(i))return ka;let e=i.state;return e.window&&(e.window=null),i.state=null,hp},inflateGetHeader:(i,e)=>{if(pp(i))return ka;const n=i.state;return 2&n.wrap?(n.head=e,e.done=!1,hp):ka},inflateSetDictionary:(i,e)=>{const n=e.length;let s,a,l;return pp(i)?ka:(s=i.state,s.wrap!==0&&s.mode!==bT?ka:s.mode===bT&&(a=1,a=GE(a,e,n,0),a!==s.check)?HV:(l=eB(i,e,n,n),l?(s.mode=16210,zV):(s.havedict=1,hp)))},inflateInfo:"pako inflate (from Nodeca project)"},coe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const tB=Object.prototype.toString,{Z_NO_FLUSH:loe,Z_FINISH:doe,Z_OK:ev,Z_STREAM_END:Tk,Z_NEED_DICT:Ck,Z_STREAM_ERROR:uoe,Z_DATA_ERROR:nB,Z_MEM_ERROR:hoe}=hm;function tv(i){this.options=gT.assign({chunkSize:65536,windowBits:15,to:""},i||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||i&&i.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&!(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WV,this.strm.avail_out=0;let n=dd.inflateInit2(this.strm,e.windowBits);if(n!==ev)throw new Error(cp[n]);if(this.header=new coe,dd.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=JE.string2buf(e.dictionary):tB.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=dd.inflateSetDictionary(this.strm,e.dictionary),n!==ev)))throw new Error(cp[n])}function wk(i,e){const n=new tv(e);if(n.push(i),n.err)throw n.msg||cp[n.err];return n.result}tv.prototype.push=function(i,e){const n=this.strm,s=this.options.chunkSize,a=this.options.dictionary;let l,u,p;if(this.ended)return!1;for(u=e===~~e?e:e===!0?doe:loe,tB.call(i)==="[object ArrayBuffer]"?n.input=new Uint8Array(i):n.input=i,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(s),n.next_out=0,n.avail_out=s),l=dd.inflate(n,u),l===Ck&&a&&(l=dd.inflateSetDictionary(n,a),l===ev?l=dd.inflate(n,u):l===nB&&(l=Ck));n.avail_in>0&&l===Tk&&n.state.wrap>0&&i[n.next_in]!==0;)dd.inflateReset(n),l=dd.inflate(n,u);switch(l){case uoe:case nB:case Ck:case hoe:return this.onEnd(l),this.ended=!0,!1}if(p=n.avail_out,n.next_out&&(n.avail_out===0||l===Tk))if(this.options.to==="string"){let m=JE.utf8border(n.output,n.next_out),g=n.next_out-m,E=JE.buf2string(n.output,m);n.next_out=g,n.avail_out=s-g,g&&n.output.set(n.output.subarray(m,m+g),0),this.onData(E)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(l!==ev||p!==0){if(l===Tk)return l=dd.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,!0;if(n.avail_in===0)break}}return!0},tv.prototype.onData=function(i){this.chunks.push(i)},tv.prototype.onEnd=function(i){i===ev&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=gT.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};var poe={Inflate:tv,inflate:wk,inflateRaw:function(i,e){return(e=e||{}).raw=!0,wk(i,e)},ungzip:wk,constants:hm};const{Deflate:mke,deflate:foe,deflateRaw:gke,gzip:_ke}=qse,{Inflate:Eke,inflate:moe,inflateRaw:vke,ungzip:yke}=poe;var Rk,goe=foe,_oe=moe;(function(i){i[i.ONE_BYTE=0]="ONE_BYTE",i[i.TWO_BYTE=1]="TWO_BYTE"})(Rk||(Rk={}));class Eoe{constructor(){R(this,"_sequence",0),R(this,"_startTime",Date.now()),R(this,"isUseOneByte",!0)}get startTime(){const e=Date.now()-this._startTime;return e<Math.pow(2,16)?e:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(e){const n={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:e};if(e.byteLength>128){const p=new Uint8Array(4);p.set([1,0,0,0]);const m={id:0,length:4,data:p.buffer},g={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[m]};n.commonPacketHeader.extension=1,n.extension=g,n.payload=this.compress(e),n.commonPacketHeader.length=8+(n.extension.length+2)+n.payload.byteLength}else n.commonPacketHeader.length=8+n.payload.byteLength;Z("SHOW_DATASTREAM2_LOG")&&N.debug("send data header: ".concat(JSON.stringify(n.commonPacketHeader)));const s=new ArrayBuffer(n.commonPacketHeader.length),a=new Uint8Array(s),l=new DataView(s);let u=0;if(l.setUint16(u,n.commonPacketHeader.extension<<15|n.commonPacketHeader.reserved<<14|n.commonPacketHeader.length,!0),u+=2,l.setUint32(u,n.commonPacketHeader.sequence,!0),u+=4,l.setUint16(u,n.commonStreamHeader,!0),u+=2,n.extension){const p=this.serializeExtension(n.extension);a.set(new Uint8Array(p),u),u+=p.byteLength}if(a.set(new Uint8Array(n.payload),u),u+=n.payload.byteLength,u!==n.commonPacketHeader.length)throw Error("serialize error!");return s}deserialize(e){if(e.byteLength<4)return new ArrayBuffer(0);const n=new DataView(e);let s=0;const a=n.getUint16(s,!0);s+=2;const l={length:16383&a,reserved:(16384&a)>>14,extension:(32768&a)>>15,sequence:n.getUint16(s+2,!0)<<16|n.getUint16(s,!0)};let u,p;if(s+=4,Z("SHOW_DATASTREAM2_LOG")&&N.debug("receive data header: ".concat(JSON.stringify(l))),n.getUint16(s,!0),s+=2,l.extension){p=this.deserializeExtension(e.slice(s)),s+=2+p.length,u=e.slice(s);let m=!1;if(p.datas.length>0){const g=p.datas.find(E=>E.id===0);g&&(m=(1&new DataView(g.data).getUint32(0,!0))==1)}u=m?this.decompress(u):u}else u=e.slice(8);return u}serializeExtension(e){const{profile:n,length:s,datas:a}=e,l=new ArrayBuffer(s+2),u=new Uint8Array(l),p=new DataView(l);let m=0;if(p.setUint8(m++,n),p.setUint8(m++,s),a.forEach(g=>{n?(p.setUint8(m++,g.id),p.setUint8(m++,g.length),u.set(new Uint8Array(g.data),m),m+=g.data.byteLength):(p.setUint8(m++,g.id|g.length<<4),u.set(new Uint8Array(g.data),m),m+=g.data.byteLength)}),m!==s+2)throw Error("serialize extension error, is ".concat(m,"!==").concat(s+2));return l}deserializeExtension(e){const n=new DataView(e);let s=0;const a=n.getUint8(s);s++;const l=n.getUint8(s);s++;const u=a===Rk.TWO_BYTE,p=[],m=new DataView(e,2);let g=0;for(;g<l;){let E=0,y=0,C=new ArrayBuffer(0);u?(E=m.getUint8(g),g++,y=m.getUint8(g),g++):(E=15&m.getUint8(g),y=m.getUint8(g)>>4,g++),y>0&&(C=m.buffer.slice(g+2,g+2+y),g+=C.byteLength),p.push({id:E,length:y,data:C})}if(g!==l)throw Error("parse error");return{profile:a,length:l,datas:p}}decompress(e){return _oe(new Uint8Array(e))}compress(e){return goe(new Uint8Array(e))}}class rB extends jn{constructor(e,n){super(),R(this,"_version",1),R(this,"_type",3),R(this,"_config",void 0),R(this,"_originDataChannel",void 0),R(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),R(this,"_dataStreamPacketHandler",void 0),R(this,"_datachannelEventMap",new Map),this._config=e,n&&(this._originDataChannel=n,this._bandDataChannelEvents(n)),this._initPacketHeader(),this._dataStreamPacketHandler=new Eoe}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return Z("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var e,n;return(e=(n=this._originDataChannel)===null||n===void 0?void 0:n.readyState)!==null&&e!==void 0?e:"connecting"}get _originDataChannelId(){var e,n;return(e=(n=this._originDataChannel)===null||n===void 0?void 0:n.id)!==null&&e!==void 0?e:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new pe((e,n)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&e();const s=setTimeout(()=>{var a;n(new ye(z.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((a=this._originDataChannel)===null||a===void 0?void 0:a.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(s),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),e()},this._originDataChannel.onerror=()=>{throw clearTimeout(s),new ye(z.DATACHANNEL_CONNECTION_TIMEOUT)}}else n(new ye(z.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(e){this._originDataChannel=e,this._bandDataChannelEvents(e)}_initPacketHeader(){const e=new DataView(this._dataStreamPacketHeader);e.setUint16(0,this._version),e.setUint8(2,this._type),e.setUint8(3,this._config.id)}_bandDataChannelEvents(e){this._unbindDataChannelEvents(e),[cm.OPEN,cm.CLOSE,cm.ERROR].forEach(n=>{const s=()=>{this.emit(n)};this._datachannelEventMap.set(n,s),e.addEventListener(n,s)})}_unbindDataChannelEvents(e){Array.from(this._datachannelEventMap.entries()).forEach(n=>{let[s,a]=n;e.removeEventListener(s,a)}),this._datachannelEventMap.clear()}}class voe extends rB{constructor(e){super(e),R(this,"_messageListener",void 0),this._messageListener=n=>{if(n.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const s=n.data.slice(0,this._dataStreamPacketHeader.byteLength),a=new DataView(s).getUint8(3);if(a!==this.id)return void(Z("SHOW_DATASTREAM2_LOG")&&N.debug("invalid datachannel id: ".concat(a," !== ").concat(this.id)));let l=n.data.slice(this._dataStreamPacketHeader.byteLength);l=this._dataStreamPacketHandler.deserialize(l),this.emit(cm.MESSAGE,l)}}_updateOriginDataChannel(e){super._updateOriginDataChannel(e),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class iB extends rB{send(e){if(this._originDataChannel){let n=e;n=this._dataStreamPacketHandler.serialize(e);const s=new Uint8Array(this._dataStreamPacketHeader.byteLength+n.byteLength);s.set(new Uint8Array(this._dataStreamPacketHeader),0),s.set(new Uint8Array(n),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(s.buffer)}}}var yoe=h,Soe=gr("iterator"),Ik=!yoe(function(){var i=new URL("b?a=1&b=2&c=3","http://a"),e=i.searchParams,n=new URLSearchParams("a=1&a=2"),s="";return i.pathname="c%20d",e.forEach(function(a,l){e.delete("b"),s+=l+a}),n.delete("a",2),!i.toJSON||!n.has("a",1)||n.has("a",2)||!e.size&&!0||!e.sort||i.href!=="http://a/c%20d?a=1&c=3"||e.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!e[Soe]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||s!=="a1c3"||new URL("http://x",void 0).host!=="x"}),boe=tu,Ak=On,gm=V,wT=Fe,fl=w,_m=Pe,sB=Ik,oB=tu,Toe=tb,Coe=function(i,e,n){for(var s in e)n&&n.unsafe&&i[s]?i[s]=e[s]:boe(i,s,e[s],n);return i},woe=nu,Roe=Dj,Ok=Lf,aB=gO,Nk=we,Ioe=Ei,Aoe=Sa,Ooe=Xc,Noe=Js,cB=Ft,eo=Ds,koe=Vt,lB=at,kk=uO,xoe=fb,Em=Eb,Poe=pF,Doe=gr("iterator"),nv="URLSearchParams",dB=nv+"Iterator",uB=Ok.set,xa=Ok.getterFor(nv),Loe=Ok.getterFor(dB),Moe=Object.getOwnPropertyDescriptor,xk=function(i){if(!_m)return gm[i];var e=Moe(gm,i);return e&&e.value},hB=xk("fetch"),RT=xk("Request"),rv=xk("Headers"),Pk=RT&&RT.prototype,pB=rv&&rv.prototype,Uoe=gm.RegExp,joe=gm.TypeError,fB=gm.decodeURIComponent,Foe=gm.encodeURIComponent,Voe=fl("".charAt),mB=fl([].join),fp=fl([].push),Dk=fl("".replace),Boe=fl([].shift),gB=fl([].splice),_B=fl("".split),Woe=fl("".slice),$oe=/\+/g,EB=Array(4),Goe=function(i){return EB[i-1]||(EB[i-1]=Uoe("((?:%[\\da-f]{2}){"+i+"})","gi"))},Hoe=function(i){try{return fB(i)}catch{return i}},vB=function(i){var e=Dk(i,$oe," "),n=4;try{return fB(e)}catch{for(;n;)e=Dk(e,Goe(n--),Hoe);return e}},zoe=/[!'()~]|%20/g,Koe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Yoe=function(i){return Koe[i]},yB=function(i){return Dk(Foe(i),zoe,Yoe)},Lk=Roe(function(i,e){uB(this,{type:dB,iterator:kk(xa(i).entries),kind:e})},"Iterator",function(){var i=Loe(this),e=i.kind,n=i.iterator.next(),s=n.value;return n.done||(n.value=e==="keys"?s.key:e==="values"?s.value:[s.key,s.value]),n},!0),SB=function(i){this.entries=[],this.url=null,i!==void 0&&(cB(i)?this.parseObject(i):this.parseQuery(typeof i=="string"?Voe(i,0)==="?"?Woe(i,1):i:eo(i)))};SB.prototype={type:nv,bindURL:function(i){this.url=i,this.update()},parseObject:function(i){var e,n,s,a,l,u,p,m=xoe(i);if(m)for(n=(e=kk(i,m)).next;!(s=wT(n,e)).done;){if(l=(a=kk(Noe(s.value))).next,(u=wT(l,a)).done||(p=wT(l,a)).done||!wT(l,a).done)throw joe("Expected sequence with length 2");fp(this.entries,{key:eo(u.value),value:eo(p.value)})}else for(var g in i)Ioe(i,g)&&fp(this.entries,{key:g,value:eo(i[g])})},parseQuery:function(i){if(i)for(var e,n,s=_B(i,"&"),a=0;a<s.length;)(e=s[a++]).length&&(n=_B(e,"="),fp(this.entries,{key:vB(Boe(n)),value:vB(mB(n,"="))}))},serialize:function(){for(var i,e=this.entries,n=[],s=0;s<e.length;)i=e[s++],fp(n,yB(i.key)+"="+yB(i.value));return mB(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var IT=function(){aB(this,vm);var i=uB(this,new SB(arguments.length>0?arguments[0]:void 0));_m||(this.size=i.entries.length)},vm=IT.prototype;if(Coe(vm,{append:function(i,e){var n=xa(this);Em(arguments.length,2),fp(n.entries,{key:eo(i),value:eo(e)}),_m||this.length++,n.updateURL()},delete:function(i){for(var e=xa(this),n=Em(arguments.length,1),s=e.entries,a=eo(i),l=n<2?void 0:arguments[1],u=l===void 0?l:eo(l),p=0;p<s.length;){var m=s[p];if(m.key!==a||u!==void 0&&m.value!==u)p++;else if(gB(s,p,1),u!==void 0)break}_m||(this.size=s.length),e.updateURL()},get:function(i){var e=xa(this).entries;Em(arguments.length,1);for(var n=eo(i),s=0;s<e.length;s++)if(e[s].key===n)return e[s].value;return null},getAll:function(i){var e=xa(this).entries;Em(arguments.length,1);for(var n=eo(i),s=[],a=0;a<e.length;a++)e[a].key===n&&fp(s,e[a].value);return s},has:function(i){for(var e=xa(this).entries,n=Em(arguments.length,1),s=eo(i),a=n<2?void 0:arguments[1],l=a===void 0?a:eo(a),u=0;u<e.length;){var p=e[u++];if(p.key===s&&(l===void 0||p.value===l))return!0}return!1},set:function(i,e){var n=xa(this);Em(arguments.length,1);for(var s,a=n.entries,l=!1,u=eo(i),p=eo(e),m=0;m<a.length;m++)(s=a[m]).key===u&&(l?gB(a,m--,1):(l=!0,s.value=p));l||fp(a,{key:u,value:p}),_m||(this.size=a.length),n.updateURL()},sort:function(){var i=xa(this);Poe(i.entries,function(e,n){return e.key>n.key?1:-1}),i.updateURL()},forEach:function(i){for(var e,n=xa(this).entries,s=Aoe(i,arguments.length>1?arguments[1]:void 0),a=0;a<n.length;)s((e=n[a++]).value,e.key,this)},keys:function(){return new Lk(this,"keys")},values:function(){return new Lk(this,"values")},entries:function(){return new Lk(this,"entries")}},{enumerable:!0}),oB(vm,Doe,vm.entries,{name:"entries"}),oB(vm,"toString",function(){return xa(this).serialize()},{enumerable:!0}),_m&&Toe(vm,"size",{get:function(){return xa(this).entries.length},configurable:!0,enumerable:!0}),woe(IT,nv),Ak({global:!0,constructor:!0,forced:!sB},{URLSearchParams:IT}),!sB&&Nk(rv)){var qoe=fl(pB.has),Xoe=fl(pB.set),bB=function(i){if(cB(i)){var e,n=i.body;if(Ooe(n)===nv)return e=i.headers?new rv(i.headers):new rv,qoe(e,"content-type")||Xoe(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),koe(i,{body:lB(0,eo(n)),headers:lB(0,e)})}return i};if(Nk(hB)&&Ak({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(i){return hB(i,arguments.length>1?bB(arguments[1]):{})}}),Nk(RT)){var Mk=function(i){return aB(this,Pk),new RT(i,arguments.length>1?bB(arguments[1]):{})};Pk.constructor=Mk,Mk.prototype=Pk,Ak({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Mk})}}var Pa,Joe={URLSearchParams:IT,getState:xa},TB=Pe,Qoe=w,Zoe=Fe,eae=h,Uk=Nf,tae=aE,nae=Ye,rae=cs,iae=sn,ym=Object.assign,CB=Object.defineProperty,sae=Qoe([].concat),oae=!ym||eae(function(){if(TB&&ym({b:1},ym(CB({},"a",{enumerable:!0,get:function(){CB(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var i={},e={},n=Symbol(),s="abcdefghijklmnopqrst";return i[n]=7,s.split("").forEach(function(a){e[a]=a}),ym({},i)[n]!=7||Uk(ym({},e)).join("")!=s})?function(i,e){for(var n=rae(i),s=arguments.length,a=1,l=tae.f,u=nae.f;s>a;)for(var p,m=iae(arguments[a++]),g=l?sae(Uk(m),l(m)):Uk(m),E=g.length,y=0;E>y;)p=g[y++],TB&&!Zoe(u,m,p)||(n[p]=m[p]);return n}:ym,aae=Js,cae=kF,lae=Sa,dae=Fe,uae=cs,hae=function(i,e,n,s){try{return s?e(aae(n)[0],n[1]):e(n)}catch(a){cae(i,"throw",a)}},pae=AF,fae=Rf,mae=Yc,wB=Z_,gae=uO,_ae=fb,RB=Array,mp=w,jk=2147483647,Eae=/[^\0-\u007E]/,IB=/[.\u3002\uFF0E\uFF61]/g,AB="Overflow: input needs wider integers to process",OB=RangeError,vae=mp(IB.exec),Sm=Math.floor,Fk=String.fromCharCode,NB=mp("".charCodeAt),kB=mp([].join),Au=mp([].push),yae=mp("".replace),Sae=mp("".split),bae=mp("".toLowerCase),xB=function(i){return i+22+75*(i<26)},Tae=function(i,e,n){var s=0;for(i=n?Sm(i/700):i>>1,i+=Sm(i/e);i>455;)i=Sm(i/35),s+=36;return Sm(s+36*i/(i+38))},Cae=function(i){var e=[];i=function(q){for(var J=[],se=0,he=q.length;se<he;){var ae=NB(q,se++);if(ae>=55296&&ae<=56319&&se<he){var de=NB(q,se++);(64512&de)==56320?Au(J,((1023&ae)<<10)+(1023&de)+65536):(Au(J,ae),se--)}else Au(J,ae)}return J}(i);var n,s,a=i.length,l=128,u=0,p=72;for(n=0;n<i.length;n++)(s=i[n])<128&&Au(e,Fk(s));var m=e.length,g=m;for(m&&Au(e,"-");g<a;){var E=jk;for(n=0;n<i.length;n++)(s=i[n])>=l&&s<E&&(E=s);var y=g+1;if(E-l>Sm((jk-u)/y))throw OB(AB);for(u+=(E-l)*y,l=E,n=0;n<i.length;n++){if((s=i[n])<l&&++u>jk)throw OB(AB);if(s==l){for(var C=u,I=36;;){var j=I<=p?1:I>=p+26?26:I-p;if(C<j)break;var P=C-j,U=36-j;Au(e,Fk(xB(j+P%U))),C=Sm(P/U),I+=36}Au(e,Fk(xB(C))),p=Tae(u,y,g==m),u=0,g++}}u++,l++}return kB(e,"")},wae=On,Vk=Pe,Rae=Ik,Bk=V,PB=Sa,Da=w,AT=tu,La=tb,Iae=gO,Wk=Ei,$k=oae,bm=function(i){var e=uae(i),n=fae(this),s=arguments.length,a=s>1?arguments[1]:void 0,l=a!==void 0;l&&(a=lae(a,s>2?arguments[2]:void 0));var u,p,m,g,E,y,C=_ae(e),I=0;if(!C||this===RB&&pae(C))for(u=mae(e),p=n?new this(u):RB(u);u>I;I++)y=l?a(e[I],I):e[I],wB(p,I,y);else for(E=(g=gae(e,C)).next,p=n?new this:[];!(m=dae(E,g)).done;I++)y=l?hae(g,a,[m.value,I],!0):m.value,wB(p,I,y);return p.length=I,p},Tc=P1,Aae=oF.codeAt,Oae=function(i){var e,n,s=[],a=Sae(yae(bae(i),IB,"."),".");for(e=0;e<a.length;e++)n=a[e],Au(s,vae(Eae,n)?"xn--"+Cae(n):n);return kB(s,".")},ud=Ds,Nae=nu,kae=Eb,DB=Joe,LB=Lf,xae=LB.set,OT=LB.getterFor("URL"),Pae=DB.URLSearchParams,Dae=DB.getState,iv=Bk.URL,Gk=Bk.TypeError,NT=Bk.parseInt,Lae=Math.floor,MB=Math.pow,Ma=Da("".charAt),Cc=Da(/./.exec),sv=Da([].join),Mae=Da(1 .toString),Uae=Da([].pop),Tm=Da([].push),Hk=Da("".replace),jae=Da([].shift),Fae=Da("".split),ov=Da("".slice),kT=Da("".toLowerCase),Vae=Da([].unshift),zk="Invalid scheme",gp="Invalid host",UB="Invalid port",jB=/[a-z]/i,Bae=/[\d+-.a-z]/i,Kk=/\d/,Wae=/^0x/i,$ae=/^[0-7]+$/,Gae=/^\d+$/,FB=/^[\da-f]+$/i,Hae=/[\0\t\n\r #%/:<>?@[\\\]^|]/,zae=/[\0\t\n\r #/:<>?@[\\\]^|]/,Kae=/^[\u0000-\u0020]+/,Yae=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,qae=/[\t\n\r]/g,av=function(i){var e,n,s,a;if(typeof i=="number"){for(e=[],n=0;n<4;n++)Vae(e,i%256),i=Lae(i/256);return sv(e,".")}if(typeof i=="object"){for(e="",s=function(l){for(var u=null,p=1,m=null,g=0,E=0;E<8;E++)l[E]!==0?(g>p&&(u=m,p=g),m=null,g=0):(m===null&&(m=E),++g);return g>p&&(u=m,p=g),u}(i),n=0;n<8;n++)a&&i[n]===0||(a&&(a=!1),s===n?(e+=n?":":"::",a=!0):(e+=Mae(i[n],16),n<7&&(e+=":")));return"["+e+"]"}return i},xT={},VB=$k({},xT,{" ":1,'"':1,"<":1,">":1,"`":1}),BB=$k({},VB,{"#":1,"?":1,"{":1,"}":1}),Yk=$k({},BB,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ou=function(i,e){var n=Aae(i,0);return n>32&&n<127&&!Wk(e,i)?i:encodeURIComponent(i)},PT={ftp:21,file:null,http:80,https:443,ws:80,wss:443},cv=function(i,e){var n;return i.length==2&&Cc(jB,Ma(i,0))&&((n=Ma(i,1))==":"||!e&&n=="|")},WB=function(i){var e;return i.length>1&&cv(ov(i,0,2))&&(i.length==2||(e=Ma(i,2))==="/"||e==="\\"||e==="?"||e==="#")},Xae=function(i){return i==="."||kT(i)==="%2e"},qk={},$B={},Xk={},GB={},HB={},Jk={},zB={},KB={},DT={},LT={},Qk={},Zk={},ex={},tx={},YB={},nx={},Cm={},ml={},qB={},_p={},hd={},rx=function(i,e,n){var s,a,l,u=ud(i);if(e){if(a=this.parse(u))throw Gk(a);this.searchParams=null}else{if(n!==void 0&&(s=new rx(n,!0)),a=this.parse(u,null,s))throw Gk(a);(l=Dae(new Pae)).bindURL(this),this.searchParams=l}};rx.prototype={type:"URL",parse:function(i,e,n){var s,a,l,u,p,m=this,g=e||qk,E=0,y="",C=!1,I=!1,j=!1;for(i=ud(i),e||(m.scheme="",m.username="",m.password="",m.host=null,m.port=null,m.path=[],m.query=null,m.fragment=null,m.cannotBeABaseURL=!1,i=Hk(i,Kae,""),i=Hk(i,Yae,"$1")),i=Hk(i,qae,""),s=bm(i);E<=s.length;){switch(a=s[E],g){case qk:if(!a||!Cc(jB,a)){if(e)return zk;g=Xk;continue}y+=kT(a),g=$B;break;case $B:if(a&&(Cc(Bae,a)||a=="+"||a=="-"||a=="."))y+=kT(a);else{if(a!=":"){if(e)return zk;y="",g=Xk,E=0;continue}if(e&&(m.isSpecial()!=Wk(PT,y)||y=="file"&&(m.includesCredentials()||m.port!==null)||m.scheme=="file"&&!m.host))return;if(m.scheme=y,e)return void(m.isSpecial()&&PT[m.scheme]==m.port&&(m.port=null));y="",m.scheme=="file"?g=tx:m.isSpecial()&&n&&n.scheme==m.scheme?g=GB:m.isSpecial()?g=KB:s[E+1]=="/"?(g=HB,E++):(m.cannotBeABaseURL=!0,Tm(m.path,""),g=qB)}break;case Xk:if(!n||n.cannotBeABaseURL&&a!="#")return zk;if(n.cannotBeABaseURL&&a=="#"){m.scheme=n.scheme,m.path=Tc(n.path),m.query=n.query,m.fragment="",m.cannotBeABaseURL=!0,g=hd;break}g=n.scheme=="file"?tx:Jk;continue;case GB:if(a!="/"||s[E+1]!="/"){g=Jk;continue}g=DT,E++;break;case HB:if(a=="/"){g=LT;break}g=ml;continue;case Jk:if(m.scheme=n.scheme,a==Pa)m.username=n.username,m.password=n.password,m.host=n.host,m.port=n.port,m.path=Tc(n.path),m.query=n.query;else if(a=="/"||a=="\\"&&m.isSpecial())g=zB;else if(a=="?")m.username=n.username,m.password=n.password,m.host=n.host,m.port=n.port,m.path=Tc(n.path),m.query="",g=_p;else{if(a!="#"){m.username=n.username,m.password=n.password,m.host=n.host,m.port=n.port,m.path=Tc(n.path),m.path.length--,g=ml;continue}m.username=n.username,m.password=n.password,m.host=n.host,m.port=n.port,m.path=Tc(n.path),m.query=n.query,m.fragment="",g=hd}break;case zB:if(!m.isSpecial()||a!="/"&&a!="\\"){if(a!="/"){m.username=n.username,m.password=n.password,m.host=n.host,m.port=n.port,g=ml;continue}g=LT}else g=DT;break;case KB:if(g=DT,a!="/"||Ma(y,E+1)!="/")continue;E++;break;case DT:if(a!="/"&&a!="\\"){g=LT;continue}break;case LT:if(a=="@"){C&&(y="%40"+y),C=!0,l=bm(y);for(var P=0;P<l.length;P++){var U=l[P];if(U!=":"||j){var q=Ou(U,Yk);j?m.password+=q:m.username+=q}else j=!0}y=""}else if(a==Pa||a=="/"||a=="?"||a=="#"||a=="\\"&&m.isSpecial()){if(C&&y=="")return"Invalid authority";E-=bm(y).length+1,y="",g=Qk}else y+=a;break;case Qk:case Zk:if(e&&m.scheme=="file"){g=nx;continue}if(a!=":"||I){if(a==Pa||a=="/"||a=="?"||a=="#"||a=="\\"&&m.isSpecial()){if(m.isSpecial()&&y=="")return gp;if(e&&y==""&&(m.includesCredentials()||m.port!==null))return;if(u=m.parseHost(y))return u;if(y="",g=Cm,e)return;continue}a=="["?I=!0:a=="]"&&(I=!1),y+=a}else{if(y=="")return gp;if(u=m.parseHost(y))return u;if(y="",g=ex,e==Zk)return}break;case ex:if(!Cc(Kk,a)){if(a==Pa||a=="/"||a=="?"||a=="#"||a=="\\"&&m.isSpecial()||e){if(y!=""){var J=NT(y,10);if(J>65535)return UB;m.port=m.isSpecial()&&J===PT[m.scheme]?null:J,y=""}if(e)return;g=Cm;continue}return UB}y+=a;break;case tx:if(m.scheme="file",a=="/"||a=="\\")g=YB;else{if(!n||n.scheme!="file"){g=ml;continue}if(a==Pa)m.host=n.host,m.path=Tc(n.path),m.query=n.query;else if(a=="?")m.host=n.host,m.path=Tc(n.path),m.query="",g=_p;else{if(a!="#"){WB(sv(Tc(s,E),""))||(m.host=n.host,m.path=Tc(n.path),m.shortenPath()),g=ml;continue}m.host=n.host,m.path=Tc(n.path),m.query=n.query,m.fragment="",g=hd}}break;case YB:if(a=="/"||a=="\\"){g=nx;break}n&&n.scheme=="file"&&!WB(sv(Tc(s,E),""))&&(cv(n.path[0],!0)?Tm(m.path,n.path[0]):m.host=n.host),g=ml;continue;case nx:if(a==Pa||a=="/"||a=="\\"||a=="?"||a=="#"){if(!e&&cv(y))g=ml;else if(y==""){if(m.host="",e)return;g=Cm}else{if(u=m.parseHost(y))return u;if(m.host=="localhost"&&(m.host=""),e)return;y="",g=Cm}continue}y+=a;break;case Cm:if(m.isSpecial()){if(g=ml,a!="/"&&a!="\\")continue}else if(e||a!="?")if(e||a!="#"){if(a!=Pa&&(g=ml,a!="/"))continue}else m.fragment="",g=hd;else m.query="",g=_p;break;case ml:if(a==Pa||a=="/"||a=="\\"&&m.isSpecial()||!e&&(a=="?"||a=="#")){if((p=kT(p=y))===".."||p==="%2e."||p===".%2e"||p==="%2e%2e"?(m.shortenPath(),a=="/"||a=="\\"&&m.isSpecial()||Tm(m.path,"")):Xae(y)?a=="/"||a=="\\"&&m.isSpecial()||Tm(m.path,""):(m.scheme=="file"&&!m.path.length&&cv(y)&&(m.host&&(m.host=""),y=Ma(y,0)+":"),Tm(m.path,y)),y="",m.scheme=="file"&&(a==Pa||a=="?"||a=="#"))for(;m.path.length>1&&m.path[0]==="";)jae(m.path);a=="?"?(m.query="",g=_p):a=="#"&&(m.fragment="",g=hd)}else y+=Ou(a,BB);break;case qB:a=="?"?(m.query="",g=_p):a=="#"?(m.fragment="",g=hd):a!=Pa&&(m.path[0]+=Ou(a,xT));break;case _p:e||a!="#"?a!=Pa&&(a=="'"&&m.isSpecial()?m.query+="%27":m.query+=a=="#"?"%23":Ou(a,xT)):(m.fragment="",g=hd);break;case hd:a!=Pa&&(m.fragment+=Ou(a,VB))}E++}},parseHost:function(i){var e,n,s;if(Ma(i,0)=="["){if(Ma(i,i.length-1)!="]"||(e=function(a){var l,u,p,m,g,E,y,C=[0,0,0,0,0,0,0,0],I=0,j=null,P=0,U=function(){return Ma(a,P)};if(U()==":"){if(Ma(a,1)!=":")return;P+=2,j=++I}for(;U();){if(I==8)return;if(U()!=":"){for(l=u=0;u<4&&Cc(FB,U());)l=16*l+NT(U(),16),P++,u++;if(U()=="."){if(u==0||(P-=u,I>6))return;for(p=0;U();){if(m=null,p>0){if(!(U()=="."&&p<4))return;P++}if(!Cc(Kk,U()))return;for(;Cc(Kk,U());){if(g=NT(U(),10),m===null)m=g;else{if(m==0)return;m=10*m+g}if(m>255)return;P++}C[I]=256*C[I]+m,++p!=2&&p!=4||I++}if(p!=4)return;break}if(U()==":"){if(P++,!U())return}else if(U())return;C[I++]=l}else{if(j!==null)return;P++,j=++I}}if(j!==null)for(E=I-j,I=7;I!=0&&E>0;)y=C[I],C[I--]=C[j+E-1],C[j+--E]=y;else if(I!=8)return;return C}(ov(i,1,-1)),!e))return gp;this.host=e}else if(this.isSpecial()){if(i=Oae(i),Cc(Hae,i)||(e=function(a){var l,u,p,m,g,E,y,C=Fae(a,".");if(C.length&&C[C.length-1]==""&&C.length--,(l=C.length)>4)return a;for(u=[],p=0;p<l;p++){if((m=C[p])=="")return a;if(g=10,m.length>1&&Ma(m,0)=="0"&&(g=Cc(Wae,m)?16:8,m=ov(m,g==8?1:2)),m==="")E=0;else{if(!Cc(g==10?Gae:g==8?$ae:FB,m))return a;E=NT(m,g)}Tm(u,E)}for(p=0;p<l;p++)if(E=u[p],p==l-1){if(E>=MB(256,5-l))return null}else if(E>255)return null;for(y=Uae(u),p=0;p<u.length;p++)y+=u[p]*MB(256,3-p);return y}(i),e===null))return gp;this.host=e}else{if(Cc(zae,i))return gp;for(e="",n=bm(i),s=0;s<n.length;s++)e+=Ou(n[s],xT);this.host=e}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return Wk(PT,this.scheme)},shortenPath:function(){var i=this.path,e=i.length;!e||this.scheme=="file"&&e==1&&cv(i[0],!0)||i.length--},serialize:function(){var i=this,e=i.scheme,n=i.username,s=i.password,a=i.host,l=i.port,u=i.path,p=i.query,m=i.fragment,g=e+":";return a!==null?(g+="//",i.includesCredentials()&&(g+=n+(s?":"+s:"")+"@"),g+=av(a),l!==null&&(g+=":"+l)):e=="file"&&(g+="//"),g+=i.cannotBeABaseURL?u[0]:u.length?"/"+sv(u,"/"):"",p!==null&&(g+="?"+p),m!==null&&(g+="#"+m),g},setHref:function(i){var e=this.parse(i);if(e)throw Gk(e);this.searchParams.update()},getOrigin:function(){var i=this.scheme,e=this.port;if(i=="blob")try{return new wm(i.path[0]).origin}catch{return"null"}return i!="file"&&this.isSpecial()?i+"://"+av(this.host)+(e!==null?":"+e:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(i){this.parse(ud(i)+":",qk)},getUsername:function(){return this.username},setUsername:function(i){var e=bm(ud(i));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<e.length;n++)this.username+=Ou(e[n],Yk)}},getPassword:function(){return this.password},setPassword:function(i){var e=bm(ud(i));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<e.length;n++)this.password+=Ou(e[n],Yk)}},getHost:function(){var i=this.host,e=this.port;return i===null?"":e===null?av(i):av(i)+":"+e},setHost:function(i){this.cannotBeABaseURL||this.parse(i,Qk)},getHostname:function(){var i=this.host;return i===null?"":av(i)},setHostname:function(i){this.cannotBeABaseURL||this.parse(i,Zk)},getPort:function(){var i=this.port;return i===null?"":ud(i)},setPort:function(i){this.cannotHaveUsernamePasswordPort()||((i=ud(i))==""?this.port=null:this.parse(i,ex))},getPathname:function(){var i=this.path;return this.cannotBeABaseURL?i[0]:i.length?"/"+sv(i,"/"):""},setPathname:function(i){this.cannotBeABaseURL||(this.path=[],this.parse(i,Cm))},getSearch:function(){var i=this.query;return i?"?"+i:""},setSearch:function(i){(i=ud(i))==""?this.query=null:(Ma(i,0)=="?"&&(i=ov(i,1)),this.query="",this.parse(i,_p)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var i=this.fragment;return i?"#"+i:""},setHash:function(i){(i=ud(i))!=""?(Ma(i,0)=="#"&&(i=ov(i,1)),this.fragment="",this.parse(i,hd)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var wm=function(i){var e=Iae(this,to),n=kae(arguments.length,1)>1?arguments[1]:void 0,s=xae(e,new rx(i,!1,n));Vk||(e.href=s.serialize(),e.origin=s.getOrigin(),e.protocol=s.getProtocol(),e.username=s.getUsername(),e.password=s.getPassword(),e.host=s.getHost(),e.hostname=s.getHostname(),e.port=s.getPort(),e.pathname=s.getPathname(),e.search=s.getSearch(),e.searchParams=s.getSearchParams(),e.hash=s.getHash())},to=wm.prototype,Ua=function(i,e){return{get:function(){return OT(this)[i]()},set:e&&function(n){return OT(this)[e](n)},configurable:!0,enumerable:!0}};if(Vk&&(La(to,"href",Ua("serialize","setHref")),La(to,"origin",Ua("getOrigin")),La(to,"protocol",Ua("getProtocol","setProtocol")),La(to,"username",Ua("getUsername","setUsername")),La(to,"password",Ua("getPassword","setPassword")),La(to,"host",Ua("getHost","setHost")),La(to,"hostname",Ua("getHostname","setHostname")),La(to,"port",Ua("getPort","setPort")),La(to,"pathname",Ua("getPathname","setPathname")),La(to,"search",Ua("getSearch","setSearch")),La(to,"searchParams",Ua("getSearchParams")),La(to,"hash",Ua("getHash","setHash"))),AT(to,"toJSON",function(){return OT(this).serialize()},{enumerable:!0}),AT(to,"toString",function(){return OT(this).serialize()},{enumerable:!0}),iv){var XB=iv.createObjectURL,JB=iv.revokeObjectURL;XB&&AT(wm,"createObjectURL",PB(XB,iv)),JB&&AT(wm,"revokeObjectURL",PB(JB,iv))}Nae(wm,"URL"),wae({global:!0,constructor:!0,forced:!Rae,sham:!Vk},{URL:wm});var Jae=On,Qae=h,Zae=Eb,QB=Ds,ece=Ik,ZB=Yn("URL");Jae({target:"URL",stat:!0,forced:!(ece&&Qae(function(){ZB.canParse()}))},{canParse:function(i){var e=Zae(arguments.length,1),n=QB(i),s=e<2||arguments[1]===void 0?void 0:QB(arguments[1]);try{return!!new ZB(n,s)}catch{return!1}}});var e6=d(mr.URL);function MT(){const i=new Blob([atob("ZnVuY3Rpb24gZShlKXtjb25zdCB0PW5ldyBEYXRhVmlldyhlLmRhdGEpO2lmKDA9PT10LmdldFVpbnQ4KDApJiYwPT09dC5nZXRVaW50OCgxKSYmMD09PXQuZ2V0VWludDgoMikmJjE9PT10LmdldFVpbnQ4KDMpJiY2PT09dC5nZXRVaW50OCg0KSl7bGV0IG49NixyPTAsbz0wO2Zvcig7MjU1PT09KG89dC5nZXRVaW50OChuKyspKTspcis9MjU1O3IrPW87Y29uc3QgYT1mdW5jdGlvbihlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLG89W10sYT0wO2Zvcig7YTxuOylhKzM8biYmMD09PXJbYV0mJjA9PT1yW2ErMV0mJjM9PT1yW2ErMl0mJigwPT09clthKzNdfHwxPT09clthKzNdfHwyPT09clthKzNdfHwzPT09clthKzNdKT8oby5wdXNoKHJbYV0sclthKzFdLHJbYSszXSksYSs9NCk6KG8ucHVzaChyW2FdKSxhKyspO3JldHVybiBuZXcgVWludDhBcnJheShvKX0oZS5kYXRhLG4scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGEpfXJldHVybiBudWxsfWZ1bmN0aW9uIHQoZSx0KXtjb25zdCBuPWZ1bmN0aW9uKGUpe2NvbnN0IHQ9ZS5sZW5ndGg7bGV0IG49W10scj0wO2Zvcig7cjx0OylyKzI8dCYmMD09PWVbcl0mJjA9PT1lW3IrMV0mJigwPT09ZVtyKzJdfHwxPT09ZVtyKzJdfHwyPT09ZVtyKzJdfHwzPT09ZVtyKzJdKT8obi5wdXNoKGVbcl0sZVtyKzFdLDMsZVtyKzJdKSxyKz0zKToobi5wdXNoKGVbcl0pLHIrKyk7cmV0dXJuIG5ldyBVaW50OEFycmF5KG4pfSh0KSxyPW4ubGVuZ3RoLG89TWF0aC5mbG9vcihyLzI1NSksYT1yJTI1NSxzPW5ldyBVaW50OEFycmF5KDYrbysxK3IrZS5ieXRlTGVuZ3RoKTtzWzBdPTAsc1sxXT0wLHNbMl09MCxzWzNdPTEsc1s0XT02LHNbNV09MTAxO2xldCBpPTA7Zm9yKDtpPG87KXNbNitpXT0yNTUsaSsrO3JldHVybiBzWzYraV09YSxpKysscy5zZXQobiw2K2kpLHMuc2V0KG5ldyBVaW50OEFycmF5KGUpLDYraStyKSxzLmJ1ZmZlcn1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIlNhZmFyaSIpPi0xJiYtMT09PW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiQ2hyb21lIikmJihzZWxmLm9ucnRjdHJhbnNmb3JtPW49Pntjb25zdCByPW4udHJhbnNmb3JtZXI7bGV0IG89W107ci5vcHRpb25zLnBvcnQub25tZXNzYWdlPWU9PntlLmRhdGEuc2VpJiZvLnB1c2goZS5kYXRhLnNlaSl9LHNlbGYucG9zdE1lc3NhZ2UoInN0YXJ0ZWQiKTtjb25zdCBhPXIucmVhZGFibGUuZ2V0UmVhZGVyKCkscz1yLndyaXRhYmxlLmdldFdyaXRlcigpOyJyeCI9PT1yLm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2EucmVhZCgpLnRoZW4oKHI9PntpZighci5kb25lKXtpZihyLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7YS5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1vLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout(()=>e6.revokeObjectURL(i),0),new Worker(e6.createObjectURL(i))}const UT=new Map,jT=new Map;async function tce(i){if(!Kt().supportWebRTCEncodedTransform)return void N.warning("browser not support audio encoded transform");if(jT.has(i))return;const e={track:i.track};if(Xl()){if(!i.createEncodedStreams)return void N.warning("browser not support createEncodedStreams() API");let s=null;try{s=i.createEncodedStreams()}catch(l){return void N.error("create audio-encoded-streams error",l&&l.message)}const a=new TransformStream({transform(l,u){e.controller||(e.controller=u),i.track&&i.track.id!==e.track.id&&(N.debug("audio track changed: ".concat(e.track.id," => ").concat(i.track.id)),e.track.removeEventListener("ended",n),e.track=i.track,e.track.addEventListener("ended",n)),u.enqueue(l)}});s.readable.pipeThrough(a).pipeTo(s.writable)}else if(vi()){if(typeof RTCRtpScriptTransform>"u")return void N.warning("browser not support RTCRtpScriptTransform");const s=MT(),a=new MessageChannel;await new pe(u=>s.onmessage=p=>{p.data==="registered"&&u(void 0)});const l=new RTCRtpScriptTransform(s,{name:"rx",port:a.port2},[a.port2]);i.transform=l,await new pe(u=>s.onmessage=p=>{p.data==="started"&&u(void 0)}),a.port1.onmessage=u=>{var p;u.data.transformed&&i.track&&((p=i.track)===null||p===void 0?void 0:p.id)!==e.track.id&&(N.debug("audio track changed: ".concat(e.track.id," => ").concat(i.track.id)),e.track.removeEventListener("ended",n),e.track=i.track,e.track.addEventListener("ended",n))},e.worker=s}function n(){i.track.removeEventListener("ended",n),function(s){const a=jT.get(s);if(a){jT.delete(s);try{var l,u;(l=a.controller)===null||l===void 0||l.terminate(),(u=a.worker)===null||u===void 0||u.terminate()}catch(p){N.warning(p&&p.message)}}}(i)}jT.set(i,e),i.track.addEventListener("ended",n)}function nce(i){const e=new DataView(i.data);if(e.getUint8(0)===0&&e.getUint8(1)===0&&e.getUint8(2)===0&&e.getUint8(3)===1&&e.getUint8(4)===6){let n=6,s=0,a=0;for(;(a=e.getUint8(n++))===255;)s+=255;s+=a;const l=function(u,p,m){let g=new Uint8Array(u,p,m),E=[],y=0;for(;y<m;)y+3<m&&g[y]===0&&g[y+1]===0&&g[y+2]===3&&(g[y+3]===0||g[y+3]===1||g[y+3]===2||g[y+3]===3)?(E.push(g[y],g[y+1],g[y+3]),y+=4):(E.push(g[y]),y++);return new Uint8Array(E)}(i.data,n,s);return new Uint8Array(l)}return null}function rce(i,e){const n=function(m){const g=m.length;let E=[],y=0;for(;y<g;)y+2<g&&m[y]===0&&m[y+1]===0&&(m[y+2]===0||m[y+2]===1||m[y+2]===2||m[y+2]===3)?(E.push(m[y],m[y+1],3,m[y+2]),y+=3):(E.push(m[y]),y++);return new Uint8Array(E)}(e),s=n.length,a=Math.floor(s/255),l=s%255,u=new Uint8Array(6+a+1+s+i.byteLength);u[0]=0,u[1]=0,u[2]=0,u[3]=1,u[4]=6,u[5]=101;let p=0;for(;p<a;)u[6+p]=255,p++;return u[6+p]=l,p++,u.set(n,6+p),u.set(new Uint8Array(i),6+p+s),u.buffer}const FT=new Map,lv=new Map;async function ice(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Kt().supportWebRTCEncodedTransform)return void N.warning("browser not support video encoded transform");if(!i.track)return;if(lv.has(i)){const a=lv.get(i);return void(a&&(a.onSei=e.onSei))}const n={track:i.track,onSei:e.onSei};if(Xl()){if(!i.createEncodedStreams)return void N.warning("browser not support createEncodedStreams() API");let a=null;try{a=i.createEncodedStreams()}catch(u){return void N.error("create video-encoded-streams error",u&&u.message)}const l=new TransformStream({transform(u,p){n.controller||(n.controller=p),i.track&&i.track.id!==n.track.id&&(N.debug("video track changed: ".concat(n.track.id," => ").concat(i.track.id)),n.track.removeEventListener("ended",s),n.track=i.track,n.track.addEventListener("ended",s));const m=nce(u);m&&n.onSei&&n.onSei(m),p.enqueue(u)}});a.readable.pipeThrough(l).pipeTo(a.writable)}else if(vi()){if(typeof RTCRtpScriptTransform>"u")return void N.warning("browser not support RTCRtpScriptTransform");const a=MT(),l=new MessageChannel;await new pe(p=>a.onmessage=m=>{m.data==="registered"&&p(void 0)});const u=new RTCRtpScriptTransform(a,{name:"rx",port:l.port2},[l.port2]);i.transform=u,await new pe(p=>a.onmessage=m=>{m.data==="started"&&p(void 0)}),l.port1.onmessage=p=>{var m;p.data.transformed&&i.track&&((m=i.track)===null||m===void 0?void 0:m.id)!==n.track.id?(N.debug("video track changed: ".concat(n.track.id," => ").concat(i.track.id)),n.track.removeEventListener("ended",s),n.track=i.track,n.track.addEventListener("ended",s)):p.data.sei&&n.onSei&&n.onSei(p.data.sei)},n.worker=a}function s(){if(i.track){if(this.id!==i.track.id)return;i.track.removeEventListener("ended",s)}(function(a){const l=lv.get(a);if(l){lv.delete(a);try{var u,p;(u=l.controller)===null||u===void 0||u.terminate(),(p=l.worker)===null||p===void 0||p.terminate()}catch(m){N.warning(m&&m.message)}}})(i)}lv.set(i,n),i.track.addEventListener("ended",s)}(function(){const i=zt();Yi.getDisplayMedia=function(e){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),Yi.getStreamFromExtension=i.name===Zt.CHROME&&Number(i.version)>34,Yi.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const e=new RTCPeerConnection;let n=!1;try{e.addTransceiver("audio"),n=!0}catch{}return e.close(),n}(),Yi.supportMinBitrate=i.name===Zt.CHROME||i.name===Zt.EDGE,Yi.supportSetRtpSenderParameters=function(){const e=zt();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!au()||!(!vi()&&!Ab())||e.name===Zt.FIREFOX&&Number(e.version)>=64}(),i.name===Zt.SAFARI&&(Number(i.version)>=14?Yi.supportDualStream=!0:Yi.supportDualStream=!1),Yi.webAudioMediaStreamDest=function(){const e=zt();return!(e.name===Zt.SAFARI&&Number(e.version)<12)}(),Yi.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),Yi.supportWebGL=typeof WebGLRenderingContext<"u",Yi.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,au()||(Yi.webAudioWithAEC=!0),Yi.supportShareAudio=function(){const e=zt();return(e.os===Dr.WIN_10||e.os===Dr.WIN_81||e.os===Dr.WIN_7||e.os===Dr.LINUX||e.os===Dr.MAC_OS||e.os===Dr.CHROMIUM_OS)&&e.name===Zt.CHROME&&Number(e.version)>=74}(),Yi.supportDataChannel=function(){return!!(GO(76)||function(e){const n=zt();return!(n.name!==Zt.FIREFOX||!n.osVersion)&&Number(n.version)>=e}(68)||function(e){const n=zt();return!(n.name!==Zt.SAFARI||!n.osVersion)&&Number(n.version)>=e}(14))}(),Yi.supportPCSetConfiguration=function(){const e=window.RTCPeerConnection;return!mn()&&!!e&&e.prototype.setConfiguration instanceof Function}(),Yi.supportWebRTCEncodedTransform=function(){const e=zt();return e.name==="Chrome"&&Number(e.version)>=86||e.name==="Safari"&&Number(e.version)>=15}(),Yi.supportWebRTCInsertableStream=function(){const e=zt();return(e.name===Zt.CHROME||e.name===Zt.EDGE)&&Number(e.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),xb(()=>{Yi.supportDualStreamEncoding=function(){const e=zt();return Z("DISABLE_WEBAUDIO")?!0:e.name==="Safari"&&Number(e.version)>=14||!!(e.name==="Chrome"&&/Windows/i.test(e.os||"")&&Number(e.version)>=100&&Z("CHROME_DUAL_STREAM_USE_ENCODING"))}(),N.info("browser compatibility",JSON.stringify(Yi),JSON.stringify(i))})})();class sce extends jn{constructor(){super(...arguments),R(this,"resultStorage",new Map)}setLocalAudioStats(e,n,s){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(s,n)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(s,n))}setLocalVideoStats(e,n,s){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(s,n)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(s,n)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(s))}setRemoteAudioStats(e,n){const s=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",s,this.checkAudioOutputLevel(n))}setRemoteVideoStats(e,n){const s=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",s,this.checkVideoDecode(n))}record(e,n,s){if(Z("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const a=this.resultStorage.get(e);if(a&&(a.result.push(s),a.result.length>=5)){var l;const u=je(l=a.result).call(l,!0);a.isPrevNormal&&!u&&this.emit("exception",t6[e],e,n),!a.isPrevNormal&&u&&this.emit("exception",t6[e]+2e3,e+"_RECOVER",n),a.isPrevNormal=u,a.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&e.receiveLevel===0)}checkAudioInputLevel(e,n){return n instanceof Nr&&!n.isActive||!!n.muted||e.sendVolumeLevel!==0}checkFramerateInput(e,n){let s=null;n._encoderConfig&&n._encoderConfig.frameRate&&(s=To(n._encoderConfig.frameRate));const a=e.captureFrameRate;return!s||!a||!(s>10&&a<5||s<10&&s>=5&&a<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,n){return!!n.muted||e.sendBitrate!==0}checkSendAudioBitrate(e,n){return n instanceof Nr&&!n.isActive||!!n.muted||e.sendBitrate!==0}checkVideoDecode(e){return e.receiveBitrate===0||e.decodeFrameRate!==0}}const t6={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Li=new class{markSubscribeStart(i,e){performance.mark("agora-web-sdk/".concat(i,"/subscribe-").concat(e))}markPublishStart(i,e){performance.mark("agora-web-sdk/".concat(i,"/publish-").concat(e))}measureFromSubscribeStart(i,e){const n=performance.getEntriesByName("agora-web-sdk/".concat(i,"/subscribe-").concat(e));if(n.length>0){const s=n[n.length-1];return Math.round(performance.now()-s.startTime)}return 0}measureFromPublishStart(i,e){const n=performance.getEntriesByName("agora-web-sdk/".concat(i,"/publish-").concat(e));if(n.length>0){const s=n[n.length-1];return Math.round(performance.now()-s.startTime)}return 0}};function ix(i,e){this.v=i,this.k=e}function Ct(i){return new ix(i,0)}var oce=A5,ace=el;On({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var i=ace.f(this);return{promise:i.promise,resolve:i.resolve,reject:i.reject}}});var cce=el,lce=$f;On({target:"Promise",stat:!0,forced:!0},{try:function(i){var e=cce.f(this),n=lce(i);return(n.error?e.reject:e.resolve)(n.value),e.promise}});var sx=d(oce),n6=Pf.f("asyncIterator"),dce=d(n6);function dv(i){var e,n;function s(l,u){try{var p=i[l](u),m=p.value,g=m instanceof ix;sx.resolve(g?m.v:m).then(function(E){if(g){var y=l==="return"?"return":"next";if(!m.k||E.done)return s(y,E);E=i[y](E).value}a(p.done?"return":"normal",E)},function(E){s("throw",E)})}catch(E){a("throw",E)}}function a(l,u){switch(l){case"return":e.resolve({value:u,done:!0});break;case"throw":e.reject(u);break;default:e.resolve({value:u,done:!1})}(e=e.next)?s(e.key,e.arg):n=null}this._invoke=function(l,u){return new sx(function(p,m){var g={key:l,arg:u,resolve:p,reject:m,next:null};n?n=n.next=g:(e=n=g,s(l,u))})},typeof i.return!="function"&&(this.return=void 0)}function no(i){return function(){return new dv(i.apply(this,arguments))}}dv.prototype[typeof Ff=="function"&&dce||"@@asyncIterator"]=function(){return this},dv.prototype.next=function(i){return this._invoke("next",i)},dv.prototype.throw=function(i){return this._invoke("throw",i)},dv.prototype.return=function(i){return this._invoke("return",i)};var r6=d(mr.Object.getOwnPropertySymbols),uce=On,hce=P_.indexOf,pce=cO,ox=oe([].indexOf),i6=!!ox&&1/ox([1],1,-0)<0;uce({target:"Array",proto:!0,forced:i6||!pce("indexOf")},{indexOf:function(i){var e=arguments.length>1?arguments[1]:void 0;return i6?ox(this,i,e)||0:hce(this,i,e)}});var fce=qc("Array").indexOf,mce=x,gce=fce,ax=Array.prototype,s6=d(function(i){var e=i.indexOf;return i===ax||mce(ax,i)&&e===ax.indexOf?gce:e}),_ce=cs,o6=Nf;On({target:"Object",stat:!0,forced:h(function(){o6(1)})},{keys:function(i){return o6(_ce(i))}});var Ece=d(mr.Object.keys);function vce(i,e){if(i==null)return{};var n,s,a=function(u,p){if(u==null)return{};var m,g,E={},y=Ece(u);for(g=0;g<y.length;g++)m=y[g],s6(p).call(p,m)>=0||(E[m]=u[m]);return E}(i,e);if(r6){var l=r6(i);for(s=0;s<l.length;s++)n=l[s],s6(e).call(e,n)>=0||Object.prototype.propertyIsEnumerable.call(i,n)&&(a[n]=i[n])}return a}var a6={exports:{}};(function(i,e){i.exports=(()=>{var n={8:(l,u,p)=>{p.r(u),p.d(u,{Parser:()=>_t,Printer:()=>io,parse:()=>ft,print:()=>Yt});const m=`
`,g="".concat("\r").concat(m),E=" ";let y;function C(Me){return Me>="0"&&Me<="9"}function I(Me){return Me>="!"&&Me<="~"}function j(Me){return I(Me)||Me>=""&&Me<="ÿ"}function P(Me){return Me==="!"||Me>="#"&&Me<="'"||Me>="*"&&Me<="+"||Me>="-"&&Me<="."||Me>="0"&&Me<="9"||Me>="A"&&Me<="Z"||Me>="^"&&Me<="~"}function U(Me){return Me>="1"&&Me<="9"}function q(Me){return Me>="A"&&Me<="Z"||Me>="a"&&Me<="z"}function J(Me){return Me==="d"||Me==="h"||Me==="m"||Me==="s"}function se(Me){return Me>""&&Me<"	"||Me>"\v"&&Me<"\f"||Me>""&&Me<"ÿ"}function he(Me){return q(Me)||C(Me)||Me==="+"||Me==="/"}function ae(Me){return C(Me)||q(Me)||Me==="+"||Me==="/"||Me==="-"||Me==="_"}function de(Me){return q(Me)||C(Me)||Me==="+"||Me==="/"}function me(Me,D){var Q=Object.keys(Me);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(Me);D&&(re=re.filter(function(Ae){return Object.getOwnPropertyDescriptor(Me,Ae).enumerable})),Q.push.apply(Q,re)}return Q}function ge(Me){for(var D=1;D<arguments.length;D++){var Q=arguments[D]!=null?arguments[D]:{};D%2?me(Object(Q),!0).forEach(function(re){Oe(Me,re,Q[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Me,Object.getOwnPropertyDescriptors(Q)):me(Object(Q)).forEach(function(re){Object.defineProperty(Me,re,Object.getOwnPropertyDescriptor(Q,re))})}return Me}function Oe(Me,D,Q){return D in Me?Object.defineProperty(Me,D,{value:Q,enumerable:!0,configurable:!0,writable:!0}):Me[D]=Q,Me}(function(Me){Me.VERSION="v",Me.ORIGIN="o",Me.SESSION_NAME="s",Me.INFORMATION="i",Me.URI="u",Me.EMAIL="e",Me.PHONE="p",Me.CONNECTION="c",Me.BANDWIDTH="b",Me.TIME="t",Me.REPEAT="r",Me.ZONE_ADJUSTMENTS="z",Me.KEY="k",Me.ATTRIBUTE="a",Me.MEDIA="m"})(y||(y={}));class De{consumeText(D,Q){let re=Q;for(;re<D.length;){const Ae=D[re];if(Ae==="\0"||Ae==="\r"||Ae===m)break;re+=1}if(re-Q==0)throw new Error("Invalid text, at ".concat(D));return re}consumeUnicastAddress(D,Q,re){return this.consumeTill(D,Q,E)}consumeOneOrMore(D,Q,re){let Ae=Q;for(;re(D[Ae]);)Ae++;if(Ae-Q==0)throw new Error("Invalid rule at ".concat(Q,"."));return Ae}consumeSpace(D,Q){if(D[Q]===E)return Q+1;throw new Error("Invalid space at ".concat(Q,"."))}consumeIP4Address(D,Q){let re=Q;for(let Ae=0;Ae<4;Ae++)if(re=this.consumeDecimalUChar(D,re),Ae!==3){if(D[re]!==".")throw new Error("Invalid IP4 address.");re++}return re}consumeDecimalUChar(D,Q){let re=Q;for(let Et=0;Et<3&&C(D[re]);Et++,re++);if(re-Q==0)throw new Error("Invalid decimal uchar.");const Ae=parseInt(D.slice(Q,re));if(Ae>=0&&Ae<=255)return re;throw new Error("Invalid decimal uchar")}consumeIP6Address(D,Q){let re=this.consumeHexpart(D,Q);return D[re]===":"&&(re+=1,re=this.consumeIP4Address(D,re)),re}consumeHexpart(D,Q){let re=Q;if(D[re]===":"&&D[re+1]===":"){re+=2;try{re=this.consumeHexseq(D,re)}catch{}return re}if(re=this.consumeHexseq(D,re),D[re]===":"&&D[re+1]===":"){re+=2;try{re=this.consumeHexseq(D,re)}catch{}return re}return re}consumeHexseq(D,Q){let re=Q;for(;re=this.consumeHex4(D,re),D[re]===":"&&D[re+1]!==":";)re+=1;return re}consumeHex4(D,Q){let re=0;for(;re<4;re++)if(!((Ae=D[Q+re])>="0"&&Ae<="9"||Ae>="a"&&Ae<="f"||Ae>="A"&&Ae<="F")){if(re===0)throw new Error("Invalid hex 4");break}var Ae;return Q+re}consumeFQDN(D,Q){let re=Q;for(;C(D[re])||q(D[re])||D[re]==="-"||D[re]===".";)re+=1;if(re-Q<4)throw new Error("Invalid FQDN");return re}consumeExtnAddr(D,Q){return this.consumeOneOrMore(D,Q,j)}consumeMulticastAddress(D,Q,re){switch(re){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(D,Q);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(D,Q);default:try{return this.consumeFQDN(D,Q)}catch{return this.consumeExtnAddr(D,Q)}}}consumeIP6MulticastAddress(D,Q){const re=this.consumeHexpart(D,Q);return D[re]==="/"?this.consumeInteger(D,re+1):re}consumeIP4MulticastAddress(D,Q){let re=Q+3;const Ae=D.slice(Q,re),Et=parseInt(Ae);if(Et<224||Et>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let In=0;In<3;In++){if(D[re]!==".")throw new Error("Invalid IP4 multicast address.");re+=1,re=this.consumeDecimalUChar(D,re)}return D[re]==="/"&&(re+=1),re=this.consumeTTL(D,re),D[re]==="/"&&(re=this.consumeInteger(D,re)),re}consumeInteger(D,Q){if(!U(D[Q]))throw new Error("Invalid integer.");for(Q+=1;C(D[Q]);)Q+=1;return Q}consumeTTL(D,Q){if(D[Q]==="0")return Q+1;if(!U(D[Q]))throw new Error("Invalid TTL.");Q+=1;for(let re=0;re<2&&C(D[Q]);re++)Q+=1;return Q}consumeToken(D,Q){return this.consumeOneOrMore(D,Q,P)}consumeTime(D,Q){let re=Q;if(D[re]==="0")return re+1;for(U(D[re])&&(re+=1);C(D[re]);)re++;if(re-Q<10)throw new Error("Invalid time");return re}consumeAddress(D,Q){return this.consumeTill(D,Q,E)}consumeTypedTime(D,Q){let re=Q;return re=this.consumeOneOrMore(D,re,C),J(D[re])?re+1:re}consumeRepeatInterval(D,Q){if(!U(D[Q]))throw new Error("Invalid repeat interval");for(Q+=1;C(D[Q]);)Q+=1;return J(D[Q])&&(Q+=1),Q}consumePort(D,Q){return this.consumeOneOrMore(D,Q,C)}consume(D,Q,re){for(let Ae=0;Ae<re.length;Ae++){if(Q+Ae>=D.length)throw new Error("consume exceeding value length");if(D[Q+Ae]!==re[Ae])throw new Error("consume ".concat(re," failed at ").concat(Ae))}return Q+re.length}consumeTill(D,Q,re){let Ae=Q;for(;Ae<D.length&&(typeof re!="string"||D[Ae]!==re)&&(typeof re!="function"||!re(D[Ae]));)Ae++;return Ae}}class _t extends De{constructor(){super(),Oe(this,"records",[]),Oe(this,"currentLine",0)}parse(D){const Q=this.probeEOL(D);this.records=D.split(Q).filter(xr=>!!xr.trim()).map(this.parseLine),this.currentLine=0;const re=this.parseVersion(),Ae=this.parseOrigin(),Et=this.parseSessionName(),In=this.parseInformation(),ji=this.parseUri(),so=this.parseEmail(),md=this.parsePhone(),eC=this.parseConnection(),tC=this.parseBandWidth(),ia=this.parseTimeFields(),ju=this.parseKey(),Dm=this.parseSessionAttribute(),hr=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:re,origin:Ae,sessionName:Et,information:In,uri:ji,emails:so,phones:md,connection:eC,bandwidths:tC,timeFields:ia,key:ju,attributes:Dm,mediaDescriptions:hr}}getCurrentRecord(){const D=this.records[this.currentLine];if(!D)throw new Error("Record doesn't exit.");return D}probeEOL(D){for(let Q=0;Q<D.length;Q++)if(D[Q]===m)return D[Q-1]==="\r"?g:m;throw new Error("Invalid newline character.")}parseLine(D,Q){if(D.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const re=D[0];if(D[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:re,value:D.slice(2),line:Q,cur:0}}parseSessionAttribute(){const D=new Rn;for(;this.currentLine<this.records.length;){const Q=this.getCurrentRecord();if(Q.type!==y.ATTRIBUTE)break;const re={attField:this.extractOneOrMore(Q,Ae=>P(Ae)&&Ae!==":"),_cur:0};Q.value[Q.cur]===":"&&(Q.cur+=1,re.attValue=this.extractOneOrMore(Q,se)),D.parse(re),this.currentLine++}return D.digest()}parseMediaAttributes(D){const Q=new kr(D);for(;this.currentLine<this.records.length;){const re=this.getCurrentRecord();if(re.type!==y.ATTRIBUTE)break;const Ae={attField:this.extractOneOrMore(re,Et=>P(Et)&&Et!==":"),_cur:0};re.value[re.cur]===":"&&(re.cur+=1,Ae.attValue=this.extractOneOrMore(re,se)),Q.parse(Ae),this.currentLine++}return Q.digest()}parseKey(){const D=this.getCurrentRecord();if(D.type===y.KEY){if(D.value==="prompt"||D.value==="clear:"||D.value==="base64:"||D.value==="uri:")return D.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const D=this.getCurrentRecord();if(D.type===y.ZONE_ADJUSTMENTS){const Q=[];for(;;)try{const re=this.extract(D,this.consumeTime);this.consumeSpaceForRecord(D);let Ae=!1;D.value[D.cur]==="-"&&(Ae=!0,D.cur+=1);const Et=this.extract(D,this.consumeTypedTime);Q.push({time:re,typedTime:Et,back:Ae})}catch{break}if(Q.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,Q}return[]}parseRepeat(){const D=[];for(;;){const Q=this.getCurrentRecord();if(Q.type!==y.REPEAT)break;{const re=this.extract(Q,this.consumeRepeatInterval),Ae=this.parseTypedTime(Q);D.push({repeatInterval:re,typedTimes:Ae}),this.currentLine++}}return D}parseTypedTime(D){const Q=[];for(;;)try{this.consumeSpaceForRecord(D),Q.push(this.extract(D,this.consumeTypedTime))}catch{break}if(Q.length===0)throw new Error("Invalid typed time.");return Q}parseTime(){const D=this.getCurrentRecord(),Q=this.extract(D,this.consumeTime);this.consumeSpaceForRecord(D);const re=this.extract(D,this.consumeTime);return this.currentLine++,{startTime:Q,stopTime:re}}parseBandWidth(){const D=[];for(;this.currentLine<this.records.length;){const Q=this.getCurrentRecord();if(Q.type!==y.BANDWIDTH)break;{const re=this.extractOneOrMore(Q,P);if(Q.value[Q.cur]!==":")throw new Error("Invalid bandwidth field.");Q.cur++;const Ae=this.extractOneOrMore(Q,C);D.push({bwtype:re,bandwidth:Ae}),this.currentLine++}}return D}parseVersion(){const D=this.getCurrentRecord();if(D.type!==y.VERSION)throw new Error("first sdp record must be version");const Q=D.value.slice(0,this.consumeOneOrMore(D.value,0,C));if(Q.length!==D.value.length)throw new Error('invalid proto version, "v='.concat(D.value,'"'));return this.currentLine++,Q}parseOrigin(){const D=this.getCurrentRecord();if(D.type!==y.ORIGIN)throw new Error("second line of sdp must be origin");const Q=this.extractOneOrMore(D,j);this.consumeSpaceForRecord(D);const re=this.extractOneOrMore(D,C);this.consumeSpaceForRecord(D);const Ae=this.extractOneOrMore(D,C);this.consumeSpaceForRecord(D);const Et=this.extractOneOrMore(D,P);this.consumeSpaceForRecord(D);const In=this.extractOneOrMore(D,P);this.consumeSpaceForRecord(D);const ji=this.extract(D,this.consumeUnicastAddress);return this.currentLine++,{username:Q,sessId:re,sessVersion:Ae,nettype:Et,addrtype:In,unicastAddress:ji}}parseSessionName(){const D=this.getCurrentRecord();if(D.type===y.SESSION_NAME){const Q=this.extract(D,this.consumeText);return this.currentLine++,Q}}parseInformation(){const D=this.getCurrentRecord();if(D.type!==y.INFORMATION)return;const Q=this.extract(D,this.consumeText);return this.currentLine++,Q}parseUri(){const D=this.getCurrentRecord();if(D.type===y.URI)return this.currentLine++,D.value}parseEmail(){const D=[];for(;;){const Q=this.getCurrentRecord();if(Q.type!==y.EMAIL)break;D.push(Q.value),this.currentLine++}return D}parsePhone(){const D=[];for(;;){const Q=this.getCurrentRecord();if(Q.type!==y.PHONE)break;D.push(Q.value),this.currentLine++}return D}parseConnection(){const D=this.getCurrentRecord();if(D.type===y.CONNECTION){const Q=this.extractOneOrMore(D,P);this.consumeSpaceForRecord(D);const re=this.extractOneOrMore(D,P);this.consumeSpaceForRecord(D);const Ae=this.extract(D,this.consumeAddress);return this.currentLine++,{nettype:Q,addrtype:re,address:Ae}}}parseMedia(){const D=this.getCurrentRecord(),Q=this.extract(D,this.consumeToken);this.consumeSpaceForRecord(D);let re=this.extract(D,this.consumePort);D.value[D.cur]==="/"&&(D.cur+=1,re+=this.extract(D,this.consumeInteger)),this.consumeSpaceForRecord(D);const Ae=[];for(Ae.push(this.extract(D,this.consumeToken));D.value[D.cur]==="/";)D.cur+=1,Ae.push(this.extract(D,this.consumeToken));if(Ae.length===0)throw new Error("Invalid proto");const Et=this.parseFmt(D);return this.currentLine++,{mediaType:Q,port:re,protos:Ae,fmts:Et}}parseTimeFields(){const D=[];for(;this.getCurrentRecord().type===y.TIME;){const Q=this.parseTime(),re=this.parseRepeat(),Ae=this.parseZone();D.push({time:Q,repeats:re,zones:Ae})}return D}parseMediaDescription(){const D=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.MEDIA;){const Q=this.parseMedia(),re=this.parseInformation(),Ae=this.parseConnections(),Et=this.parseBandWidth(),In=this.parseKey(),ji=this.parseMediaAttributes(Q);D.push({media:Q,information:re,connections:Ae,bandwidths:Et,key:In,attributes:ji})}return D}parseConnections(){const D=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.CONNECTION;)D.push(this.parseConnection());return D}parseFmt(D){const Q=[];for(;;)try{this.consumeSpaceForRecord(D),Q.push(this.extract(D,this.consumeToken))}catch{break}if(Q.length===0)throw new Error("Invalid fmts");return Q}extract(D,Q,...re){const Ae=Q.call(this,D.value,D.cur,...re),Et=D.value.slice(D.cur,Ae);return D.cur=Ae,Et}extractOneOrMore(D,Q){const re=this.consumeOneOrMore(D.value,D.cur,Q),Ae=D.value.slice(D.cur,re);return D.cur=re,Ae}consumeSpaceForRecord(D){if(D.value[D.cur]!==E)throw new Error("Invalid space at ".concat(D.cur,"."));D.cur+=1}}class Pt extends De{constructor(...D){super(...D),Oe(this,"attributes",void 0),Oe(this,"digested",!1)}extractOneOrMore(D,Q,re){const Ae=this.consumeOneOrMore(D.attValue,D._cur,Q),Et=D.attValue.slice(D._cur,Ae),[In,ji]=re||[];if(typeof In=="number"&&Et.length<In)throw new Error("error in length, should be more or equal than ".concat(In," characters."));if(typeof ji=="number"&&Et.length>ji)throw new Error("error in length, should be less or equal than ".concat(ji," characters."));return D._cur=Ae,Et}consumeAttributeSpace(D){if(D.attValue[D._cur]!==E)throw new Error("Invalid space at ".concat(D._cur,"."));D._cur+=1}extract(D,Q,...re){if(!D.attValue)throw new Error("Nothing to extract from attValue.");const Ae=Q.call(this,D.attValue,D._cur,...re),Et=D.attValue.slice(D._cur,Ae);return D._cur=Ae,Et}atEnd(D){if(!D.attValue)throw new Error;return D._cur>=D.attValue.length}peekChar(D){if(!D.attValue)throw new Error;return D.attValue[D._cur]}peek(D,Q){if(!D.attValue)throw new Error;for(let re=0;re<Q.length;re++)if(Q[re]!==D.attValue[D._cur+re])return!1;return!0}parseIceUfrag(D){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(D,he,[4,256])}parseIcePwd(D){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(D,he,[22,256])}parseIceOptions(D){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const Q=[];for(;!this.atEnd(D);){Q.push(this.extractOneOrMore(D,he));try{this.consumeAttributeSpace(D)}catch(re){if(this.atEnd(D))break;throw re}}this.attributes.iceOptions=Q}parseFingerprint(D){const Q=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D);const re=this.extract(D,this.consumeTill);this.attributes.fingerprints.push({hashFunction:Q,fingerprint:re})}parseExtmap(D){const Q=this.extractOneOrMore(D,C);let re;this.peekChar(D)==="/"&&(this.extract(D,this.consume,"/"),re=this.extract(D,this.consumeToken)),this.consumeAttributeSpace(D);const Ae=this.extract(D,this.consumeTill,E),Et=ge(ge({entry:parseInt(Q,10)},re&&{direction:re}),{},{extensionName:Ae});this.peekChar(D)===E&&(this.consumeAttributeSpace(D),Et.extensionAttributes=this.extract(D,this.consumeTill)),this.attributes.extmaps.push(Et)}parseSetup(D){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const Q=this.extract(D,this.consumeTill);if(Q!=="active"&&Q!=="passive"&&Q!=="actpass"&&Q!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=Q}}class Rn extends Pt{constructor(...D){super(...D),Oe(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(D){if(this.digested)throw new Error("already digested");try{switch(D.attField){case"group":this.parseGroup(D);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(D);break;case"ice-pwd":this.parseIcePwd(D);break;case"ice-options":this.parseIceOptions(D);break;case"fingerprint":this.parseFingerprint(D);break;case"setup":this.parseSetup(D);break;case"tls-id":this.parseTlsId(D);break;case"identity":this.parseIdentity(D);break;case"extmap":this.parseExtmap(D);break;case"msid-semantic":this.parseMsidSemantic(D);break;default:D.ignored=!0,this.attributes.unrecognized.push(D)}}catch(Q){throw console.error("parsing session attribute ".concat(D.attField,' error, "a=').concat(D.attField,":").concat(D.attValue,'"')),Q}if(!D.ignored&&D.attValue&&!this.atEnd(D))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(D){const Q=this.extract(D,this.consumeToken),re=[];for(;!this.atEnd(D)&&this.peekChar(D)===E;)this.consumeAttributeSpace(D),re.push(this.extract(D,this.consumeToken));this.attributes.groups.push({semantic:Q,identificationTag:re})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(D){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(D,ae)}parseIdentity(D){const Q=this.extractOneOrMore(D,de),re=[];for(;!this.atEnd(D)&&this.peekChar(D)===E;){this.consumeAttributeSpace(D);const Ae=this.extract(D,this.consumeToken);this.extract(D,this.consume,"=");const Et=this.extractOneOrMore(D,In=>In!==E&&se(In));re.push({name:Ae,value:Et})}this.attributes.identities.push({assertionValue:Q,extensions:re})}parseMsidSemantic(D){this.peekChar(D)===E&&this.consumeAttributeSpace(D);const Q={semantic:this.extract(D,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(D)}catch{break}if(this.peekChar(D)==="*"){this.extract(D,this.consume,"*"),Q.applyForAll=!0;break}{const re=this.extract(D,this.consumeTill,E);Q.identifierList.push(re)}}this.attributes.msidSemantic=Q}}class kr extends Pt{constructor(D){super(),Oe(this,"attributes",void 0),D.protos.indexOf("RTP")!==-1||D.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(D){if(this.digested)throw new Error("already digested");try{switch(D.attField){case"extmap":this.parseExtmap(D);break;case"setup":this.parseSetup(D);break;case"ice-ufrag":this.parseIceUfrag(D);break;case"ice-pwd":this.parseIcePwd(D);break;case"ice-options":this.parseIceOptions(D);break;case"candidate":this.parseCandidate(D);break;case"remote-candidate":this.parseRemoteCandidate(D);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(D);break;case"rtpmap":this.parseRtpmap(D);break;case"ptime":this.parsePtime(D);break;case"maxptime":this.parseMaxPtime(D);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(D);break;case"ssrc":this.parseSSRC(D);break;case"fmtp":this.parseFmtp(D);break;case"rtcp-fb":this.parseRtcpFb(D);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(D);break;case"mid":this.parseMid(D);break;case"msid":this.parseMsid(D);break;case"imageattr":this.parseImageAttr(D);break;case"rid":this.parseRid(D);break;case"simulcast":this.parseSimulcast(D);break;case"sctp-port":this.parseSctpPort(D);break;case"max-message-size":this.parseMaxMessageSize(D);break;case"ssrc-group":this.parseSSRCGroup(D);break;default:D.ignored=!0,this.attributes.unrecognized.push(D)}}catch(Q){throw console.error("parsing media attribute ".concat(D.attField,' error, "a=').concat(D.attField,":").concat(D.attValue,'"')),Q}if(!D.ignored&&D.attValue&&!this.atEnd(D))throw new Error("attribute parsing error")}parseCandidate(D){const Q=this.extractOneOrMore(D,he,[1,32]);this.consumeAttributeSpace(D);const re=this.extractOneOrMore(D,C,[1,5]);this.consumeAttributeSpace(D);const Ae=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D);const Et=this.extractOneOrMore(D,C,[1,10]);this.consumeAttributeSpace(D);const In=this.extract(D,this.consumeAddress);this.consumeAttributeSpace(D);const ji=this.extract(D,this.consumePort);this.consumeAttributeSpace(D),this.extract(D,this.consume,"typ"),this.consumeAttributeSpace(D);const so={foundation:Q,componentId:re,transport:Ae,priority:Et,connectionAddress:In,port:ji,type:this.extract(D,this.consumeToken),extension:{}};for(this.peek(D," raddr")&&(this.extract(D,this.consume," raddr"),this.consumeAttributeSpace(D),so.relAddr=this.extract(D,this.consumeAddress)),this.peek(D," rport")&&(this.extract(D,this.consume," rport"),this.consumeAttributeSpace(D),so.relPort=this.extract(D,this.consumePort));this.peekChar(D)===E;){this.consumeAttributeSpace(D);const md=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D),so.extension[md]=this.extractOneOrMore(D,I)}this.attributes.candidates.push(so)}parseRemoteCandidate(D){const Q=[];for(;;){const re=this.extractOneOrMore(D,C,[1,5]);this.consumeAttributeSpace(D);const Ae=this.extract(D,this.consumeAddress);this.consumeAttributeSpace(D);const Et=this.extract(D,this.consumePort);Q.push({componentId:re,connectionAddress:Ae,port:Et});try{this.consumeAttributeSpace(D)}catch{break}}this.attributes.remoteCandidatesList.push(Q)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(D){const Q=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D);const re=this.extract(D,this.consumeTill,"/");this.extract(D,this.consume,"/");const Ae={encodingName:re,clockRate:this.extractOneOrMore(D,C)};this.atEnd(D)||this.peekChar(D)!=="/"||(this.extract(D,this.consume,"/"),Ae.encodingParameters=parseInt(this.extract(D,this.consumeTill),10));const Et=this.attributes.payloads.find(In=>In.payloadType===parseInt(Q,10));Et?Et.rtpMap=Ae:this.attributes.payloads.push({payloadType:parseInt(Q,10),rtpMap:Ae,rtcpFeedbacks:[]})}parsePtime(D){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(D,this.consumeTill)}parseMaxPtime(D){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(D,this.consumeTill)}parseDirection(D){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=D.attField}parseSSRC(D){const Q=this.extractOneOrMore(D,C);this.consumeAttributeSpace(D);const re=this.extract(D,this.consumeTill,":");let Ae;this.peekChar(D)===":"&&(this.extract(D,this.consume,":"),Ae=this.extract(D,this.consumeTill));const Et=this.attributes.ssrcs.find(In=>In.ssrcId===parseInt(Q,10));Et?Et.attributes[re]=Ae:this.attributes.ssrcs.push({ssrcId:parseInt(Q,10),attributes:{[re]:Ae}})}parseFmtp(D){const Q=this.extract(D,this.consumeTill,E);this.consumeAttributeSpace(D);const re=this.extract(D,this.consumeTill),Ae={};re.split(";").forEach(In=>{let[ji,so]=In.split("=");ji=ji.trim();const md=typeof so=="string"?so.trim():null;typeof ji=="string"&&ji.length>0&&(Ae[ji]=md)});const Et=this.attributes.payloads.find(In=>In.payloadType===parseInt(Q,10));Et?Et.fmtp={parameters:Ae}:this.attributes.payloads.push({payloadType:parseInt(Q,10),rtcpFeedbacks:[],fmtp:{parameters:Ae}})}parseFmtParameters(D){const Q={},re=this.extract(D,this.consumeTill,"=");D._cur++;const Ae=this.extract(D,this.consumeTill,";");for(Q[re]=Ae;D.attValue[D._cur]===";";){const Et=this.extract(D,this.consumeTill,"=");D._cur++;const In=this.extract(D,this.consumeTill,";");Q[Et]=In}return Q}parseRtcpFb(D){let Q="";Q=this.peekChar(D)==="*"?this.extract(D,this.consume,"*"):this.extract(D,this.consumeTill,E),this.consumeAttributeSpace(D);const re=this.extract(D,this.consumeTill,E);let Ae;if(re==="trr-int")Ae={type:re,interval:this.extract(D,this.consumeTill)};else{const Et={type:re};this.peekChar(D)===E&&(this.consumeAttributeSpace(D),Et.parameter=this.extract(D,this.consumeToken),this.peekChar(D)===E&&(Et.additional=this.extract(D,this.consumeTill))),Ae=Et}if(Q==="*")this.attributes.rtcpFeedbackWildcards.push(Ae);else{const Et=this.attributes.payloads.find(In=>In.payloadType===parseInt(Q,10));Et?Et.rtcpFeedbacks.push(Ae):this.attributes.payloads.push({payloadType:parseInt(Q,10),rtcpFeedbacks:[Ae]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(D){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const Q={port:this.extract(D,this.consumePort)};this.peekChar(D)===E&&(this.consumeAttributeSpace(D),Q.netType=this.extractOneOrMore(D,P),this.consumeAttributeSpace(D),Q.addressType=this.extractOneOrMore(D,P),this.consumeAttributeSpace(D),Q.address=this.extract(D,this.consumeAddress)),this.attributes.rtcp=Q}parseMsid(D){const Q={id:this.extractOneOrMore(D,P,[1,64])};this.peekChar(D)===E&&(this.consumeAttributeSpace(D),Q.appdata=this.extractOneOrMore(D,P,[1,64])),this.attributes.msids.push(Q)}parseImageAttr(D){this.attributes.imageattr.push(D.attValue)}parseRid(D){const Q=this.extractOneOrMore(D,Ae=>q(Ae)||C(Ae)||Ae==="_"||Ae==="-");this.consumeAttributeSpace(D);const re={id:Q,direction:this.extract(D,this.consumeToken),params:[]};if(this.peekChar(D)===E){if(this.consumeAttributeSpace(D),this.peek(D,"pt=")){this.extract(D,this.consume,"pt=");const Ae=[];for(;;){const Et=this.extract(D,this.consumeToken);Ae.push(Et);try{this.extract(D,this.consume,",")}catch{break}}re.payloads=Ae,this.peekChar(D)===E&&this.extract(D,this.consume,E)}for(;;){const Ae=this.extract(D,this.consumeToken);switch(Ae){case"depend":{const Et={type:Ae,rids:this.extract(D,this.consume,"=").split(",")};re.params.push(Et);break}default:{const Et={type:Ae};this.peekChar(D)==="="&&(this.extract(D,this.consume,"="),Et.val=this.extract(D,this.consumeTill,";")),re.params.push(Et)}}try{this.extract(D,this.consume,";")}catch{break}}}this.attributes.rids.push(re)}parseSimulcast(D){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=D.attValue,this.extract(D,this.consumeTill)}parseSctpPort(D){this.attributes.sctpPort=this.extractOneOrMore(D,C,[1,5])}parseMaxMessageSize(D){this.attributes.maxMessageSize=this.extractOneOrMore(D,C,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(D){this.attributes.mid=this.extract(D,this.consumeToken)}parseSSRCGroup(D){const Q=this.extract(D,this.consumeToken),re=[];for(;;)try{this.consumeAttributeSpace(D);const Ae=this.extract(D,this.consumeInteger);re.push(parseInt(Ae,10))}catch{break}this.attributes.ssrcGroups.push({semantic:Q,ssrcIds:re})}}function xn(Me,D,Q){return D in Me?Object.defineProperty(Me,D,{value:Q,enumerable:!0,configurable:!0,writable:!0}):Me[D]=Q,Me}class io{constructor(){xn(this,"eol",g)}print(D,Q){let re="";return Q&&(this.eol=Q),re+=this.printVersion(D.version),re+=this.printOrigin(D.origin),re+=this.printSessionName(D.sessionName),re+=this.printInformation(D.information),re+=this.printUri(D.uri),re+=this.printEmail(D.emails),re+=this.printPhone(D.phones),re+=this.printConnection(D.connection),re+=this.printBandwidth(D.bandwidths),re+=this.printTimeFields(D.timeFields),re+=this.printKey(D.key),re+=this.printSessionAttributes(D.attributes),re+=this.printMediaDescription(D.mediaDescriptions),re}printVersion(D){return"v=".concat(D).concat(this.eol)}printOrigin(D){return"o=".concat(D.username," ").concat(D.sessId," ").concat(D.sessVersion," ").concat(D.nettype," ").concat(D.addrtype," ").concat(D.unicastAddress).concat(this.eol)}printSessionName(D){return D?"s=".concat(D).concat(this.eol):""}printInformation(D){return D?"i=".concat(D).concat(this.eol):""}printUri(D){return D?"u=".concat(D).concat(this.eol):""}printEmail(D){let Q="";for(const re of D)Q+="e=".concat(re).concat(this.eol);return Q}printPhone(D){let Q="";for(const re of D)Q+="e=".concat(re).concat(this.eol);return Q}printConnection(D){return D?"c=".concat(D.nettype," ").concat(D.addrtype," ").concat(D.address).concat(this.eol):""}printBandwidth(D){let Q="";for(const re of D)Q+="b=".concat(re.bwtype,":").concat(re.bandwidth).concat(this.eol);return Q}printTimeFields(D){let Q="";for(const re of D){Q+="t=".concat(re.time.startTime," ").concat(re.time.startTime).concat(this.eol);for(const Ae of re.repeats)Q+="r=".concat(Ae.repeatInterval," ").concat(Ae.typedTimes.join(" ")).concat(this.eol);re.zoneAdjustments&&(Q+="z=",Q+="z=".concat(re.zoneAdjustments.map(Ae=>"".concat(Ae.time," ").concat(Ae.back?"-":""," ").concat(Ae.typedTime)).join(" ")).concat(this.eol),Q+=this.eol)}return Q}printKey(D){return D?"k=".concat(D).concat(this.eol):""}printAttributes(D){let Q="";for(const re of D)Q+="a=".concat(re.attField).concat(re.attValue?":".concat(re.attValue):"").concat(this.eol);return Q}printMediaDescription(D){let Q="";for(const re of D)Q+=this.printMedia(re.media),Q+=this.printInformation(re.information),Q+=this.printConnections(re.connections),Q+=this.printBandwidth(re.bandwidths),Q+=this.printKey(re.key),Q+=this.printMediaAttributes(re);return Q}printConnections(D){let Q="";for(const re of D)Q+=this.printConnection(re);return Q}printMedia(D){return"m=".concat(D.mediaType," ").concat(D.port," ").concat(D.protos.join("/")," ").concat(D.fmts.join(" ")).concat(this.eol)}printSessionAttributes(D){return new xe(this.eol).print(D)}printMediaAttributes(D){return new Ke(this.eol).print(D)}}class Te{constructor(D){xn(this,"eol",void 0),this.eol=D}printIceUfrag(D){return D===void 0?"":"a=ice-ufrag:".concat(D).concat(this.eol)}printIcePwd(D){return D===void 0?"":"a=ice-pwd:".concat(D).concat(this.eol)}printIceOptions(D){return D===void 0?"":"a=ice-options:".concat(D.join(E)).concat(this.eol)}printFingerprints(D){return D.length>0?D.map(Q=>"a=fingerprint:".concat(Q.hashFunction).concat(E).concat(Q.fingerprint)).join(this.eol)+this.eol:""}printExtmap(D){return D.map(Q=>"a=extmap:".concat(Q.entry).concat(Q.direction?"/".concat(Q.direction):"").concat(E).concat(Q.extensionName).concat(Q.extensionAttributes?"".concat(E).concat(Q.extensionAttributes):"").concat(this.eol)).join("")}printSetup(D){return D===void 0?"":"a=setup:".concat(D).concat(this.eol)}printUnrecognized(D){return D.map(Q=>"a=".concat(Q.attField).concat(Q.attValue?":".concat(Q.attValue):"").concat(this.eol)).join("")}}class xe extends Te{print(D){let Q="";return Q+=this.printGroups(D.groups),Q+=this.printMsidSemantic(D.msidSemantic),Q+=this.printIceLite(D.iceLite),Q+=this.printIceUfrag(D.iceUfrag),Q+=this.printIcePwd(D.icePwd),Q+=this.printIceOptions(D.iceOptions),Q+=this.printFingerprints(D.fingerprints),Q+=this.printSetup(D.setup),Q+=this.printTlsId(D.tlsId),Q+=this.printIdentity(D.identities),Q+=this.printExtmap(D.extmaps),Q+=this.printUnrecognized(D.unrecognized),Q}printGroups(D){let Q="";return D.length>0&&(Q+=D.map(re=>"a=group:".concat(re.semantic).concat(re.identificationTag.map(Ae=>"".concat(E).concat(Ae)).join("")).concat(this.eol)).join("")),Q}printIceLite(D){return D===void 0?"":"a=ice-lite"+this.eol}printTlsId(D){return D?"a=tls-id:".concat(D).concat(this.eol):""}printIdentity(D){return D.length===0?"":D.map(Q=>"a=identity:".concat(Q.assertionValue).concat(Q.extensions.map(re=>"".concat(E).concat(re.name).concat(re.value?"=".concat(re.value):"")))).join(this.eol)+this.eol}printMsidSemantic(D){if(!D)return"";let Q="a=msid-semantic:".concat(D.semantic);return D.applyForAll?Q+="".concat(E,"*"):D.identifierList.length>0&&(Q+=D.identifierList.map(re=>"".concat(E).concat(re))),Q+this.eol}}class Ke extends Te{print(D){const Q=D.attributes;let re="";return re+=this.printRTCP(Q.rtcp),re+=this.printIceUfrag(Q.iceUfrag),re+=this.printIcePwd(Q.icePwd),re+=this.printIceOptions(Q.iceOptions),re+=this.printCandidates(Q.candidates),re+=this.printRemoteCandidatesList(Q.remoteCandidatesList),re+=this.printEndOfCandidates(Q.endOfCandidates),re+=this.printFingerprints(Q.fingerprints),re+=this.printSetup(Q.setup),re+=this.printMid(Q.mid),re+=this.printExtmap(Q.extmaps),re+=this.printRTPRelated(Q),re+=this.printPtime(Q.ptime),re+=this.printMaxPtime(Q.maxPtime),re+=this.printDirection(Q.direction),re+=this.printSSRCGroups(Q.ssrcGroups),re+=this.printSSRC(Q.ssrcs),re+=this.printRTCPMux(Q.rtcpMux),re+=this.printRTCPMuxOnly(Q.rtcpMuxOnly),re+=this.printRTCPRsize(Q.rtcpRsize),re+=this.printMSId(Q.msids),re+=this.printImageattr(Q.imageattr),re+=this.printRid(Q.rids),re+=this.printSimulcast(Q.simulcast),re+=this.printSCTPPort(Q.sctpPort),re+=this.printMaxMessageSize(Q.maxMessageSize),re+=this.printUnrecognized(Q.unrecognized),re}printCandidates(D){return D.map(Q=>"a=candidate:".concat(Q.foundation).concat(E).concat(Q.componentId).concat(E).concat(Q.transport).concat(E).concat(Q.priority).concat(E).concat(Q.connectionAddress).concat(E).concat(Q.port).concat(E,"typ").concat(E).concat(Q.type).concat(Q.relAddr?"".concat(E,"raddr").concat(E).concat(Q.relAddr):"").concat(Q.relPort?"".concat(E,"rport").concat(E).concat(Q.relPort):"").concat(Object.keys(Q.extension).map(re=>"".concat(E).concat(re).concat(E).concat(Q.extension[re])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(D){return D.map(Q=>"a=remote-candidates:".concat(Q.join(E)).concat(this.eol)).join("")}printEndOfCandidates(D){return D===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(D){if(!D.payloads)return"";const Q=D.payloads;let re="";re+=D.rtcpFeedbackWildcards.map(Ae=>this.printRTCPFeedback("*",Ae)).join("");for(const Ae of Q)re+=this.printRtpMap(Ae.payloadType,Ae.rtpMap),re+=this.printFmtp(Ae.payloadType,Ae.fmtp),re+=Ae.rtcpFeedbacks.map(Et=>this.printRTCPFeedback(Ae.payloadType,Et)).join("");return re}printFmtp(D,Q){if(!Q)return"";const re=Object.keys(Q.parameters);return re.length===1&&Q.parameters[re[0]]===null?"a=fmtp:".concat(D).concat(E).concat(re[0]).concat(this.eol):"a=fmtp:".concat(D).concat(E).concat(Object.keys(Q.parameters).map(Ae=>"".concat(Ae,"=").concat(Q.parameters[Ae])).join(";")).concat(this.eol)}printRtpMap(D,Q){return Q?"a=rtpmap:".concat(D).concat(E).concat(Q.encodingName,"/").concat(Q.clockRate).concat(Q.encodingParameters?"/".concat(Q.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(D,Q){let re="a=rtcp-fb:".concat(D).concat(E),Ae=Q;return Ae.type==="trr-int"?re+="ttr-int".concat(E).concat(Ae.interval):(re+="".concat(Ae.type),Ae.parameter&&(re+="".concat(E).concat(Ae.parameter),Ae.additional&&(re+="".concat(E).concat(Ae.additional)))),re+this.eol}printPtime(D){return D===void 0?"":"a=ptime:".concat(D).concat(this.eol)}printMaxPtime(D){return D===void 0?"":"a=maxptime:".concat(D).concat(this.eol)}printDirection(D){return D===void 0?"":"a=".concat(D).concat(this.eol)}printSSRC(D){return D.map(Q=>Object.keys(Q.attributes).map(re=>"a=ssrc:".concat(Q.ssrcId.toString(10)).concat(E).concat(re).concat(Q.attributes[re]?":".concat(Q.attributes[re]):"").concat(this.eol)).join("")).join("")}printRTCPMux(D){return D===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(D){return D===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(D){return D===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(D){if(D===void 0)return"";let Q="a=rtcp:".concat(D.port);return D.netType&&(Q+="".concat(E).concat(D.netType)),D.addressType&&(Q+="".concat(E).concat(D.addressType)),D.address&&(Q+="".concat(E).concat(D.address)),Q+this.eol}printMSId(D){return D.map(Q=>"a=msid:".concat(Q.id).concat(Q.appdata?"".concat(E).concat(Q.appdata):"").concat(this.eol)).join("")}printImageattr(D){return D.map(Q=>"a=imageattr:".concat(Q).concat(this.eol)).join("")}printRid(D){return D.map(Q=>{let re="a=rid:".concat(Q.id).concat(E).concat(Q.direction);return Q.payloads&&(re+="".concat(E,"pt=").concat(Q.payloads.join(","))),Q.params.length>0&&(re+="".concat(E).concat(Q.params.map(Ae=>Ae.type==="depend"?"depend=".concat(Ae.rids.join(",")):"".concat(Ae.type,"=").concat(Ae.val)).join(";"))),re+this.eol}).join("")}printSimulcast(D){return D===void 0?"":"a=simulcast:".concat(D).concat(this.eol)}printSCTPPort(D){return D===void 0?"":"a=sctp-port:".concat(D).concat(this.eol)}printMaxMessageSize(D){return D===void 0?"":"a=max-message-size:".concat(D).concat(this.eol)}printMid(D){return D===void 0?"":"a=mid:".concat(D).concat(this.eol)}printSSRCGroups(D){return D.map(Q=>"a=ssrc-group:".concat(Q.semantic).concat(Q.ssrcIds.map(re=>"".concat(E).concat(re.toString(10))).join("")).concat(this.eol)).join("")}}function ft(Me){return new _t().parse(Me)}function Yt(Me,D){return new io().print(Me,D)}}},s={};function a(l){if(s[l])return s[l].exports;var u=s[l]={exports:{}};return n[l](u,u.exports,a),u.exports}return a.d=(l,u)=>{for(var p in u)a.o(u,p)&&!a.o(l,p)&&Object.defineProperty(l,p,{enumerable:!0,get:u[p]})},a.o=(l,u)=>Object.prototype.hasOwnProperty.call(l,u),a.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},a(8)})()})(a6);var Fn=a6.exports;function ja(i){if(Array.isArray(i))return i.map(n=>n);if(!c6(i))return i;const e={};for(const n in i){const s=i[n];c6(s)||Array.isArray(s)?e[n]=ja(s):e[n]=s}return e}function c6(i){return!(typeof i!="object"||Array.isArray(i)||!i)}class cx{constructor(e){R(this,"input",[]),R(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const gl={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},uv={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:gl,remoteCandidate:gl}},l6={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},d6={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},u6={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},h6={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function p6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function f6(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?p6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):p6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class lx{constructor(e,n){R(this,"onFirstVideoReceived",void 0),R(this,"onFirstVideoDecoded",void 0),R(this,"onFirstAudioReceived",void 0),R(this,"onFirstVideoDecodedTimeout",void 0),R(this,"onFirstAudioDecoded",void 0),R(this,"onSelectedLocalCandidateChanged",void 0),R(this,"onSelectedRemoteCandidateChanged",void 0),R(this,"videoIsReady",!1),R(this,"videoIsReady2",{}),R(this,"pc",void 0),R(this,"options",void 0),R(this,"intervalTimer",void 0),R(this,"stats",ja(uv)),R(this,"isFirstVideoReceived",{}),R(this,"isFirstVideoDecoded",{}),R(this,"isFirstAudioReceived",{}),R(this,"isFirstAudioDecoded",{}),R(this,"isFirstVideoDecodedTimeout",{}),R(this,"lossRateWindowStats",[]),this.pc=e,this.options=n,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new pe(e=>{e({local:f6({},gl),remote:f6({},gl)})})}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,n){this.videoIsReady2[e]=n}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const n=this.lossRateWindowStats.length,s=["videoSend","audioSend","videoRecv","audioRecv"];let a=0,l=0,u=0,p=0;for(const m of s)e[m].forEach((g,E)=>{if(!this.lossRateWindowStats[n-1][m][E]||!this.lossRateWindowStats[0][m][E])return;const y=this.lossRateWindowStats[n-1][m][E].packets-this.lossRateWindowStats[0][m][E].packets,C=this.lossRateWindowStats[n-1][m][E].packetsLost-this.lossRateWindowStats[0][m][E].packetsLost;m==="videoSend"||m==="audioSend"?(a+=y,u+=C):(l+=y,p+=C),Number.isNaN(y)||Number.isNaN(y)?g.packetLostRate=0:g.packetLostRate=y<=0||C<=0?0:C/(y+C)});e.sendPacketLossRate=a<=0||u<=0?0:u/(a+u),e.recvPacketLossRate=l<=0||p<=0?0:p/(l+p)}}function m6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function yce(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?m6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):m6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class Sce extends lx{constructor(){super(...arguments),R(this,"_stats",uv),R(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),n=this.statsResponsesToObjects(e);this._stats=ja(uv);const s=n.filter(l=>l.type==="ssrc");this.processSSRCStats(s);const a=n.find(l=>l.type==="VideoBwe");a&&this.processBandwidthStats(a),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach(n=>{var s;const a=je(s=n.id).call(s,"send");switch("".concat(n.mediaType,"_").concat(a?"send":"recv")){case"video_send":{const l=ja(d6);l.codec=n.googCodecName,l.adaptionChangeReason="none",n.googCpuLimitedResolution&&(l.adaptionChangeReason="cpu"),n.googBandwidthLimitedResolution&&(l.adaptionChangeReason="bandwidth"),l.avgEncodeMs=Number(n.googAvgEncodeMs),l.inputFrame={width:Number(n.googFrameWidthInput)||Number(n.googFrameWidthSent),height:Number(n.googFrameHeightInput)||Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},l.sentFrame={width:Number(n.googFrameWidthSent),height:Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},l.firsCount=Number(n.googFirReceived),l.nacksCount=Number(n.googNacksReceived),l.plisCount=Number(n.googPlisReceived),l.frameCount=Number(n.framesEncoded),l.bytes=Number(n.bytesSent),l.packets=Number(n.packetsSent),l.packetsLost=Number(n.packetsLost),l.ssrc=Number(n.ssrc),l.rttMs=Number(n.googRtt||0),this._stats.videoSend.push(l),this._stats.rtt=l.rttMs;break}case"video_recv":{const l=ja(l6),u=this.lastDecodeVideoReceiverStats.get(Number(n.ssrc));if(l.codec=n.googCodecName,l.targetDelayMs=Number(n.googTargetDelayMs),l.renderDelayMs=Number(n.googRenderDelayMs),l.currentDelayMs=Number(n.googCurrentDelayMs),l.minPlayoutDelayMs=Number(n.googMinPlayoutDelayMs),l.decodeMs=Number(n.googDecodeMs),l.maxDecodeMs=Number(n.googMaxDecodeMs),l.receivedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateReceived)},l.decodedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateDecoded)},l.decodeFrameRate=Number(n.googFrameRateDecoded),l.outputFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateOutput)},l.jitterBufferMs=Number(n.googJitterBufferMs),l.firsCount=Number(n.googFirsSent),l.nacksCount=Number(n.googNacksSent),l.plisCount=Number(n.googPlisSent),l.framesDecodeCount=Number(n.framesDecoded),l.bytes=Number(n.bytesReceived),l.packets=Number(n.packetsReceived),l.packetsLost=Number(n.packetsLost),l.ssrc=Number(n.ssrc),l.packets>0&&!this.isFirstVideoReceived[l.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(l.ssrc),this.isFirstVideoReceived[l.ssrc]=!0),l.framesDecodeCount>0&&!this.isFirstVideoDecoded[l.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(l.ssrc,l.decodedFrame.width,l.decodedFrame.height),this.isFirstVideoDecoded[l.ssrc]=!0),u){const p=u.stats,m=Date.now()-u.lts;l.framesDecodeFreezeTime=p.framesDecodeFreezeTime,l.framesDecodeInterval=p.framesDecodeInterval,l.framesDecodeCount>p.framesDecodeCount&&this.isFirstVideoDecoded[l.ssrc]?(u.lts=Date.now(),l.framesDecodeInterval=m,l.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(n.ssrc,10))?l.framesDecodeFreezeTime+=l.framesDecodeInterval:this.setVideoIsReady2(parseInt(n.ssrc,10),!0))):l.framesDecodeCount<u.stats.framesDecodeCount&&(l.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(l.ssrc,{stats:yce({},l),lts:Date.now()}),this._stats.videoRecv.push(l);break}case"audio_recv":{const l=ja(h6);l.codec=n.googCodecName,l.outputLevel=Math.abs(Number(n.audioOutputLevel))/32767,l.decodingCNG=Number(n.googDecodingCNG),l.decodingCTN=Number(n.googDecodingCTN),l.decodingCTSG=Number(n.googDecodingCTSG),l.decodingNormal=Number(n.googDecodingNormal),l.decodingPLC=Number(n.googDecodingPLC),l.decodingPLCCNG=Number(n.googDecodingPLCCNG),l.expandRate=Number(n.googExpandRate),l.accelerateRate=Number(n.googAccelerateRate),l.preemptiveExpandRate=Number(n.googPreemptiveExpandRate),l.secondaryDecodedRate=Number(n.googSecondaryDecodedRate),l.speechExpandRate=Number(n.googSpeechExpandRate),l.preferredJitterBufferMs=Number(n.googPreferredJitterBufferMs),l.jitterBufferMs=Number(n.googJitterBufferMs),l.jitterMs=Number(n.googJitterReceived),l.bytes=Number(n.bytesReceived),l.packets=Number(n.packetsReceived),l.packetsLost=Number(n.packetsLost),l.ssrc=Number(n.ssrc),l.receivedFrames=Number(n.googDecodingCTN)||Number(n.packetsReceived),l.droppedFrames=Number(n.googDecodingPLC)+Number(n.googDecodingPLCCNG)||Number(n.packetsLost),l.receivedFrames>0&&!this.isFirstAudioReceived[l.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(l.ssrc),this.isFirstAudioReceived[l.ssrc]=!0),l.decodingNormal>0&&!this.isFirstAudioDecoded[l.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(l.ssrc),this.isFirstAudioDecoded[l.ssrc]=!0),this._stats.audioRecv.push(l);break}case"audio_send":{const l=ja(u6);l.codec=n.googCodecName,l.inputLevel=Math.abs(Number(n.audioInputLevel))/32767,l.aecReturnLoss=Number(n.googEchoCancellationReturnLoss||0),l.aecReturnLossEnhancement=Number(n.googEchoCancellationReturnLossEnhancement||0),l.residualEchoLikelihood=Number(n.googResidualEchoLikelihood||0),l.residualEchoLikelihoodRecentMax=Number(n.googResidualEchoLikelihoodRecentMax||0),l.bytes=Number(n.bytesSent),l.packets=Number(n.packetsSent),l.packetsLost=Number(n.packetsLost),l.ssrc=Number(n.ssrc),l.rttMs=Number(n.googRtt||0),this._stats.rtt=l.rttMs,this._stats.audioSend.push(l);break}}})}_getStats(){return new pe((e,n)=>{this.pc.getStats(e,n)})}statsResponsesToObjects(e){const n=[];return e.result().forEach(s=>{const a={id:s.id,timestamp:s.timestamp.valueOf().toString(),type:s.type};s.names().forEach(l=>{a[l]=s.stat(l)}),n.push(a)}),n}}function g6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Ep(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?g6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):g6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class _6 extends lx{constructor(){super(...arguments),R(this,"_stats",uv),R(this,"report",void 0),R(this,"lastDecodeVideoReceiverStats",new Map),R(this,"lastVideoFramesRecv",new Map),R(this,"lastVideoFramesSent",new Map),R(this,"lastVideoFramesDecode",new Map),R(this,"lastVideoJBDelay",new Map),R(this,"lastAudioJBDelay",new Map),R(this,"mediaBytesSent",new Map),R(this,"mediaBytesRetransmit",new Map),R(this,"mediaBytesTargetEncode",new Map),R(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=ja(uv),this.report.forEach(e=>{switch(e.type){case Ms.OUTBOUND:case Ms.INBOUND:{const n=e.mediaType||e.kind,s=!n&&"frameWidth"in e,a=!n&&!("frameWidth"in e);e.type===Ms.OUTBOUND?n==="audio"||a?this.processAudioOutboundStats(e):(n==="video"||s)&&this.processVideoOutboundStats(e):e.type===Ms.INBOUND&&(n==="audio"||a?this.processAudioInboundStats(e):(n==="video"||s)&&this.processVideoInboundStats(e));break}case Ms.TRANSPORT:{const n=this.report.get(e.selectedCandidatePairId);n&&this.processCandidatePairStats(n);break}case Ms.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),n={local:Ep({},gl),remote:Ep({},gl)};return e.forEach(s=>{let a;if(s.type===Ms.TRANSPORT&&(a=e.get(s.selectedCandidatePairId)),s.type===Ms.CANDIDATE_PAIR&&s.selected&&(a=s),a){const l=(u,p)=>{u.type=p.type,u.id=p.id,p.address&&(u.address=p.address),p.candidateType&&(u.candidateType=p.candidateType),p.port&&(u.port=p.port),p.priority&&(u.priority=p.priority),p.protocol&&(u.protocol=p.protocol),p.relayProtocol&&(u.relayProtocol=p.relayProtocol)};if(a.localCandidateId){const u=e.get(a.localCandidateId);u&&l(n.local,u)}if(a.remoteCandidateId){const u=e.get(a.remoteCandidateId);u&&l(n.remote,u)}}}),n}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach(n=>{e.currentRoundTripTime&&(n.rttMs=1e3*e.currentRoundTripTime)}),this._stats.audioSend.forEach(n=>{e.currentRoundTripTime&&(n.rttMs=1e3*e.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const n=this.report.get(e.localCandidateId);n&&this.processCandidateStats(n)}if(e.remoteCandidateId){const n=this.report.get(e.remoteCandidateId);n&&this.processCandidateStats(n)}}processCandidateStats(e){let n;e.type===Ms.LOCAL_CANDIDATE&&(n=this._stats.selectedCandidatePair.localCandidate),e.type===Ms.REMOTE_CANDIDATE&&(n=this._stats.selectedCandidatePair.remoteCandidate),n&&(n.type=e.type,n.id=e.id,e.address&&(n.address=e.address),e.candidateType&&(n.candidateType=e.candidateType),e.port&&(n.port=e.port),e.priority&&(n.priority=e.priority),e.protocol&&(n.protocol=e.protocol),e.relayProtocol&&(n.relayProtocol=e.relayProtocol),e.type===Ms.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==n.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Ep({},n),Ep({},this.stats.selectedCandidatePair.localCandidate)),e.type===Ms.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==n.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Ep({},n),Ep({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let n=this._stats.audioRecv.find(s=>s.ssrc===e.ssrc);n||(n=ja(h6),this._stats.audioRecv.push(n)),n.ssrc=e.ssrc,n.packets=e.packetsReceived,n.packetsLost=e.packetsLost,n.bytes=e.bytesReceived,n.jitterMs=1e3*e.jitter,this.processAudioTrackReceiverStats(e,e.trackId,n),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),n.receivedFrames||(n.receivedFrames=e.packetsReceived),n.droppedFrames||(n.droppedFrames=e.packetsLost),n.receivedFrames>0&&!this.isFirstAudioReceived[n.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(n.ssrc),this.isFirstAudioReceived[n.ssrc]=!0),n.outputLevel&&n.outputLevel>0&&!this.isFirstAudioDecoded[n.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(n.ssrc),this.isFirstAudioDecoded[n.ssrc]=!0),typeof e.concealedSamples=="number"&&(n.concealedSamples=e.concealedSamples)}processVideoInboundStats(e){let n=this._stats.videoRecv.find(u=>u.ssrc===e.ssrc);n||(n=ja(l6),this._stats.videoRecv.push(n)),n.ssrc=e.ssrc,n.packets=e.packetsReceived,n.packetsLost=e.packetsLost,n.bytes=e.bytesReceived,n.firsCount=e.firCount,n.nacksCount=e.nackCount,n.plisCount=e.pliCount,n.framesDecodeCount=e.framesDecoded,n.totalInterFrameDelay=e.totalInterFrameDelay,n.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay;const s=this.lastDecodeVideoReceiverStats.get(n.ssrc),a=this.lastVideoFramesDecode.get(n.ssrc),l=Date.now();if(n.framesDecodeCount>0&&!this.isFirstVideoDecoded[n.ssrc]){const u=n.decodedFrame?n.decodedFrame.width:0,p=n.decodedFrame?n.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(n.ssrc,u,p),this.isFirstVideoDecoded[n.ssrc]=!0}if(s){const u=s.stats,p=l-s.lts;n.framesDecodeFreezeTime=u.framesDecodeFreezeTime,n.framesDecodeInterval=u.framesDecodeInterval,!this.isFirstVideoDecoded[n.ssrc]&&p>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[n.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(n.ssrc),this.isFirstVideoDecodedTimeout[n.ssrc]=!0),n.framesDecodeCount>u.framesDecodeCount&&this.isFirstVideoDecoded[n.ssrc]?(s.lts=Date.now(),n.framesDecodeInterval=p,n.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?n.framesDecodeFreezeTime+=n.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):n.framesDecodeCount<u.framesDecodeCount&&(n.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(s.stats.framesDecodeCount>e.framesDecoded?n.qpSumPerFrame=e.qpSum/e.framesDecoded:n.qpSumPerFrame=(e.qpSum-s.qpSum)/(e.framesDecoded-s.stats.framesDecodeCount))}a&&l-a.lts>=800?(n.decodeFrameRate=Math.round((n.framesDecodeCount-a.count)/((l-a.lts)/1e3)),this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:l,rate:n.decodeFrameRate})):a?n.decodeFrameRate=a.rate:this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:l,rate:0}),e.totalDecodeTime&&(n.decodeMs=1e3*e.totalDecodeTime),this.processVideoTrackReceiverStats(e,e.trackId,n),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(n.framesRateFirefox=e.framerateMean),n.packets>0&&!this.isFirstVideoReceived[n.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(n.ssrc),this.isFirstVideoReceived[n.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(n.ssrc,{stats:Ep({},n),lts:s?s.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let n=this._stats.videoSend.find(a=>a.ssrc===e.ssrc);n||(n=ja(d6),this._stats.videoSend.push(n));const s=this.mediaBytesSent.get(e.ssrc);if(s)s.add(e.bytesSent);else{const a=new cx(10);a.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,a)}if(e.retransmittedBytesSent!==void 0){const a=this.mediaBytesRetransmit.get(e.ssrc);if(a)a.add(e.retransmittedBytesSent);else{const l=new cx(10);l.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,l)}}if(e.totalEncodedBytesTarget){const a=this.mediaBytesTargetEncode.get(e.ssrc);if(a)a.add(e.totalEncodedBytesTarget);else{const l=new cx(10);l.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,l)}}if(n.ssrc=e.ssrc,n.bytes=e.bytesSent,n.packets=e.packetsSent,n.firsCount=e.firCount,n.nacksCount=e.nackCount,n.plisCount=e.pliCount,n.frameCount=e.framesEncoded,n.adaptionChangeReason=e.qualityLimitationReason,n.scalabilityMode=e.scalabilityMode,e.totalEncodeTime&&e.framesEncoded){const a=this.lastEncoderMs.get(e.ssrc);if(!a||a.lastFrameCount>e.framesEncoded)n.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const l=e.framesEncoded-a.lastFrameCount,u=e.totalEncodeTime-a.lastEncoderTime;n.avgEncodeMs=1e3*u/l}}if(e.framesEncoded&&e.qpSum){const a=this.lastEncoderMs.get(e.ssrc);!a||a.lastFrameCount>e.framesEncoded?n.qpSumPerFrame=e.qpSum/e.framesEncoded:n.qpSumPerFrame=(e.qpSum-a.lastQpSum)/(e.framesEncoded-a.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,n),this.processVideoTrackSenderStats(e,e.trackId,n),e.remoteId)this.processRemoteInboundStats(e.remoteId,n);else{const a=this.findRemoteStatsId(e.ssrc,Ms.REMOTE_INBOUND);a&&this.processRemoteInboundStats(a,n)}}processAudioOutboundStats(e){let n=this._stats.audioSend.find(s=>s.ssrc===e.ssrc);if(n||(n=ja(u6),this._stats.audioSend.push(n)),n.ssrc=e.ssrc,n.packets=e.packetsSent,n.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,n),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,n),e.remoteId)this.processRemoteInboundStats(e.remoteId,n);else{const s=this.findRemoteStatsId(e.ssrc,Ms.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,n)}}findRemoteStatsId(e,n){var s;const a=Array.from(yc(s=this.report).call(s)).find(l=>l.type===n&&l.ssrc===e);return a?a.id:null}processVideoMediaSource(e,n){const s=this.report.get(e);s&&s.width&&s.height&&s.framesPerSecond&&(n.inputFrame={width:s.width,height:s.height,frameRate:s.framesPerSecond})}processAudioMediaSource(e,n){const s=this.report.get(e);s&&(n.inputLevel=s.audioLevel)}processVideoTrackSenderStats(e,n,s){var a,l,u,p;const m=n?this.report.get(n):void 0,g=(a=m==null?void 0:m.framesSent)!==null&&a!==void 0?a:e.framesSent;if(typeof g!="number")return;let E=(l=m==null?void 0:m.frameWidth)!==null&&l!==void 0?l:e.frameWidth,y=(u=m==null?void 0:m.frameHeight)!==null&&u!==void 0?u:e.frameHeight,C=(p=m==null?void 0:m.framesPerSecond)!==null&&p!==void 0?p:e.framesPerSecond;if(typeof E=="number"&&typeof y=="number"||(E=0,y=0),C==null){const I=Date.now(),j=this.lastVideoFramesSent.get(s.ssrc);j&&I-j.lts>=800?(C=Math.round((g-j.count)/((I-j.lts)/1e3)),this.lastVideoFramesSent.set(s.ssrc,{count:g,lts:I,rate:C})):j?C=j.rate:this.lastVideoFramesSent.set(s.ssrc,{count:g,lts:I,rate:0})}s.sentFrame={width:E,height:y,frameRate:Math.max(0,C)}}processVideoTrackReceiverStats(e,n,s){var a,l,u,p,m;const g=n?this.report.get(n):void 0,E=(a=g==null?void 0:g.framesReceived)!==null&&a!==void 0?a:e.framesReceived,y=(l=g==null?void 0:g.frameWidth)!==null&&l!==void 0?l:e.frameWidth,C=(u=g==null?void 0:g.frameHeight)!==null&&u!==void 0?u:e.frameHeight,I=(p=g==null?void 0:g.jitterBufferDelay)!==null&&p!==void 0?p:e.jitterBufferDelay,j=(m=g==null?void 0:g.jitterBufferEmittedCount)!==null&&m!==void 0?m:e.jitterBufferEmittedCount;if(typeof E=="number"){const P=this.lastVideoFramesRecv.get(s.ssrc),U=Date.now();s.framesReceivedCount=E;let q=0;P&&U-P.lts>=800?(q=Math.round((E-P.count)/((U-P.lts)/1e3)),this.lastVideoFramesRecv.set(s.ssrc,{count:E,lts:U,rate:q})):P?q=P.rate:this.lastVideoFramesRecv.set(s.ssrc,{count:E,lts:U,rate:0}),s.receivedFrame={width:y||0,height:C||0,frameRate:q||0},s.decodedFrame={width:y||0,height:C||0,frameRate:s.decodeFrameRate||0},s.outputFrame={width:y||0,height:C||0,frameRate:s.decodeFrameRate||0}}if(I&&j){const P=this.lastVideoJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let U=P.jitterBufferMs;const q=j-P.jitterBufferEmittedCount;q>0&&(U=1e3*(I-P.jitterBufferDelay)/q),s.jitterBufferMs=U,s.currentDelayMs=Math.round(U),this.lastVideoJBDelay.set(s.ssrc,{jitterBufferDelay:I,jitterBufferEmittedCount:j,jitterBufferMs:s.currentDelayMs})}}processAudioTrackSenderStats(e,n,s){var a,l,u,p;const m=n?this.report.get(n):void 0,g=(a=(l=m==null?void 0:m.echoReturnLoss)!==null&&l!==void 0?l:e.echoReturnLoss)!==null&&a!==void 0?a:0,E=(u=(p=m==null?void 0:m.echoReturnLossEnhancement)!==null&&p!==void 0?p:e.echoReturnLossEnhancement)!==null&&u!==void 0?u:0;s.aecReturnLoss=g,s.aecReturnLossEnhancement=E}processAudioTrackReceiverStats(e,n,s){var a,l,u,p,m,g,E;const y=n?this.report.get(n):void 0,C=(a=y==null?void 0:y.removedSamplesForAcceleration)!==null&&a!==void 0?a:e.removedSamplesForAcceleration,I=(l=y==null?void 0:y.totalSamplesReceived)!==null&&l!==void 0?l:e.totalSamplesReceived,j=(u=y==null?void 0:y.jitterBufferDelay)!==null&&u!==void 0?u:e.jitterBufferDelay,P=(p=y==null?void 0:y.jitterBufferEmittedCount)!==null&&p!==void 0?p:e.jitterBufferEmittedCount,U=(m=y==null?void 0:y.audioLevel)!==null&&m!==void 0?m:e==null?void 0:e.audioLevel,q=(g=y==null?void 0:y.totalSamplesDuration)!==null&&g!==void 0?g:e==null?void 0:e.totalSamplesDuration,J=(E=y==null?void 0:y.concealedSamples)!==null&&E!==void 0?E:e.concealedSamples;if(C&&I&&(s.accelerateRate=C/I),j&&P){const he=this.lastAudioJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let ae=he.jitterBufferMs;const de=P-he.jitterBufferEmittedCount;de>0&&(ae=1e3*(j-he.jitterBufferDelay)/de),s.jitterBufferMs=Math.round(ae),this.lastAudioJBDelay.set(s.ssrc,{jitterBufferDelay:j,jitterBufferEmittedCount:P,jitterBufferMs:s.jitterBufferMs})}s.outputLevel=U;let se=1920;q&&I&&(se=I/q/50,s.receivedFrames=Math.round(I/se)),J&&(s.droppedFrames=Math.round(J/se))}processRemoteInboundStats(e,n){const s=this.report.get(e);s&&(n.packetsLost=s.packetsLost,s.roundTripTime&&(n.rttMs=1e3*s.roundTripTime),s.jitter&&(n.jitterMs=1e3*s.jitter),s.timestamp&&(n.timestamp=s.timestamp))}getCodecFromCodecStats(e){const n=this.report.get(e);if(!n)return"";const s=n.mimeType.match(/\/(.*)$/);return s&&s[1]?s[1]:""}updateSendBitrate(){let e=0,n=null,s=null;this.mediaBytesSent.forEach(l=>{e+=l.diffMean()}),this.mediaBytesRetransmit.forEach(l=>{n=n===null?l.diffMean():n+l.diffMean()}),this.mediaBytesTargetEncode.forEach(l=>{s=s===null?l.diffMean():s+l.diffMean()});const a=n!==null?e-n:e;this._stats.bitrate={actualEncoded:8*a/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},n!==null&&(this._stats.bitrate.retransmit=8*n/(this.options.updateInterval/1e3)),s!==null&&(this._stats.bitrate.targetEncoded=8*s/(this.options.updateInterval/1e3))}}class bce extends lx{updateStats(){return pe.resolve()}}function VT(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const l=function(){const u=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return u&&u[0]?Number(u[0].split("/")[1]):null}();return l?l<76?new Sce(i,{updateInterval:e,lossRateInterval:n,freezeRateLimit:s,firstVideoDecodedTimeout:a}):new _6(i,{updateInterval:e,lossRateInterval:n,freezeRateLimit:s,firstVideoDecodedTimeout:a}):function(u){return!!window.RTCStatsReport&&u.getStats()instanceof pe}(i)?new _6(i,{updateInterval:e,lossRateInterval:n,freezeRateLimit:s,firstVideoDecodedTimeout:a}):new bce(i,{updateInterval:e,lossRateInterval:n,freezeRateLimit:s,firstVideoDecodedTimeout:a})}function E6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function v6(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?E6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):E6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function hv(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;const{filterRTX:a,filterVideoFec:l,filterAudioFec:u,filterAudioCodec:p,filterVideoCodec:m}=e,{useXR:g}=n;let E=[],y=[],C=[],I=[],j=!1,P=!1;if(Fn.parse(i).mediaDescriptions.forEach(q=>{s&&s!==q.attributes.direction||(q.media.mediaType!=="video"||j||(y=q.attributes.payloads,I=q.attributes.extmaps,j=!0),q.media.mediaType!=="audio"||P||(E=q.attributes.payloads,C=q.attributes.extmaps,P=!0))}),!I||y.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!C||E.length===0)throw new Error("Cannot get audio capabilities from SDP.");y.forEach(q=>{var J;(J=q.rtpMap)!==null&&J!==void 0&&J.clockRate&&(q.rtpMap.clockRate=parseInt(q.rtpMap.clockRate)),g&&q.rtcpFeedbacks.push({type:"rrtr"})}),E.forEach(q=>{var J;(J=q.rtpMap)!==null&&J!==void 0&&J.clockRate&&(q.rtpMap.clockRate=parseInt(q.rtpMap.clockRate)),g&&q.rtcpFeedbacks.push({type:"rrtr"})}),a&&(E=E.filter(q=>{var J;return((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName.toLowerCase())!=="rtx"}),y=y.filter(q=>{var J;return((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName.toLowerCase())!=="rtx"})),l&&(y=y.filter(q=>{var J;return!/(red)|(ulpfec)|(flexfec)/i.test(((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName)||"")})),u&&(E=E.filter(q=>{var J;return!/(red)|(ulpfec)|(flexfec)/i.test(((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName)||"")})),p&&(p==null?void 0:p.length)>0&&(E=E.filter(q=>{var J;return je(p).call(p,((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName.toLowerCase())||"")})),m&&(m==null?void 0:m.length)>0&&(y=y.filter(q=>{var J;return je(m).call(m,((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName.toLowerCase())||"")}));const U=Z("UNSUPPORTED_VIDEO_CODEC");return U&&U.length>0&&(y=y.filter(q=>!(q.rtpMap&&je(U).call(U,q.rtpMap.encodingName.toLowerCase())))),{audioCodecs:E,videoCodecs:y,audioExtensions:C,videoExtensions:I}}function wc(i){const e=Fn.parse(i);let n,s;for(const a of e.mediaDescriptions){if(!n){const l=a.attributes.iceUfrag,u=a.attributes.icePwd;if(!l||!u)throw new Error("Cannot get iceUfrag or icePwd from SDP.");n={iceUfrag:l,icePwd:u}}if(!s){const l=a.attributes.fingerprints;l.length>0&&(s={fingerprints:l})}}if(!s&&e.attributes.fingerprints.length>0&&(s={fingerprints:e.attributes.fingerprints}),!s||!n)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:n,dtlsParameters:s}}function dx(i,e){const n=[],s=i.attributes.ssrcGroups.filter(u=>u.semantic==="FID"),a=i.attributes.ssrcGroups.find(u=>u.semantic==="SIM"),l=i.attributes.ssrcs;if(a)a.ssrcIds.forEach(u=>{var p;const m=(p=s.find(g=>g.ssrcIds[0]===u))===null||p===void 0?void 0:p.ssrcIds[1];n.push({ssrcId:u,rtx:e?m:void 0})});else if(s.length>0){const u=s[0].ssrcIds[0],p=s[0].ssrcIds[1];n.push({ssrcId:u,rtx:e?p:void 0})}else{if(l.length===0)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:l[0].ssrcId})}return n}function y6(i,e){const{cname:n}=i;let s;e&&e.ip&&typeof e.port=="number"?(s=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],N.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(s.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),N.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))):s=i.iceParameters.candidates.map(p=>({foundation:p.foundation,componentId:"1",transport:p.protocol,priority:p.priority.toString(),connectionAddress:p.ip,port:p.port.toString(),type:p.type,extension:{}}));const a={fingerprints:i.dtlsParameters.fingerprints.map(p=>({hashFunction:p.algorithm,fingerprint:p.fingerprint}))},l={iceUfrag:i.iceParameters.iceUfrag,icePwd:i.iceParameters.icePwd};let u;switch(i.dtlsParameters.role){case"server":u="passive";break;case"client":u="active";break;case"auto":u="actpass"}return{dtlsParameters:a,iceParameters:l,candidates:s,rtpCapabilities:Im(i.rtpCapabilities),setup:u,cname:n}}function Fs(i,e,n){const s=[],a=[];return i.forEach(l=>{let{ssrcId:u,rtx:p}=l;const m=Sn(8,"track-"),g={ssrcId:u,attributes:v6({label:m,mslabel:n=n||Sn(10,""),msid:"".concat(n," ").concat(m)},e&&{cname:e})};if(s.push(g),p!==void 0){const E={ssrcId:p,attributes:v6({label:m,mslabel:n,msid:"".concat(n," ").concat(m)},e&&{cname:e})};s.push(E),a.push({semantic:"FID",ssrcIds:[u,p]})}}),i.length>1&&a.push({semantic:"SIM",ssrcIds:i.map(l=>{let{ssrcId:u}=l;return u})}),{ssrcs:s,ssrcGroups:a}}function Nu(i,e){e instanceof ln&&i.attributes.payloads.forEach(n=>{var s;const a=(s=n.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase();if(!a||["opus","pcmu","pcma","g722"].indexOf(a)===-1)return;n.fmtp||(n.fmtp={parameters:{}}),n.fmtp.parameters.minptime="10",n.fmtp.parameters.useinbandfec="1";const l=e._encoderConfig;l&&a!=="pcmu"&&a!=="pcma"&&a!=="g722"&&(l.bitrate&&!mn()&&(n.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*l.bitrate))),l.sampleRate&&(n.fmtp.parameters.maxplaybackrate="".concat(l.sampleRate),n.fmtp.parameters["sprop-maxcapturerate"]="".concat(l.sampleRate)),l.stereo&&(n.fmtp.parameters.stereo="1",n.fmtp.parameters["sprop-stereo"]="1"))})}function BT(i){const e=i.attributes.unrecognized.findIndex(n=>n.attField==="x-google-flag"&&n.attValue==="conference");e!==-1&&i.attributes.unrecognized.splice(e,1)}function WT(i,e){var n;if(!(e instanceof At&&e._encoderConfig&&e._hints.indexOf(wn.SCREEN_TRACK)===-1))return;const s=e._encoderConfig;Kt().supportMinBitrate&&s.bitrateMin&&i.attributes.payloads.forEach(a=>{var l,u;je(l=["h264","h265","vp8","vp9","av1"]).call(l,((u=a.rtpMap)===null||u===void 0?void 0:u.encodingName.toLowerCase())||"")&&(a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters["x-google-min-bitrate"]="".concat(s.bitrateMin))}),Kt().supportMinBitrate&&!je(n=e._hints).call(n,wn.LOW_STREAM)&&s.bitrateMax&&i.attributes.payloads.forEach(a=>{var l,u;je(l=["h264","h265","vp8","vp9","av1"]).call(l,((u=a.rtpMap)===null||u===void 0?void 0:u.encodingName.toLowerCase())||"")&&(a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters["x-google-start-bitrate"]="".concat(Z("X_GOOGLE_START_BITRATE")||Math.floor(s.bitrateMax)))})}function ux(i){if(i.media.mediaType!=="video")return;const e=zt();if(e.name!==Zt.SAFARI&&e.os!==Dr.IOS)return;const n=i.attributes.extmaps.findIndex(s=>/video-orientation/g.test(s.extensionName));n!==-1&&i.attributes.extmaps.splice(n,1)}function Rm(i,e,n){if(!e)return;let s,a;if(i.media.mediaType==="video"?(s=n.videoExtensions,a=n.videoCodecs):(s=n.audioExtensions,a=n.audioCodecs),e.twcc===!0){const l=s.find(u=>u.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");l&&(i.attributes.extmaps.find(p=>p.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||i.attributes.extmaps.push({entry:l.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(p,m){return m.filter(g=>!!p.find(E=>E.payloadType===g.payloadType&&!!E.rtcpFeedbacks.find(y=>y.type==="transport-cc")))}(a,i.attributes.payloads).forEach(p=>{p.rtcpFeedbacks.find(m=>m.type==="transport-cc")||p.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(e.twcc===!1){const l=i.attributes.extmaps.findIndex(u=>u.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");l!==-1&&i.attributes.extmaps.splice(l,1),i.attributes.payloads.forEach(u=>{const p=u.rtcpFeedbacks.findIndex(m=>m.type==="transport-cc");p!==-1&&u.rtcpFeedbacks.splice(p,1)})}if(e.remb===!0){const l=s.find(u=>u.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");l&&(i.attributes.extmaps.find(p=>p.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||i.attributes.extmaps.push({entry:l.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(p,m){return m.filter(g=>!!p.find(E=>E.payloadType===g.payloadType&&!!E.rtcpFeedbacks.find(y=>y.type==="goog-remb")))}(a,i.attributes.payloads).forEach(p=>{p.rtcpFeedbacks.find(m=>m.type==="goog-remb")||p.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(e.remb===!1){const l=i.attributes.extmaps.findIndex(u=>u.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");l!==-1&&i.attributes.extmaps.splice(l,1),i.attributes.payloads.forEach(u=>{const p=u.rtcpFeedbacks.findIndex(m=>m.type==="goog-remb");p!==-1&&u.rtcpFeedbacks.splice(p,1)})}}function hx(i,e,n){if(mn()||i.media.mediaType!=="video"||!(e instanceof At)||n!=="vp9"&&n!=="vp8"||n==="vp8"&&!Z("SIMULCAST")||e._scalabilityMode===void 0||e._scalabilityMode.numSpatialLayers<=1)return;const s=n==="vp8"?2:e._scalabilityMode.numSpatialLayers,a=i.attributes.ssrcs[0],l=i.attributes.ssrcGroups.find(p=>p.semantic==="FID"&&p.ssrcIds[0]===a.ssrcId),u={semantic:"SIM",ssrcIds:[a.ssrcId]};for(let p=1;p<s;p++)i.attributes.ssrcs.push({ssrcId:a.ssrcId+p,attributes:Cn(a.attributes)}),u.ssrcIds.push(a.ssrcId+p),l&&(i.attributes.ssrcs.push({ssrcId:l.ssrcIds[1]+p,attributes:Cn(a.attributes)}),i.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[a.ssrcId+p,l.ssrcIds[1]+p]}));i.attributes.ssrcGroups.unshift(u)}async function px(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new RTCPeerConnection;n.addTransceiver("video",{direction:"sendonly"}),n.addTransceiver("audio",{direction:"sendonly"}),n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const s=(await n.createOffer()).sdp,{send:a,recv:l,sendrecv:u}=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=arguments.length>2?arguments[2]:void 0;const E=hv(g,p,m,"sendonly"),y=hv(g,p,m,"recvonly"),C={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},j={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Fa(E,y,"videoExtensions",C,I,j),Fa(E,y,"videoCodecs",C,I,j),Fa(E,y,"audioExtensions",C,I,j),Fa(E,y,"audioCodecs",C,I,j),Z("RAISE_H264_BASELINE_PRIORITY")){const P=j.videoCodecs.findIndex(U=>{var q,J;return((q=U.rtpMap)===null||q===void 0?void 0:q.encodingName.toLocaleLowerCase())==="h264"&&((J=U.fmtp)===null||J===void 0?void 0:J.parameters["profile-level-id"])==="42001f"});if(P!==-1){const U=j.videoCodecs.findIndex(q=>{var J;return((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName.toLocaleLowerCase())==="h264"});if(U<P){N.debug("raising H264 baseline profile priority");const q=j.videoCodecs[P];j.videoCodecs.splice(P,1),j.videoCodecs.splice(U,0,q)}U!==-1&&(I.videoCodecs=I.videoCodecs.filter(q=>{var J,se;return!(((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName.toLocaleLowerCase())==="h264"&&((se=q.fmtp)===null||se===void 0?void 0:se.parameters["profile-level-id"])!=="42001f")})),U!==-1&&Z("FILTER_SEND_H264_BASELINE")&&(C.videoCodecs=C.videoCodecs.filter(q=>{var J,se;return!(((J=q.rtpMap)===null||J===void 0?void 0:J.encodingName.toLocaleLowerCase())==="h264"&&((se=q.fmtp)===null||se===void 0?void 0:se.parameters["profile-level-id"])!=="42001f")}))}}return{send:C,recv:I,sendrecv:j}}(i,e,s);try{n.close()}catch{}return{send:a,recv:l,sendrecv:u}}function S6(){const i={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},e=hv(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Fa(i,e,"videoExtensions",n,s,a),Fa(i,e,"videoCodecs",n,s,a),Fa(i,e,"audioExtensions",n,s,a),Fa(i,e,"audioCodecs",n,s,a),Z("RAISE_H264_BASELINE_PRIORITY")){const l=a.videoCodecs.findIndex(u=>u.rtpMap&&u.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&u.fmtp&&u.fmtp.parameters["profile-level-id"]==="42001f");if(l!==-1){const u=a.videoCodecs.findIndex(p=>p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(u<l){N.debug("raising H264 baseline profile priority");const p=a.videoCodecs[l];a.videoCodecs.splice(l,1),a.videoCodecs.splice(u,0,p)}u!==-1&&(s.videoCodecs=s.videoCodecs.filter(p=>!(p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&p.fmtp&&p.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:n,recv:s,sendrecv:a}}function Fa(i,e,n,s,a,l){if(n==="videoExtensions"||n==="audioExtensions"){const u=[];return i[n].forEach(p=>{e[n].some((m,g)=>{if(p.entry===m.entry&&p.extensionName===m.extensionName)return u.push(g),!0})?l[n].push(p):s[n].push(p)}),void e[n].forEach((p,m)=>{u.indexOf(m)===-1&&a[n].push(p)})}if(n==="videoCodecs"||n==="audioCodecs"){const u=[];return i[n].forEach(p=>{e[n].some((m,g)=>{if(p.payloadType===m.payloadType&&JSON.stringify(p)===JSON.stringify(m))return u.push(g),!0})?l[n].push(p):s[n].push(p)}),void e[n].forEach((p,m)=>{u.indexOf(m)===-1&&a[n].push(p)})}}function Im(i){const{send:e,recv:n,sendrecv:s}=i;if(!s){if(!e||!n)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:e,recv:n}}let a,l;return e?(a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a.audioCodecs=[...e.audioCodecs,...s.audioCodecs],a.videoCodecs=[...e.videoCodecs,...s.videoCodecs],a.audioExtensions=[...e.audioExtensions,...s.audioExtensions],a.videoExtensions=[...e.videoExtensions,...s.videoExtensions]):a=s,n?(l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l.audioCodecs=[...n.audioCodecs,...s.audioCodecs],l.videoCodecs=[...n.videoCodecs,...s.videoCodecs],l.audioExtensions=[...n.audioExtensions,...s.audioExtensions],l.videoExtensions=[...n.videoExtensions,...s.videoExtensions]):l=s,{send:a,recv:l}}function Rc(i){i.media.mediaType==="audio"&&i.attributes.payloads.filter(e=>{var n;return((n=e.rtpMap)===null||n===void 0?void 0:n.encodingName.toLowerCase())==="opus"}).forEach(e=>{e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"})}function pv(i){i.mediaDescriptions.forEach(e=>{e.media.mediaType!=="video"&&e.media.mediaType!=="audio"||e.attributes.payloads.forEach(n=>{n.rtcpFeedbacks.findIndex(s=>s.type==="rrtr")===-1&&n.rtcpFeedbacks.push({type:"rrtr"})})})}function vp(i,e,n,s){let a=[];if(i===ze.VIDEO){if(Z("H264_PROFILE_LEVEL_ID")&&s==="h264"&&(a=e.videoCodecs.filter(l=>{var u;return je(u=l.rtpMap&&l.rtpMap.encodingName.toLowerCase()||"").call(u,s)&&l&&l.fmtp&&l.fmtp.parameters["profile-level-id"]===Z("H264_PROFILE_LEVEL_ID")})),!Array.isArray(a)||a.length===0){let l=[];const u=[],p=[];n.videoCodecs.forEach(m=>{var g,E,y;je(g=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(g,s)&&l.push(m),je(E=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(E,"vp8")&&u.push(m),je(y=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(y,"h264")&&p.push(m)}),l.length===0&&(u.length!==0?(l=u,N.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: vp8"))):p.length!==0&&(l=p,N.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: h264")))),l.length!==0&&(a=e.videoCodecs.filter(m=>l.some(g=>g.payloadType===m.payloadType)))}if(Z("USE_PUB_RTX")){const l=a.map(p=>p.payloadType.toString()),u=e.videoCodecs.filter(p=>p.rtpMap&&p.rtpMap.encodingName==="rtx"&&je(l).call(l,p.fmtp&&p.fmtp.parameters.apt||""));a=[...a,...u]}a.length===0&&(N.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(e.videoCodecs[0].rtpMap&&e.videoCodecs[0].rtpMap.encodingName)),a=e.videoCodecs)}else a=e.audioCodecs.filter(l=>{var u;return je(u=l.rtpMap&&l.rtpMap.encodingName.toLowerCase()||"").call(u,s)}),a.length===0&&(N.warning("codec ".concat(s," not included in rtpCapabilities, fallback to opus")),a=e.audioCodecs.filter(l=>{var u;return je(u=l.rtpMap&&l.rtpMap.encodingName.toLowerCase()||"").call(u,"opus")}));return a}let b6=class{get localCapabilities(){return Cn(this._localCapabilities)}get rtpCapabilities(){return Cn(this._rtpCapabilities)}get candidates(){return Cn(this._candidates)}get iceParameters(){return Cn(this._iceParameters)}get dtlsParameters(){return Cn(this._dtlsParameters)}constructor(i){R(this,"sessionDesc",void 0),R(this,"_localCapabilities",void 0),R(this,"_rtpCapabilities",void 0),R(this,"_candidates",void 0),R(this,"_iceParameters",void 0),R(this,"_dtlsParameters",void 0),R(this,"setup",void 0),R(this,"currentMidIndex",void 0),R(this,"cname","o/i14u9pJrxRKAsu"),R(this,"firefoxSsrcMidMap",new Map),i=Cn(i);const{remoteIceParameters:e,remoteDtlsParameters:n,candidates:s,remoteRTPCapabilities:a,localCapabilities:l,direction:u,setup:p,videoCodec:m,audioCodec:g}=i;let E;this.setup=p,E=u===zi.RECEIVE_ONLY?Fn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):Fn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=a,this._candidates=s,this._iceParameters=e,this._dtlsParameters=n,this._localCapabilities=l;const y=u===zi.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,C=u===zi.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,I=u===zi.RECEIVE_ONLY?a.send.videoCodecs:vp(ze.VIDEO,y,C,m),j=u===zi.RECEIVE_ONLY?a.send.audioCodecs:vp(ze.AUDIO,y,C,g);for(const P of E.mediaDescriptions){if(P.attributes.iceUfrag=e.iceUfrag,P.attributes.icePwd=e.icePwd,P.attributes.fingerprints=n.fingerprints,P.attributes.candidates=s,P.attributes.setup=this.setup,P.media.mediaType==="application"&&(P.attributes.sctpPort="5000"),P.media.mediaType==="video"&&(P.media.fmts=I.map(U=>U.payloadType.toString(10)),P.attributes.payloads=I,P.attributes.extmaps=y.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:U,ssrcGroups:q}=Fs([{ssrcId:4e4,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);P.attributes.ssrcs=U,P.attributes.ssrcGroups=q}if(P.media.mediaType==="audio"&&(P.media.fmts=j.map(U=>U.payloadType.toString(10)),P.attributes.payloads=j,P.attributes.extmaps=y.audioExtensions,Rc(P),Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:U,ssrcGroups:q}=Fs([{ssrcId:2e4}],this.cname);P.attributes.ssrcs=U,P.attributes.ssrcGroups=q}}this.sessionDesc=E,this.currentMidIndex=E.mediaDescriptions.length-1}toString(){return Fn.print(this.sessionDesc)}hasMid(i){return Array.isArray(i)?i.every(e=>this.hasMid(e)):this.sessionDesc.mediaDescriptions.some(e=>e.attributes.mid===i)}send(i,e,n,s,a){n=n.replace(/ /g,"-");const{ssrcs:l,ssrcGroups:u}=Fs(e,this.cname,Z("SYNC_GROUP")?n:void 0),p=this.findPreloadMediaDesc(l);if(p){if(mn()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,p.attributes.mid),a&&(a.twcc||a.remb)){const m=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(p,a),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const m=this.findAvailableMediaIndex(i,l,s);let g;return m===-1?(g=this.createOrRecycleSendMedia(i,l,u,"sendonly",s,a),this.updateBundleMids()):(g=Cn(this.sessionDesc.mediaDescriptions[m]),g.attributes.direction="sendonly",g.attributes.ssrcs=l,g.attributes.ssrcGroups=u,this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(g,a)),mn()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,g.attributes.mid),{needExchangeSDP:!0,mid:g.attributes.mid}}}stopSending(i){const e=this.sessionDesc.mediaDescriptions.filter(n=>n.attributes.mid&&i.indexOf(n.attributes.mid)!==-1);if(e.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");e.forEach(n=>{n.attributes.ssrcs=[]}),this.updateBundleMids()}receive(i,e,n){const s=[];return i.forEach(a=>{const l=a._mediaStreamTrack.kind,u=this.findAvailableRecvMediaIndex(l);let p,m=!1;u===-1?(m=!0,p=this.createOrRecycleRecvMedia(a,[],"recvonly",e,n),this.updateBundleMids()):(p=Cn(this.sessionDesc.mediaDescriptions[u]),p.attributes.direction="recvonly"),s.push({mid:p.attributes.mid,needCreateTransceiver:m})}),s}stopReceiving(i){const e=this.sessionDesc.mediaDescriptions.filter(n=>i.indexOf(n.attributes.mid)!==-1);if(e.length!==i.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");e.forEach(n=>{n.media.port="0",n.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(i){const{foundation:e,protocol:n,address:s,port:a,type:l,relatedAddress:u,relatedPort:p,priority:m}=new RTCIceCandidate(i),g={foundation:e??"",componentId:"1",transport:n??"",priority:m?m+"":"",connectionAddress:s??"",port:a?a+"":"",type:l?l+"":"",relAddr:u??"",relPort:p?p+"":"",extension:{}};this.candidates.some(E=>E.priority===g.priority&&E.connectionAddress===g.connectionAddress&&E.port===g.port)||(this._candidates.push(g),this.sessionDesc.mediaDescriptions.forEach(E=>{E.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(i,e,n,s,a){const l=i._mediaStreamTrack.kind,u=this.rtpCapabilities.recv,p=vp(l,u,this.localCapabilities.send,l===ze.AUDIO?a:s),m=l===ze.VIDEO?u.videoExtensions:u.audioExtensions,g="".concat(++this.currentMidIndex);let E={media:{mediaType:l,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(C=>C.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:e,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(g)}};E=this.mungRecvMediaDsec(E,i);const y=this.findFirstClosedMedia(l);if(y){const C=this.sessionDesc.mediaDescriptions.indexOf(y);this.sessionDesc.mediaDescriptions[C]=E}else this.sessionDesc.mediaDescriptions.push(E);return E}muteRemote(i){const e=this.sessionDesc.mediaDescriptions.filter(n=>je(i).call(i,n.attributes.mid||""));if(e.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");e.forEach(n=>{n.attributes.direction="inactive"})}unmuteRemote(i){const e=this.sessionDesc.mediaDescriptions.filter(n=>je(i).call(i,n.attributes.mid||""));if(e.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");e.forEach(n=>{n.attributes.direction="recvonly"})}findAvailableMediaIndex(i,e,n){return this.sessionDesc.mediaDescriptions.findIndex(s=>{const a=s.media.mediaType===i&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0;if(mn()){if(a){const l=this.firefoxSsrcMidMap.get(e[0].ssrcId);return!(l||s.attributes.mid!=="0"&&s.attributes.mid!=="1")||!(!l||l!==s.attributes.mid)}return!1}return a&&s.attributes.mid===n})}findAvailableRecvMediaIndex(i){return this.sessionDesc.mediaDescriptions.findIndex(e=>{const n=e.media.mediaType===i&&e.media.port!=="0"&&(e.attributes.direction==="recvonly"||e.attributes.direction==="sendrecv");return e.attributes.mid!=="0"&&e.attributes.mid!=="1"&&n})}predictReceivingMids(i){const e=[];for(let n=0;n<i;n++)e.push((this.currentMidIndex+n+1).toString(10));return e}restartICE(i){i=Cn(i),this._iceParameters=i,this.sessionDesc.mediaDescriptions.forEach(e=>{e.attributes.iceUfrag=i.iceUfrag,e.attributes.icePwd=i.icePwd})}createOrRecycleSendMedia(i,e,n,s,a,l){const u=this.rtpCapabilities.send,p=i===ze.VIDEO?u.videoCodecs:u.audioCodecs,m=i===ze.VIDEO?u.videoExtensions:u.audioExtensions;mn()&&(a="".concat(++this.currentMidIndex));let g={media:{mediaType:i,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(y=>y.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:e,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:a}};g=this.mungSendMediaDesc(g,l);const E=this.findFirstClosedMedia(i);if(E){const y=this.sessionDesc.mediaDescriptions.indexOf(E);this.sessionDesc.mediaDescriptions[y]=g}else this.sessionDesc.mediaDescriptions.push(g);return g}mungRecvMediaDsec(i,e,n){const s=Cn(i);return BT(s),Nu(s,e),WT(s,e),ux(s),Rm(s,n,this.localCapabilities.send),s}mungSendMediaDesc(i,e){const n=Cn(i);return Rm(n,e,this.localCapabilities.recv),Rc(n),n}updateRecvMedia(i,e){const n=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===i);if(n!==-1){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],e);this.sessionDesc.mediaDescriptions[n]=s}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(i=>i.media.port!=="0").map(i=>i.attributes.mid)}findPreloadMediaDesc(i){return this.sessionDesc.mediaDescriptions.find(e=>{var n;return((n=e.attributes)===null||n===void 0||(n=n.ssrcs[0])===null||n===void 0?void 0:n.ssrcId)===i[0].ssrcId})}findFirstClosedMedia(i){return this.sessionDesc.mediaDescriptions.find(e=>mn()?e.media.port==="0"&&e.media.mediaType===i:e.media.port==="0")}};const Tce=["sdp"];function T6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function ku(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?T6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):T6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}let No=class Hm extends t3{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,n;return(e=(n=this.peerConnection.getReceivers()[0])===null||n===void 0||(n=n.transport)===null||n===void 0?void 0:n.state)!==null&&e!==void 0?e:null}get localCodecs(){return[]}set isInRestartIce(e){this._isInRestartIce=e}get isInRestartIce(){return this._isInRestartIce}constructor(e,n,s){super(e,n),R(this,"direction",void 0),R(this,"name",void 0),R(this,"store",void 0),R(this,"spec",void 0),R(this,"peerConnection",void 0),R(this,"initialOffer",void 0),R(this,"transport",void 0),R(this,"statsFilter",void 0),R(this,"localCandidateCount",0),R(this,"allCandidatesReceived",!1),R(this,"localCandidateAddress",null),R(this,"useXR",Z("USE_XR")),R(this,"filter",{filterRTX:!Z("USE_PUB_RTX")&&!Z("USE_SUB_RTX"),filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC")}),R(this,"extension",{useXR:this.useXR}),R(this,"_isInRestartIce",!1),R(this,"mutex",new ii("P2PConnection-mutex")),R(this,"onLocalCandidate",void 0),R(this,"remoteSDP",void 0),R(this,"pendingCandidates",[]),R(this,"localCapabilities",void 0),R(this,"isReady",!1),R(this,"restartCnt",0),R(this,"curTurnServerIndex",0),this.store=n,this.spec=e,this.peerConnection=new RTCPeerConnection(Hm.resolvePCConfiguration(e,n.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=s??zi.SEND_ONLY,this.name=this.direction===zi.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=VT(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,mn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(e){try{const n=await px(this.filter,this.extension);if(this.localCapabilities=Im(n),e){const{sdp:s}=e,a=vce(e,Tce),l=function(){const E={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},y=hv(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),C={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},j={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Fa(y,E,"videoExtensions",C,I,j),Fa(y,E,"videoCodecs",C,I,j),Fa(y,E,"audioExtensions",C,I,j),Fa(y,E,"audioCodecs",C,I,j),Z("RAISE_H264_BASELINE_PRIORITY")){const P=j.videoCodecs.findIndex(U=>U.rtpMap&&U.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&U.fmtp&&U.fmtp.parameters["profile-level-id"]==="42001f");if(P!==-1){const U=j.videoCodecs.findIndex(q=>q.rtpMap&&q.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(U<P){N.debug("raising H264 baseline profile priority");const q=j.videoCodecs[P];j.videoCodecs.splice(P,1),j.videoCodecs.splice(U,0,q)}U!==-1&&Z("FILTER_SEND_H264_BASELINE")&&(C.videoCodecs=C.videoCodecs.filter(q=>!(q.rtpMap&&q.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&q.fmtp&&q.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:C,recv:I,sendrecv:j}}(this.filter,this.extension,s);this.remoteSDP=new b6({remoteIceParameters:a.iceParameters,remoteDtlsParameters:a.dtlsParameters,candidates:[],remoteRTPCapabilities:l,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const u=await this.peerConnection.createAnswer();if(!u.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const p=wc(u.sdp);await this.peerConnection.setLocalDescription(u);const m=await S6(this.filter,this.extension,u.sdp);this.localCapabilities=Im(m);const g=this.peerConnection.getTransceivers()[0];return g!=null&&g.receiver&&g.receiver.transport&&this.tryBindTransportEvents(g.receiver.transport),ku(ku({},p),{},{sdp:u.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=wc(s.sdp);return this.initialOffer=s,ku(ku({},a),{},{sdp:s.sdp})}}catch(n){throw new ye(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:n,iceParameters:s,dtlsParameters:a}=e,l=await S6(this.filter,this.extension,n);this.remoteSDP=new b6({remoteIceParameters:s,remoteDtlsParameters:a,candidates:[],remoteRTPCapabilities:l,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const u=this.peerConnection.getTransceivers()[0];u!=null&&u.sender&&u.sender.transport&&this.tryBindTransportEvents(u.sender.transport)}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(n.toString()))}}async addRemoteCandidate(e){try{e&&this.pendingCandidates.push(e),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(n=>{this.peerConnection.addIceCandidate(n)}),this.pendingCandidates=[])}catch(n){throw new ye(z.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(n.toString()))}}send(e,n,s){var a=this;return no(function*(){const l=yield Ct(a.mutex.lock("From P2PConnection.send"));try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=[],p=a.remoteSDP.receive(e,n,s);e.forEach((U,q)=>{if(p[q].needCreateTransceiver){const J=a.peerConnection.addTransceiver(U._mediaStreamTrack,{direction:"sendonly"});u.push(J),U._updateRtpTransceiver(J)}else{const J=a.peerConnection.getTransceivers().find(se=>se.mid===p[q].mid);if(!J)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(p[q].mid));u.push(J),U._updateRtpTransceiver(J)}}),mn()&&Z("SIMULCAST")===!0&&(yield Ct(a.applySimulcastForFirefox(u,e)));const m=p.map(U=>U.mid),g=yield Ct(a.peerConnection.createOffer()),E=a.mungSendOfferSDP(g.sdp,e,m),y=Fn.parse(E),C=m.map(U=>{const q=y.mediaDescriptions.find(J=>J.attributes.mid===U);if(!q)throw new Error("Cannot extract ssrc from mediaDescription.");return dx(q,Z("USE_PUB_RTX"))}),I=u.map((U,q)=>{const J=m[q];return{localSSRC:C[q],id:J}});yield Ct(a.peerConnection.setLocalDescription({type:"offer",sdp:E}));try{yield I}catch(U){const q=a.remoteSDP.toString();throw yield Ct(a.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield Ct(a.peerConnection.setRemoteDescription({type:"answer",sdp:q})),yield Ct(a.stopSending(m,!0)),U}yield Ct(a.applySimulcastEncodings(u,e)),yield Ct(a.applySendEncodings(u,e));const j=a.remoteSDP.toString(),P=a.logSDPExchange(E,"offer","local","send");return P==null||P(j),yield Ct(a.setRemoteDescription({type:"answer",sdp:j})),u.map((U,q)=>{const J=m[q];return{localSSRC:C[q],id:J}})}catch(u){throw u instanceof ye?u:new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async stopSending(e,n){const s=n?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const a=this.peerConnection.getTransceivers().filter(m=>e.indexOf(m.mid)!==-1);if(a.length!==e.length)throw new Error("Transceivers' length (".concat(a.length,") doesn't match mids' length (").concat(e.length,") when trying to call P2PConnection.stopSending."));a.map(m=>{var g;m.direction="inactive",(g=m.stop)===null||g===void 0||g.call(m)});const l=await this.peerConnection.createOffer(),u=this.logSDPExchange(l.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(l),this.remoteSDP.stopReceiving(e);const p=this.remoteSDP.toString();u==null||u(p),await this.setRemoteDescription({type:"answer",sdp:p})}catch(a){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(a.toString()))}finally{s&&s()}}async receive(e,n,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:l,needExchangeSDP:u}=this.remoteSDP.send(e,n,s,a);if(u){const m=this.remoteSDP.toString(),g=this.logSDPExchange(m,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:m});const E=await this.peerConnection.createAnswer(),y=this.mungReceiveAnswerSDP(E.sdp,l,e);g==null||g(y||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:y}),N.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else N.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."));const p=this.peerConnection.getTransceivers().find(m=>m.mid===l);if(!p||p.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,mid:p.mid,transceiver:p}}catch(l){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async mockReceive(e,n,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:l,needExchangeSDP:u}=this.remoteSDP.send(e,n,s,a);if(u){const p=this.remoteSDP.toString(),m=this.logSDPExchange(p,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:p});const g=await this.peerConnection.createAnswer(),E=this.mungReceiveAnswerSDP(g.sdp,l,e);m==null||m(E||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:E}),N.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else N.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."))}catch(l){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const n=this.remoteSDP.toString(),s=this.logSDPExchange(n,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}async restartICE(e){try{if(this.store.p2pTransport===nd.Auto&&(this.store.p2pTransport=nd.SdRtn,Kt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(Hm.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,Kt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(Hm.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!e){this.restartCnt++,this.isReady=!1;const n=await this.peerConnection.createOffer({iceRestart:!0});if(!n.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:s}=wc(n.sdp);return this.store.descriptionStart(),this.direction===zi.SEND_ONLY&&await this.peerConnection.setLocalDescription(n),s}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(e),this.store.descriptionStart(),this.direction===zi.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const n=await this.peerConnection.createAnswer();if(!n.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:s}=wc(n.sdp);return await this.peerConnection.setLocalDescription(n),s}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}close(){var e;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),a=this.mungSendOfferSDP(s.sdp,[n],[e]);this.remoteSDP.updateRecvMedia(e,n);const l=this.remoteSDP.toString(),u=this.logSDPExchange(a,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),u==null||u(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new ye(z.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(e,n){const s=this.peerConnection.getTransceivers().filter(a=>a.mid===e);s.length===1&&(this.isVP8Simulcast(n)?mn()||await this.applySimulcastEncodings(s,[n]):await this.applySendEncodings(s,[n]))}setStatsRemoteVideoIsReady(e,n){this.statsFilter.setVideoIsReady2(e,n)}async replaceTrack(e,n){const s=this.peerConnection.getTransceivers().find(a=>a.mid===n);s&&await s.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const n=e[0].transport.iceTransport,{local:s,remote:a}=n.getSelectedCandidatePair();return{local:ku(ku({},gl),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:ku(ku({},gl),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e,n;je(e=["connected","completed"]).call(e,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(n=this.onICEConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=e=>{if(e.candidate){var n;e.candidate.candidate&&(this.localCandidateAddress=e.candidate.address,(n=this.onLocalCandidate)===null||n===void 0||n.call(this,e.candidate.toJSON())),this.localCandidateCount+=1}else this.allCandidatesReceived=!0,N.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const a={iceServers:[]};var l;return e.iceServers?a.iceServers=e.iceServers:e.turnServer&&e.turnServer.mode!=="off"&&(Yf(e.turnServer.servers)?a.iceServers=e.turnServer.servers:(a.iceServers&&a.iceServers.push(...Hm.turnServerConfigToIceServers(e.turnServer.servers,n,s)),Z("USE_TURN_SERVER_OF_GATEWAY")&&a.iceServers&&e.turnServer.serversFromGateway&&a.iceServers.push(...Hm.turnServerConfigToIceServers(e.turnServer.serversFromGateway,n,s)),je(l=[nd.Relay,nd.SdRtn]).call(l,n)&&(a.iceTransportPolicy="relay"),Z("FORCE_TURN_TCP")?a.iceTransportPolicy="relay":e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach(u=>{u.forceturn&&(a.iceTransportPolicy="relay")}))),Z("ENABLE_ENCODED_TRANSFORM")&&Kt().supportWebRTCEncodedTransform&&(a.encodedInsertableStreams=!0),N.debug("P2PConnection p2pTransport is ".concat(n)),a}static turnServerConfigToIceServers(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const a=[],l=e.filter(p=>p.tcpport);N.debug("P2PConnection turnServers is ".concat(l,", current index is ").concat(s));const u=l.length>s?l[s]:l[0];switch(n){case nd.SdRtn:const p=e.filter(g=>{var E;return je(E=g.username).call(E,"glb:")&&g.turnServerURL==g.turnServerURL}),m=p.length>s?p[s]:p[0];m&&(a.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(gu(m.turnServerURL),":").concat(m.tcpport,"?transport=udp")}),a.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(gu(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}));break;case nd.Relay:u&&(a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turn:".concat(u.turnServerURL,":").concat(u.tcpport,"?transport=udp")}),a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turns:".concat(gu(u.turnServerURL),":").concat(u.tcpport,"?transport=tcp")}));break;default:u&&(a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turn:".concat(u.turnServerURL,":").concat(u.tcpport,"?transport=udp")}),a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turns:".concat(gu(u.turnServerURL),":").concat(u.tcpport,"?transport=tcp")}),a.push({username:u.username,credential:u.password,credentialType:"password",urls:"stun:".concat(u.turnServerURL,":").concat(u.tcpport)}))}return a}tryBindTransportEvents(e){if(e){this.transport=e,e.onstatechange=()=>{var s;e!=null&&e.state&&((s=this.onDTLSTransportStateChange)===null||s===void 0||s.call(this,e.state))},e.onerror=s=>{var a;(a=this.onDTLSTransportError)===null||a===void 0||a.call(this,"error"in s?s.error:s)};const n=e.iceTransport;n&&(n.onstatechange=()=>{const s=e==null?void 0:e.iceTransport.state;var a;s&&((a=this.onICETransportStateChange)===null||a===void 0||a.call(this,s))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){const{local:s,remote:a}=n.getSelectedCandidatePair();N.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:s.type,protocol:s.protocol}),", remote ").concat(JSON.stringify({candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,n){var s;if(n||(n=this.peerConnection.getSenders().find(E=>E.track===e._mediaStreamTrack)),!n)return N.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return N.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Kt().supportSetRtpSenderParameters)return N.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const a={},l={};switch(e._optimizationMode){case"motion":a.degradationPreference="maintain-framerate";break;case"detail":a.degradationPreference="maintain-resolution";break;default:a.degradationPreference="balanced"}if(e._encoderConfig){var u;const{bitrateMax:E,frameRate:y,scaleResolutionDownBy:C}=e._encoderConfig;E&&(l.maxBitrate=1e3*E),je(u=e._hints).call(u,wn.LOW_STREAM)&&(y&&(l.maxFramerate=To(y)),C&&C>=1&&(l.scaleResolutionDownBy=C))}if(Z("DSCP_TYPE")&&au()){var p;const E=Z("DSCP_TYPE");je(p=["very-low","low","medium","high"]).call(p,E)&&(l.networkPriority=E)}const m=n.getParameters(),g=(s=m.encodings)===null||s===void 0?void 0:s[0];mn()&&!g&&(a.encodings=[l]),g&&Object.assign(g,l),Object.assign(m,a),N.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(m.encodings))),await n.setParameters(m)}async applySendEncodings(e,n){try{if(!Kt().supportSetRtpSenderParameters||e.length!==n.length)return;for(let s=0;s<e.length;s++){const a=e[s],l=n[s];l instanceof At&&!this.isVP8Simulcast(l)&&await this.updateRtpSenderEncodings(l,a.sender)}}catch{N.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,n,s){const a=Fn.parse(e);return n.forEach((l,u)=>{const p=s[u],m=a.mediaDescriptions.find(g=>g.attributes.mid===p);m&&(Nu(m,l),hx(m,l,this.store.codec))}),Fn.print(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,n,s)=>{var a;(a=this.onFirstVideoDecoded)===null||a===void 0||a.call(this,e,n,s)},this.statsFilter.onSelectedLocalCandidateChanged=(e,n)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,e,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,n)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,e,n)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var n;(n=this.onFirstVideoDecodedTimeout)===null||n===void 0||n.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,n){if(e.length===n.length)for(let m=0;m<e.length;m++){var s,a,l,u,p;const g=e[m],E=n[m];if(E instanceof At&&!je(s=E._hints).call(s,wn.LOW_STREAM)&&(a=E._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=E._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=E._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=E._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const y={},C={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};y.encodings=[{rid:"m",active:!0,maxBitrate:C.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:C.high}];const I=g.sender.getParameters();await g.sender.setParameters(Object.assign(I,y))}}}async applySimulcastEncodings(e,n){if(!mn()&&e.length===n.length)for(let s=0;s<e.length;s++){const a=n[s];if(a instanceof At&&this.isVP8Simulcast(a)){const l=e[s],u={},p={high:1e3*(a._encoderConfig.bitrateMax-50),medium:5e4};u.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const m=l.sender.getParameters();await l.sender.setParameters(Object.assign(m,u))}}}isVP8Simulcast(e){var n,s,a,l,u;return!!(e instanceof At&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!je(n=e._hints).call(n,wn.LOW_STREAM)&&(s=e._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((a=e._encoderConfig)===null||a===void 0?void 0:a.bitrateMax)>200&&(l=e._scalabilityMode)!==null&&l!==void 0&&l.numSpatialLayers&&((u=e._scalabilityMode)===null||u===void 0?void 0:u.numSpatialLayers)>1)}logSDPExchange(e,n,s,a){if(Z("SDP_LOGGING"))return N.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(n," SDP during P2PConnection.").concat(a,`
`),e),n==="offer"?l=>{this.logSDPExchange(l,"answer",s==="local"?"remote":"local",a)}:void 0}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(u=>u.mid&&e.indexOf(u.mid)!==-1);if(n.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(u=>{u.direction="inactive"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(e);const l=this.remoteSDP.toString();a==null||a(l),await this.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(u=>u.mid&&e.indexOf(u.mid)!==-1);if(n.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(async u=>{u.direction="sendonly"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(e);const l=this.remoteSDP.toString();a==null||a(l),await this.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(n.toString()))}}async getRemoteSSRC(e,n){var s,a;if(n=(s=n)!==null&&s!==void 0?s:(a=this.currentRemoteDescription)===null||a===void 0?void 0:a.sdp){var l;const u=(l=Fn.parse(n).mediaDescriptions.find(p=>p.attributes.mid===e))===null||l===void 0?void 0:l.attributes.ssrcs;return u==null?void 0:u[0].ssrcId}}async setRemoteDescription(e){var n;await this.peerConnection.setRemoteDescription(e),je(n=["connected","completed"]).call(n,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(e,n,s){const a=Fn.parse(e),l=a.mediaDescriptions.find(u=>u.attributes.mid===n);return l&&(s===ze.AUDIO&&l.media.mediaType==="audio"&&Rc(l),this.useXR&&pv(a)),Fn.print(a)}};function Va(i,e,n){const s=i[e];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const a=this.mutex,l=await a.lock("From P2PConnection.".concat(e));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},n}function fx(i,e){let n=document.createElement("video"),s=document.createElement("canvas");n.setAttribute("style","display:none"),s.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),s.width=To(e.width),s.height=To(e.height);const a=To(e.framerate||15);document.body.append(n),document.body.append(s);let l=i._mediaStreamTrack;n.srcObject=new MediaStream([l]),n.play();const u=s.getContext("2d");if(!u)throw new le(z.UNEXPECTED_ERROR,"can not get canvas context");const p=Kt(),m=s.captureStream(p.supportRequestFrame?0:a).getVideoTracks()[0];m.canvas||(m.canvas=s),s.startCapture=()=>{if(!n)return s.stopCapture&&s.stopCapture();if(n.paused&&n.play(),n.videoHeight>2&&n.videoWidth>2){const E=n.videoWidth,y=n.videoHeight/E,C=s.width*y;Math.abs(C-s.height)>=2&&(N.debug("adjust low stream resolution","".concat(s.width,"x").concat(s.height," -> ").concat(s.width,"x").concat(C)),s.height=C)}u.drawImage(n,0,0,s.width,s.height),m.requestFrame&&m.requestFrame(),l!==i._mediaStreamTrack&&(l=i._mediaStreamTrack,n.srcObject=new MediaStream([l]))},s.stopCapture=JN(()=>s.startCapture&&s.startCapture(),a);const g=m.stop;return m.stop=()=>{g.call(m),n&&(n.remove(),n.srcObject=null,n=null),s&&(s.width=0,s.remove(),s.stopCapture&&s.stopCapture(),s.startCapture=void 0,s.stopCapture=void 0,s=null),N.debug("clean low stream renderer")},m}var fv,C6,Yr,xu,Mi,Am,mx,pd,ta,gx,ko;be([Va,$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],No.prototype,"establish",null),be([Va,$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],No.prototype,"connect",null),be([Va,$("design:type",Function),$("design:paramtypes",[String,Array,String,String]),$("design:returntype",pe)],No.prototype,"receive",null),be([Va,$("design:type",Function),$("design:paramtypes",[String,Array,String,String]),$("design:returntype",pe)],No.prototype,"mockReceive",null),be([Va,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],No.prototype,"stopReceiving",null),be([Va,$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],No.prototype,"restartICE",null),be([Va,$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],No.prototype,"close",null),be([Va,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],No.prototype,"updateEncoderConfig",null),be([Va,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],No.prototype,"updateSendParameters",null),be([Va,$("design:type",Function),$("design:paramtypes",[Di,String]),$("design:returntype",pe)],No.prototype,"replaceTrack",null),be([Va,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],No.prototype,"muteLocal",null),be([Va,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],No.prototype,"unmuteLocal",null),function(i){i[i.HEIGHT=2033]="HEIGHT",i[i.FRAME_RATE=2034]="FRAME_RATE",i[i.WIDTH=2035]="WIDTH"}(fv||(fv={})),function(i){i[i.HEIGHT=2072]="HEIGHT",i[i.FRAME_RATE=2074]="FRAME_RATE",i[i.WIDTH=2076]="WIDTH"}(C6||(C6={})),function(i){i[i.FRAME_RATE=2002]="FRAME_RATE",i[i.WIDTH=2003]="WIDTH",i[i.HEIGHT=2004]="HEIGHT",i[i.PACKAGE_LOST=2005]="PACKAGE_LOST",i[i.AVG_ENCODE=2007]="AVG_ENCODE",i[i.NACKS=2009]="NACKS",i[i.PLIS=2010]="PLIS",i[i.FIRS=2011]="FIRS",i[i.BITRATE=2012]="BITRATE",i[i.PACKAGE_RATE=2031]="PACKAGE_RATE",i[i.ADAPTATION=2032]="ADAPTATION",i[i.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",i[i.BANDWIDTH=2061]="BANDWIDTH",i[i.RETRANSMIT=2062]="RETRANSMIT",i[i.TARGET_ENCODED=2064]="TARGET_ENCODED",i[i.TRANSMIT=2066]="TRANSMIT",i[i.FREEZE=2082]="FREEZE",i[i.DISABLED=2095]="DISABLED",i[i.PLAYER_STATUS=2128]="PLAYER_STATUS",i[i.QP_SUM=2143]="QP_SUM"}(Yr||(Yr={})),function(i){i[i.BITRATE=2069]="BITRATE",i[i.PACKAGE_LOST=2070]="PACKAGE_LOST",i[i.PACKAGE_RATE=2071]="PACKAGE_RATE",i[i.HEIGHT=2073]="HEIGHT",i[i.FRAME_RATE=2075]="FRAME_RATE",i[i.WIDTH=2077]="WIDTH"}(xu||(xu={})),function(i){i[i.JITTER=-1]="JITTER",i[i.PACKAGE_LOST=2014]="PACKAGE_LOST",i[i.WIDTH=2018]="WIDTH",i[i.HEIGHT=2019]="HEIGHT",i[i.FRAME_RATE=2020]="FRAME_RATE",i[i.JITTER_BUFFER=2023]="JITTER_BUFFER",i[i.CURRENT_DELAY=2024]="CURRENT_DELAY",i[i.NACKS=2026]="NACKS",i[i.PLIS=2027]="PLIS",i[i.FIRS=2028]="FIRS",i[i.BITRATE=2029]="BITRATE",i[i.PACKAGE_RATE=2078]="PACKAGE_RATE",i[i.FREEZE=2084]="FREEZE",i[i.DISABLED=2101]="DISABLED",i[i.PLAYER_STATUS=2129]="PLAYER_STATUS",i[i.QP_SUM=2144]="QP_SUM",i[i.I_FRAME_DELAY=2149]="I_FRAME_DELAY"}(Mi||(Mi={})),function(i){i[i.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",i[i.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",i[i.FREEZE_TIME=2109]="FREEZE_TIME",i[i.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER"}(Am||(Am={})),function(i){i[i.PCM_LEVEL=2104]="PCM_LEVEL"}(mx||(mx={})),function(i){i[i.PACKAGE_LOST=-1]="PACKAGE_LOST",i[i.LEVEL=2038]="LEVEL",i[i.BITRATE=2039]="BITRATE",i[i.PACKAGE_RATE=2040]="PACKAGE_RATE",i[i.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",i[i.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",i[i.FREEZE=2081]="FREEZE",i[i.DISABLED=2096]="DISABLED"}(pd||(pd={})),function(i){i[i.BITRATE=2044]="BITRATE",i[i.PACKAGE_LOST=2045]="PACKAGE_LOST",i[i.PACKAGE_RATE=2046]="PACKAGE_RATE",i[i.CURRENT_DELAY=2047]="CURRENT_DELAY",i[i.JITTER_BUFFER=2054]="JITTER_BUFFER",i[i.JITTER=2055]="JITTER",i[i.FREEZE=2083]="FREEZE",i[i.DISABLED=2102]="DISABLED",i[i.PCM_LEVEL=2105]="PCM_LEVEL",i[i.PLAYER_STATUS=2130]="PLAYER_STATUS",i[i.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES"}(ta||(ta={})),function(i){i[i.FREEZE_TIME=-1]="FREEZE_TIME",i[i.LEVEL=2043]="LEVEL"}(gx||(gx={})),function(i){i[i.RTT=2006]="RTT",i[i.CONN_TYPE=801]="CONN_TYPE"}(ko||(ko={}));const fd=1e3,yp=3;function xt(i,e,n){n!=null&&Number.isFinite(n)&&(i[e]=Math.round(Math.max(0,n)))}function w6(i){const e={[ko.CONN_TYPE]:0,[ko.RTT]:i.rtt};switch(i.selectedCandidatePair.localCandidate.candidateType){case"relay":{const n=i.selectedCandidatePair.localCandidate.relayProtocol;n==="udp"&&(e[ko.CONN_TYPE]=1),n==="tcp"&&(e[ko.CONN_TYPE]=3),n==="tls"&&(e[ko.CONN_TYPE]=4);break}case"srflx":e[ko.CONN_TYPE]=2}return e}class R6 extends jn{constructor(e){super(),R(this,"store",void 0),R(this,"uploadWRTCStatsTimer",void 0),R(this,"uploadOutboundDenoiserStatsTimer",void 0),R(this,"uploadExtStatsTimer",void 0),R(this,"uploadExtUsageStatsTimer",void 0),R(this,"uploadInboundExtStatsTimer",void 0),R(this,"requestStats",void 0),R(this,"requestTransportStats",void 0),R(this,"requestLocalMedia",void 0),R(this,"requestRemoteMedia",void 0),R(this,"requestAllTracks",void 0),R(this,"requestVideoIsReady",void 0),R(this,"requestUploadStats",void 0),R(this,"requestUpload",void 0),R(this,"uploadOutboundStarted",!1),R(this,"uploadInboundStarted",!1),R(this,"uploadTransportStarted",!1),R(this,"uploadExtensionUsageStarted",!1),R(this,"lastRecvStats",void 0),R(this,"lastSendStats",void 0),R(this,"lastFullRecvStats",void 0),R(this,"lastFullSendStats",void 0),R(this,"needUploadRenderFreezeTime",!0),this.store=e}uploadWRTCStats(e){if(!this.requestStats||!this.requestUploadStats)return;let n,s;if(this.uploadTransportStarted&&(n=this.requestStats(),this.store.useP2P&&(s=this.requestStats(!0))),!n&&this.uploadOutboundStarted&&(n=this.requestStats()),!s&&this.uploadInboundStarted&&(s=this.requestStats(!0)),n||s){const a={};if(this.uploadTransportStarted&&n){const l=this.getTransportStats(n,s,e);l&&(a.misc=[l])}if(this.uploadOutboundStarted&&n){const l=this.getOutboundStats(n,e?this.lastSendStats:this.lastFullSendStats,e);l&&(a.outbound=[l])}if(this.uploadInboundStarted&&s){const l=this.getInboundStats(s,e?this.lastRecvStats:this.lastFullRecvStats,e);l&&(a.inbound=l)}this.requestUploadStats(a)}this.lastRecvStats=s,this.lastSendStats=n,e||(this.lastFullRecvStats=s,this.lastFullSendStats=n)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let e=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(e!==yp),++e===yp+1&&(e=1)},fd)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(e,n,s){if(!this.requestStats)return;if(s)return e.rtt==null?void 0:{addition:{[ko.RTT]:e.rtt,[ko.CONN_TYPE]:void 0}};const a=w6(e);if(this.store.useP2P){if(n){const l=w6(n);a[ko.CONN_TYPE]+=l[ko.CONN_TYPE]<<3}a[ko.CONN_TYPE]+=110}else a[ko.CONN_TYPE]+=100;return{addition:a}}getOutboundStats(e,n,s){if(!this.requestUploadStats||!this.requestLocalMedia)return;const a=this.requestLocalMedia();if(!a||a.length===0)return;let l,u,p;return a.forEach(m=>{let[g,{track:E,ssrcs:y}]=m;switch(g){case Ie.LocalVideoLowTrack:case Ie.LocalVideoTrack:if(g===Ie.LocalVideoTrack){const C=function(P,U,q,J,se){const he=U.videoSend.find(Oe=>Oe.ssrc===P);if(!he)return;const ae={},{sentFrame:de,inputFrame:me}=he;if(me&&de){const Oe=me.frameRate,De=de.frameRate;ae[Yr.FREEZE]=function(_t,Pt){let Rn=!0;return Rn=!(_t<=5)&&(_t<=10?Pt<3:_t<=20?Pt<4:Pt<5),Rn}(Oe,De)?1:0}if(xt(ae,Yr.QP_SUM,he.qpSumPerFrame),se)return ae;switch(de&&(xt(ae,Yr.HEIGHT,de.height),xt(ae,Yr.WIDTH,de.width),xt(ae,Yr.FRAME_RATE,de.frameRate)),ae[Yr.DISABLED]=J._originMediaStreamTrack&&!J._originMediaStreamTrack.enabled||J._mediaStreamTrack&&!J._mediaStreamTrack.enabled?1:0,he.adaptionChangeReason){case"none":ae[Yr.ADAPTATION]=0;break;case"cpu":ae[Yr.ADAPTATION]=1;break;case"bandwidth":ae[Yr.ADAPTATION]=2;break;case"other":ae[Yr.ADAPTATION]=3}ae[Yr.PLAYER_STATUS]=qN[J._player?J._player.videoElementStatus:"uninit"],xt(ae,Yr.NACKS,he.nacksCount),xt(ae,Yr.PLIS,he.plisCount),xt(ae,Yr.FIRS,he.firsCount),xt(ae,Yr.AVG_ENCODE,he.avgEncodeMs);const ge=q&&q.videoSend.find(Oe=>Oe.ssrc===P);if(ge){let Oe=se?fd:fd*yp;ge.timestamp&&he.timestamp&&(Oe=he.timestamp-ge.timestamp),ge.packets!=null&&he.packets!=null&&xt(ae,Yr.PACKAGE_RATE,1e3*(he.packets-ge.packets)/Oe),he.packetsLost!=null&&ge.packetsLost!=null&&xt(ae,Yr.PACKAGE_LOST,he.packetsLost-ge.packetsLost),ge.bytes!=null&&he.bytes!=null&&xt(ae,Yr.BITRATE,8*(he.bytes-ge.bytes)/Oe)}return ae}(y[0].ssrcId,e,n,E,s),I=s?null:function(P,U,q){const J=U.videoSend.find(ge=>ge.ssrc===P);if(!J)return null;const se={},he=J.inputFrame,ae=he&&he.height||q&&q._videoHeight||0,de=he&&he.width||q&&q._videoWidth||0,me=he&&he.frameRate||0;return xt(se,fv.HEIGHT,ae),xt(se,fv.WIDTH,de),xt(se,fv.FRAME_RATE,me),se}(y[0].ssrcId,e,E),j=s?null:function(P){const U={};return xt(U,Yr.RETRANSMIT,P.bitrate.retransmit),xt(U,Yr.TARGET_ENCODED,P.bitrate.targetEncoded),xt(U,Yr.ACTUAL_ENCODED,P.bitrate.actualEncoded),xt(U,Yr.TRANSMIT,P.bitrate.transmit),xt(U,Yr.BANDWIDTH,P.sendBandwidth),U}(e);u=Object.assign({},C,I,j)}else p=s?void 0:function(C,I,j){const P=I.videoSend.find(J=>J.ssrc===C);if(!P)return;const U={},q=P.sentFrame;if(q&&(xt(U,xu.HEIGHT,q.height),xt(U,xu.WIDTH,q.width),xt(U,xu.FRAME_RATE,q.frameRate)),j){const J=j.videoSend.find(se=>se.ssrc===C);if(J){let se=fd*yp;J.timestamp&&P.timestamp&&(se=P.timestamp-J.timestamp),J.packets!=null&&P.packets!=null&&xt(U,xu.PACKAGE_RATE,1e3*(P.packets-J.packets)/se),P.packetsLost!=null&&J.packetsLost!=null&&xt(U,xu.PACKAGE_LOST,P.packetsLost-J.packetsLost),J.bytes!=null&&P.bytes!=null&&xt(U,xu.BITRATE,8*(P.bytes-J.bytes)/se)}}return U}(y[0].ssrcId,e,n);break;case Ie.LocalAudioTrack:l=s?void 0:function(C,I,j,P){const U=I.audioSend.find(ae=>ae.ssrc===C);if(!U)return;const q={};q[pd.DISABLED]=P._originMediaStreamTrack&&!P._originMediaStreamTrack.enabled||P._mediaStreamTrack&&!P._mediaStreamTrack.enabled?1:0;const J=P._source.getAccurateVolumeLevel(),se=U.inputLevel;xt(q,pd.LEVEL,100*(se??J)),xt(q,mx.PCM_LEVEL,100*J),xt(q,pd.AEC_RETURN_LOSS,U.aecReturnLoss),xt(q,pd.AEC_RETURN_LOSS_ENH,U.aecReturnLossEnhancement),q[pd.FREEZE]=0;const he=j&&j.audioSend.find(ae=>ae.ssrc===C);if(he){let ae=fd*yp;he.timestamp&&U.timestamp&&(ae=U.timestamp-he.timestamp),he.bytes!=null&&U.bytes!=null&&xt(q,pd.BITRATE,8*(U.bytes-he.bytes)/ae),he.packets!=null&&U.packets!=null&&xt(q,pd.PACKAGE_RATE,1e3*(U.packets-he.packets)/ae)}return q}(y[0].ssrcId,e,n,E)}}),{high:u,low:p,audio:l}}getInboundStats(e,n,s){if(!this.requestRemoteMedia)return;const a=this.requestRemoteMedia()||[],l=[];return a.forEach(u=>{let[p,m]=u;const g={peer:p.uid};if(m.has(ze.VIDEO)&&p.videoTrack){const E=p._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(p._videoSSRC)||!1,y=p.videoTrack?function(C,I,j,P,U,q,J){const se=I.videoRecv.find(Oe=>Oe.ssrc===C);if(!se)return;const he={},{receivedFrame:ae,outputFrame:de,decodeFrameRate:me}=se,ge=j&&j.videoRecv.find(Oe=>Oe.ssrc===C);if(he[Mi.FREEZE]=U&&mv.isRemoteVideoFreeze(P,se,ge)?1:0,xt(he,Am.FRAME_RATE_DECODE,me),xt(he,Mi.QP_SUM,se.qpSumPerFrame),se.framesRateFirefox&&xt(he,Mi.FRAME_RATE,se.framesRateFirefox),ae&&xt(he,Mi.FRAME_RATE,ae.frameRate),ge){const Oe=I.timestamp-j.timestamp||(J?fd:yp*fd);se.packetsLost!=null&&ge.packetsLost!=null&&xt(he,Mi.PACKAGE_LOST,se.packetsLost-ge.packetsLost),ge.bytes!=null&&se.bytes!=null&&xt(he,Mi.BITRATE,8*(se.bytes-ge.bytes)/Oe),ge.packets!=null&&se.packets!=null&&xt(he,Mi.PACKAGE_RATE,1e3*(se.packets-ge.packets)/Oe)}if(J)return he;if(ae?(xt(he,Mi.HEIGHT,ae.height),xt(he,Mi.WIDTH,ae.width)):P&&(xt(he,Mi.HEIGHT,P._videoHeight||0),xt(he,Mi.WIDTH,P._videoWidth||0)),de&&xt(he,Am.FRAME_RATE_RENDER,de.frameRate),xt(he,Mi.JITTER_BUFFER,se.jitterBufferMs),xt(he,Mi.CURRENT_DELAY,se.currentDelayMs),xt(he,Mi.FIRS,se.firsCount),xt(he,Mi.NACKS,se.nacksCount),xt(he,Mi.PLIS,se.plisCount),P){he[Mi.DISABLED]=P._originMediaStreamTrack.enabled&&P._mediaStreamTrack.enabled?0:1;const Oe=P._player;if(Oe){const{freezeTimeCounterList:De,renderFreezeAccTime:_t}=Oe;if(De&&De.length>0&&xt(he,Am.FREEZE_TIME,De.splice(0,1)[0]),q&&ad.visibility==="visible"){const Pt=Math.min(6e3,_t);Oe.renderFreezeAccTime=Math.max(0,_t-Pt),xt(he,Am.FREEZE_TIME_RENDER,Pt)}}}if(he[Mi.PLAYER_STATUS]=qN[P._player?P._player.videoElementStatus:"uninit"],ge&&se.totalInterFrameDelay!==void 0&&se.totalSquaredInterFrameDelay!==void 0&&ge.totalInterFrameDelay!==void 0&&ge.totalSquaredInterFrameDelay!==void 0){const Oe=se.totalInterFrameDelay-ge.totalInterFrameDelay,De=se.totalSquaredInterFrameDelay-ge.totalSquaredInterFrameDelay,_t=se.framesDecodeCount-ge.framesDecodeCount,Pt=Oe/_t*1e3,Rn=Math.round(1e3*Math.sqrt((De-Math.pow(Oe,2)/_t)/_t));!isNaN(Rn)&&Pt+Rn>Math.max(3*Pt,Pt+150)&&(he[Mi.I_FRAME_DELAY]=Rn)}return he}(p._videoSSRC,e,n,p.videoTrack,E===!0,this.needUploadRenderFreezeTime,s):void 0;y&&(g.video=y)}if(m.has(ze.AUDIO)&&p.audioTrack){const E=p.audioTrack?function(y,C,I,j,P){const U=C.audioRecv.find(Oe=>Oe.ssrc===y);if(!U)return;const q={},J=I&&I.audioRecv.find(Oe=>Oe.ssrc===y),{receivedFrames:se,droppedFrames:he}=U;var ae,de;if(xt(q,ta.JITTER,U.jitterMs),se!=null&&he!=null&&(q[ta.FREEZE]=(de=he,(ae=se)===0||100*de/ae>20?1:0)),J){const Oe=C.timestamp-I.timestamp||(P?fd:fd*yp);U.packets!=null&&J.packets!=null&&xt(q,ta.PACKAGE_RATE,1e3*(U.packets-J.packets)/Oe),J.bytes!=null&&U.bytes!=null&&xt(q,ta.BITRATE,8*(U.bytes-J.bytes)/Oe),U.packetsLost!=null&&J.packetsLost!=null&&xt(q,ta.PACKAGE_LOST,U.packetsLost-J.packetsLost)}if(P)return q;const me=j._source.getAccurateVolumeLevel(),ge=U.outputLevel;if(xt(q,gx.LEVEL,100*(ge??me)),xt(q,ta.PCM_LEVEL,100*me),j&&(q[ta.DISABLED]=j._originMediaStreamTrack.enabled&&j._mediaStreamTrack.enabled?0:1),xt(q,ta.JITTER_BUFFER,U.jitterBufferMs),xt(q,ta.CURRENT_DELAY,U.jitterBufferMs),q[ta.PLAYER_STATUS]=qN[Ss.getPlayerState(j.getTrackId())],J){const Oe=U.concealedSamples-J.concealedSamples;Oe>0&&xt(q,ta.CONCEALED_SAMPLES,Oe)}return q}(p._audioSSRC,e,n,p.audioTrack,s):void 0;E&&(g.audio=E)}(g.video||g.audio)&&l.push(g)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,l}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const e=(this.requestAllTracks()||[]).find(n=>n instanceof ap);if(e&&e._external.getDenoiserStats){const n=e._external.getDenoiserStats();n&&this.requestUpload(rd.DENOISER_STATS,n)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(e=>{e.getProcessorStats().forEach(n=>{this.requestUpload&&this.requestUpload(n.type,n.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(e=>{let[n,s]=e;s.has(ze.VIDEO)&&n.videoTrack&&n.videoTrack.getProcessorStats().forEach(a=>{this.requestUpload&&this.requestUpload(a.type,a.stats)}),s.has(ze.AUDIO)&&n.audioTrack&&n.audioTrack.getProcessorStats().forEach(a=>{this.requestUpload&&this.requestUpload(a.type,a.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const e=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const n=Date.now(),s={connectionInterval:Z("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:n};let a=[];const l=this.requestAllTracks&&this.requestAllTracks()||[];for(const g of l)!g.muted&&g.enabled&&(a=a.concat(await g.getProcessorUsage()));const u=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[g,E]of u)E.has(ze.VIDEO)&&g.videoTrack&&(a=a.concat(await g.videoTrack.getProcessorUsage())),E.has(ze.AUDIO)&&g.audioTrack&&(a=a.concat(await g.audioTrack.getProcessorUsage()));if(a.length===0)return;s.details=function(g,E){const y={};for(const{id:P,value:U,level:q,direction:J}of g){var C;const se=(C=E.get(P))!==null&&C!==void 0?C:0,he=U===2?se+Z("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:se;var I,j;E.set(P,he),y[P]?(U===2&&(y[P].value=U),q>y[P].level&&(y[P].level=q),J==="remote"&&(y[P].remoteUidCount+=1),y[P].totalTs=(I=E.get(P))!==null&&I!==void 0?I:0):y[P]={value:U,level:q,remoteUidCount:J==="local"?0:1,totalTs:(j=E.get(P))!==null&&j!==void 0?j:0}}return Object.keys(y).map(P=>{const{level:U,value:q,totalTs:J}=y[P];return{id:P,level:U,value:q,totalTs:J}})}(a,e);const p=Date.now(),m=p>n?p:n+1;this.requestUpload&&this.requestUpload(rd.EXTENSION_USAGE_STATS,{usageStats:s,sendTs:m})},Z("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}}class Si{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(e,n){R(this,"uid",void 0),R(this,"_uintid",void 0),R(this,"_trust_in_room_",!0),R(this,"_trust_audio_enabled_state_",!0),R(this,"_trust_video_enabled_state_",!0),R(this,"_trust_audio_mute_state_",!0),R(this,"_trust_video_mute_state_",!0),R(this,"_audio_muted_",!1),R(this,"_video_muted_",!1),R(this,"_audio_enabled_",!0),R(this,"_video_enabled_",!0),R(this,"_audio_added_",!1),R(this,"_video_added_",!1),R(this,"_is_pre_created",!1),R(this,"_video_pre_subscribed",!1),R(this,"_audio_pre_subscribed",!1),R(this,"_trust_video_stream_added_state_",!0),R(this,"_trust_audio_stream_added_state_",!0),R(this,"_audioTrack",void 0),R(this,"_videoTrack",void 0),R(this,"_dataChannels",[]),R(this,"_audioSSRC",void 0),R(this,"_videoSSRC",void 0),R(this,"_audioOrtc",void 0),R(this,"_videoOrtc",void 0),R(this,"_cname",void 0),R(this,"_rtxSsrcId",void 0),R(this,"_videoMid",void 0),R(this,"_audioMid",void 0),this.uid=e,this._uintid=n}}var na;function Cce(i,e){var n;let s;switch(e){case Ie.LocalAudioTrack:s=Qt.Audio;break;case Ie.LocalVideoTrack:s=je(n=i._hints).call(n,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalVideoLowTrack:s=Qt.Low}return s}function _x(i){const e=Kt();if(i.some(n=>n._bypassWebAudio))throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!e.webAudioMediaStreamDest)throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function Ex(i,e){_x(i);const n=e||new Nr;return i.forEach(s=>n.addAudioTrack(s)),n}function I6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function $T(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?I6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):I6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}(function(i){i.SEND_ONLY="SEND_ONLY",i.RECEIVE_ONLY="RECEIVE_ONLY"})(na||(na={}));class Fr extends jn{get state(){return this._state}set state(e){const n=this._state;this._state=e,this.emit(st.StateChange,n,this._state)}constructor(e,n){super(),R(this,"store",void 0),R(this,"statsUploader",void 0),R(this,"sendConnection",void 0),R(this,"recvConnection",void 0),R(this,"localTrackMap",new Map),R(this,"remoteUserMap",new Map),R(this,"localDataChannels",[]),R(this,"pendingLocalTracks",[]),R(this,"pendingRemoteTracks",[]),R(this,"statsCollector",void 0),R(this,"dtlsFailedCount",0),R(this,"sendMutex",new ii("P2PChannel2-send-mutex")),R(this,"recvMutex",new ii("P2PChannel2-recv-mutex")),R(this,"_state",en.Disconnected),R(this,"_restartStates",["disconnected","failed"]),R(this,"reconnectInterval",void 0),R(this,"uploadUnplinkStarted",!1),R(this,"uploadDownlinkStarted",!1),R(this,"uplinkStateUploadInterval",void 0),R(this,"downlinkStatsUploadInterval",void 0),R(this,"handleMuteLocalTrack",async(s,a,l)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==en.Connected)return void l(new ye(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const g=this.filterTobeMutedTracks(s);if(g.length===0)return void a();const E=g.find(j=>j[0]==="videoLowTrack");E&&E[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(g.map(j=>{let[,{id:P}]=j;return P}));let y=!1;var p,m;s.trackMediaType==="video"?y=!((p=this.localTrackMap.get(Ie.LocalAudioTrack))===null||p===void 0||!p.track._muted):y=((m=this.localTrackMap.get(Ie.LocalVideoTrack))===null||m===void 0?void 0:m.id)===void 0;const C=this.createMuteMessage(g);await gn(this,st.RequestMuteLocal,C);const I=s.trackMediaType==="video"?al.MUTE_LOCAL_VIDEO:al.MUTE_LOCAL_AUDIO;await gn(this,st.RequestP2PMuteLocal,{action:I,message:C,isMuteAll:y}),a()}catch(g){l(g)}finally{u()}}),R(this,"handleUnmuteLocalTrack",async(s,a,l)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==en.Connected)return void l(new ye(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const p=this.filterTobeUnmutedTracks(s);if(p.length===0)return void a();await this.sendConnection.unmuteLocal(p.map(E=>{let[,{id:y}]=E;return y}));const m=this.createUnmuteMessage(p),g=s.trackMediaType==="video"?al.UNMUTE_LOCAL_VIDEO:al.UNMUTE_LOCAL_AUDIO;await gn(this,st.RequestP2PMuteLocal,{action:g,message:m}),a()}catch(p){l(p)}finally{u()}}),R(this,"handleUpdateVideoEncoder",async(s,a,l)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.sendConnection||!p||p.track!==s||this.state!==en.Connected)return void a();const{id:m,track:g}=p;m&&(await this.sendConnection.updateSendParameters(m,g),await this.sendConnection.updateEncoderConfig(m,g),this.emit(st.UpdateVideoEncoder,g)),a()}catch(p){l(p)}finally{u()}}),R(this,"handleSetOptimizationMode",async(s,a,l)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleSetOptimizationMode");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.sendConnection||!p||p.track!==s||this.state!==en.Connected)return;const{id:m,track:g}=p;m&&await this.sendConnection.updateSendParameters(m,g),a()}catch(p){l(p)}finally{u()}}),R(this,"handleReplaceTrack",async(s,a,l,u)=>{let p;N.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof u=="boolean"&&u||(p=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var m;const E=Array.from(this.localTrackMap.entries()).find(y=>{let[,{track:C}]=y;return s===C});if(!this.sendConnection||!E||E[1].id===void 0||this.state!==en.Connected)return void a();if(await((m=this.sendConnection)===null||m===void 0?void 0:m.replaceTrack(s,E[1].id)),E[0]===Ie.LocalVideoTrack&&Kt().supportDualStreamEncoding){const y=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(y){const C=s._mediaStreamTrack.clone();y.track._originMediaStreamTrack.stop(),y.track._mediaStreamTrack=C,y.track._originMediaStreamTrack=C,await new pe((I,j)=>{this.handleReplaceTrack(y.track,I,j,!0)})}}a()}catch(E){l(E)}finally{var g;(g=p)===null||g===void 0||g()}}),R(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),R(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),R(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),R(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=e,this.statsCollector=n,this.statsCollector.addP2PChannel(this),this.statsUploader=new R6(e),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(s=>{s&&(s.iceConnectionState!=="disconnected"&&s.iceConnectionState!=="failed"||this.handleDisconnect(s.direction))})},Z("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,n){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e,n,s,a,l,u){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,n){let s;try{if(n){this.recvConnection&&(N.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),s=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new No(e,this.store,zi.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const a=await this.recvConnection.establish(n);return{iceParameters:a.iceParameters,dtlsParameters:a.dtlsParameters,sdp:a.sdp}}{this.state=en.New,this.sendConnection&&(N.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),s=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new No(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const a=await this.sendConnection.establish();return{iceParameters:a.iceParameters,dtlsParameters:a.dtlsParameters,sdp:a.sdp}}}finally{s&&s()}}async p2pConnect(e){if(!this.sendConnection)throw new ye(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=en.Connected}async addRemoteCandidate(e,n){if(n===zi.RECEIVE_ONLY){if(!this.sendConnection)throw new ye(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new ye(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,n,s){var a=this;return no(function*(){const l=yield Ct(a.sendMutex.lock("From P2PChannel.publish"));try{if(!a.sendConnection||a.state!==en.Connected){a.throwIfTrackTypeNotMatch(e);const E=e.filter(y=>a.pendingLocalTracks.indexOf(y)===-1);return void(a.pendingLocalTracks=a.pendingLocalTracks.concat(E))}a.store.pubId=a.store.pubId+1,Li.markPublishStart(a.store.clientId,a.store.pubId);const u=a.filterTobePublishedTracks(e,n,s);if(u.length===0)return void(yield Ct(a.tryToUnmuteAudio(e)));u.forEach(E=>{let{track:y,type:C}=E;const I=Date.now();a.store.publish(y.getTrackId(),C===Ie.LocalAudioTrack?"audio":"video",I)}),a.bindLocalTrackEvents(u);const p=yield Ct(a.sendConnection.send(u.map(E=>{let{track:y}=E;return y}),a.store.codec,a.store.audioCodec)),m=(yield Ct(p.next())).value,g=a.createGatewayPublishMessage(u,m);try{yield g}catch(E){throw p.throw(E),(E==null?void 0:E.code)===z.WS_ABORT&&u.forEach(y=>{let{track:C}=y;a.pendingLocalTracks.indexOf(C)===-1&&a.pendingLocalTracks.push(C)}),a.unbindLocalTrackEvents(u),E}yield Ct(p.next()),u.forEach(E=>{let{type:y}=E;a.statsCollector.addLocalStats(y)}),a.statsUploader.startUploadOutboundStats(),a.assignLocalTracks(u,m),u.forEach(E=>{let{track:y,type:C}=E;const I=Date.now();a.store.publish(y.getTrackId(),C===Ie.LocalAudioTrack?"audio":"video",void 0,I)}),a.startUploadUplinkState()}finally{l()}})()}async unpublish(e){if(!this.sendConnection||this.state!==en.Connected)return void(e.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(l=>!je(e).call(e,l)));const n=this.filterTobeUnpublishedTracks(e);if(n.length===0)return;const s=n.find(l=>l[0]==="videoLowTrack");s&&s[1].track.close();const a=this.createGatewayUnpublishMessage(n);if(await this.sendConnection.stopSending(n.map(l=>{let[,{id:u}]=l;return u})),this.withdrawLocalTracks(n),this.unbindLocalTrackEvents(n.map(l=>{let[u,{track:p}]=l;return{type:u,track:p}})),n.forEach(l=>{let[u]=l;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===en.Connected)return s&&s[1].track.close(),a;e.forEach(l=>{const u=this.pendingLocalTracks.indexOf(l);u!==-1&&this.pendingLocalTracks.splice(u,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const n=[],s=[];Array.from(this.localTrackMap.entries()).forEach(a=>{let[l,{track:u,ssrcs:p}]=a;const m={stream_type:Cce(u,l),ssrcs:p};u._muted||!u._enabled?n.push(m):s.push(m)}),n.length>0&&n.forEach(a=>{gn(this,st.RequestMuteLocal,[a])}),s.length>0&&s.forEach(a=>{gn(this,st.RequestUnmuteLocal,[a])})};e(),this.uplinkStateUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return no(function*(){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(N.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Tr(this,st.RequestRePublish,this.pendingLocalTracks),this.emit(st.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,n,s,a){var l;if(!this.recvConnection)throw new ye(z.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((l=this.remoteUserMap.get(e))!==null&&l!==void 0&&l.has(n))return;const{track:u,mid:p,transceiver:m}=await this.recvConnection.receive(n,[{ssrcId:s}],String(e.uid),a);n===ze.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(u):(e._audioTrack=new Oa(u,e.uid,e._uintid,this.store),N.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),m&&e._audioTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=s,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(u):(e._videoTrack=new ll(u,e.uid,e._uintid,this.store),N.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),m&&e._videoTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(e,e._videoTrack));const g=this.remoteUserMap.get(e);g?g.set(n,p):this.remoteUserMap.set(e,new Map([[n,p]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const E=this.pendingRemoteTracks.findIndex(y=>{let{user:C,kind:I}=y;return C.uid===e.uid&&n===I});E!==-1&&(this.pendingRemoteTracks.splice(E,1),this.emit(st.MediaReconnectEnd,e.uid))}async mockSubscribe(e,n,s,a){if(!this.recvConnection)throw new ye(z.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(n,[{ssrcId:s}],String(e.uid),a)}async unsubscribe(e,n,s){const a=this.pendingRemoteTracks.filter(u=>{let{user:p,kind:m}=u;return n!==void 0?p.uid===e.uid&&n===m:p.uid===e.uid});if(a.forEach(u=>{const p=this.pendingRemoteTracks.indexOf(u);this.pendingRemoteTracks.splice(p,1)}),this.recvConnection||s||a.forEach(u=>{let{kind:p}=u;var m;if(p===ze.AUDIO)(m=e._audioTrack)===null||m===void 0||m._destroy(),e._audioTrack=void 0;else if(p===ze.VIDEO){var g;(g=e._videoTrack)===null||g===void 0||g._destroy(),e._videoTrack=void 0}}),!this.recvConnection)return;const l=this.filterTobeUnSubscribedTracks(e,n);l.length!==0&&(await this.recvConnection.stopReceiving(l.map(u=>{let[,{id:p}]=u;return p})),this.withdrawRemoteTracks(l),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),l.forEach(u=>{let[p,{kind:m}]=u;var g,E;if(m===ze.VIDEO&&p._videoSSRC&&((g=this.recvConnection)===null||g===void 0||g.setStatsRemoteVideoIsReady(p._videoSSRC,!1)),m===ze.VIDEO)this.unbindRemoteTrackEvents(p._videoTrack),s||((E=p._videoTrack)===null||E===void 0||E._destroy(),p._videoTrack=void 0);else if(m===ze.AUDIO){var y;this.unbindRemoteTrackEvents(p._audioTrack),!s&&((y=p._audioTrack)===null||y===void 0||y._destroy(),p._audioTrack=void 0)}}),l.forEach(u=>{let[,{kind:p}]=u;gn(this,st.RequestP2PMuteRemote,p)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach(n=>{let[,s]=n;[ze.VIDEO,ze.AUDIO].forEach(a=>{s.has(a)?gn(this,st.RequestP2PUnmuteRemote,a):gn(this,st.RequestP2PMuteRemote,a)})});e(),this.downlinkStatsUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new ye(z.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,n){if(!this.recvConnection)return;const s=this.remoteUserMap.get(e);if(!s)return void N.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!s.get(n))return void N.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."));const a=n===ze.VIDEO?e._videoSSRC:e._audioSSRC;a!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(a,!1)}async unmuteRemote(e,n){return this.unmuteRemoteNoLock(e,n)}async unmuteRemoteNoLock(e,n){if(!this.recvConnection)return;const s=this.remoteUserMap.get(e);if(!s)return void N.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."));s.get(n)||N.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."))}getAllTracks(e){const n=this.localTrackMap.get(Ie.LocalAudioTrack);if((n==null?void 0:n.track)instanceof Nr){const s=n.track;return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return l!==Ie.LocalAudioTrack}).filter(a=>{let[l]=a;return!(e&&l===Ie.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[a]=s;return!(e&&a===Ie.LocalVideoLowTrack)}).map(s=>{let[,{track:a}]=s;return a})}reportPublishEvent(e,n,s,a,l){if(e){const p=this.localTrackMap.get(Ie.LocalAudioTrack),m=a?this.localTrackMap.get(Ie.LocalVideoLowTrack):this.localTrackMap.get(Ie.LocalVideoTrack);qe.publish(this.store.sessionId,{eventElapse:Li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:m==null?void 0:m.track.getTrackLabel(),screenshare:(m==null?void 0:m.track._hints.indexOf(wn.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}else{var u;s||(s=[]);const p=s.find(g=>g instanceof ln),m=a?(u=this.localTrackMap.get(Ie.LocalVideoTrack))===null||u===void 0?void 0:u.track:s.find(g=>g instanceof At);qe.publish(this.store.sessionId,{eventElapse:Li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:p==null?void 0:p.getTrackLabel(),videoName:m==null?void 0:m.getTrackLabel(),screenshare:(m==null?void 0:m._hints.indexOf(wn.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}}reportSubscribeEvent(e,n,s,a){const l=a===ze.VIDEO?s._videoSSRC:s._audioSSRC;l&&qe.subscribe(this.store.sessionId,{succ:e,ec:n,video:a===ze.VIDEO,audio:a===ze.AUDIO,peerid:s.uid,subscribeRequestid:a===ze.VIDEO?s._videoSSRC:s._audioSSRC,p2pid:this.store.p2pId,eventElapse:Li.measureFromSubscribeStart(this.store.clientId,l)})}reset(){N.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new ii("P2PChannel2-send-mutex"),this.sendMutex=new ii("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(Ie.LocalAudioTrack);if((e==null?void 0:e.track)instanceof Nr){if(e.track.trackList.length>0){const n=e.track;e.track.trackList.forEach(s=>{n.removeAudioTrack(s)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=en.Disconnected}getStats(e){var n,s;return e?(s=this.recvConnection)===null||s===void 0?void 0:s.getStats():(n=this.sendConnection)===null||n===void 0?void 0:n.getStats()}getRemoteVideoIsReady(e){var n;return((n=this.recvConnection)===null||n===void 0?void 0:n.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(Ie.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(Ie.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const n=this.localTrackMap.get(e);return n&&n.track instanceof At||n&&n.track instanceof ln?n.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,n){if(!e)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(e);return!!s&&(!n||s.has(n))}async hasRemoteMediaWithLock(e,n){if(!e)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(e);return!!s&&(!n||s.has(n))}getRemoteMedia(e){var n;const s=Array.from(vo(n=this.remoteUserMap).call(n)).find(a=>a.uid===e);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(s=>{let[a]=s;return{uid:a.uid,level:a.audioTrack?100*a.audioTrack._source.getAccurateVolumeLevel():0}});const n=this.localTrackMap.get(Ie.LocalAudioTrack);return n&&e.push({level:100*n.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=fE(e).call(e,(s,a)=>s.level-a.level),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(N.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=en.Reconnecting,Z("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n]=e;var s;n._videoTrack&&n._videoTrack._player&&((s=n._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var n;let[s,{track:a}]=e;switch(s){case Ie.LocalVideoTrack:je(n=a._hints).call(n,wn.LOW_STREAM)?a.close():this.pendingLocalTracks.push(a);break;case Ie.LocalAudioTrack:a instanceof Nr?this.pendingLocalTracks=this.pendingLocalTracks.concat(a.trackList):this.pendingLocalTracks.push(a);case Ie.LocalVideoLowTrack:}}),this.emit(st.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,s]=e;Array.from(vo(s).call(s)).forEach(a=>{this.setPendingRemoteMedia(n,a)}),this.emit(st.MediaReconnectStart,n.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),N.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,n){for(const s of this.pendingRemoteTracks){const{user:a,kind:l}=s;if((e instanceof Si?e.uid:e)===a.uid&&n===l)return!0}return!1}setPendingRemoteMedia(e,n){this.hasPendingRemoteMedia(e,n)||this.pendingRemoteTracks.push({user:e,kind:n})}async restartICE(e,n){let s,a;if(e===zi.SEND_ONLY){if(!this.sendConnection)throw new ye(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");s=await this.sendMutex.lock("From P2PChannel.restartICE"),a=this.sendConnection}else{if(!this.recvConnection)throw new ye(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");s=await this.recvMutex.lock("From P2PChannel.restartICE"),a=this.recvConnection}try{if(n){const l=await a.restartICE(n);return a.isInRestartIce=!1,l}{const l=await a.restartICE();if(l){const u=await Tr(this,st.RequestP2PRestartICE,{direction:zi.RECEIVE_ONLY,iceParameter:l});await a.restartICE(u),a.isInRestartIce=!1}}}finally{s()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),n=this.localTrackMap.get(Ie.LocalVideoTrack),s=this.localTrackMap.get(Ie.LocalAudioTrack),a=e.videoSend.find(j=>{var P;return j.ssrc===(n==null||(P=n.ssrcs)===null||P===void 0?void 0:P[0].ssrcId)}),l=e.audioSend.find(j=>{var P;return j.ssrc===(s==null||(P=s.ssrcs)===null||P===void 0?void 0:P[0].ssrcId)});if(!a||!l)return 1;const u=Qs(this,st.NeedSignalRTT),p=a?a.rttMs:void 0,m=l?l.rttMs:void 0,g=p&&m?(p+m)/2:p||m,E=(g&&u?(g+u)/2:g||u)||0,y=100*e.sendPacketLossRate*.7/50+.3*E/1500,C=y<.17?1:y<.36?2:y<.59?3:y<.1?4:5,I=n==null?void 0:n.track;if(I&&I._encoderConfig&&I._hints.indexOf(wn.SCREEN_TRACK)===-1){const j=I._encoderConfig.bitrateMax,P=e.bitrate.actualEncoded;if(j&&P){const U=(1e3*j-P)/(1e3*j);return z4[U<.15?0:U<.3?1:U<.45?2:U<.6?3:4][C]}}return C}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let n=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[a]=s;const l=a._audioSSRC,u=a._videoSSRC,p=e.audioRecv.find(P=>P.ssrc===l),m=e.videoRecv.find(P=>P.ssrc===u);if(!p&&!m)return void(n+=1);const g=Qs(this,st.NeedSignalRTT),E=e.rtt,y=(E&&g?(E+g)/2:E||g)||0,C=p?p.jitterMs:void 0,I=e.recvPacketLossRate;let j=.7*I*100/50+.3*y/1500;C&&(j=.6*I*100/50+.2*y/1500+.2*C/400),n+=j<.1?1:j<.17?2:j<.36?3:j<.59?4:5}),this.remoteUserMap.size>0?Math.round(n/this.remoteUserMap.size):n}async muteLocalTrack(e){return new pe((n,s)=>{this.handleMuteLocalTrack(e,n,s)})}filterTobePublishedTracks(e,n,s){const a=[],l=Kt(),u=this.getAllTracks();e=qf(e=e.filter(g=>u.indexOf(g)===-1));let p=!1,m=!1;for(const g of e){if(g instanceof At&&(this.localTrackMap.has(Ie.LocalVideoTrack)||p?new ye(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(a.push({track:g,type:Ie.LocalVideoTrack}),p=!0),n)){const E=this.getLowVideoTrack(g,s);a.push({track:E,type:Ie.LocalVideoLowTrack})}if(g instanceof ln){const E=this.localTrackMap.get(Ie.LocalAudioTrack);if(E){if(!(E.track instanceof Nr))throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(g._bypassWebAudio)throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");E.track.addAudioTrack(g),this.bindLocalAudioTrackEvents(g,!0)}else if(m){const y=a.find(C=>{let{type:I}=C;return I===Ie.LocalAudioTrack});if(!(y.track instanceof Nr))throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(g._bypassWebAudio)throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(g)}else{if(!l.webAudioMediaStreamDest||g instanceof Nr||g._bypassWebAudio)a.push({track:g,type:Ie.LocalAudioTrack});else{const y=new Nr;y.addAudioTrack(g),a.push({track:y,type:Ie.LocalAudioTrack})}m=!0}}}return a}filterTobeUnpublishedTracks(e){const n=[],s=this.getAllTracks();e=qf(e=e.filter(a=>s.indexOf(a)!==-1));for(const a of e){if(a instanceof ln){const l=this.localTrackMap.get(Ie.LocalAudioTrack);if(!l)continue;l.track instanceof Nr?(l.track.removeAudioTrack(a),this.unbindLocalAudioTrackEvents(a),l.track.trackList.length===0&&(n.push([Ie.LocalAudioTrack,l]),l.track.close())):n.push([Ie.LocalAudioTrack,l])}if(a instanceof At){const l=this.localTrackMap.get(Ie.LocalVideoTrack);if(!l)continue;n.push([Ie.LocalVideoTrack,l]);const u=this.localTrackMap.get(Ie.LocalVideoLowTrack);u&&n.push([Ie.LocalVideoLowTrack,u])}}return n}bindLocalTrackEvents(e){e.forEach(n=>{let{track:s,type:a}=n;switch(a){case Ie.LocalVideoTrack:s.addListener(Ve.GET_STATS,this.handleGetLocalVideoStats),s.addListener(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ve.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(Ve.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.addListener(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case Ie.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,n){e instanceof Nr?e.trackList.forEach(s=>{s.addListener(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ve.GET_STATS,this.handleGetLocalAudioStats),s.addListener(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Ve.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),n||e.addListener(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(n=>{let[s,{track:a}]=n;return{track:a,type:s}})),e.forEach(n=>{let{track:s,type:a}=n;switch(a){case Ie.LocalVideoTrack:s.off(Ve.GET_STATS,this.handleGetLocalVideoStats),s.off(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(Ve.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(Ve.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.off(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case Ie.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Nr?e.trackList.forEach(n=>{n.off(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(Ve.GET_STATS,this.handleGetLocalAudioStats),n.off(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Ve.GET_STATS,this.handleGetLocalAudioStats),e.off(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,n){n instanceof ll&&n.addListener(Ve.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(e))}),n instanceof Oa&&n.addListener(Ve.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Ve.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,s]=e;s.has(ze.AUDIO)&&this.unbindRemoteTrackEvents(n._audioTrack),s.has(ze.VIDEO)&&this.unbindRemoteTrackEvents(n._videoTrack)})}createGatewayPublishMessage(e,n){return e.map((s,a)=>{var l;let u,{track:p,type:m}=s;switch(m){case Ie.LocalAudioTrack:u=Qt.Audio;break;case Ie.LocalVideoTrack:u=je(l=p._hints).call(l,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalVideoLowTrack:u=Qt.Low}return{kind:m===Ie.LocalAudioTrack?ze.AUDIO:ze.VIDEO,stream_type:u,mid:n[a].id,ssrcs:n[a].localSSRC,isMuted:p.muted||!p.enabled}})}createGatewayUnpublishMessage(e){return e.map(n=>{var s;let a,[l,{track:u,ssrcs:p,id:m}]=n;switch(l){case Ie.LocalVideoTrack:a=je(s=u._hints).call(s,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalAudioTrack:a=Qt.Audio;break;case Ie.LocalVideoLowTrack:a=Qt.Low}return{stream_type:a,ssrcs:p,mid:m}})}assignLocalTracks(e,n){e.forEach((s,a)=>{let{track:l,type:u}=s;this.localTrackMap.set(u,{track:l,id:n[a].id,ssrcs:n[a].localSSRC})})}withdrawLocalTracks(e){e.forEach(n=>{let[s]=n;this.localTrackMap.delete(s)})}bindConnectionEvents(e){e.onConnectionStateChange=async n=>{var s;N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(n,")")),this.emit(st.PeerConnectionStateChange,n),n!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),n==="connected"&&(e.isInRestartIce=!1),je(s=this._restartStates).call(s,n)&&!e.isInRestartIce&&(n==="disconnected"&&await ri(800),e.iceConnectionState!=="disconnected"&&e.iceConnectionState!=="failed"||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=n=>{n!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),qe.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:Bn.TRACER}).onSuccess(),this.emit(st.IceConnectionStateChange,n)},e.onICETransportStateChange=n=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},e.onDTLSTransportStateChange=n=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},e.onDTLSTransportError=n=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},e.onFirstAudioDecoded=n=>{var s;const a=Array.from(vo(s=this.remoteUserMap).call(s)).find(u=>u._audioSSRC===n);var l;a&&(this.store.subscribe(a.uid,"audio",void 0,void 0,void 0,Date.now()),(l=a.audioTrack)===null||l===void 0||l.emit(Su.FIRST_FRAME_DECODED),qe.firstRemoteFrame(this.store.sessionId,Mr.FIRST_AUDIO_DECODE,kn.FIRST_AUDIO_DECODE,{peer:a._uintid,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=n=>{var s;const a=Array.from(vo(s=this.remoteUserMap).call(s)).find(l=>l._audioSSRC===n);a&&qe.firstRemoteFrame(this.store.sessionId,Mr.FIRST_AUDIO_RECEIVED,kn.FIRST_AUDIO_RECEIVED,{peer:a._uintid,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(n,s,a)=>{this.reportVideoFirstFrameDecoded(n,s,a)},e.onFirstVideoReceived=n=>{var s;const a=Array.from(vo(s=this.remoteUserMap).call(s)).find(l=>l._videoSSRC===n);a&&qe.firstRemoteFrame(this.store.sessionId,Mr.FIRST_VIDEO_RECEIVED,kn.FIRST_VIDEO_RECEIVED,{peer:a._uintid,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(n,s)=>{const a=n.candidateType==="relay",l=s.candidateType==="relay";s.candidateType!=="unknown"&&a===l||this.emit(st.ConnectionTypeChange,a),N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(_u(s))," -> ").concat(JSON.stringify(_u(n)),")"))},e.onSelectedRemoteCandidateChanged=(n,s)=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(_u(s))," -> ").concat(JSON.stringify(_u(n)),")"))},e.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)},e.onLocalCandidate=n=>{this.emit(st.LocalCandidate,{candidate:n,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const n=e===zi.SEND_ONLY?this.sendConnection:this.recvConnection;n&&!n.isInRestartIce&&(n.isInRestartIce=!0,N.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(n.name,"] start use restartICE")),e===zi.SEND_ONLY?this.restartICE(e):Tr(this,st.RequestP2PRestartICE,{direction:zi.SEND_ONLY}))}filterTobeMutedTracks(e){const n=[];if(this.getAllTracks().indexOf(e)===-1)return n;const s=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof ln&&(s==null?void 0:s.track)instanceof Nr)return s.track.isActive||n.push([Ie.LocalAudioTrack,s]),n;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return e===u});if(a&&(n.push(a),a[0]===Ie.LocalVideoTrack)){const l=this.localTrackMap.get(Ie.LocalVideoLowTrack);l&&n.push([Ie.LocalVideoLowTrack,l])}return n}filterTobeUnmutedTracks(e){const n=[],s=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof ln&&(s==null?void 0:s.track)instanceof Nr)return s.track.isActive&&n.push([Ie.LocalAudioTrack,s]),n;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return e===u});if(a)if(a[0]===Ie.LocalVideoTrack){n.push(a);const l=this.localTrackMap.get(Ie.LocalVideoLowTrack);l&&n.push([Ie.LocalVideoLowTrack,l])}else n.push(a);return n}createMuteMessage(e){return e.map(n=>{var s;let a,[l,{track:u,ssrcs:p,id:m}]=n;switch(l){case Ie.LocalAudioTrack:a=Qt.Audio;break;case Ie.LocalVideoTrack:a=je(s=u._hints).call(s,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalVideoLowTrack:a=Qt.Low}return{stream_type:a,ssrcs:p,mid:m}})}createUnmuteMessage(e){return e.map(n=>{var s;let a,[l,{track:u,ssrcs:p,id:m}]=n;switch(l){case Ie.LocalAudioTrack:a=Qt.Audio;break;case Ie.LocalVideoTrack:a=je(s=u._hints).call(s,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalVideoLowTrack:a=Qt.Low}return{stream_type:a,ssrcs:p,mid:m}})}filterTobeUnSubscribedTracks(e,n){const s=[],a=this.remoteUserMap.get(e);if(!a)return s;if(n){const l=a.get(n);if(!l)return s;s.push([e,{kind:n,id:l}])}else Array.from(a.entries()).forEach(l=>{let[u,p]=l;s.push([e,{kind:u,id:p}])});return s}createUnsubscribeMessage(e){const n=[];return e.forEach(s=>{let[a,{kind:l,id:u}]=s;switch(l){case ze.VIDEO:return void(a._videoSSRC&&n.push({stream_type:ze.VIDEO,ssrcId:a._videoSSRC}));case ze.AUDIO:return void(a._audioSSRC&&n.push({stream_type:ze.AUDIO,ssrcId:a._audioSSRC}))}}),n}withdrawRemoteTracks(e){e.forEach(n=>{let[s,{kind:a}]=n;const l=this.remoteUserMap.get(s);l&&(l.delete(a),Array.from(l.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(e){const n=this.localTrackMap.get(Ie.LocalVideoTrack),s=this.localTrackMap.get(Ie.LocalVideoLowTrack);n&&await n.track.setBitrateLimit(e.uplink),s&&e.low_stream_uplink&&await s.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,n=this.recvConnection.peerConnectionState;return e!=="connected"&&n!=="connected"}return!0}async tryToUnmuteAudio(e){for(let n=0;n<e.length;n++)if(e[n]instanceof ln){const s=this.filterTobeUnmutedTracks(e[n]);if(s.length===0)continue;const a=this.createUnmuteMessage(s);return void await gn(this,st.RequestUnmuteLocal,a)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(e=>{let[,{ssrcs:n}]=e;return!!n}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var n;return!((n=this.recvConnection)===null||n===void 0||!n.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,n)=>this.emit(st.RequestUpload,e,n),this.statsUploader.requestUploadStats=e=>this.emit(st.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await ri(Lb(this.dtlsFailedCount,wr)),this.emit(st.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Ie.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof At)}throwIfTrackTypeNotMatch(e){if(e.filter(n=>n instanceof At).length>1)throw new ye(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(n=>n instanceof ln).length>1&&(e.some(n=>n instanceof ln&&n._bypassWebAudio)||!Kt().webAudioMediaStreamDest))throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const n of e){if(n instanceof At&&this.pendingLocalTracks.some(s=>s instanceof At))throw new ye(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n instanceof ln&&this.pendingLocalTracks.some(s=>s instanceof ln)&&(!Kt().webAudioMediaStreamDest||n._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof ln&&s._bypassWebAudio)))throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,n){const s=!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&Kt().supportDualStreamEncoding,a=$T($T({},{width:160,height:120,framerate:15,bitrate:50}),n);let l;l=s?e._mediaStreamTrack.clone():fx(e,a);const u=Sn(8,"track-low-"),p=new At(l,$T($T({},s&&{scaleResolutionDownBy:DN(a,e)}),{},{frameRate:a.framerate,bitrateMax:a.bitrate,bitrateMin:a.bitrate}),void 0,void 0,u);return p.on(vu.TRANSCEIVER_UPDATED,m=>{e._updateRtpTransceiver(m,Eu.LOW_STREAM)}),p._hints.push(wn.LOW_STREAM),e.addListener(Ve.NEED_CLOSE,()=>{p.close()}),p}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,n,s,a){var l;const u=Array.from(vo(l=this.remoteUserMap).call(l)).find(p=>p._videoSSRC===e);if(u){a||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,m=p.subscribe.find(g=>g.userId===u.uid&&g.type==="video");qe.firstRemoteVideoDecode(this.store.sessionId,Mr.FIRST_VIDEO_DECODE,kn.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:n,videoheight:s,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(m==null?void 0:m.subscribeEnd)||0,subscriberStart:(m==null?void 0:m.subscribeStart)||0,videoAddNotify:(m==null?void 0:m.streamAdded)||0,state:a?1:0})}}async remoteMediaSsrcChanged(e,n,s){if(!this.recvConnection)return!1;const a=this.remoteUserMap.get(e);if(!a)return!1;const l=a.get(n);if(!l)return!1;const u=await this.recvConnection.getRemoteSSRC(l);return u!==void 0&&u!==s}resetConnection(e){N.debug("[".concat(this.store.clientId,"] [P2PChannel2] reset connection to ").concat(e)),this.state===en.Connected?(N.debug("[".concat(this.store.clientId,"] [P2PChannel2] fallback to websocket but P2PChannel2 state still connected, disconnect first")),this.disconnectForReconnect()):(this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0))}async publishDataChannel(e){throw new ye(z.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new ye(z.NOT_SUPPORTED)}async subscribeDataChannel(e,n){throw new ye(z.NOT_SUPPORTED)}async unsubscribeDataChannel(e,n){throw new ye(z.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,n){throw new ye(z.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,n){throw new ye(z.NOT_SUPPORTED)}async preConnect(e,n,s,a,l,u){throw new ye(z.NOT_SUPPORTED)}getEstablishParams(){throw new ye(z.NOT_SUPPORTED)}async reSubscribe(e){throw new ye(z.NOT_SUPPORTED)}async updateVideoStreamParameter(e,n){throw new ye(z.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[n,{track:s}]=e;n===Ie.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,Eu.LOW_STREAM):s._updateRtpTransceiver(void 0)})}}function Ic(i){return function(e,n,s){const a=e[n];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){for(var l=arguments.length,u=new Array(l),p=0;p<l;p++)u[p]=arguments[p];switch(i){case na.SEND_ONLY:{const m=await this.sendMutex.lock("From P2PChannel2.".concat(n));try{return await a.apply(this,u)}finally{m()}}case na.RECEIVE_ONLY:{const m=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await a.apply(this,u)}finally{m()}}default:{const m=await this.sendMutex.lock("From P2PChannel2.".concat(n)),g=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await a.apply(this,u)}finally{m(),g()}}}},s}}function A6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Sp(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?A6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):A6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}be([Ic(na.SEND_ONLY),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],Fr.prototype,"p2pConnect",null),be([Ic(na.SEND_ONLY),$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Fr.prototype,"unpublish",null),be([Ic(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],Fr.prototype,"unpublishLowStream",null),be([Ic(na.RECEIVE_ONLY),$("design:type",Function),$("design:paramtypes",[Si,String,Number,String]),$("design:returntype",pe)],Fr.prototype,"subscribe",null),be([Ic(na.RECEIVE_ONLY),$("design:type",Function),$("design:paramtypes",[Si,String,Number,String]),$("design:returntype",pe)],Fr.prototype,"mockSubscribe",null),be([Ic(na.RECEIVE_ONLY),$("design:type",Function),$("design:paramtypes",[Si,String,Boolean]),$("design:returntype",pe)],Fr.prototype,"unsubscribe",null),be([Ic(na.RECEIVE_ONLY),$("design:type",Function),$("design:paramtypes",[Si,String]),$("design:returntype",pe)],Fr.prototype,"muteRemote",null),be([Ic(na.RECEIVE_ONLY),$("design:type",Function),$("design:paramtypes",[Si,String]),$("design:returntype",pe)],Fr.prototype,"unmuteRemote",null),be([Ic(na.RECEIVE_ONLY),$("design:type",Function),$("design:paramtypes",[Si,String]),$("design:returntype",pe)],Fr.prototype,"hasRemoteMediaWithLock",null),be([Ic(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],Fr.prototype,"disconnectForReconnect",null),be([Ic(na.RECEIVE_ONLY),$("design:type",Function),$("design:paramtypes",[Si,String,Number]),$("design:returntype",pe)],Fr.prototype,"remoteMediaSsrcChanged",null);class mv{constructor(e){R(this,"store",void 0),R(this,"onStatsException",void 0),R(this,"onUploadPublishDuration",void 0),R(this,"onStatsChanged",void 0),R(this,"localStats",new Map),R(this,"remoteStats",new Map),R(this,"updateStatsInterval",void 0),R(this,"trafficStats",void 0),R(this,"trafficStatsPeerList",[]),R(this,"uplinkStats",void 0),R(this,"exceptionMonitor",void 0),R(this,"p2pChannel",void 0),R(this,"scalabilityMode",SN.L1T1),R(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=e,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new sce,this.exceptionMonitor.on("exception",(n,s,a)=>{this.onStatsException&&this.onStatsException(n,s,a)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Ie.LocalAudioTrack)||Sp({},KN)}getLocalVideoTrackStats(){return this.localStats.get(Ie.LocalVideoTrack)||Sp({},YN)}getRemoteAudioTrackStats(e){const n=(l,u)=>{if(!this.trafficStats)return u;const p=this.trafficStats.peer_delay.find(m=>m.peer_uid===l);return p&&(u.publishDuration=p.B_ppad+(Date.now()-this.trafficStats.timestamp)),u},s={};if(e){var a;const l=(a=this.remoteStats.get(e))===null||a===void 0?void 0:a.audioStats;l&&(s[e]=n(e,l))}else Array.from(this.remoteStats.entries()).forEach(l=>{let[u,{audioStats:p}]=l;p&&(s[u]=n(u,p))});return s}getRemoteNetworkQualityStats(e){const n={};if(e){var s;const a=(s=this.remoteStats.get(e))===null||s===void 0?void 0:s.networkStats;a&&(n[e]=a)}else Array.from(this.remoteStats.entries()).forEach(a=>{let[l,{networkStats:u}]=a;u&&(n[l]=u)});return n}getRemoteVideoTrackStats(e){const n=(l,u)=>{if(!this.trafficStats)return u;const p=this.trafficStats.peer_delay.find(m=>m.peer_uid===l);return p&&(u.publishDuration=p.B_ppvd+(Date.now()-this.trafficStats.timestamp)),u},s={};if(e){var a;const l=(a=this.remoteStats.get(e))===null||a===void 0?void 0:a.videoStats;l&&(s[e]=n(e,l))}else Array.from(this.remoteStats.entries()).forEach(l=>{let[u,{videoStats:p}]=l;p&&(s[u]=n(u,p))});return s}getRTCStats(){let e=0,n=0,s=0,a=0;const l=this.localStats.get(Ie.LocalAudioTrack);l&&(e+=l.sendBytes,n+=l.sendBitrate);const u=this.localStats.get(Ie.LocalVideoTrack);u&&(e+=u.sendBytes,n+=u.sendBitrate);const p=this.localStats.get(Ie.LocalVideoLowTrack);p&&(e+=p.sendBytes,n+=p.sendBitrate),this.remoteStats.forEach(g=>{let{audioStats:E,videoStats:y}=g;E&&(s+=E.receiveBytes,a+=E.receiveBitrate),y&&(s+=y.receiveBytes,a+=y.receiveBitrate)});let m=1;return this.trafficStats&&(m+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:m,SendBitrate:n,SendBytes:e,RecvBytes:s,RecvBitrate:a,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(e){this.localStats.set(e,void 0)}removeLocalStats(e){e?this.localStats.delete(e):this.localStats.clear()}addRemoteStats(e){this.remoteStats.set(e,{})}removeRemoteStats(e){e?this.remoteStats.delete(e):this.remoteStats.clear()}addP2PChannel(e){this.p2pChannel=e}updateTrafficStats(e){e.peer_delay=e.peer_delay.filter(n=>n.B_ppad!==void 0||n.B_ppvd!==void 0),e.peer_delay.filter(n=>this.trafficStatsPeerList.indexOf(n.peer_uid)===-1).forEach(n=>{var s;const a=(s=this.p2pChannel)===null||s===void 0?void 0:s.getRemoteMedia(n.peer_uid),l=a!=null&&a.videoSSRC?Li.measureFromSubscribeStart(this.store.clientId,a.videoSSRC):0,u=a!=null&&a.audioSSRC?Li.measureFromSubscribeStart(this.store.clientId,a.audioSSRC):0;n.B_ppad!==void 0&&n.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(n.peer_uid,n.B_ppad,n.B_ppvd,l>u?l:u),this.trafficStatsPeerList.push(n.peer_uid))}),this.trafficStats=e}updateUplinkStats(e){this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&N.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,n,s){if(!e)return!1;const a=!!s&&n.framesDecodeFreezeTime>s.framesDecodeFreezeTime,l=!s||n.framesDecodeCount>s.framesDecodeCount;return a||!l}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}updateLocalStats(e){Array.from(this.localStats.entries()).forEach(n=>{let[s,a]=n;switch(s){case Ie.LocalVideoTrack:case Ie.LocalVideoLowTrack:{const u=a,p=Sp({},YN),m=e.getStats(),g=e.getLocalMedia(s);if(m){const E=m.videoSend.find(y=>y.ssrc===(g==null?void 0:g.ssrcs[0].ssrcId));if(E){const y=e.getLocalVideoSize(),C=e.getEncoderConfig(Ie.LocalVideoTrack);E.codec!=="H264"&&E.codec!=="H265"&&E.codec!=="VP8"&&E.codec!=="VP9"&&E.codec!=="AV1X"&&E.codec!=="AV1"||(p.codecType=E.codec),p.sendBytes=E.bytes,p.sendBitrate=u?8*Math.max(0,p.sendBytes-u.sendBytes):0,E.inputFrame?(p.captureFrameRate=E.inputFrame.frameRate,p.captureResolutionHeight=E.inputFrame.height,p.captureResolutionWidth=E.inputFrame.width):y&&(p.captureResolutionWidth=y.width,p.captureResolutionHeight=y.height),E.sentFrame?(p.sendFrameRate=E.sentFrame.frameRate,p.sendResolutionHeight=E.sentFrame.height,p.sendResolutionWidth=E.sentFrame.width):y&&(p.sendResolutionWidth=y.width,p.sendResolutionHeight=y.height),E.avgEncodeMs&&(p.encodeDelay=E.avgEncodeMs),C&&C.bitrateMax&&(p.targetSendBitrate=1e3*C.bitrateMax),p.sendPackets=E.packets,p.sendPacketsLost=E.packetsLost,p.sendJitterMs=E.jitterMs,p.sendRttMs=E.rttMs,p.totalDuration=u?u.totalDuration+1:1,p.totalFreezeTime=u?u.totalFreezeTime:0,this.isLocalVideoFreeze(E)&&(p.totalFreezeTime+=1),E.scalabilityMode&&this.scalabilityMode!==E.scalabilityMode&&(N.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(E.scalabilityMode)),this.scalabilityMode=E.scalabilityMode)}this.trafficStats&&(p.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var l;this.localStats.set(s,p),((u==null?void 0:u.sendResolutionWidth)!==p.sendResolutionWidth||(u==null?void 0:u.sendResolutionHeight)!==p.sendResolutionHeight)&&((l=this.onStatsChanged)===null||l===void 0||l.call(this,"resolution",{width:p.sendResolutionWidth,height:p.sendResolutionHeight})),p&&g&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,g.track,p);break}case Ie.LocalAudioTrack:{const u=a,p=Sp({},KN),m=e.getStats(),g=e.getLocalMedia(s);if(m){const E=m.audioSend.find(y=>y.ssrc===(g==null?void 0:g.ssrcs[0].ssrcId));if(E){if(E.codec!=="opus"&&E.codec!=="aac"&&E.codec!=="PCMU"&&E.codec!=="PCMA"&&E.codec!=="G722"||(p.codecType=E.codec),E.inputLevel)p.sendVolumeLevel=Math.round(32767*E.inputLevel);else{const y=e.getLocalAudioVolume();y&&(p.sendVolumeLevel=Math.round(32767*y))}p.sendBytes=E.bytes,p.sendPackets=E.packets,p.sendPacketsLost=E.packetsLost,p.sendJitterMs=E.jitterMs,p.sendRttMs=E.rttMs,p.sendBitrate=u?8*Math.max(0,p.sendBytes-u.sendBytes):0}}this.trafficStats&&(p.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Ie.LocalAudioTrack,p),p&&g&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,g.track,p);break}}})}updateRemoteStats(e){Array.from(this.remoteStats.entries()).forEach(n=>{var s,a;let[l,{videoStats:u,audioStats:p,videoPcStats:m}]=n;const g=p,E=u,y=m,C=Sp({},L3),I=Sp({},M3),j=Sp({},sse),{audioTrack:P,videoTrack:U,audioSSRC:q,videoSSRC:J}=e.getRemoteMedia(l);let se;se=e instanceof Fr?e.getStats(!0):e.getStats();const he=(s=se)===null||s===void 0?void 0:s.audioRecv.find(me=>me.ssrc===q),ae=(a=se)===null||a===void 0?void 0:a.videoRecv.find(me=>me.ssrc===J),de=this.trafficStats&&this.trafficStats.peer_delay.find(me=>me.peer_uid===l);if(he&&(he.codec!=="opus"&&he.codec!=="aac"&&he.codec!=="PCMU"&&he.codec!=="PCMA"&&he.codec!=="G722"||(C.codecType=he.codec),he.outputLevel?C.receiveLevel=Math.round(32767*he.outputLevel):P&&(C.receiveLevel=Math.round(32767*P.getVolumeLevel())),C.receiveBytes=he.bytes,C.receivePackets=he.packets,C.receivePacketsLost=he.packetsLost,C.packetLossRate=C.receivePacketsLost/(C.receivePackets+C.receivePacketsLost),C.receiveBitrate=g?8*Math.max(0,C.receiveBytes-g.receiveBytes):0,C.totalDuration=g?g.totalDuration+1:1,C.totalFreezeTime=g?g.totalFreezeTime:0,C.freezeRate=C.totalFreezeTime/C.totalDuration,C.receiveDelay=he.jitterBufferMs,C.totalDuration>10&&mv.isRemoteAudioFreeze(P)&&(C.totalFreezeTime+=1)),ae){ae.codec!=="H264"&&ae.codec!=="H265"&&ae.codec!=="VP8"&&ae.codec!=="VP9"&&ae.codec!=="AV1X"&&ae.codec!=="AV1"||(I.codecType=ae.codec),I.receiveBytes=ae.bytes,I.receiveBitrate=E?8*Math.max(0,I.receiveBytes-E.receiveBytes):0,I.decodeFrameRate=ae.decodeFrameRate<0?0:ae.decodeFrameRate,I.renderFrameRate=ae.decodeFrameRate<0?0:ae.decodeFrameRate,ae.outputFrame&&(I.renderFrameRate=ae.outputFrame.frameRate),ae.receivedFrame?(I.receiveFrameRate=ae.receivedFrame.frameRate,I.receiveResolutionHeight=ae.receivedFrame.height,I.receiveResolutionWidth=ae.receivedFrame.width):U&&(I.receiveResolutionHeight=U._videoHeight||0,I.receiveResolutionWidth=U._videoWidth||0),ae.framesRateFirefox!==void 0&&(I.receiveFrameRate=Math.round(ae.framesRateFirefox)),I.receivePackets=ae.packets,I.receivePacketsLost=ae.packetsLost,I.packetLossRate=I.receivePacketsLost/(I.receivePackets+I.receivePacketsLost),I.totalDuration=E?E.totalDuration+1:1,I.totalFreezeTime=E?E.totalFreezeTime:0,I.receiveDelay=ae.jitterBufferMs||0;const me=!!J&&e.getRemoteVideoIsReady(J);U&&me&&mv.isRemoteVideoFreeze(U,ae,y)&&(I.totalFreezeTime+=1),I.freezeRate=I.totalFreezeTime/I.totalDuration}de&&(C.end2EndDelay=de.B_ad,I.end2EndDelay=de.B_vd,C.transportDelay=de.B_ed,I.transportDelay=de.B_ed,C.currentPacketLossRate=de.B_ealr4/100,I.currentPacketLossRate=de.B_evlr4/100,j.uplinkNetworkQuality=de.B_punq?de.B_punq:0,j.downlinkNetworkQuality=de.B_pdnq?de.B_pdnq:0),this.remoteStats.set(l,{audioStats:C,videoStats:I,videoPcStats:ae,networkStats:j}),P&&this.exceptionMonitor.setRemoteAudioStats(P,C),U&&this.exceptionMonitor.setRemoteVideoStats(U,I)})}}function O6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function gv(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?O6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):O6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class wce extends jn{constructor(e,n,s,a){super(),R(this,"spec",void 0),R(this,"token",void 0),R(this,"websocket",void 0),R(this,"pingpongTimer",void 0),R(this,"reconnectMode","retry"),R(this,"serviceMode",void 0),R(this,"reqId",0),R(this,"commandReqId",0),R(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),R(this,"handleWebSocketMessage",l=>{if(!l.data)return;const u=JSON.parse(l.data);u.requestId?this.emit("@".concat(u.requestId,"-").concat(u.sid),u):this.serviceMode===Ur.INJECT?this.emit(Ca.INJECT_STREAM_STATUS,u):(qe.workerEvent(this.spec.sid,{actionType:"status",serverCode:u.code,workerType:this.serviceMode===Ur.TRANSCODE?1:2}),this.emit(Ca.PUBLISH_STREAM_STATUS,u))}),this.spec=n,this.token=e,this.serviceMode=a,this.websocket=new ME("live-streaming",s),this.websocket.on(ct.CONNECTED,this.handleWebSocketOpen),this.websocket.on(ct.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(ct.REQUEST_NEW_URLS,(l,u)=>{Tr(this,Ca.REQUEST_NEW_ADDRESS).then(l).catch(u)}),this.websocket.on(ct.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(e){return this.websocket.init(e)}async request(e,n,s,a){this.reqId+=1,e==="request"&&(this.commandReqId+=1);const l=this.commandReqId,u=this.reqId;if(!u||!this.websocket)throw new le(z.UNEXPECTED_ERROR);const p=gv({command:e,sdkVersion:qo==="4.20.2"?"0.0.1":qo,seq:u,requestId:u,allocate:s,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},n);if(this.websocket.state==="closed")throw new le(z.WS_DISCONNECT);const m=()=>new pe((C,I)=>{this.websocket.once(ct.CLOSED,()=>I(new le(z.WS_ABORT))),this.websocket.once(ct.CONNECTED,C)});this.websocket.state!=="connected"&&await m(),p.clientRequest&&(p.clientRequest.workerToken=this.token);const g=new pe((C,I)=>{const j=()=>{I(new le(z.WS_ABORT))};this.websocket.once(ct.RECONNECTING,j),this.websocket.once(ct.CLOSED,j),this.once("@".concat(u,"-").concat(this.spec.sid),P=>{C(P)})});a&&qe.workerEvent(this.spec.sid,gv(gv({},a),{},{requestId:l,actionType:"request",payload:JSON.stringify(n.clientRequest),serverCode:0,code:0}));const E=Date.now();this.websocket.sendMessage(p);let y=null;try{y=await g}catch(C){if(this.websocket.state==="closed")throw C;return await m(),await this.request(e,n,s)}return a&&qe.workerEvent(this.spec.sid,gv(gv({},a),{},{requestId:l,actionType:"response",payload:JSON.stringify(y.serverResponse),serverCode:y.code,success:y.code===200,responseTime:Date.now()-E})),y.code!==200&&this.handleResponseError(y),y}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const e=qo==="4.20.2"?"0.0.1":qo;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case _r.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void N.warning("live stream response already exists stream");case _r.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case _r.LIVE_STREAM_RESPONSE_BAD_STREAM:case _r.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new le(z.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case _r.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(e.serverResponse.command==="UnpublishStream"||e.serverResponse.command==="UninjectStream")return;throw new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case _r.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new le(z.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case _r.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const n=new le(z.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(Ca.WARNING,n,e.serverResponse.url)}case _r.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const n=new le(z.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(Ca.WARNING,n,e.serverResponse.url)}case _r.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case _r.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new le(z.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case _r.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const n=new le(z.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(Ca.WARNING,n,e.serverResponse.url)}case _r.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case _r.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case _r.LIVE_STREAM_RESPONSE_WORKER_LOST:case _r.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(e.serverResponse.command==="UnpublishStream"||e.serverResponse.command==="UninjectStream")return;throw new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case _r.ERROR_FAIL_SEND_MESSAGE:if(e.serverResponse.command==="UnpublishStream"||e.serverResponse.command==="UninjectStream")return;if(e.serverResponse.command==="UpdateTranscoding"||e.serverResponse.command==="ControlStream")return new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case _r.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case _r.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case _r.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case _r.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new le(z.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(Pb)},6e3)}}function N6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Ts(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):N6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class Rce extends jn{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wr,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wr;super(),R(this,"onLiveStreamWarning",void 0),R(this,"onLiveStreamError",void 0),R(this,"onInjectStatusChange",void 0),R(this,"spec",void 0),R(this,"retryTimeout",1e4),R(this,"connection",void 0),R(this,"httpRetryConfig",void 0),R(this,"wsRetryConfig",void 0),R(this,"streamingTasks",new Map),R(this,"isStartingStreamingTask",!1),R(this,"taskMutex",new ii("live-streaming")),R(this,"cancelToken",Ls.CancelToken.source()),R(this,"transcodingConfig",void 0),R(this,"injectConfig",Ts({},bie)),R(this,"injectLoopTimes",0),R(this,"uapResponse",void 0),R(this,"lastTaskId",1),R(this,"statusError",new Map),this.spec=e,this.httpRetryConfig=s,this.wsRetryConfig=n}async setTranscodingConfig(e){const n=Ts(Ts({},Sie),e);n.videoCodecProfile!==66&&n.videoCodecProfile!==77&&n.videoCodecProfile!==100&&(N.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(n.videoCodecProfile," -> 100")),n.videoCodecProfile=100),n.transcodingUsers||(n.transcodingUsers=n.userConfigs),n.transcodingUsers&&(n.transcodingUsers=n.transcodingUsers.map(u=>Ts(Ts(Ts({},yie),u),{},{zOrder:u.zOrder?u.zOrder+1:1}))),function(u){Xn(u.width)||pn(u.width,"config.width",0,1e4),Xn(u.height)||pn(u.height,"config.height",0,1e4),Xn(u.videoBitrate)||pn(u.videoBitrate,"config.videoBitrate",1,1e6),Xn(u.videoFrameRate)||pn(u.videoFrameRate,"config.videoFrameRate"),Xn(u.lowLatency)||Jl(u.lowLatency,"config.lowLatency"),Xn(u.audioSampleRate)||Lr(u.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Xn(u.audioBitrate)||pn(u.audioBitrate,"config.audioBitrate",1,128),Xn(u.audioChannels)||Lr(u.audioChannels,"config.audioChannels",[1,2,3,4,5]),Xn(u.videoGop)||pn(u.videoGop,"config.videoGop"),Xn(u.videoCodecProfile)||Lr(u.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Xn(u.userCount)||pn(u.userCount,"config.userCount",0,17),Xn(u.backgroundColor)||pn(u.backgroundColor,"config.backgroundColor",0,16777215),Xn(u.userConfigExtraInfo)||xi(u.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),u.transcodingUsers&&!Xn(u.transcodingUsers)&&(Ql(u.transcodingUsers,"config.transcodingUsers"),u.transcodingUsers.forEach((p,m)=>{CN(p.uid),Xn(p.x)||pn(p.x,"transcodingUser[".concat(m,"].x"),0,1e4),Xn(p.y)||pn(p.y,"transcodingUser[".concat(m,"].y"),0,1e4),Xn(p.width)||pn(p.width,"transcodingUser[".concat(m,"].width"),0,1e4),Xn(p.height)||pn(p.height,"transcodingUser[".concat(m,"].height"),0,1e4),Xn(p.zOrder)||pn(p.zOrder-1,"transcodingUser[".concat(m,"].zOrder"),0,100),Xn(p.alpha)||pn(p.alpha,"transcodingUser[".concat(m,"].alpha"),0,1,!1)})),Xn(u.watermark)||RN(u.watermark,"watermark"),Xn(u.backgroundImage)||RN(u.backgroundImage,"backgroundImage"),u.images&&!Xn(u.images)&&(Ql(u.images,"config.images"),u.images.forEach((p,m)=>{RN(p,"images[".concat(m,"]"))}))}(n);const s=[];n.images&&s.push(...n.images.map(u=>Ts(Ts(Ts({},wN),u),{},{zOrder:255}))),n.backgroundImage&&(s.push(Ts(Ts(Ts({},wN),n.backgroundImage),{},{zOrder:0})),delete n.backgroundImage),n.watermark&&(s.push(Ts(Ts(Ts({},wN),n.watermark),{},{zOrder:255})),delete n.watermark),n.images=s,n.transcodingUsers&&(n.userConfigs=n.transcodingUsers.map(u=>Ts({},u)),n.userCount=n.transcodingUsers.length,delete n.transcodingUsers);const a=(n.userConfigs||[]).map(u=>typeof u.uid=="number"?pe.resolve(u.uid):A3(u.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await pe.all(a)).forEach((u,p)=>{n.userConfigs&&n.userConfigs[p]&&(n.userConfigs[p].uid=u)}),this.transcodingConfig=n,this.connection)try{var l;const u=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(yc(l=this.streamingTasks).call(l)).map(p=>p.taskId).join("#")});N.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(u.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(u){if(!u.data||!u.data.retry)throw u;u.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(p=>{N.warning("[".concat(this.spec.clientId,"] live streaming receive error"),u.toString(),"try to republish",p.url),this.startLiveStreamingTask(p.url,p.mode,u).then(()=>{N.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(p.url," success"))}).catch(m=>{N.error("[".concat(this.spec.clientId,"] live streaming republish failed"),p.url,m.toString()),this.onLiveStreamError&&this.onLiveStreamError(p.url,m)})})}}setInjectStreamConfig(e,n){this.injectConfig=Object.assign({},this.injectConfig,e),this.injectLoopTimes=n}async startLiveStreamingTask(e,n,s){var a;if(Array.from(yc(a=this.streamingTasks).call(a)).find(m=>m.mode===Ur.INJECT)&&n===Ur.INJECT)return new le(z.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&n===Ur.TRANSCODE)throw new le(z.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let l={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};N.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(e,", mode: ").concat(n));const u=await this.taskMutex.lock();if(!this.connection&&s)return void u();if(this.streamingTasks.get(e)&&!s)return u(),new le(z.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(n))}catch(m){throw u(),m}switch(n){case Ur.TRANSCODE:l.transcodingConfig=Ts({},this.transcodingConfig);break;case Ur.RAW:break;case Ur.INJECT:l={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:e,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(l.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const p=this.lastTaskId++;try{const m=new pe((E,y)=>{ri(this.retryTimeout).then(()=>{if(s)return y(s);const C=this.statusError.get(e);return C?(this.statusError.delete(e),y(C)):void 0})}),g=await pe.race([this.connection.request("request",{clientRequest:l},!0,{url:e,command:"PublishStream",workerType:n===Ur.TRANSCODE?1:2,requestByUser:!s,tid:p.toString()}),m]);this.isStartingStreamingTask=!1,N.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(g.code)),this.streamingTasks.set(e,{clientRequest:l,mode:n,url:e,taskId:p}),u()}catch(m){if(u(),this.isStartingStreamingTask=!1,!m.data||!m.data.retry||s)throw m;return m.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,n,m)):await this.startLiveStreamingTask(e,n,m)}}stopLiveStreamingTask(e){return new pe((n,s)=>{const a=this.streamingTasks.get(e);if(!a||!this.connection)return new le(z.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const l=a.mode;a.abortTask=()=>{N.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),n()},this.connection.request("request",{clientRequest:{command:l===Ur.INJECT?"UninjectStream":"UnpublishStream",url:a.url}},!1,{url:e,command:"UnPublishStream",workerType:l===Ur.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(u=>{N.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(u.code)),this.streamingTasks.delete(e),this.streamingTasks.size===0&&l!==Ur.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),n(),l===Ur.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(hu.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,e)}).catch(s)})}async controlInjectStream(e,n,s,a){const l=this.streamingTasks.get(e);if(!l||!this.connection||l.mode!==Ur.INJECT)throw new le(z.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:e,control:n,audioVolume:s,position:a}})).serverResponse}resetAllTask(){var e;const n=Array.from(yc(e=this.streamingTasks).call(e));this.terminate();for(const s of n)this.startLiveStreamingTask(s.url,s.mode).catch(a=>{this.onLiveStreamError&&this.onLiveStreamError(s.url,a)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Ls.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new le(z.UNEXPECTED_ERROR,"live streaming connection has already connected");const n=await Tr(this,rm.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=n,this.connection=new wce(n.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(Ca.WARNING,(s,a)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(a,s)),this.connection.on(Ca.PUBLISH_STREAM_STATUS,s=>this.handlePublishStreamServer(s)),this.connection.on(Ca.INJECT_STREAM_STATUS,s=>this.handleInjectStreamServerStatus(s)),this.connection.on(Ca.REQUEST_NEW_ADDRESS,(s,a)=>{if(!this.connection)return a(new le(z.UNEXPECTED_ERROR,"can not get new live streaming address list"));Tr(this,rm.REQUEST_WORKER_MANAGER_LIST,e).then(l=>{this.uapResponse=l,s(l.addressList)}).catch(a)}),await this.connection.init(n.addressList),this.connection}handlePublishStreamServer(e){const n=e.serverStatus&&e.serverStatus.url||"empty_url",s=this.streamingTasks.get(n),a=e.reason;switch(e.code){case _r.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case _r.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case _r.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case _r.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const u=new le(z.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(s)return N.error(u.toString()),this.onLiveStreamError&&this.onLiveStreamError(n,u);if(!this.isStartingStreamingTask)return;this.statusError.set(n,u)}case _r.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const u=new le(z.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,a);return this.onLiveStreamWarning&&this.onLiveStreamWarning(n,u)}case _r.LIVE_STREAM_RESPONSE_WORKER_LOST:case _r.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var l;if(!this.connection)return;this.connection.tryNextAddress();const u=Array.from(yc(l=this.streamingTasks).call(l));for(const p of u)p.abortTask?p.abortTask():(N.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",p.url),this.startLiveStreamingTask(p.url,p.mode,new le(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then(()=>{N.debug("[".concat(this.spec.clientId,"] republish live stream success"),p.url)}).catch(m=>{N.error(m.toString()),this.onLiveStreamError&&this.onLiveStreamError(p.url,m)}));return}}}handleInjectStreamServerStatus(e){const n=Number(e.uid),s=e.serverStatus&&e.serverStatus.url;switch(e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(hu.INJECT_STREAM_STATUS_START_SUCCESS,n,s));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(hu.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,n,s),void this.streamingTasks.delete(s);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(hu.INJECT_STREAM_STATUS_START_UNAUTHORIZED,n,s),void this.streamingTasks.delete(s);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(hu.INJECT_STREAM_STATUS_BROKEN,n,s),void this.streamingTasks.delete(s);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(hu.INJECT_STREAM_STATUS_START_TIMEOUT,n,s),void this.streamingTasks.delete(s);default:return void N.debug("inject stream server status",e)}}hasUrl(e){return this.streamingTasks.has(e)}}class GT{constructor(){R(this,"destChannelMediaInfos",new Map),R(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(e){q4(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){q4(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){TN(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function k6(i){if(!(i instanceof GT))return new le(z.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const e=i.getSrcChannelMediaInfo(),n=i.getDestChannelMediaInfo();if(!e)return new le(z.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(n.size===0)return new le(z.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class Ice extends jn{constructor(e,n,s){super(),R(this,"ws",void 0),R(this,"requestId",1),R(this,"heartBeatTimer",void 0),R(this,"joinInfo",void 0),R(this,"clientId",void 0),R(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),R(this,"onClose",a=>{this.emit("close"),this.dispose()}),R(this,"onMessage",a=>{const l=JSON.parse(a.data);if(!l||l.command!=="serverResponse"||!l.requestId)return l&&l.command==="serverStatus"&&l.serverStatus&&l.serverStatus.command?(this.emit("status",l.serverStatus),void this.emit(l.serverStatus.command,l.serverStatus)):void 0;this.emit("req_".concat(l.requestId),l)}),this.joinInfo=e,this.clientId=n,this.ws=new ME("cross-channel-".concat(this.clientId),s),this.ws.on(ct.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(ct.CONNECTED,this.onOpen),this.ws.on(ct.ON_MESSAGE,this.onMessage),this.ws.on(ct.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(e){const n=this.requestId++;return e.requestId=n,e.seq=n,this.ws.sendMessage(e),n}waitStatus(e){return new pe((n,s)=>{const a=window.setTimeout(()=>{s(new le(z.TIMEOUT,"wait status timeout, status: ".concat(e)))},5e3);this.once(e,l=>{window.clearTimeout(a),l.state&&l.state!==0?s(new le(z.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):n(void 0)}),this.once("dispose",()=>{window.clearTimeout(a),s(new le(z.WS_ABORT))})})}async request(e){if(this.ws.state==="closed")throw new le(z.WS_DISCONNECT);const n=()=>new pe((u,p)=>{this.ws.once(ct.CLOSED,()=>p(new le(z.WS_ABORT))),this.ws.once(ct.CONNECTED,u)});this.ws.state!=="connected"&&await n();const s=this.sendMessage(e),a=new pe((u,p)=>{const m=()=>{p(new le(z.WS_ABORT))};this.ws.once(ct.RECONNECTING,m),this.ws.once(ct.CLOSED,m),this.once("req_".concat(s),u),ri(3e3).then(()=>{this.removeAllListeners("req_".concat(s)),this.ws.off(ct.RECONNECTING,m),this.ws.off(ct.CLOSED,m),p(new le(z.TIMEOUT,"cross channel ws request timeout"))})}),l=await a;if(!l||l.code!==200)throw new le(z.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(l)));return l}async connect(e){this.ws.removeAllListeners(ct.REQUEST_NEW_URLS),this.ws.on(ct.REQUEST_NEW_URLS,n=>{n(e)}),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){const n=this.requestId++;return e.requestId=n,this.ws.sendMessage(e),n}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class Ace extends jn{set state(e){e!==this._state&&(e!==hs.RELAY_STATE_FAILURE&&(this.errorCode=pu.RELAY_OK),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}constructor(e,n,s,a,l){super(),R(this,"joinInfo",void 0),R(this,"sid",void 0),R(this,"clientId",void 0),R(this,"cancelToken",Ls.CancelToken.source()),R(this,"workerToken",void 0),R(this,"requestId",0),R(this,"signal",void 0),R(this,"prevChannelMediaConfig",void 0),R(this,"httpRetryConfig",void 0),R(this,"_resolution",void 0),R(this,"_state",hs.RELAY_STATE_IDLE),R(this,"errorCode",pu.RELAY_OK),R(this,"onStatus",u=>{N.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(u))),u&&u.command&&(u.command==="onAudioPacketReceived"&&this.emit("event",Sc.PACKET_RECEIVED_AUDIO_FROM_SRC),u.command==="onVideoPacketReceived"&&this.emit("event",Sc.PACKET_RECEIVED_VIDEO_FROM_SRC),u.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=pu.SRC_TOKEN_EXPIRED,this.state=hs.RELAY_STATE_FAILURE),u.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=pu.DEST_TOKEN_EXPIRED,this.state=hs.RELAY_STATE_FAILURE))}),R(this,"onReconnect",async()=>{N.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",Sc.NETWORK_DISCONNECTED),this.state=hs.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(u=>{this.state!==hs.RELAY_STATE_IDLE&&(N.error("auto restart channel media relay failed",u.toString()),this.errorCode=pu.SERVER_CONNECTION_LOST,this.state=hs.RELAY_STATE_FAILURE)})}),this.joinInfo=e,this.clientId=n,this.sid=JO(),this.signal=new Ice(this.joinInfo,this.clientId,s),this.httpRetryConfig=a,this._resolution=l}async startChannelMediaRelay(e){if(this.state!==hs.RELAY_STATE_IDLE)throw new le(z.INVALID_OPERATION);this.state=hs.RELAY_STATE_CONNECTING,await this.connect(),N.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(n){throw n.data&&n.data.serverResponse&&n.data.serverResponse.command==="SetSourceChannel"?new le(z.CROSS_CHANNEL_FAILED_JOIN_SRC):n.data&&n.data.serverResponse&&n.serverResponse.command==="SetDestChannelStatus"?new le(z.CROSS_CHANNEL_FAILED_JOIN_DEST):n.data&&n.data.serverResponse&&n.serverResponse.command==="StartPacketTransfer"?new le(z.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):n}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if(this.state!==hs.RELAY_STATE_RUNNING)throw new le(z.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async setVideoProfile(e){if(this._resolution=e,this.state!==hs.RELAY_STATE_RUNNING)throw new le(z.INVALID_OPERATION);const n=this.genMessage(Ki.SetVideoProfile);await this.signal.request(n),N.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),N.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=hs.RELAY_STATE_IDLE,this.dispose()}dispose(){N.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Ls.CancelToken.source(),this.state=hs.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const e=await Qie(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event",Sc.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){const n=this.genMessage(Ki.StopPacketTransfer);await this.signal.request(n),await this.signal.waitStatus("Normal Quit"),N.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const s=this.genMessage(Ki.SetSdkProfile,e);await this.signal.request(s),N.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const a=this.genMessage(Ki.SetSourceChannel,e);await this.signal.request(a),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",Sc.PACKET_JOINED_SRC_CHANNEL),N.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const l=this.genMessage(Ki.SetSourceUserId,e);await this.signal.request(l),N.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const u=this.genMessage(Ki.SetDestChannel,e);await this.signal.request(u),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",Sc.PACKET_JOINED_DEST_CHANNEL),N.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const p=this.genMessage(Ki.StartPacketTransfer,e);await this.signal.request(p),this.emit("event",Sc.PACKET_SENT_TO_DEST_CHANNEL),this.state=hs.RELAY_STATE_RUNNING,N.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(e){const n=this.genMessage(Ki.UpdateDestChannel,e);await this.signal.request(n),this.emit("event",Sc.PACKET_UPDATE_DEST_CHANNEL),N.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const e=this.genMessage(Ki.StopPacketTransfer);await this.signal.request(e),N.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,n){const s=[],a=[],l=[];this.requestId+=1;const u={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:qo,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};u.sdkVersion==="4.20.2"&&(u.sdkVersion="0.0.1");let p=null,m=null;switch(e){case Ki.SetSdkProfile:return u.clientRequest={command:"SetSdkProfile",type:"multi_channel"},u;case Ki.SetSourceChannel:if(m=n&&n.getSrcChannelMediaInfo(),!m)throw new le(z.UNEXPECTED_ERROR,"can not find source config");return u.clientRequest={command:"SetSourceChannel",uid:"0",channelName:m.channelName,token:m.token||this.joinInfo.appId},u;case Ki.SetSourceUserId:if(m=n&&n.getSrcChannelMediaInfo(),!m)throw new le(z.UNEXPECTED_ERROR,"can not find source config");return u.clientRequest={command:"SetSourceUserId",uid:m.uid+""},u;case Ki.SetDestChannel:if(p=n&&n.getDestChannelMediaInfo(),!p)throw new le(z.UNEXPECTED_ERROR,"can not find dest config");return p.forEach(g=>{s.push(g.channelName),a.push(g.uid+""),l.push(g.token||this.joinInfo.appId)}),u.clientRequest={command:"SetDestChannel",channelName:s,uid:a,token:l},u;case Ki.StartPacketTransfer:return u.clientRequest={command:"StartPacketTransfer"},u;case Ki.Reconnect:return u.clientRequest={command:"Reconnect"},u;case Ki.StopPacketTransfer:return u.clientRequest={command:"StopPacketTransfer"},u;case Ki.UpdateDestChannel:if(p=n&&n.getDestChannelMediaInfo(),!p)throw new le(z.UNEXPECTED_ERROR,"can not find dest config");return p.forEach(g=>{s.push(g.channelName),a.push(g.uid+""),l.push(g.token||this.joinInfo.appId)}),u.clientRequest={command:"UpdateDestChannel",channelName:s,uid:a,token:l},u;case Ki.SetVideoProfile:u.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return u}}function HT(i){var e={},n=!1;function s(a,l){return n=!0,{done:!1,value:new ix(l=new sx(function(u){u(i[a](l))}),1)}}return e[Ff!==void 0&&dF||"@@iterator"]=function(){return this},e.next=function(a){return n?(n=!1,a):s("next",a)},typeof i.throw=="function"&&(e.throw=function(a){if(n)throw n=!1,a;return s("throw",a)}),typeof i.return=="function"&&(e.return=function(a){return n?(n=!1,a):s("return",a)}),e}var x6=d(n6);function P6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function D6(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?P6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):P6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function L6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function M6(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?L6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):L6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class ai extends Jb{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").filter(e=>{var n;return je(n=Object.keys(du)).call(n,e)}))]}constructor(e,n){super(e,n),R(this,"store",void 0),R(this,"peerConnection",void 0),R(this,"remoteSDP",void 0),R(this,"initialOffer",void 0),R(this,"statsFilter",void 0),R(this,"useRTX",!1),R(this,"localCapabilities",void 0),R(this,"localCandidateCount",0),R(this,"allCandidatesReceived",!1),R(this,"establishPromise",void 0),R(this,"mutex",new ii("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection(ai.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.statsFilter=VT(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,mn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const n=wc(e.sdp),s=hv(e.sdp,{filterRTX:!this.useRTX,filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=s,this.initialOffer=e,M6(M6({},n),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:s},offerSDP:e.sdp})}catch(e){throw new ye(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,n,s,a,l,u){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(m){R(this,"sessionDesc",void 0),R(this,"localCapabilities",void 0),R(this,"rtpCapabilities",void 0),R(this,"candidates",void 0),R(this,"iceParameters",void 0),R(this,"dtlsParameters",void 0),R(this,"setup",void 0),R(this,"currentMidIndex",void 0),R(this,"cname",void 0),m=Cn(m);const{remoteIceParameters:g,remoteDtlsParameters:E,candidates:y,remoteRTPCapabilities:C,remoteSetup:I,localCapabilities:j,sdkCodec:P,cname:U}=m,q=Fn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=C,this.candidates=y,this.iceParameters=g,this.dtlsParameters=E,this.setup=I,this.localCapabilities=j,this.cname=U;for(let J=0;J<q.mediaDescriptions.length;J++){const se=q.mediaDescriptions[J];if(se.attributes.iceUfrag=g.iceUfrag,se.attributes.icePwd=g.icePwd,se.attributes.fingerprints=E.fingerprints,se.attributes.candidates=y,se.attributes.setup=I,se.media.mediaType==="video"){se.media.fmts=C.videoCodecs.map(ae=>ae.payloadType.toString(10));let he=C.videoCodecs.filter(ae=>{var de,me;return(de=ae.rtpMap)===null||de===void 0?void 0:je(me=de.encodingName.toLowerCase()).call(me,P)});he.length===0&&(he=C.videoCodecs),se.attributes.payloads=he,se.attributes.extmaps=C.videoExtensions}se.media.mediaType==="audio"&&(se.media.fmts=C.audioCodecs.map(he=>he.payloadType.toString(10)),se.attributes.payloads=C.audioCodecs,se.attributes.extmaps=C.audioExtensions),q.mediaDescriptions[J]=this.mungMediaDesc(se)}this.sessionDesc=q,this.currentMidIndex=q.mediaDescriptions.length-1}toString(){return Fn.print(this.sessionDesc)}send(m,g,E){const{ssrcs:y,ssrcGroups:C}=Fs(g,this.cname),I=this.sessionDesc.mediaDescriptions.find(U=>m===ze.VIDEO?U.media.mediaType==="video":U.media.mediaType==="audio"),j=y[0].attributes.label,P=y[0].attributes.mslabel;return I.attributes.ssrcs=I.attributes.ssrcs.concat(y),I.attributes.ssrcGroups=I.attributes.ssrcGroups.concat(C),{id:j,mslabel:P}}batchSend(m){return m.map(g=>{let{kind:E,ssrcMsg:y}=g;return this.send(E,y,void 0)})}stopSending(m){this.sessionDesc.mediaDescriptions.forEach(g=>{const E=[],y=[],C=[];g.attributes.ssrcs.forEach(I=>{je(m).call(m,I.attributes.label||"")?C.push(I):E.push(I)}),g.attributes.ssrcGroups.forEach(I=>{var j;je(j=C.map(P=>P.ssrcId)).call(j,I.ssrcIds[0])||y.push(I)}),g.attributes.ssrcs=E,g.attributes.ssrcGroups=y})}mute(m){const g=this.sessionDesc.mediaDescriptions.find(E=>E.attributes.mid===m);if(!g)throw new Error("mediaDescription not found with ".concat(m," in remote SDP when calling RemoteSDP.mute."));g.attributes.direction="inactive"}unmute(m){const g=this.sessionDesc.mediaDescriptions.find(E=>E.attributes.mid===m);if(!g)throw new Error("mediaDescription not found with ".concat(m," in remote SDP when calling RemoteSDP.unmute."));g.attributes.direction="sendonly"}receive(m,g,E){m.forEach((y,C)=>{const I=y._mediaStreamTrack,j=this.sessionDesc.mediaDescriptions.findIndex(U=>U.attributes.mid===I.kind),P=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[j],y);this.sessionDesc.mediaDescriptions[j]=P})}stopReceiving(m){}updateCandidates(m){m===Pi.TCP?this.candidates.forEach(g=>{this.candidates.findIndex(E=>E.transport==="tcp"&&E.connectionAddress===g.connectionAddress&&E.port===g.port)===-1&&this.candidates.push(D6(D6({},g),{},{foundation:"tcpcandidate",priority:Number(g.priority)-1+"",transport:"tcp",port:Number(g.port)+90+""}))}):this.candidates=this.candidates.filter(g=>g.transport!=="tcp");for(const g of this.sessionDesc.mediaDescriptions)g.attributes.candidates=this.candidates}restartICE(m){m=Cn(m),this.iceParameters=m,this.sessionDesc.mediaDescriptions.forEach(g=>{g.attributes.iceUfrag=m.iceUfrag,g.attributes.icePwd=m.icePwd})}predictReceivingMids(m){const g=[];for(let E=0;E<m;E++)g.push((this.currentMidIndex+E+1).toString(10));return g}mungRecvMediaDsec(m,g){const E=Cn(m);return Nu(E,g),WT(E,g),E}updateRecvMedia(m,g){const E=this.sessionDesc.mediaDescriptions.findIndex(y=>y.attributes.mid===m);if(E!==-1){const y=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[E],g);this.sessionDesc.mediaDescriptions[E]=y}}bumpMid(m){this.currentMidIndex+=m}updateTrackLabel(m,g,E){const y=this.sessionDesc.mediaDescriptions.find(I=>m===ze.VIDEO?I.attributes.mid==="video":I.attributes.mid==="audio");if(y){const I=y.attributes.ssrcs.find(j=>j.attributes.label===g);var C;I&&(I.attributes.label=E,(C=I.attributes.msid)===null||C===void 0||C.replace(g,E))}}mungMediaDesc(m){const g=Cn(m);return BT(g),function(E){const y=E.attributes.extmaps.find(C=>C.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");y&&E.attributes.extmaps.splice(E.attributes.extmaps.indexOf(y),1),E.attributes.payloads.forEach(C=>{const I=C.rtcpFeedbacks.findIndex(j=>j.type==="transport-cc");I!==-1&&C.rtcpFeedbacks.splice(I,1)})}(g),g}getSSRC(m){for(const g of this.sessionDesc.mediaDescriptions)for(const E of g.attributes.ssrcs)if(E.attributes.label===m)return[E]}}({remoteIceParameters:e,remoteDtlsParameters:n,candidates:s,remoteRTPCapabilities:a.send,remoteSetup:l,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:u});const p=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(p){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(p.toString()))}}async updateRemoteRTPCapabilities(e,n){throw new ye(z.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}send(e,n){var s=this;return no(function*(){const a=yield Ct(s.mutex.lock());try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const l=e.map(C=>s.peerConnection.addTrack(C._mediaStreamTrack)),u=yield Ct(s.peerConnection.createOffer()),p=Fn.parse(u.sdp),m=e.map(C=>{const I=C._mediaStreamTrack,j=p.mediaDescriptions.find(P=>P.attributes.mid===I.kind);if(!j)throw new Error("Cannot extract ssrc from mediaDescription.");return function(P,U,q){const J=P.attributes.ssrcs.filter(he=>he.attributes.label===U),se=P.attributes.ssrcGroups;if(J.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(se&&J.length>1){const he=se.find(ae=>ae.ssrcIds.indexOf(J[0].ssrcId)!==-1);return he?[{ssrcId:he.ssrcIds[0],rtx:q?he.ssrcIds[1]:void 0}]:[{ssrcId:J[0].ssrcId}]}return[{ssrcId:J[0].ssrcId}]}(j,I.id,s.useRTX)});let g;try{g=yield m}catch(C){throw l.forEach(I=>{vi()&&I.replaceTrack(null),s.peerConnection.removeTrack(I)}),C}const E=s.mungSendOfferSDP(u.sdp,e);s.remoteSDP.receive(e,n,g);const y=s.remoteSDP.toString();return yield Ct(s.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield Ct(s.applySendEncodings(l,e)),yield Ct(s.peerConnection.setRemoteDescription({type:"answer",sdp:y})),e.map((C,I)=>{const j=C._mediaStreamTrack.id;return{localSSRC:m[I],id:j}})}catch(l){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(l.toString()))}finally{a()}})()}async stopSending(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const n=this.peerConnection.getSenders().filter(l=>{var u;return e.indexOf(((u=l.track)===null||u===void 0?void 0:u.id)||"")!==-1});if(n.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");n.map(l=>{vi()&&l.replaceTrack(null),this.peerConnection.removeTrack(l)});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s),this.remoteSDP.stopReceiving(e);const a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:a})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(n.toString()))}}async receive(e,n,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{id:l,mslabel:u}=this.remoteSDP.send(e,n,a),p=new pe((E,y)=>{const C=setTimeout(()=>{y(new Error("Cannot receive track, id: ".concat(l)))},1e4),I=j=>{const P=zt();if((P.name==="Safari"&&Number(P.version)===11||ts())&&j.track.id!==l&&j.streams[0].id===u){var U;const q=j.streams[0].getTracks()[0];return(U=this.remoteSDP)===null||U===void 0||U.updateTrackLabel(e,l,j.track.id),this.peerConnection.removeEventListener("track",I),clearTimeout(C),void E(q)}if(j.track.id===l)return this.peerConnection.removeEventListener("track",I),clearTimeout(C),void E(j.track)};this.peerConnection.addEventListener("track",I)}),m=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:m});const g=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(g),{track:await p,id:l}}catch(l){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(s)}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}async muteRemote(e){}async unmuteRemote(e){}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getSenders().filter(s=>{var a;return e.indexOf(((a=s.track)===null||a===void 0?void 0:a.id)||"")!==-1});if(n.length!==e.length)throw new Error("sender' length doesn't match mids' length.");n.map(s=>{if(vi()&&s.track)s.track.enabled=!1;else{const a=s.getParameters();a.encodings.forEach(l=>l.active=!1),s.setParameters(a)}})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getSenders().filter(l=>{var u;return e.indexOf(((u=l.track)===null||u===void 0?void 0:u.id)||"")!==-1});if(n.length!==e.length)throw new Error("Senders' length doesn't match mids' length.");n.map(async l=>{if(vi()&&l.track)l.track.enabled=!0;else{const u=l.getParameters();u.encodings.forEach(p=>p.active=!0),await l.setParameters(u)}});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s);const a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:a})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(n.toString()))}}restartICE(e){var n=this;return no(function*(){const s=yield Ct(n.mutex.lock("From P2PConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Kt().supportPCSetConfiguration){const m=n.peerConnection.getConfiguration(),g=e===Pi.RELAY?"relay":"all";m.iceTransportPolicy!==g&&(N.debug("[".concat(n.store.clientId,"] restartICE change iceTransportPolicy from [").concat(m.iceTransportPolicy,"] to [").concat(g,"]")),m.iceTransportPolicy=g,n.peerConnection.setConfiguration(m))}else if(e===Pi.RELAY)return;e!==Pi.RELAY&&n.remoteSDP.updateCandidates(e);const a=yield Ct(n.peerConnection.createOffer({iceRestart:!0}));if(!a.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const l=wc(a.sdp),{remoteIceParameters:u}=yield l.iceParameters;n.remoteSDP.restartICE(u);const p=n.remoteSDP.toString();yield Ct(n.peerConnection.setLocalDescription(a)),yield Ct(n.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(a){N.warning("[".concat(n.store.clientId,"] restart ICE failed, abort operation"),a)}finally{s()}})()}close(){var e;this.peerConnection.close(),(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),a=this.mungSendOfferSDP(s.sdp,[n]);this.remoteSDP.updateRecvMedia(n._mediaStreamTrack.kind,n);const l=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new ye(z.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(e,n){const s=this.peerConnection.getSenders().filter(a=>{var l;return((l=a.track)===null||l===void 0?void 0:l.id)===e});s.length===1&&await this.applySendEncodings(s,[n])}setStatsRemoteVideoIsReady(e,n){this.statsFilter.setVideoIsReady2(e,n)}async replaceTrack(e,n){const s=this.peerConnection.getSenders().find(a=>{var l;return((l=a.track)===null||l===void 0?void 0:l.id)===n});s&&await s.replaceTrack(e._mediaStreamTrack)}createDataChannels(e,n){throw new ye(z.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(e){throw new ye(z.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;(e=this.onICEConnectionStateChange)===null||e===void 0||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,N.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,N.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const n={iceServers:[],sdpSemantics:"plan-b"};return e.iceServers?n.iceServers=e.iceServers:e.turnServer&&e.turnServer.mode!=="off"&&(Yf(e.turnServer.servers)?n.iceServers=e.turnServer.servers:(n.iceServers&&n.iceServers.push(...ai.turnServerConfigToIceServers(e.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&e.turnServer.serversFromGateway&&n.iceServers.push(...ai.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(e){const n=[];return e.forEach(s=>{s.security?s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),n}async updateRtpSenderEncodings(e,n){var s;if(n||(n=this.peerConnection.getSenders().find(g=>{var E;return((E=g.track)===null||E===void 0?void 0:E.id)===e._mediaStreamTrack.id})),!n)return N.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(!Kt().supportSetRtpSenderParameters)return N.warn("Browser not support set rtp-sender parameters");const a={},l={};if(e instanceof At)switch(e._optimizationMode){case"motion":a.degradationPreference="maintain-framerate";break;case"detail":a.degradationPreference="maintain-resolution";break;default:a.degradationPreference="balanced"}if(Z("DSCP_TYPE")&&au()){var u;const g=Z("DSCP_TYPE");je(u=["very-low","low","medium","high"]).call(u,g)&&(l.networkPriority=g)}const p=n.getParameters(),m=(s=p.encodings)===null||s===void 0?void 0:s[0];m&&Object.assign(m,l),Object.assign(p,a),N.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(p.encodings))),await n.setParameters(p)}async applySendEncodings(e,n){try{if(!Kt().supportSetRtpSenderParameters||e.length!==n.length)return;for(let s=0;s<e.length;s++){const a=e[s],l=n[s];a&&l&&await this.updateRtpSenderEncodings(l,a)}}catch{N.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,n){const s=Fn.parse(e);return n.forEach((a,l)=>{const u=a._mediaStreamTrack,p=s.mediaDescriptions.find(m=>m.attributes.mid===u.kind);p&&Nu(p,a)}),Fn.print(s)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,n,s)=>{var a;(a=this.onFirstVideoDecoded)===null||a===void 0||a.call(this,e,n,s)},this.statsFilter.onSelectedLocalCandidateChanged=(e,n)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,e,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,n)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,e,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const n=this.remoteSDP.batchSend(e).map((l,u)=>{let{id:p,mslabel:m}=l;const{kind:g}=e[u];return new pe((E,y)=>{const C=setTimeout(()=>{y(new Error("Cannot receive track, id: ".concat(p)))},1e4),I=j=>{const P=zt();if(P.name==="Safari"&&Number(P.version)===11&&j.track.id!==p&&j.streams[0].id===m){var U;const q=j.streams[0].getTracks()[0];return(U=this.remoteSDP)===null||U===void 0||U.updateTrackLabel(g,p,j.track.id),this.peerConnection.removeEventListener("track",I),clearTimeout(C),void E({track:q,id:p})}if(j.track.id===p)return this.peerConnection.removeEventListener("track",I),clearTimeout(C),void E({track:j.track,id:p})};this.peerConnection.addEventListener("track",I)})}),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(a),await pe.all(n)}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(n.toString()))}}async getRemoteSSRC(e){if(!this.remoteSDP)return;const n=this.remoteSDP.getSSRC(e);return n==null?void 0:n[0].ssrcId}setConfiguration(e){if(Kt().supportPCSetConfiguration){const n=ai.resolvePCConfiguration(e);this.peerConnection.setConfiguration(n)}}}function ra(i,e,n){const s=i[e];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const a=this.mutex,l=await a.lock("Locking from P2PConnection.".concat(e));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},n}function U6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Pu(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?U6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):U6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}be([ra,$("design:type",Function),$("design:paramtypes",[Object,Object,Array,Object,String,String]),$("design:returntype",pe)],ai.prototype,"connect",null),be([ra,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ai.prototype,"stopSending",null),be([ra,$("design:type",Function),$("design:paramtypes",[String,Array,String,Object]),$("design:returntype",pe)],ai.prototype,"receive",null),be([ra,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ai.prototype,"stopReceiving",null),be([ra,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],ai.prototype,"muteRemote",null),be([ra,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],ai.prototype,"unmuteRemote",null),be([ra,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ai.prototype,"muteLocal",null),be([ra,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ai.prototype,"unmuteLocal",null),be([ra,$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],ai.prototype,"close",null),be([ra,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],ai.prototype,"updateEncoderConfig",null),be([ra,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],ai.prototype,"updateSendParameters",null),be([ra,$("design:type",Function),$("design:paramtypes",[Di,String]),$("design:returntype",pe)],ai.prototype,"replaceTrack",null),be([ra,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],ai.prototype,"getRemoteSSRC",null);const _v="9",j6=4e4;function F6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Om(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?F6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):F6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class sr extends Jb{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,n;return(e=(n=this.peerConnection.getReceivers()[0])===null||n===void 0||(n=n.transport)===null||n===void 0?void 0:n.state)!==null&&e!==void 0?e:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").filter(e=>{var n;return je(n=Object.keys(du)).call(n,e)}))]}constructor(e,n){super(e,n),R(this,"store",void 0),R(this,"peerConnection",void 0),R(this,"remoteSDP",void 0),R(this,"initialOffer",void 0),R(this,"transportEventReceiver",void 0),R(this,"statsFilter",void 0),R(this,"useXR",Z("USE_XR")),R(this,"localCapabilities",void 0),R(this,"remoteCodecs",void 0),R(this,"localCandidateCount",0),R(this,"allCandidatesReceived",!1),R(this,"dataStreamChannelMap",new Map),R(this,"establishPromise",void 0),R(this,"recoveredDataChannelIds",[]),R(this,"currentDataChannelId",1),R(this,"mutex",new ii("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection(sr.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.statsFilter=VT(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,mn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async updateRemoteRTPCapabilities(e,n){if(this.remoteCodecs=n,!this.remoteSDP)return void N.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(n));if(this.remoteSDP.updateRemoteCodec(e,n,this.store.codec)){const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}else N.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const n=wc(e.sdp),s=await px({filterRTX:!Z("USE_PUB_RTX")&&!Z("USE_SUB_RTX"),filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterVideoCodec:Z("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=Im(s),this.initialOffer=e,Om(Om({},n),{},{rtpCapabilities:s,offerSDP:e.sdp})}catch(e){throw new ye(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,n,s,a,l,u){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{get localCapabilities(){return Cn(this._localCapabilities)}get rtpCapabilities(){return Cn(this._rtpCapabilities)}get candidates(){return Cn(this._candidates)}get iceParameters(){return Cn(this._iceParameters)}get dtlsParameters(){return Cn(this._dtlsParameters)}constructor(I){R(this,"sessionDesc",void 0),R(this,"_localCapabilities",void 0),R(this,"_rtpCapabilities",void 0),R(this,"_candidates",void 0),R(this,"_iceParameters",void 0),R(this,"_dtlsParameters",void 0),R(this,"setup",void 0),R(this,"currentMidIndex",void 0),R(this,"cname",void 0),R(this,"firefoxSsrcMidMap",new Map),I=Cn(I);const{remoteIceParameters:j,remoteDtlsParameters:P,candidates:U,remoteRTPCapabilities:q,remoteSetup:J,localCapabilities:se,cname:he}=I,ae=Fn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=q,this._candidates=U,this._iceParameters=j,this._dtlsParameters=P,this._localCapabilities=se,this.setup=J,this.cname=he;const de=this.rtpCapabilities.send;for(const me of ae.mediaDescriptions){if(me.attributes.iceUfrag=j.iceUfrag,me.attributes.icePwd=j.icePwd,me.attributes.fingerprints=P.fingerprints,me.attributes.candidates=U,me.attributes.setup=J,me.media.mediaType==="video"&&(me.media.fmts=de.videoCodecs.map(ge=>ge.payloadType.toString(10)),me.attributes.payloads=de.videoCodecs,me.attributes.extmaps=de.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:ge,ssrcGroups:Oe}=Fs([{ssrcId:j6,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);me.attributes.ssrcs=ge,me.attributes.ssrcGroups=Oe}if(me.media.mediaType==="audio"&&(me.media.fmts=de.audioCodecs.map(ge=>ge.payloadType.toString(10)),me.attributes.payloads=de.audioCodecs,me.attributes.extmaps=de.audioExtensions,Rc(me),Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:ge,ssrcGroups:Oe}=Fs([{ssrcId:2e4}],this.cname);me.attributes.ssrcs=ge,me.attributes.ssrcGroups=Oe}}this.sessionDesc=ae,this.currentMidIndex=ae.mediaDescriptions.length-1}preloadRemoteMedia(){const I=Z("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const j=this.candidates,P=this.dtlsParameters,U=this.iceParameters,q=this.rtpCapabilities.send;for(let J=1;J<I;J++){const se=2*J+2e4,he=2*J+j6,{ssrcs:ae,ssrcGroups:de}=Fs([{ssrcId:se}],this.cname),{ssrcs:me,ssrcGroups:ge}=Fs([{ssrcId:he,rtx:Z("USE_SUB_RTX")?he+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:_v,protos:["UDP","TLS","RTP","SAVPF"],fmts:q.videoCodecs.map(Oe=>Oe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:U.iceUfrag,icePwd:U.icePwd,unrecognized:[],candidates:j,extmaps:q.videoExtensions,fingerprints:P.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:me,ssrcGroups:ge,rtcpFeedbackWildcards:[],payloads:q.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*J)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:_v,protos:["UDP","TLS","RTP","SAVPF"],fmts:q.audioCodecs.map(Oe=>Oe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:U.iceUfrag,icePwd:U.icePwd,unrecognized:[],candidates:j,extmaps:q.audioExtensions,fingerprints:P.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:ae,ssrcGroups:de,rtcpFeedbackWildcards:[],payloads:q.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*J+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Fn.print(this.sessionDesc)}send(I,j,P,U){const{ssrcs:q,ssrcGroups:J}=Fs(j,this.cname,Z("SYNC_GROUP")?P:void 0),se=this.findPreloadMediaDesc(q);if(se){if(mn()&&this.firefoxSsrcMidMap.set(q[0].ssrcId,se.attributes.mid),U&&(U.twcc||U.remb)){const he=this.sessionDesc.mediaDescriptions.indexOf(se);return this.sessionDesc.mediaDescriptions[he]=this.mungSendMediaDesc(se,U),{mid:se.attributes.mid,needExchangeSDP:!0}}return{mid:se.attributes.mid,needExchangeSDP:!1}}{const he=this.findAvailableMediaIndex(I,q);let ae;return he===-1||he===1&&(vi()||x5())||he===0&&Z("USE_SUB_RTX")||P5()?(ae=this.createOrRecycleSendMedia(I,q,J,"sendonly",U),this.updateBundleMids()):(ae=Cn(this.sessionDesc.mediaDescriptions[he]),ae.attributes.direction="sendonly",ae.attributes.ssrcs=q,ae.attributes.ssrcGroups=J,this.sessionDesc.mediaDescriptions[he]=this.mungSendMediaDesc(ae,U)),mn()&&this.firefoxSsrcMidMap.set(q[0].ssrcId,ae.attributes.mid),{mid:ae.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:I,needExchangeSDP:j}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:I.attributes.mid,needExchangeSDP:j}}batchSend(I){const j=I.map(q=>{let{kind:J,ssrcMsg:se,mslabel:he}=q;return this.send(J,se,he)}),P=[];let U=!1;return j.forEach(q=>{let{mid:J,needExchangeSDP:se}=q;se&&(U=!0),P.push(J)}),{mids:P,needExchangeSDP:U}}stopSending(I){const j=this.sessionDesc.mediaDescriptions.filter(P=>P.attributes.mid&&I.indexOf(P.attributes.mid)!==-1);if(j.length!==I.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");j.forEach(P=>{P.attributes.mid==="0"||mn()||P5()?P.attributes.ssrcs=[]:(P.attributes.ssrcs=[],P.attributes.direction="inactive",P.media.port="0")}),this.updateBundleMids()}mute(I){const j=this.sessionDesc.mediaDescriptions.find(P=>P.attributes.mid===I);if(!j)throw new Error("mediaDescription not found with ".concat(I," in remote SDP when calling RemoteSDP.mute."));j.attributes.direction="inactive"}unmute(I){const j=this.sessionDesc.mediaDescriptions.find(P=>P.attributes.mid===I);if(!j)throw new Error("mediaDescription not found with ".concat(I," in remote SDP when calling RemoteSDP.unmute."));j.attributes.direction="sendonly"}muteRemote(I){const j=this.sessionDesc.mediaDescriptions.filter(P=>je(I).call(I,P.attributes.mid||""));if(j.length!==I.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");j.forEach(P=>{P.attributes.direction="inactive"})}unmuteRemote(I){const j=this.sessionDesc.mediaDescriptions.filter(P=>je(I).call(I,P.attributes.mid||""));if(j.length!==I.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");j.forEach(P=>{P.attributes.direction="recvonly"})}receive(I,j,P,U){I.forEach((q,J)=>{this.createOrRecycleRecvMedia(q,[],"recvonly",j,P,U[J])}),this.updateBundleMids()}stopReceiving(I){const j=this.sessionDesc.mediaDescriptions.filter(P=>I.indexOf(P.attributes.mid)!==-1);if(j.length!==I.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");j.forEach(P=>{P.media.port="0",P.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(I){const j=this._candidates.filter(P=>P.transport==="udp");if(I===Pi.TCP){if(j.length===0)return;if(Z("TCP_CANDIDATE_ONLY")){const P=this._candidates.filter(U=>U.transport==="tcp");j.forEach(U=>{P.findIndex(q=>q.connectionAddress===U.connectionAddress)===-1&&P.push(Pu(Pu({},U),{},{foundation:"tcpcandidate",priority:Number(U.priority)-1+"",transport:"tcp",port:Number(U.port)+90+""}))}),this._candidates=P}else{const P=[];j.forEach(U=>{P.push(Pu(Pu({},U),{},{foundation:"tcpcandidate",priority:Number(U.priority)-1+"",transport:"tcp",port:Number(U.port)+90+""}))}),this._candidates=[...j,...P]}}else if(I===Pi.RELAY){if(j.length!==0)return;{const P=this._candidates.filter(U=>U.transport==="tcp");P.forEach(U=>{j.push(Pu(Pu({},U),{},{foundation:"udpcandidate",priority:Number(U.priority)+1+"",transport:"udp",port:Number(U.port)-90+""}))}),this._candidates=[...j,...P]}}else j.length===0?(this._candidates.filter(P=>P.transport==="tcp").forEach(P=>{j.push(Pu(Pu({},P),{},{foundation:"udpcandidate",priority:Number(P.priority)+1+"",transport:"udp",port:Number(P.port)-90+""}))}),this._candidates=j):this._candidates=this._candidates.filter(P=>P.transport!=="tcp");for(const P of this.sessionDesc.mediaDescriptions)P.attributes.candidates=this.candidates}restartICE(I){I=Cn(I),this._iceParameters=I,this.sessionDesc.mediaDescriptions.forEach(j=>{j.attributes.iceUfrag=I.iceUfrag,j.attributes.icePwd=I.icePwd})}predictReceivingMids(I){const j=[];for(let P=0;P<I;P++)j.push((this.currentMidIndex+P+1).toString(10));return j}findAvailableMediaIndex(I,j){return this.sessionDesc.mediaDescriptions.findIndex(P=>{const U=P.media.mediaType===I&&P.media.port!=="0"&&(P.attributes.direction==="sendonly"||P.attributes.direction==="sendrecv")&&P.attributes.ssrcs.length===0;if(mn()){if(U){const q=this.firefoxSsrcMidMap.get(j[0].ssrcId);return!(q||P.attributes.mid!=="0"&&P.attributes.mid!=="1")||!(!q||q!==P.attributes.mid)}return!1}return U})}createOrRecycleDataChannel(){for(const P of this.sessionDesc.mediaDescriptions)if(P.media.mediaType==="application")return{mediaDesc:P,needExchangeSDP:!1};this.currentMidIndex+=1;const I="".concat(this.currentMidIndex),j={media:{mediaType:"application",port:_v,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(I),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(j),{mediaDesc:j,needExchangeSDP:!0}}createOrRecycleRecvMedia(I,j,P,U,q,J){const se=I._mediaStreamTrack.kind,he=this.rtpCapabilities.recv,ae=vp(se,he,this.localCapabilities.send,se===ze.VIDEO?U:q),de=se===ze.VIDEO?he.videoExtensions:he.audioExtensions;this.currentMidIndex+=1;const me="".concat(this.currentMidIndex);let ge={media:{mediaType:se,port:_v,protos:["UDP","TLS","RTP","SAVPF"],fmts:ae.map(De=>De.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:de,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:j,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:ae,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:P,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(me)}};ge=this.mungRecvMediaDsec(ge,I,J);const Oe=this.findFirstClosedMedia(se);if(Oe){const De=this.sessionDesc.mediaDescriptions.indexOf(Oe);this.sessionDesc.mediaDescriptions[De]=ge}else this.sessionDesc.mediaDescriptions.push(ge);return ge}updateRemoteCodec(I,j,P){const U=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(ge=>ge.rtpMap&&ge.rtpMap.encodingName.toLowerCase()||"").filter(ge=>{var Oe;return je(Oe=Object.keys(du)).call(Oe,ge)}))],q=new Set(j);if(U.every(ge=>q.has(ge)))return N.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(j)),!1;const J=this._rtpCapabilities.recv.videoCodecs.filter(ge=>j.some(Oe=>{var De;return je(De=ge.rtpMap&&ge.rtpMap.encodingName.toLowerCase()||"").call(De,Oe)}));if(J.length===0)return N.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(U," codecs: ").concat(j)),!1;const se=[...new Set(J.map(ge=>ge.rtpMap&&ge.rtpMap.encodingName.toLowerCase()||""))];let he;if(N.debug("updateRemoteCodec, from ".concat(U," to ").concat(se)),I.length===0)he=this.sessionDesc.mediaDescriptions.filter(ge=>ge.media.mediaType==="video"&&ge.attributes.direction==="recvonly");else if(he=this.sessionDesc.mediaDescriptions.filter(ge=>ge.attributes.mid&&je(I).call(I,ge.attributes.mid)&&ge.attributes.direction==="recvonly"),he.length!==I.length)return N.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(I,", codecs: ").concat(j)),!1;this._rtpCapabilities.recv.videoCodecs=J;const ae=this.localCapabilities.send,de=this.rtpCapabilities.recv,me=vp(ze.VIDEO,de,ae,P);return he.forEach(ge=>{const Oe=me.map(De=>De.payloadType.toString(10));N.debug("updateRemoteCodec mid: ".concat(ge.attributes.mid,", from ").concat(ge.attributes.payloads," to ").concat(me)),ge.attributes.payloads=me,ge.media.fmts=Oe}),!0}createOrRecycleSendMedia(I,j,P,U,q){const J=this.rtpCapabilities.send,se=I===ze.VIDEO?J.videoCodecs:J.audioCodecs,he=I===ze.VIDEO?J.videoExtensions:J.audioExtensions;this.currentMidIndex+=1;const ae="".concat(this.currentMidIndex);let de={media:{mediaType:I,port:_v,protos:["UDP","TLS","RTP","SAVPF"],fmts:se.map(ge=>ge.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:he,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:j,ssrcGroups:P,rtcpFeedbackWildcards:[],payloads:se,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:U,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(ae)}};de=this.mungSendMediaDesc(de,q);const me=this.findFirstClosedMedia(I);if(me){const ge=this.sessionDesc.mediaDescriptions.indexOf(me);this.sessionDesc.mediaDescriptions[ge]=de}else this.sessionDesc.mediaDescriptions.push(de);return de}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(I=>I.media.port!=="0").map(I=>I.attributes.mid)}mungRecvMediaDsec(I,j,P){const U=Cn(I);return BT(U),Nu(U,j),WT(U,j),ux(U),Rm(U,P,this.localCapabilities.send),U}mungSendMediaDesc(I,j){const P=Cn(I);return Rm(P,j,this.localCapabilities.recv),Rc(P),P}updateRecvMedia(I,j){const P=this.sessionDesc.mediaDescriptions.findIndex(U=>U.attributes.mid===I);if(P!==-1){const U=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[P],j);this.sessionDesc.mediaDescriptions[P]=U}}bumpMid(I){this.currentMidIndex+=I}findFirstClosedMedia(I){return this.sessionDesc.mediaDescriptions.find(j=>mn()?j.media.port==="0"&&j.media.mediaType===I:j.media.port==="0")}findPreloadMediaDesc(I){return this.sessionDesc.mediaDescriptions.find(j=>{var P;return((P=j.attributes)===null||P===void 0||(P=P.ssrcs[0])===null||P===void 0?void 0:P.ssrcId)===I[0].ssrcId})}getSSRC(I){var j;return(j=this.sessionDesc.mediaDescriptions.find(P=>P.attributes.mid===I))===null||j===void 0?void 0:j.attributes.ssrcs}}({remoteIceParameters:e,remoteDtlsParameters:n,candidates:s,remoteRTPCapabilities:a,remoteSetup:l,localCapabilities:this.localCapabilities,cname:u}),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const p=this.remoteSDP.toString(),m=Fn.parse(this.initialOffer.sdp),g=m.mediaDescriptions.find(I=>I.media.mediaType==="audio");g&&Rc(g),this.useXR&&pv(m);const E=Fn.print(m),y=this.logSDPExchange(E||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:E}),y==null||y(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p});const C=this.peerConnection.getTransceivers()[0];if(C!=null&&C.receiver&&this.tryBindTransportEvents(C.receiver),Z("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const I=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:I});const j=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(j)}}catch(p){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(p.toString()))}}send(e,n,s){var a=this;return no(function*(){const l=yield Ct(a.mutex.lock("From P2PConnection.send"));try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=[];e.forEach(P=>{const U=a.peerConnection.addTransceiver(P._mediaStreamTrack,{direction:"sendonly"});u.push(U),P._updateRtpTransceiver(U)}),mn()&&Z("SIMULCAST")===!0&&(yield Ct(a.applySimulcastForFirefox(u,e)));const p=yield Ct(a.peerConnection.createOffer()),m=a.remoteSDP.predictReceivingMids(e.length),g=a.mungSendOfferSDP(p.sdp,e,m),E=Fn.parse(g),y=m.map(P=>{const U=E.mediaDescriptions.find(q=>q.attributes.mid===P);if(!U)throw new Error("Cannot extract ssrc from mediaDescription.");return dx(U,Z("USE_PUB_RTX"))});let C;try{C=yield y}catch(P){C=[],a.remoteSDP.receive(e,n,s,C);const U=a.remoteSDP.toString();throw yield Ct(a.peerConnection.setLocalDescription({type:"offer",sdp:g})),yield Ct(a.peerConnection.setRemoteDescription({type:"answer",sdp:U})),yield Ct(a.stopSending(m,!0)),P}a.remoteSDP.receive(e,n,s,C);const I=a.remoteSDP.toString(),j=a.logSDPExchange(g,"offer","local","send");return yield Ct(a.peerConnection.setLocalDescription({type:"offer",sdp:g})),yield Ct(a.applySimulcastEncodings(u,e)),yield Ct(a.applySendEncodings(u,e)),j==null||j(I),yield Ct(a.peerConnection.setRemoteDescription({type:"answer",sdp:I})),u.map((P,U)=>{const q=m[U];return{localSSRC:y[U],id:q,transceiver:P}})}catch(u){throw u instanceof ye?u:new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async createDataChannels(e,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let s=this.dataStreamChannelMap.get(e);if(s&&s.readyState==="open")N.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const l=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof l!="number")throw new Error("create DataChannel error, because cannot get dc id");s=this.peerConnection.createDataChannel("datastream-channel",{id:l,negotiated:!0,ordered:!1,maxRetransmits:Z("DATASTREAM_MAX_RETRANSMITS")}),s.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,s)}n.forEach(l=>{l._updateOriginDataChannel(s)});const{needExchangeSDP:a}=this.remoteSDP.sendDataChannel();if(a){const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const u=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(u),N.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else N.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(s){throw s instanceof ye?s:new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(s.toString()))}}async stopDataChannels(e){try{const n=this.dataStreamChannelMap.get(e);return n&&(n.id&&this.recoveredDataChannelIds.push(n.id),n.close()),void this.dataStreamChannelMap.delete(e)}catch(n){throw n instanceof ye?n:new ye(z.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(n.toString()))}}async stopSending(e,n){const s=n?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const a=this.peerConnection.getTransceivers().filter(m=>e.indexOf(m.mid)!==-1);if(a.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");a.map(m=>{var g;m.direction="inactive",(g=m.stop)===null||g===void 0||g.call(m)});const l=await this.peerConnection.createOffer(),u=this.logSDPExchange(l.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(l),this.remoteSDP.stopReceiving(e);const p=this.remoteSDP.toString();u==null||u(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(a){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(a.toString()))}finally{s&&s()}}async receive(e,n,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:l,needExchangeSDP:u}=this.remoteSDP.send(e,n,s,a);if(u){const m=this.remoteSDP.toString(),g=this.logSDPExchange(m,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:m});const E=await this.peerConnection.createAnswer(),y=this.mungReceiveAnswerSDP(E.sdp,l,e);g==null||g(y||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:y}),N.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else N.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."));const p=this.peerConnection.getTransceivers().find(m=>m.mid===l);if(!p)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,id:l,transceiver:p}}catch(l){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:n,needExchangeSDP:s}=this.remoteSDP.batchSend(e);if(s){const a=this.remoteSDP.toString(),l=this.logSDPExchange(a,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const u=await this.peerConnection.createAnswer();l==null||l(u.sdp||""),await this.peerConnection.setLocalDescription(u),N.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else N.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return n.map(a=>{const l=this.peerConnection.getTransceivers().find(u=>u.mid===a);if(!l)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:l.receiver.track,id:a,transceiver:l}})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(n.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const n=this.remoteSDP.toString(),s=this.logSDPExchange(n,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const n=this.remoteSDP.toString(),s=this.logSDPExchange(n,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(n.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const n=this.remoteSDP.toString(),s=this.logSDPExchange(n,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(n.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(u=>u.mid&&e.indexOf(u.mid)!==-1);if(n.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(u=>{u.direction="inactive"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(e);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(u=>u.mid&&e.indexOf(u.mid)!==-1);if(n.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(async(u,p)=>{u.direction="sendonly"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(e);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new ye(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(n.toString()))}}restartICE(e){var n=this;return no(function*(){const s=yield Ct(n.mutex.lock("From P2PConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Kt().supportPCSetConfiguration){const g=n.peerConnection.getConfiguration(),E=e===Pi.RELAY?"relay":"all";g.iceTransportPolicy!==E&&(N.debug("[".concat(n.store.clientId,"] restartICE change iceTransportPolicy from [").concat(g.iceTransportPolicy,"] to [").concat(E,"]")),g.iceTransportPolicy=E,n.peerConnection.setConfiguration(g))}else if(e===Pi.RELAY)return;n.remoteSDP.updateCandidates(e);const a=yield Ct(n.peerConnection.createOffer({iceRestart:!0}));if(!a.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const l=wc(a.sdp),{remoteIceParameters:u}=yield l.iceParameters;n.remoteSDP.restartICE(u);const p=n.remoteSDP.toString(),m=n.logSDPExchange(a.sdp||"","offer","local","restartICE");n.store.descriptionStart(),yield Ct(n.peerConnection.setLocalDescription(a)),m==null||m(p),yield Ct(n.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(a){N.warning("[".concat(n.store.clientId,"] restart ICE failed, abort operation"),a)}finally{s()}})()}close(){var e;this.peerConnection.close(),(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),a=this.mungSendOfferSDP(s.sdp,[n],[e]);this.remoteSDP.updateRecvMedia(e,n);const l=this.remoteSDP.toString(),u=this.logSDPExchange(a,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),u==null||u(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new ye(z.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(e,n){const s=this.peerConnection.getTransceivers().filter(a=>a.mid===e);s.length===1&&(this.isVP8Simulcast(n)?mn()||await this.applySimulcastEncodings(s,[n]):await this.applySendEncodings(s,[n]))}setStatsRemoteVideoIsReady(e,n){this.statsFilter.setVideoIsReady2(e,n)}async replaceTrack(e,n){const s=this.peerConnection.getTransceivers().find(a=>a.mid===n);s&&await s.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const n=e[0].transport.iceTransport,{local:s,remote:a}=n.getSelectedCandidatePair();return{local:Om(Om({},gl),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:Om(Om({},gl),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;(e=this.onICEConnectionStateChange)===null||e===void 0||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,N.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,N.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const n={iceServers:[]};return e.iceServers?n.iceServers=e.iceServers:e.turnServer&&e.turnServer.mode!=="off"&&(Yf(e.turnServer.servers)?n.iceServers=e.turnServer.servers:(n.iceServers&&n.iceServers.push(...sr.turnServerConfigToIceServers(e.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&e.turnServer.serversFromGateway&&n.iceServers.push(...sr.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(n.iceTransportPolicy="relay")}))),Z("ENABLE_ENCODED_TRANSFORM")&&Kt().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(e){const n=[];return e.forEach(s=>{s.security?s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(gu(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Z("FORCE_TURN_TCP")&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),n}tryBindTransportEvents(e){const n=e.transport;if(n){this.transportEventReceiver=e,n.onstatechange=()=>{var a;n!=null&&n.state&&((a=this.onDTLSTransportStateChange)===null||a===void 0||a.call(this,n.state))},n.onerror=a=>{var l;(l=this.onDTLSTransportError)===null||l===void 0||l.call(this,"error"in a?a.error:a)};const s=n.iceTransport;s&&(s.onstatechange=()=>{const a=n==null?void 0:n.iceTransport.state;var l;a&&((l=this.onICETransportStateChange)===null||l===void 0||l.call(this,a))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:a,remote:l}=s.getSelectedCandidatePair();N.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:a.type,protocol:a.protocol}),", remote ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,n){var s;if(n||(n=this.peerConnection.getSenders().find(E=>E.track===e._mediaStreamTrack)),!n)return N.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return N.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Kt().supportSetRtpSenderParameters)return N.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const a={},l={};switch(e._optimizationMode){case"motion":a.degradationPreference="maintain-framerate";break;case"detail":a.degradationPreference="maintain-resolution";break;default:a.degradationPreference="balanced"}if(e._encoderConfig){var u;const{bitrateMax:E,frameRate:y,scaleResolutionDownBy:C}=e._encoderConfig;E&&(l.maxBitrate=1e3*E),(je(u=e._hints).call(u,wn.LOW_STREAM)||e.isUseScaleResolutionDownBy)&&(y&&(l.maxFramerate=To(y)),C&&C>=1&&(l.scaleResolutionDownBy=C))}if(Z("DSCP_TYPE")&&au()){var p;const E=Z("DSCP_TYPE");je(p=["very-low","low","medium","high"]).call(p,E)&&(l.networkPriority=E)}const m=n.getParameters(),g=(s=m.encodings)===null||s===void 0?void 0:s[0];mn()&&!g&&(a.encodings=[l]),g&&Object.assign(g,l),Object.assign(m,a),N.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(m.encodings))),await n.setParameters(m)}async applySendEncodings(e,n){try{if(!Kt().supportSetRtpSenderParameters||e.length!==n.length)return;for(let s=0;s<e.length;s++){const a=e[s],l=n[s];l instanceof At&&!this.isVP8Simulcast(l)&&await this.updateRtpSenderEncodings(l,a.sender)}}catch{N.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,n,s){const a=Fn.parse(e);return n.forEach((l,u)=>{const p=s[u],m=a.mediaDescriptions.find(g=>g.attributes.mid===p);m&&(Nu(m,l),hx(m,l,this.store.codec))}),Fn.print(a)}mungReceiveAnswerSDP(e,n,s){const a=Fn.parse(e),l=a.mediaDescriptions.find(u=>u.attributes.mid===n);return l&&(s===ze.AUDIO&&l.media.mediaType==="audio"&&Rc(l),this.useXR&&pv(a)),Fn.print(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,n,s)=>{var a;(a=this.onFirstVideoDecoded)===null||a===void 0||a.call(this,e,n,s)},this.statsFilter.onSelectedLocalCandidateChanged=(e,n)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,e,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,n)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,e,n)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var n;(n=this.onFirstVideoDecodedTimeout)===null||n===void 0||n.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,n){if(e.length===n.length)for(let m=0;m<e.length;m++){var s,a,l,u,p;const g=e[m],E=n[m];if(E instanceof At&&!je(s=E._hints).call(s,wn.LOW_STREAM)&&(a=E._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=E._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=E._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=E._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const y={},C={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};y.encodings=[{rid:"m",active:!0,maxBitrate:C.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:C.high}];const I=g.sender.getParameters();await g.sender.setParameters(Object.assign(I,y))}}}async applySimulcastEncodings(e,n){if(!mn()&&e.length===n.length)for(let s=0;s<e.length;s++){const a=n[s];if(a instanceof At&&this.isVP8Simulcast(a)){const l=e[s],u={},p={high:1e3*(a._encoderConfig.bitrateMax-50),medium:5e4};u.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const m=l.sender.getParameters();await l.sender.setParameters(Object.assign(m,u))}}}isVP8Simulcast(e){var n,s,a,l,u;return!!(e instanceof At&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!je(n=e._hints).call(n,wn.LOW_STREAM)&&(s=e._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((a=e._encoderConfig)===null||a===void 0?void 0:a.bitrateMax)>200&&(l=e._scalabilityMode)!==null&&l!==void 0&&l.numSpatialLayers&&((u=e._scalabilityMode)===null||u===void 0?void 0:u.numSpatialLayers)>1)}logSDPExchange(e,n,s,a){if(Z("SDP_LOGGING"))return N.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(n," SDP during P2PConnection.").concat(a,`
`),e),n==="offer"?l=>{this.logSDPExchange(l,"answer",s==="local"?"remote":"local",a)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const n=this.remoteSDP.getSSRC(e);return n==null?void 0:n[0].ssrcId}setConfiguration(e){if(Kt().supportPCSetConfiguration){const n=sr.resolvePCConfiguration(e);this.peerConnection.setConfiguration(n)}}}function ro(i,e,n){const s=i[e];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const a=this.mutex,l=await a.lock("From P2PConnection.".concat(e));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},n}function V6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function B6(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?V6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):V6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}be([ro,$("design:type",Function),$("design:paramtypes",[Array,Array]),$("design:returntype",pe)],sr.prototype,"updateRemoteRTPCapabilities",null),be([ro,$("design:type",Function),$("design:paramtypes",[Object,Object,Array,Object,String,String]),$("design:returntype",pe)],sr.prototype,"connect",null),be([ro,$("design:type",Function),$("design:paramtypes",[Object,Array]),$("design:returntype",pe)],sr.prototype,"createDataChannels",null),be([ro,$("design:type",Function),$("design:paramtypes",[String,Array,String,Object]),$("design:returntype",pe)],sr.prototype,"receive",null),be([ro,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],sr.prototype,"batchReceive",null),be([ro,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],sr.prototype,"stopReceiving",null),be([ro,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],sr.prototype,"muteRemote",null),be([ro,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],sr.prototype,"unmuteRemote",null),be([ro,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],sr.prototype,"muteLocal",null),be([ro,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],sr.prototype,"unmuteLocal",null),be([ro,$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],sr.prototype,"close",null),be([ro,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],sr.prototype,"updateEncoderConfig",null),be([ro,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],sr.prototype,"updateSendParameters",null),be([ro,$("design:type",Function),$("design:paramtypes",[Di,String]),$("design:returntype",pe)],sr.prototype,"replaceTrack",null),be([ro,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],sr.prototype,"getRemoteSSRC",null);const W6=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,zT="9",vx=2e4,yx=4e4;class Oce{get localCapabilities(){return Cn(this._localCapabilities)}get rtpCapabilities(){return Cn(this._rtpCapabilities)}get candidates(){return Cn(this._candidates)}get iceParameters(){return Cn(this._iceParameters)}get dtlsParameters(){return Cn(this._dtlsParameters)}constructor(e){R(this,"sessionDesc",void 0),R(this,"_localCapabilities",void 0),R(this,"_rtpCapabilities",void 0),R(this,"_candidates",void 0),R(this,"_iceParameters",void 0),R(this,"_dtlsParameters",void 0),R(this,"setup",void 0),R(this,"currentMidIndex",void 0),R(this,"cname",void 0),R(this,"firefoxSsrcMidMap",new Map),e=Cn(e);const{remoteIceParameters:n,remoteDtlsParameters:s,candidates:a,remoteRTPCapabilities:l,remoteSetup:u,localCapabilities:p,cname:m}=e,g=Fn.parse(W6);this._rtpCapabilities=l,this._candidates=a,this._iceParameters=n,this._dtlsParameters=s,this._localCapabilities=p,this.setup=u,this.cname=m;const E=this.rtpCapabilities.send;for(const y of g.mediaDescriptions){if(y.attributes.iceUfrag=n.iceUfrag,y.attributes.icePwd=n.icePwd,y.attributes.fingerprints=s.fingerprints,y.attributes.candidates=a,y.attributes.setup=u,y.media.mediaType==="application"&&(y.attributes.sctpPort="5000"),y.media.mediaType==="video"&&(y.media.fmts=E.videoCodecs.map(C=>C.payloadType.toString(10)),y.attributes.payloads=E.videoCodecs,y.attributes.extmaps=E.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:C,ssrcGroups:I}=Fs([{ssrcId:yx,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);y.attributes.ssrcs=C,y.attributes.ssrcGroups=I}if(y.media.mediaType==="audio"&&(y.media.fmts=E.audioCodecs.map(C=>C.payloadType.toString(10)),y.attributes.payloads=E.audioCodecs,y.attributes.extmaps=E.audioExtensions,Rc(y),Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:C,ssrcGroups:I}=Fs([{ssrcId:vx}],this.cname);y.attributes.ssrcs=C,y.attributes.ssrcGroups=I}}this.sessionDesc=g,this.currentMidIndex=g.mediaDescriptions.length-1}updateRemoteRTPCapabilities(e){const n=Fn.parse(W6);this._rtpCapabilities=e;const s=this.rtpCapabilities.send;for(const a of n.mediaDescriptions){if(a.attributes.iceUfrag=this._iceParameters.iceUfrag,a.attributes.icePwd=this._iceParameters.icePwd,a.attributes.fingerprints=this._dtlsParameters.fingerprints,a.attributes.candidates=this._candidates,a.attributes.setup=this.setup,a.media.mediaType==="application"&&(a.attributes.sctpPort="5000"),a.media.mediaType==="video"&&(a.media.fmts=s.videoCodecs.map(l=>l.payloadType.toString(10)),a.attributes.payloads=s.videoCodecs,a.attributes.extmaps=s.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:l,ssrcGroups:u}=Fs([{ssrcId:yx,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);a.attributes.ssrcs=l,a.attributes.ssrcGroups=u}if(a.media.mediaType==="audio"&&(a.media.fmts=s.audioCodecs.map(l=>l.payloadType.toString(10)),a.attributes.payloads=s.audioCodecs,a.attributes.extmaps=s.audioExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:l,ssrcGroups:u}=Fs([{ssrcId:vx}],this.cname);a.attributes.ssrcs=l,a.attributes.ssrcGroups=u}}this.sessionDesc=n,this.currentMidIndex=n.mediaDescriptions.length-1}preloadRemoteMedia(e){this.rtpCapabilities;const n=this.candidates,s=this.dtlsParameters,a=this.iceParameters,l=this.rtpCapabilities.send;for(let u=1;u<e;u++){const p=2*u+vx,m=2*u+yx,{ssrcs:g,ssrcGroups:E}=Fs([{ssrcId:p}],this.cname),{ssrcs:y,ssrcGroups:C}=Fs([{ssrcId:m,rtx:Z("USE_SUB_RTX")?m+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:zT,protos:["UDP","TLS","RTP","SAVPF"],fmts:l.videoCodecs.map(I=>I.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:a.iceUfrag,icePwd:a.icePwd,unrecognized:[],candidates:n,extmaps:l.videoExtensions,fingerprints:s.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:y,ssrcGroups:C,rtcpFeedbackWildcards:[],payloads:l.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*u-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:zT,protos:["UDP","TLS","RTP","SAVPF"],fmts:l.audioCodecs.map(I=>I.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:a.iceUfrag,icePwd:a.icePwd,unrecognized:[],candidates:n,extmaps:l.audioExtensions,fingerprints:s.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:g,ssrcGroups:E,rtcpFeedbackWildcards:[],payloads:l.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*u)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Fn.print(this.sessionDesc)}send(e,n,s,a){const{ssrcs:l,ssrcGroups:u}=Fs(n,this.cname,Z("SYNC_GROUP")?s:void 0),p=this.findPreloadMediaDesc(l);if(p){if(mn()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,p.attributes.mid),a&&(a.twcc||a.remb)){const m=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(p,a),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const m=this.findAvailableMediaIndex(e,l);let g;return m===-1||vi()||ts()||x5()||m===0&&Z("USE_SUB_RTX")?(g=this.createOrRecycleSendMedia(e,l,u,"sendonly",a),this.updateBundleMids()):(g=Cn(this.sessionDesc.mediaDescriptions[m]),g.attributes.direction="sendonly",g.attributes.ssrcs=l,g.attributes.ssrcGroups=u,this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(g,a)),mn()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,g.attributes.mid),{mid:g.attributes.mid,needExchangeSDP:!0}}}batchSend(e){const n=e.map(l=>{let{kind:u,ssrcMsg:p,mslabel:m}=l;return this.send(u,p,m)}),s=[];let a=!1;return n.forEach(l=>{let{mid:u,needExchangeSDP:p}=l;p&&(a=!0),s.push(u)}),{mids:s,needExchangeSDP:a}}stopSending(e){const n=this.sessionDesc.mediaDescriptions.filter(s=>s.attributes.mid&&e.indexOf(s.attributes.mid)!==-1);if(n.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");n.forEach(s=>{s.attributes.mid==="0"||mn()||vi()||ts()?s.attributes.ssrcs=[]:(s.attributes.ssrcs=[],s.attributes.direction="inactive",s.media.port="0")}),this.updateBundleMids()}mute(e){const n=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===e);if(!n)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));n.attributes.direction="inactive"}unmute(e){const n=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===e);if(!n)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));n.attributes.direction="sendonly"}muteRemote(e){const n=this.sessionDesc.mediaDescriptions.filter(s=>je(e).call(e,s.attributes.mid||""));if(n.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(s=>{s.attributes.direction="inactive"})}unmuteRemote(e){const n=this.sessionDesc.mediaDescriptions.filter(s=>je(e).call(e,s.attributes.mid||""));if(n.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(s=>{s.attributes.direction="recvonly"})}receive(e,n,s,a){e.forEach((l,u)=>{this.createOrRecycleRecvMedia(l,[],"recvonly",n,s,a[u])}),this.updateBundleMids()}stopReceiving(e){const n=this.sessionDesc.mediaDescriptions.filter(s=>e.indexOf(s.attributes.mid)!==-1);if(n.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");n.forEach(s=>{s.media.port="0",s.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(e){e===Pi.TCP?this._candidates.forEach(n=>{this._candidates.findIndex(s=>s.transport==="tcp"&&s.connectionAddress===n.connectionAddress&&s.port===n.port)===-1&&this._candidates.push(B6(B6({},n),{},{foundation:"tcpcandidate",priority:Number(n.priority)-1+"",transport:"tcp",port:Number(n.port)+90+""}))}):this._candidates=this._candidates.filter(n=>n.transport!=="tcp");for(const n of this.sessionDesc.mediaDescriptions)n.attributes.candidates=this.candidates}restartICE(e){e=Cn(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(n=>{n.attributes.iceUfrag=e.iceUfrag,n.attributes.icePwd=e.icePwd})}predictReceivingMids(e){const n=[];for(let s=0;s<e;s++)n.push((this.currentMidIndex+s+1).toString(10));return n}findAvailableMediaIndex(e,n){return this.sessionDesc.mediaDescriptions.findIndex(s=>{const a=s.media.mediaType===e&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0;if(mn()){if(a){const l=this.firefoxSsrcMidMap.get(n[0].ssrcId);return!(l||s.attributes.mid!=="0"&&s.attributes.mid!=="1")||!(!l||l!==s.attributes.mid)}return!1}return a})}createOrRecycleRecvMedia(e,n,s,a,l,u){const p=e._mediaStreamTrack.kind,m=this.rtpCapabilities.recv,g=vp(p,m,this.localCapabilities.send,p===ze.VIDEO?a:l),E=p===ze.VIDEO?m.videoExtensions:m.audioExtensions;this.currentMidIndex+=1;const y="".concat(this.currentMidIndex);let C={media:{mediaType:p,port:zT,protos:["UDP","TLS","RTP","SAVPF"],fmts:g.map(j=>j.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:E,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:g,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};C=this.mungRecvMediaDsec(C,e,u);const I=this.findFirstClosedMedia(p);if(I){const j=this.sessionDesc.mediaDescriptions.indexOf(I);this.sessionDesc.mediaDescriptions[j]=C}else this.sessionDesc.mediaDescriptions.push(C);return C}updateRemoteCodec(e,n,s){const a=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(C=>C.rtpMap&&C.rtpMap.encodingName.toLowerCase()||"").filter(C=>{var I;return je(I=Object.keys(du)).call(I,C)}))],l=new Set(n);if(a.every(C=>l.has(C)))return N.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(n)),!1;const u=this._rtpCapabilities.recv.videoCodecs.filter(C=>n.some(I=>{var j;return je(j=C.rtpMap&&C.rtpMap.encodingName.toLowerCase()||"").call(j,I)}));if(u.length===0)return N.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(a," codecs: ").concat(n)),!1;const p=[...new Set(u.map(C=>C.rtpMap&&C.rtpMap.encodingName.toLowerCase()||""))];let m;if(N.debug("updateRemoteCodec, from ".concat(a," to ").concat(p)),e.length===0)m=this.sessionDesc.mediaDescriptions.filter(C=>C.media.mediaType==="video"&&C.attributes.direction==="recvonly");else if(m=this.sessionDesc.mediaDescriptions.filter(C=>C.attributes.mid&&je(e).call(e,C.attributes.mid)&&C.attributes.direction==="recvonly"),m.length!==e.length)return N.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(n)),!1;this._rtpCapabilities.recv.videoCodecs=u;const g=this.localCapabilities.send,E=this.rtpCapabilities.recv,y=vp(ze.VIDEO,E,g,s);return m.forEach(C=>{const I=y.map(j=>j.payloadType.toString(10));N.debug("updateRemoteCodec mid: ".concat(C.attributes.mid,", from ").concat(C.attributes.payloads," to ").concat(y)),C.attributes.payloads=y,C.media.fmts=I}),!0}createOrRecycleSendMedia(e,n,s,a,l){const u=this.rtpCapabilities.send,p=e===ze.VIDEO?u.videoCodecs:u.audioCodecs,m=e===ze.VIDEO?u.videoExtensions:u.audioExtensions;this.currentMidIndex+=1;const g="".concat(this.currentMidIndex);let E={media:{mediaType:e,port:zT,protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(C=>C.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:s,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(g)}};E=this.mungSendMediaDesc(E,l);const y=this.findFirstClosedMedia(e);if(y){const C=this.sessionDesc.mediaDescriptions.indexOf(y);this.sessionDesc.mediaDescriptions[C]=E}else this.sessionDesc.mediaDescriptions.push(E);return E}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}mungRecvMediaDsec(e,n,s){const a=Cn(e);return BT(a),Nu(a,n),WT(a,n),ux(a),Rm(a,s,this.localCapabilities.send),a}mungSendMediaDesc(e,n){const s=Cn(e);return Rm(s,n,this.localCapabilities.recv),Rc(s),s}updateRecvMedia(e,n){const s=this.sessionDesc.mediaDescriptions.findIndex(a=>a.attributes.mid===e);if(s!==-1){const a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],n);this.sessionDesc.mediaDescriptions[s]=a}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(n=>mn()?n.media.port==="0"&&n.media.mediaType===e:n.media.port==="0")}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(n=>{var s;return((s=n.attributes)===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId)===e[0].ssrcId})}getSSRC(e){var n;return(n=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===e))===null||n===void 0?void 0:n.attributes.ssrcs}}function $6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function KT(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):$6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}class Ui extends Jb{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){let e;return this.localCapabilities&&(e=Im(this.localCapabilities)),[...new Set(e&&e.send.videoCodecs.map(n=>n.rtpMap&&n.rtpMap.encodingName.toLowerCase()||"").filter(n=>{var s;return je(s=Object.keys(du)).call(s,n)}))]}constructor(e,n,s){super(e,n),R(this,"store",void 0),R(this,"peerConnection",void 0),R(this,"remoteSDP",void 0),R(this,"initialOffer",void 0),R(this,"transportEventReceiver",void 0),R(this,"statsFilter",void 0),R(this,"useXR",Z("USE_XR")),R(this,"localCapabilities",void 0),R(this,"localCandidateCount",0),R(this,"allCandidatesReceived",!1),R(this,"remoteCodecs",void 0),R(this,"dataStreamChannelMap",new Map),R(this,"establishPromise",void 0),R(this,"mutex",new ii("NVExtentionsConnection-mutex")),R(this,"rtcMedia",void 0),this.store=n,this.peerConnection=s,this.statsFilter=VT(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,mn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(e){try{const n=await this.peerConnection.createOffer();if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=wc(n.sdp),a=await px({filterRTX:!Z("USE_PUB_RTX")&&!Z("USE_SUB_RTX"),filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterVideoCodec:Z("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=a,this.initialOffer=n,KT(KT({},s),{},{rtpCapabilities:a,offerSDP:n.sdp})}catch(n){throw new le(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}}async connect(e,n,s,a,l,u){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new Oce({remoteIceParameters:e,remoteDtlsParameters:n,candidates:s,remoteRTPCapabilities:a,remoteSetup:l,localCapabilities:Im(this.localCapabilities),cname:u});const p=this.remoteSDP.toString(),m=Fn.parse(this.initialOffer.sdp),g=m.mediaDescriptions.find(C=>C.media.mediaType==="audio");g&&Rc(g),this.useXR&&pv(m);const E=Fn.print(m),y=this.logSDPExchange(E||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:E}),y==null||y(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(p){throw new le(z.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(p.toString()))}}async updateRemoteRTPCapabilities(e,n){if(this.remoteCodecs=n,!this.remoteSDP)return void N.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(n));if(this.remoteSDP.updateRemoteCodec(e,n,this.store.codec)){const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}else N.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async updateRemoteConnect(e){var n,s,a,l;(n=this.remoteSDP)===null||n===void 0||n.updateRemoteRTPCapabilities(e),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&((l=this.remoteSDP)===null||l===void 0||l.updateRemoteCodec([],this.remoteCodecs,this.store.codec)),(s=this.remoteSDP)===null||s===void 0||s.preloadRemoteMedia(2);const u=(a=this.remoteSDP)===null||a===void 0?void 0:a.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const p=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(p),N.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(e,n,s){var a=this;return no(function*(){const l=yield Ct(a.mutex.lock("From NVExtentionsConnection.send"));try{if(!a.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const u=[];e.forEach(P=>{const U=a.peerConnection.addTransceiver(P._mediaStreamTrack,{direction:"sendonly"});u.push(U)}),mn()&&Z("SIMULCAST")===!0&&(yield Ct(a.applySimulcastForFirefox(u,e)));const p=yield Ct(a.peerConnection.createOffer()),m=a.remoteSDP.predictReceivingMids(e.length),g=a.mungSendOfferSDP(p.sdp,e,m),E=Fn.parse(g),y=m.map(P=>{const U=E.mediaDescriptions.find(q=>q.attributes.mid===P);if(!U)throw new Error("Cannot extract ssrc from mediaDescription.");return dx(U,Z("USE_PUB_RTX"))});let C;try{C=yield y}catch(P){C=[],a.remoteSDP.receive(e,n,s,C);const U=a.remoteSDP.toString();throw yield Ct(a.peerConnection.setLocalDescription({type:"offer",sdp:g})),yield Ct(a.peerConnection.setRemoteDescription({type:"answer",sdp:U})),yield Ct(a.stopSending(m,!0)),P}a.remoteSDP.receive(e,n,s,C);const I=a.remoteSDP.toString(),j=a.logSDPExchange(g,"offer","local","send");return yield Ct(a.peerConnection.setLocalDescription({type:"offer",sdp:g})),yield Ct(a.applySimulcastEncodings(u,e)),yield Ct(a.applySendEncodings(u,e)),j==null||j(I),yield Ct(a.peerConnection.setRemoteDescription({type:"answer",sdp:I})),u.map((P,U)=>{const q=m[U];return{localSSRC:y[U],id:q,transceiver:P}})}catch(u){throw u instanceof le?u:new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async stopSending(e,n){const s=n?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const a=this.peerConnection.getTransceivers().filter(m=>e.indexOf(m.mid)!==-1);if(a.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");a.map(m=>{var g;m.direction="inactive",(g=m.stop)===null||g===void 0||g.call(m)});const l=await this.peerConnection.createOffer(),u=this.logSDPExchange(l.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(l),this.remoteSDP.stopReceiving(e);const p=this.remoteSDP.toString();u==null||u(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(a){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(a.toString()))}finally{s&&s()}}async createDataChannels(e,n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.createDataChannels before remote SDP created");let s=this.dataStreamChannelMap.get(e);return s&&s.readyState==="open"?N.debug("[P2PConnection] Channels are already available and can be reused directly."):(s=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:Z("DATASTREAM_MAX_RETRANSMITS")}),s.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,s)),void n.forEach(a=>{a._updateOriginDataChannel(s)})}catch(s){throw s instanceof le?s:new le(z.DATACHANNEL_FAILED,"NVExtentionsConnection.createDataChannels failed; ".concat(s.toString()))}}async stopDataChannels(e){try{const n=this.dataStreamChannelMap.get(e);return n==null||n.close(),void this.dataStreamChannelMap.delete(e)}catch(n){throw n instanceof le?n:new le(z.DATACHANNEL_FAILED,"NVExtentionsConnection.stopDataChannels failed; ".concat(n.toString()))}}async receive(e,n,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(e," before remoteSDP created."));const{mid:l,needExchangeSDP:u}=this.remoteSDP.send(e,n,s,a);if(u){const m=this.remoteSDP.toString(),g=this.logSDPExchange(m,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:m});const E=await this.peerConnection.createAnswer(),y=this.mungReceiveAnswerSDP(E.sdp,l,e);g==null||g(y||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:y}),N.debug("[NVExtentionsConnection] receive ".concat(e," by exchanging SDP."))}else N.debug("[NVExtentionsConnection] receive ".concat(e," no need to exchange SDP."));const p=this.peerConnection.getTransceivers().find(m=>m.mid===l);if(!p)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,id:l}}catch(l){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(l.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:n,needExchangeSDP:s}=this.remoteSDP.batchSend(e);if(s){const a=this.remoteSDP.toString(),l=this.logSDPExchange(a,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const u=await this.peerConnection.createAnswer();l==null||l(u.sdp||""),await this.peerConnection.setLocalDescription(u),N.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else N.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return n.map(a=>{const l=this.peerConnection.getTransceivers().find(u=>u.mid===a);if(!l)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:l.receiver.track,id:a}})}catch(n){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(n.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const n=this.remoteSDP.toString(),s=this.logSDPExchange(n,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(n){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(n.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const n=this.remoteSDP.toString(),s=this.logSDPExchange(n,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(n){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(n.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const n=this.remoteSDP.toString(),s=this.logSDPExchange(n,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(n){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(n.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(u=>u.mid&&e.indexOf(u.mid)!==-1);if(n.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(u=>{u.direction="inactive"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(e);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(u=>u.mid&&e.indexOf(u.mid)!==-1);if(n.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(async(u,p)=>{u.direction="sendonly"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(e);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new le(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(n.toString()))}}restartICE(e){var n=this;return no(function*(){const s=yield Ct(n.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Kt().supportPCSetConfiguration){const g=n.peerConnection.getConfiguration(),E=e===Pi.RELAY?"relay":"all";g.iceTransportPolicy!==E&&(N.debug("restartICE change iceTransportPolicy from [".concat(g.iceTransportPolicy,"] to [").concat(E,"]")),g.iceTransportPolicy=E,n.peerConnection.setConfiguration(g))}else if(e===Pi.RELAY)return;e!==Pi.RELAY&&n.remoteSDP.updateCandidates(e);const a=yield Ct(n.peerConnection.createOffer({iceRestart:!0}));if(!a.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const l=wc(a.sdp),{remoteIceParameters:u}=yield l.iceParameters;n.remoteSDP.restartICE(u);const p=n.remoteSDP.toString(),m=n.logSDPExchange(a.sdp||"","offer","local","restartICE");yield Ct(n.peerConnection.setLocalDescription(a)),m==null||m(p),yield Ct(n.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(a){N.warning("restart ICE failed, abort operation",a)}finally{s()}})()}close(){var e;(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),a=this.mungSendOfferSDP(s.sdp,[n],[e]);this.remoteSDP.updateRecvMedia(e,n);const l=this.remoteSDP.toString(),u=this.logSDPExchange(a,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),u==null||u(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new le(z.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(e,n){const s=this.peerConnection.getTransceivers().filter(a=>a.mid===e);s.length===1&&(this.isVP8Simulcast(n)?mn()||await this.applySimulcastEncodings(s,[n]):await this.applySendEncodings(s,[n]))}setStatsRemoteVideoIsReady(e,n){this.statsFilter.setVideoIsReady2(e,n)}async replaceTrack(e,n){const s=this.peerConnection.getTransceivers().find(a=>a.mid===n);s&&await s.sender.replaceTrack(e._mediaStreamTrack)}getP2PConnectionParams(){var e;if((e=this.peerConnection.currentLocalDescription)===null||e===void 0||!e.sdp||!this.localCapabilities)throw new Error;return KT(KT({},wc(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;(e=this.onICEConnectionStateChange)===null||e===void 0||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;(e=this.onConnectionStateChange)===null||e===void 0||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,N.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const n={iceServers:[]};return e.iceServers?n.iceServers=e.iceServers:e.turnServer&&e.turnServer.mode!=="off"&&(Yf(e.turnServer.servers)?n.iceServers=e.turnServer.servers:(n.iceServers&&n.iceServers.push(...Ui.turnServerConfigToIceServers(e.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&e.turnServer.serversFromGateway&&n.iceServers.push(...Ui.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(e){const n=[];return e.forEach(s=>{s.security?s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(gu(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Z("FORCE_TURN_TCP")&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),n}async applySendEncodings(e,n){try{if(!Kt().supportSetRtpSenderParameters||e.length!==n.length)return;for(let y=0;y<e.length;y++){const C=e[y],I=n[y];if(I&&I instanceof At){var s,a,l;if(this.isVP8Simulcast(I))continue;const j={},P={};switch(I._optimizationMode){case"motion":j.degradationPreference="maintain-framerate";break;case"detail":j.degradationPreference="maintain-resolution";break;default:j.degradationPreference="balanced"}var u,p,m,g;if((s=I._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&(P.maxBitrate=1e3*((u=I._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)),je(a=I._hints).call(a,wn.LOW_STREAM)&&((p=I._encoderConfig)!==null&&p!==void 0&&p.frameRate&&(P.maxFramerate=To(I._encoderConfig.frameRate)),(m=I._encoderConfig)!==null&&m!==void 0&&m.scaleResolutionDownBy&&((g=I._encoderConfig)===null||g===void 0?void 0:g.scaleResolutionDownBy)>1&&(P.scaleResolutionDownBy=I._encoderConfig.scaleResolutionDownBy)),Z("DSCP_TYPE")&&au()){var E;const J=Z("DSCP_TYPE");je(E=["very-low","low","medium","high"]).call(E,J)&&(P.networkPriority=J)}const U=C.sender.getParameters(),q=(l=U.encodings)===null||l===void 0?void 0:l[0];mn()&&!q&&(j.encodings=[P]),q&&Object.assign(q,P),Object.assign(U,j),await C.sender.setParameters(U)}}}catch{N.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(e,n,s){const a=Fn.parse(e);return n.forEach((l,u)=>{const p=s[u],m=a.mediaDescriptions.find(g=>g.attributes.mid===p);m&&(Nu(m,l),hx(m,l,this.store.codec))}),Fn.print(a)}mungReceiveAnswerSDP(e,n,s){const a=Fn.parse(e),l=a.mediaDescriptions.find(u=>u.attributes.mid===n);return l&&s===ze.AUDIO&&l.media.mediaType==="audio"&&Rc(l),this.useXR&&pv(a),Fn.print(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,n,s)=>{var a;(a=this.onFirstVideoDecoded)===null||a===void 0||a.call(this,e,n,s)},this.statsFilter.onSelectedLocalCandidateChanged=(e,n)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,e,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,n)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,e,n)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var n;(n=this.onFirstVideoDecodedTimeout)===null||n===void 0||n.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,n){if(e.length===n.length)for(let m=0;m<e.length;m++){var s,a,l,u,p;const g=e[m],E=n[m];if(E instanceof At&&!je(s=E._hints).call(s,wn.LOW_STREAM)&&(a=E._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=E._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=E._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=E._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const y={},C={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};y.encodings=[{rid:"m",active:!0,maxBitrate:C.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:C.high}];const I=g.sender.getParameters();await g.sender.setParameters(Object.assign(I,y))}}}async applySimulcastEncodings(e,n){if(!mn()&&e.length===n.length)for(let s=0;s<e.length;s++){const a=n[s];if(a instanceof At&&this.isVP8Simulcast(a)){const l=e[s],u={},p={high:1e3*(a._encoderConfig.bitrateMax-50),medium:5e4};u.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const m=l.sender.getParameters();await l.sender.setParameters(Object.assign(m,u))}}}isVP8Simulcast(e){var n,s,a,l,u;return!!(e instanceof At&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!je(n=e._hints).call(n,wn.LOW_STREAM)&&(s=e._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((a=e._encoderConfig)===null||a===void 0?void 0:a.bitrateMax)>200&&(l=e._scalabilityMode)!==null&&l!==void 0&&l.numSpatialLayers&&((u=e._scalabilityMode)===null||u===void 0?void 0:u.numSpatialLayers)>1)}logSDPExchange(e,n,s,a){if(Z("SDP_LOGGING"))return N.upload("exchanging ".concat(s," ").concat(n," SDP during NVExtentionsConnection.").concat(a,`
`),e),n==="offer"?l=>{this.logSDPExchange(l,"answer",s==="local"?"remote":"local",a)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const n=this.remoteSDP.getSSRC(e);return n==null?void 0:n[0].ssrcId}setConfiguration(e){if(Kt().supportPCSetConfiguration){const n=Ui.resolvePCConfiguration(e);this.peerConnection.setConfiguration(n)}}}function Vs(i,e,n){const s=i[e];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const a=this.mutex,l=await a.lock("From NVExtentionsConnection.".concat(e));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},n}function G6(i){var e,n,s,a=2;for(typeof Symbol<"u"&&(n=x6,s=Symbol.iterator);a--;){if(n&&(e=i[n])!=null)return e.call(i);if(s&&(e=i[s])!=null)return new YT(e.call(i));n="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function YT(i){function e(n){if(Object(n)!==n)return pe.reject(new TypeError(n+" is not an object."));var s=n.done;return pe.resolve(n.value).then(function(a){return{value:a,done:s}})}return YT=function(n){this.s=n,this.n=n.next},YT.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(n){var s=this.s.return;return s===void 0?pe.resolve({value:n,done:!0}):e(s.apply(this.s,arguments))},throw:function(n){var s=this.s.return;return s===void 0?pe.reject(n):e(s.apply(this.s,arguments))}},new YT(i)}be([Vs,$("design:type",Function),$("design:paramtypes",[Object,Object,Array,Object,String,String]),$("design:returntype",pe)],Ui.prototype,"connect",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Array,Array]),$("design:returntype",pe)],Ui.prototype,"updateRemoteRTPCapabilities",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],Ui.prototype,"updateRemoteConnect",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Object,Array]),$("design:returntype",pe)],Ui.prototype,"createDataChannels",null),be([Vs,$("design:type",Function),$("design:paramtypes",[String,Array,String,Object]),$("design:returntype",pe)],Ui.prototype,"receive",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Ui.prototype,"batchReceive",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Ui.prototype,"stopReceiving",null),be([Vs,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],Ui.prototype,"muteRemote",null),be([Vs,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],Ui.prototype,"unmuteRemote",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Ui.prototype,"muteLocal",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Ui.prototype,"unmuteLocal",null),be([Vs,$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],Ui.prototype,"close",null),be([Vs,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],Ui.prototype,"updateEncoderConfig",null),be([Vs,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],Ui.prototype,"updateSendParameters",null),be([Vs,$("design:type",Function),$("design:paramtypes",[Di,String]),$("design:returntype",pe)],Ui.prototype,"replaceTrack",null),be([Vs,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],Ui.prototype,"getRemoteSSRC",null);class Vr extends Jb{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){return this._p2pConnection.localCodecs}constructor(e,n){super(e,n),R(this,"store",void 0),R(this,"peerConnection",void 0),R(this,"cname",void 0),R(this,"mutex",new ii("DataChannelConnection-mutex")),R(this,"dataChannel",void 0),R(this,"_p2pConnection",void 0),R(this,"establishPromise",void 0),R(this,"_nvMedia",void 0),this.store=n,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(Vr.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new Ui(e,n,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var e;const n=(e=this._nvMedia)===null||e===void 0?void 0:e.getLocalRtpCapabilities();return await this._p2pConnection.establish(n)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(e,n,s,a,l,u){return this.cname=u,await this._p2pConnection.connect(e,n,s,a,l,u),await new pe((p,m)=>{const g=setTimeout(()=>{this.closeSignal(),m(new le(z.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(s))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(g),void p()},this.dataChannel.onerror=E=>{this.closeSignal(),m(E)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(e,n){return this._p2pConnection.updateRemoteRTPCapabilities(e,n)}send(e,n,s){var a=this;return no(function*(){const l=yield Ct(a.mutex.lock("From DataChannelConnection.send"));try{return yield*HT(G6(a._p2pConnection.send(e,n,s)))}finally{l()}})()}async stopSending(e,n){return this._p2pConnection.stopSending(e,n)}async createDataChannels(e,n){return this._p2pConnection.createDataChannels(e,n)}async stopDataChannels(e){return this._p2pConnection.stopDataChannels(e)}async receive(e,n,s,a){return this._nvMedia?(N.debug("[DataChannelConnection] receive ".concat(e," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(e,n,this.cname)):(N.debug("[DataChannelConnection] receive ".concat(e," by WebRTC.")),await this._p2pConnection.receive(e,n,s,a))}async batchReceive(e){return[...await this._p2pConnection.batchReceive(e)]}async stopReceiving(e){return await this._p2pConnection.stopReceiving(e)}async muteRemote(e){return await this._p2pConnection.muteRemote(e)}async unmuteRemote(e){return await this._p2pConnection.unmuteRemote(e)}async muteLocal(e){return await this._p2pConnection.muteLocal(e)}async unmuteLocal(e){return await this._p2pConnection.unmuteLocal(e)}restartICE(e){var n=this;return no(function*(){return yield*HT(G6(n._p2pConnection.restartICE(e)))})()}close(){var e;(e=this._nvMedia)===null||e===void 0||e.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(e){return this._p2pConnection.getRemoteVideoIsReady(e)}updateRemoteConnect(e){var n;(n=this._nvMedia)===null||n===void 0||n.setRemoteRtpCapabilities(e),this._p2pConnection.updateRemoteConnect(e)}async updateEncoderConfig(e,n){return await this._p2pConnection.updateEncoderConfig(e,n)}async updateSendParameters(e,n){return await this._p2pConnection.updateSendParameters(e,n)}setStatsRemoteVideoIsReady(e,n){this._p2pConnection.setStatsRemoteVideoIsReady(e,n)}async replaceTrack(e,n){return await this._p2pConnection.replaceTrack(e,n)}async getRemoteSSRC(e){return this._p2pConnection.getRemoteSSRC(e)}logSDPExchange(e,n,s,a){if(Z("SDP_LOGGING"))return N.upload("exchanging ".concat(s," ").concat(n," SDP during DataChannelConnection.").concat(a,`
`),e),n==="offer"?l=>{this.logSDPExchange(l,"answer",s==="local"?"remote":"local",a)}:void 0}static resolvePCConfiguration(e){const n={iceServers:[]};return e.iceServers?n.iceServers=e.iceServers:e.turnServer&&e.turnServer.mode!=="off"&&(Yf(e.turnServer.servers)?n.iceServers=e.turnServer.servers:(n.iceServers&&n.iceServers.push(...Vr.turnServerConfigToIceServers(e.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&e.turnServer.serversFromGateway&&n.iceServers.push(...Vr.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(e){const n=[];return e.forEach(s=>{s.security?s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(gu(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Z("FORCE_TURN_TCP")&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&n.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),n}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=e=>{var n;return(n=this.onICEConnectionStateChange)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onConnectionStateChange=e=>{var n;return(n=this.onConnectionStateChange)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onDTLSTransportStateChange=e=>{var n;return(n=this.onDTLSTransportStateChange)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onDTLSTransportError=e=>{var n;return(n=this.onDTLSTransportError)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onICETransportStateChange=e=>{var n;return(n=this.onICETransportStateChange)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onFirstAudioReceived=e=>{var n;return(n=this.onFirstAudioReceived)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onFirstVideoReceived=e=>{var n;return(n=this.onFirstVideoReceived)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onFirstAudioDecoded=e=>{var n;return(n=this.onFirstAudioDecoded)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onFirstVideoDecoded=(e,n,s)=>{var a;return(a=this.onFirstVideoDecoded)===null||a===void 0?void 0:a.call(this,e,n,s)},this._p2pConnection.onFirstVideoDecodedTimeout=e=>{var n;return(n=this.onFirstVideoDecodedTimeout)===null||n===void 0?void 0:n.call(this,e)},this._p2pConnection.onSelectedLocalCandidateChanged=(e,n)=>{var s;return(s=this.onSelectedLocalCandidateChanged)===null||s===void 0?void 0:s.call(this,e,n)},this._p2pConnection.onSelectedRemoteCandidateChanged=(e,n)=>{var s;return(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0?void 0:s.call(this,e,n)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0}setConfiguration(e){this._p2pConnection.setConfiguration(e)}}function xo(i,e,n){const s=i[e];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const a=this.mutex,l=await a.lock("From DataChannelConnection.".concat(e));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},n}function H6(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Du(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H6(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):H6(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}function z6(i){var e,n,s,a=2;for(typeof Symbol<"u"&&(n=x6,s=Symbol.iterator);a--;){if(n&&(e=i[n])!=null)return e.call(i);if(s&&(e=i[s])!=null)return new qT(e.call(i));n="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function qT(i){function e(n){if(Object(n)!==n)return pe.reject(new TypeError(n+" is not an object."));var s=n.done;return pe.resolve(n.value).then(function(a){return{value:a,done:s}})}return qT=function(n){this.s=n,this.n=n.next},qT.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(n){var s=this.s.return;return s===void 0?pe.resolve({value:n,done:!0}):e(s.apply(this.s,arguments))},throw:function(n){var s=this.s.return;return s===void 0?pe.reject(n):e(s.apply(this.s,arguments))}},new qT(i)}be([xo,$("design:type",Function),$("design:paramtypes",[Object,Object,Array,Object,String,String]),$("design:returntype",pe)],Vr.prototype,"connect",null),be([xo,$("design:type",Function),$("design:paramtypes",[Array,Array]),$("design:returntype",pe)],Vr.prototype,"updateRemoteRTPCapabilities",null),be([xo,$("design:type",Function),$("design:paramtypes",[Object,Array]),$("design:returntype",pe)],Vr.prototype,"createDataChannels",null),be([xo,$("design:type",Function),$("design:paramtypes",[String,Array,String,Object]),$("design:returntype",pe)],Vr.prototype,"receive",null),be([xo,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Vr.prototype,"stopReceiving",null),be([xo,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],Vr.prototype,"muteRemote",null),be([xo,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],Vr.prototype,"unmuteRemote",null),be([xo,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Vr.prototype,"muteLocal",null),be([xo,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],Vr.prototype,"unmuteLocal",null),be([xo,$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],Vr.prototype,"close",null),be([xo,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],Vr.prototype,"updateEncoderConfig",null),be([xo,$("design:type",Function),$("design:paramtypes",[String,Di]),$("design:returntype",pe)],Vr.prototype,"updateSendParameters",null),be([xo,$("design:type",Function),$("design:paramtypes",[Di,String]),$("design:returntype",pe)],Vr.prototype,"replaceTrack",null),be([xo,$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],Vr.prototype,"getRemoteSSRC",null);class ci extends jn{get state(){return this._state}set state(e){const n=this._state;this._state=e,this.emit(st.StateChange,n,this._state)}constructor(e,n){super(),R(this,"store",void 0),R(this,"statsUploader",void 0),R(this,"connection",void 0),R(this,"localTrackMap",new Map),R(this,"remoteUserMap",new Map),R(this,"localDataChannels",[]),R(this,"remoteDataChannelMap",new Map),R(this,"pendingLocalTracks",[]),R(this,"pendingRemoteTracks",[]),R(this,"pendingLocalDataChannels",[]),R(this,"pendingRemoteDataChannels",[]),R(this,"statsCollector",void 0),R(this,"isPlanB",!1),R(this,"shouldForwardP2PCreation",void 0),R(this,"iceFailedCount",0),R(this,"dtlsFailedCount",0),R(this,"mutex",new ii("P2PChannel-mutex")),R(this,"_state",en.Disconnected),R(this,"_pcStatsUploadType",Z("NEW_ICE_RESTART")?bc.FIRST_CONNECTION:bc.OLD_FIRST_CONNECTION),R(this,"_isInRestartIce",!1),R(this,"_isStartRestartIce",!1),R(this,"_restartStates",["disconnected","failed"]),R(this,"_restartTimer",void 0),R(this,"_isFirstConnected",!0),R(this,"handleMuteLocalTrack",async(s,a,l)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==en.Connected)return void l(new ye(z.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const p=this.filterTobeMutedTracks(s);if(p.length===0)return void a();const m=p.find(E=>E[0]==="videoLowTrack");m&&m[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(p.map(E=>{let[,{id:y}]=E;return y}));const g=this.createMuteMessage(p);await gn(this,st.RequestMuteLocal,g),a()}catch(p){l(p)}finally{u()}}),R(this,"handleUnmuteLocalTrack",async(s,a,l)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==en.Connected)return void l(new ye(z.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const p=this.filterTobeUnmutedTracks(s);if(p.length===0)return void a();const m=p.find(E=>E[0]==="videoLowTrack");if(m){const E=m[1];if(E.track._originMediaStreamTrack.stop(),!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&Kt().supportDualStreamEncoding){const y=s._mediaStreamTrack.clone();E.track._mediaStreamTrack=y,E.track._originMediaStreamTrack=y}else{const y=fx(s,Qh(this,st.RequestLowStreamParameter));E.track._mediaStreamTrack=y,E.track._originMediaStreamTrack=y}await new pe((y,C)=>{this.handleReplaceTrack(E.track,y,C,!0)})}await this.connection.unmuteLocal(p.map(E=>{let[,{id:y}]=E;return y}));const g=this.createUnmuteMessage(p);await gn(this,st.RequestUnmuteLocal,g),a()}catch(p){l(p)}finally{u()}}),R(this,"handleUpdateVideoEncoder",async(s,a,l)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.connection||!p||p.track!==s||this.state!==en.Connected)return void a();const{id:m,track:g}=p;await this.connection.updateSendParameters(m,g),await this.connection.updateEncoderConfig(m,g),this.emit(st.UpdateVideoEncoder,g),a()}catch(p){l(p)}finally{u()}}),R(this,"handleSetOptimizationMode",async(s,a,l)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.connection||!p||p.track!==s||this.state!==en.Connected)return;const{id:m,track:g}=p;await this.connection.updateSendParameters(m,g),a()}catch(p){l(p)}finally{u()}}),R(this,"handleReplaceMixingTrack",async(s,a,l,u)=>{if(!this.connection||this.state!==en.Connected)return void a();const p=Ex([s]);let m;N.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(p.getTrackId(),"]")),typeof u=="boolean"&&u||(m=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(s,p),a()}catch(E){l(E)}finally{var g;(g=m)===null||g===void 0||g()}}),R(this,"handleReplaceTrack",async(s,a,l,u)=>{let p;N.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof u=="boolean"&&u||(p=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var m;const E=Array.from(this.localTrackMap.entries()).find(y=>{let[,{track:C}]=y;return s===C});if(!this.connection||!E||this.state!==en.Connected)return void a();if(await((m=this.connection)===null||m===void 0?void 0:m.replaceTrack(s,E[1].id)),this.isPlanB){const y=E[1];y.id=s._mediaStreamTrack.id,this.localTrackMap.set(E[0],y)}if(E[0]===Ie.LocalVideoTrack&&!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&Kt().supportDualStreamEncoding){const y=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(y){const C=s._mediaStreamTrack.clone();y.track._originMediaStreamTrack.stop(),y.track._mediaStreamTrack=C,y.track._originMediaStreamTrack=C,await new pe((I,j)=>{this.handleReplaceTrack(y.track,I,j,!0)})}}a()}catch(E){l(E)}finally{var g;(g=p)===null||g===void 0||g()}}),R(this,"handleGetRTCStats",s=>{s(this.statsCollector.getRTCStats())}),R(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),R(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),R(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),R(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=e,this.statsCollector=n,this.statsCollector.addP2PChannel(this),this.statsUploader=new R6(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!Kt().supportUnifiedPlan||Z("CHROME_FORCE_PLAN_B")&&au(),this.shouldForwardP2PCreation=Z("FORWARD_P2P_CREATION")&&Kt().supportPCSetConfiguration&&function(){const s=Ib();return s===Dr.ANDROID||s===Dr.IOS||s===Dr.HARMONY_OS}(),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new Vr({},this.store):this.isPlanB?new ai({},this.store):new sr({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(e,n){var s;this.state=en.New;const a=this.shouldForwardP2PCreation&&((s=this.connection)===null||s===void 0?void 0:s.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!a||(a&&this.connection&&(N.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new Vr(e,this.store):this.isPlanB?new ai(e,this.store):new sr(e,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new ye(z.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=Z("NEW_ICE_RESTART")?bc.FIRST_CONNECTION:bc.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e,n,s,a,l,u){if(!this.connection)throw new ye(z.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof Vr?this.connection.updateRemoteConnect(a):(this.store.peerConnectionStart(),await this.connection.connect(e,n,s,a,l,u),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=en.Connected)}updateRemoteRTPCapabilities(e){const n=Array.from(this.localTrackMap.entries()).filter(l=>{var u;let[p]=l;return je(u=[Ie.LocalVideoLowTrack,Ie.LocalVideoTrack]).call(u,p)}),s=n.map(l=>{let[,{id:u}]=l;return u}),a=n.map(l=>{let[u]=l;return u});if(this.connection instanceof sr){if(qe.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(a),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!je(e).call(e,this.store.codec)){const l=["vp8","h264"].find(u=>je(e).call(e,u));l&&(this.store.codec=l,N.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(l,".")))}this.connection.updateRemoteRTPCapabilities(s,e)}}async preConnect(e,n,s,a,l,u){if(!this.connection)throw new ye(z.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const p=await this.connection.connect(e,n,s,a,l,u);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=en.Connected,p}getEstablishParams(){if(this.connection instanceof Vr)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}async publishDataChannel(e){if(!this.connection||this.state!==en.Connected){if(this.state===en.Disconnected)throw new ye(z.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return void e.forEach(s=>{var a;je(a=this.pendingLocalDataChannels).call(a,s)||this.pendingLocalDataChannels.push(s)})}const n=this.filterTobePublishedDataChannels(e);n.length!==0&&(n.forEach(s=>{const a=Date.now();this.store.publish(s.id.toString(),"datachannel",a)}),await this.connection.createDataChannels(this.store.uid,n),n.forEach(s=>{this.localDataChannels.push(s);const a=Date.now();this.store.publish(s.id+"","datachannel",void 0,a)}))}publish(e,n,s){var a=this;return no(function*(){const l=yield Ct(a.mutex.lock("From P2PChannel.publish"));try{if(!a.connection||a.state!==en.Connected){if(a.state===en.Disconnected)throw new ye(z.UNEXPECTED_ERROR,"PeerConnection already disconnected.");a.throwIfTrackTypeNotMatch(e);const p=e.filter(m=>a.pendingLocalTracks.indexOf(m)===-1);return void(a.pendingLocalTracks=a.pendingLocalTracks.concat(p))}a.store.pubId=a.store.pubId+1,Li.markPublishStart(a.store.clientId,a.store.pubId);const u=a.filterTobePublishedTracks(e,n,s);if(u.length===0)return void(yield Ct(a.tryToUnmuteAudio(e)));yield*HT(z6(a.doPublish(a.connection,u)))}finally{l()}})()}doPublish(e,n){var s=this;return no(function*(){n.forEach(C=>{let{track:I,type:j}=C;const P=Date.now();s.store.publish(I.getTrackId(),j===Ie.LocalAudioTrack?"audio":"video",P)}),s.bindLocalTrackEvents(n);const a=n.map(C=>{let{track:I}=C;return I}),l=yield Ct(e.send(n.map(C=>{let{track:I}=C;return I}),s.store.codec,s.store.audioCodec)),u=(yield Ct(l.next())).value,p=s.createGatewayPublishMessage(n,u);let m;try{m=yield p}catch(C){throw l.throw(C),(C==null?void 0:C.code)===z.WS_ABORT&&n.forEach(I=>{let{track:j}=I;s.pendingLocalTracks.indexOf(j)===-1&&s.pendingLocalTracks.push(j)}),s.unbindLocalTrackEvents(n),C}const g=s.mapPubResToRemoteConfig(p,m),E=(yield Ct(l.next(g))).value,y=Z("ENABLE_VIDEO_SEI");a.forEach(async C=>{const I=C.getRTCRtpTransceiver();I&&y&&(C.trackMediaType===ze.VIDEO?await async function(j,P){if(!Kt().supportWebRTCEncodedTransform)return void N.warning("browser not support video encoded transform");if(FT.has(j)||!j.track)return;const U={track:j.track};if(Xl()){if(!j.createEncodedStreams)return void N.warning("browser not support createEncodedStreams() API");let J=null;try{J=j.createEncodedStreams()}catch(ae){return void N.error("create video-encoded-streams error",ae&&ae.message)}let se=[];P.on("sei-to-send",ae=>{se.push(ae)});const he=new TransformStream({transform(ae,de){U.controller||(U.controller=de),j.track&&j.track.id!==U.track.id&&(N.debug("video track changed: ".concat(U.track.id," => ").concat(j.track.id)),U.track.removeEventListener("ended",q),U.track=j.track,U.track.addEventListener("ended",q));const me=se.shift();me&&(ae.data=rce(ae.data,me)),de.enqueue(ae)}});J.readable.pipeThrough(he).pipeTo(J.writable)}else{if(!vi())return;{if(typeof RTCRtpScriptTransform>"u")return void N.warning("browser not support RTCRtpScriptTransform");const J=MT(),se=new MessageChannel;await new pe(ae=>J.onmessage=de=>{de.data==="registered"&&ae(void 0)});const he=new RTCRtpScriptTransform(J,{name:"tx",port:se.port2},[se.port2]);j.transform=he,await new pe(ae=>J.onmessage=de=>{de.data==="started"&&ae(void 0)}),P.on("sei-to-send",ae=>{se.port1.postMessage({sei:ae})}),se.port1.onmessage=ae=>{var de;ae.data.transformed&&j.track&&((de=j.track)===null||de===void 0?void 0:de.id)!==U.track.id&&(N.debug("video track changed: ".concat(U.track.id," => ").concat(j.track.id)),U.track.removeEventListener("ended",q),U.track=j.track,U.track.addEventListener("ended",q))},U.worker=J}}function q(){if(j.track){if(this.id!==j.track.id)return;j.track.removeEventListener("ended",q)}const J=FT.get(j);if(J){FT.delete(j);try{var se,he;(se=J.controller)===null||se===void 0||se.terminate(),(he=J.worker)===null||he===void 0||he.terminate()}catch(ae){N.warning(ae&&ae.message)}}}FT.set(j,U),j.track.addEventListener("ended",q)}(I.sender,C):C.trackMediaType===ze.AUDIO&&await async function(j){if(!Kt().supportWebRTCEncodedTransform)return void N.warning("browser not support audio encoded transform");if(UT.has(j)||!j.track)return;const P={track:j.track};if(Xl()){if(!j.createEncodedStreams)return void N.warning("browser not support createEncodedStreams() API");let q=null;try{q=j.createEncodedStreams()}catch(se){return void N.error("create audio-encoded-streams error",se&&se.message)}const J=new TransformStream({transform(se,he){P.controller||(P.controller=he),j.track&&j.track.id!==P.track.id&&(N.debug("audio track changed: ".concat(P.track.id," => ").concat(j.track.id)),P.track.removeEventListener("ended",U),P.track=j.track,P.track.addEventListener("ended",U)),he.enqueue(se)}});q.readable.pipeThrough(J).pipeTo(q.writable)}else if(vi()){if(typeof RTCRtpScriptTransform>"u")return void N.warning("browser not support RTCRtpScriptTransform");const q=MT(),J=new MessageChannel;await new pe(he=>q.onmessage=ae=>{ae.data==="registered"&&he(void 0)});const se=new RTCRtpScriptTransform(q,{name:"tx",port:J.port2},[J.port2]);j.transform=se,await new pe(he=>q.onmessage=ae=>{ae.data==="started"&&he(void 0)}),J.port1.onmessage=he=>{var ae;he.data.transformed&&j.track&&((ae=j.track)===null||ae===void 0?void 0:ae.id)!==P.track.id&&(N.debug("audio track changed: ".concat(P.track.id," => ").concat(j.track.id)),P.track.removeEventListener("ended",U),P.track=j.track,P.track.addEventListener("ended",U))},P.worker=q}function U(){if(j.track){if(this.id!==j.track.id)return;j.track.removeEventListener("ended",U)}const q=UT.get(j);if(q){UT.delete(j);try{var J,se;(J=q.controller)===null||J===void 0||J.terminate(),(se=q.worker)===null||se===void 0||se.terminate()}catch(he){N.warning(he&&he.message)}}}UT.set(j,P),j.track.addEventListener("ended",U)}(I.sender))}),n.forEach(C=>{let{type:I}=C;s.statsCollector.addLocalStats(I)}),s.assignLocalTracks(n,E),s.statsUploader.startUploadOutboundStats(),n.forEach(C=>{let{track:I,type:j}=C;const P=Date.now();s.store.publish(I.getTrackId(),j===Ie.LocalAudioTrack?"audio":"video",void 0,P)})})()}async updateVideoStreamParameter(e,n){const s=this.localTrackMap.get(n);if(!s)return;if(!(s.track instanceof At))return N.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof sr||this.connection instanceof ai))return N.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:a}=s,l=function(u,p){const m={};return u.height&&u.width&&(m.scaleResolutionDownBy=DN(u,p)),m.maxFramerate=u.framerate?To(u.framerate):void 0,m.maxBitrate=u.bitrate?1e3*u.bitrate:void 0,m}(e,a);if(a._encoderConfig||(a._encoderConfig={}),n!==Ie.LocalVideoLowTrack||!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&Kt().supportDualStreamEncoding)l.scaleResolutionDownBy!=null&&(a._encoderConfig.scaleResolutionDownBy=l.scaleResolutionDownBy);else{const u=a._originMediaStreamTrack;if(!u.canvas)return N.warn("[".concat(a.getTrackId(),"] no canvas on track"));(function(p,m){const g=p.canvas;m.width&&(g.width=To(m.width)),m.height&&(g.height=To(m.height)),m.framerate&&(g.stopCapture&&g.stopCapture(),g.stopCapture=JN(()=>{!g.startCapture&&g.stopCapture&&g.stopCapture(),g.startCapture&&g.startCapture()},To(m.framerate)))})(u,e)}l.maxBitrate!=null&&(a._encoderConfig.bitrateMax=l.maxBitrate/1e3),l.maxFramerate!=null&&(a._encoderConfig.frameRate&&typeof a._encoderConfig.frameRate=="object"?a._encoderConfig.frameRate.max=l.maxFramerate:a._encoderConfig.frameRate={max:l.maxFramerate}),N.debug("[".concat(a.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(a._encoderConfig))),await this.connection.updateRtpSenderEncodings(a)}publishLowStream(e){var n=this;return no(function*(){if(!n.connection||n.state!==en.Connected)return;const s=yield Ct(n.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const l=n.localTrackMap.get(Ie.LocalVideoTrack);if(!l)throw new ye(z.UNEXPECTED_ERROR,"Could not find high stream");if(n.localTrackMap.has(Ie.LocalVideoLowTrack))throw new ye(z.UNEXPECTED_ERROR,"[".concat(n.store.clientId,"] Can't publish low stream when stream already publish"));const u=[{track:n.getLowVideoTrack(l.track,e),type:Ie.LocalVideoLowTrack}];if(yield*HT(z6(n.doPublish(n.connection,u))),l.track.muted||!l.track.enabled){var a;const p=(a=n.localTrackMap.get(Ie.LocalVideoLowTrack))===null||a===void 0?void 0:a.id;p!==void 0&&(yield Ct(n.connection.muteLocal([p])))}}finally{s()}})()}async republish(){this.pendingLocalTracks.length>0&&(N.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Tr(this,st.RequestRePublish,this.pendingLocalTracks),this.emit(st.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(N.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Tr(this,st.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(e){for(let n=this.pendingRemoteTracks.length-1;n>=0;n--){const{user:s,kind:a}=this.pendingRemoteTracks[n];(a!==ze.AUDIO||s._audio_added_&&s._audioSSRC)&&(a!==ze.VIDEO||s._video_added_&&s._videoSSRC)||this.pendingRemoteTracks.splice(n,1)}if(e)await Tr(this,st.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:n,kind:s}of this.pendingRemoteTracks)await this.subscribe(n,s,s===ze.VIDEO?n._videoSSRC:n._audioSSRC);this.pendingRemoteTracks.forEach(n=>{let{user:s}=n;this.emit(st.MediaReconnectEnd,s.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==en.Connected)return void e.forEach(a=>{const l=this.pendingLocalTracks.indexOf(a);l!==-1&&this.pendingLocalTracks.splice(l,1)});const n=this.filterTobeUnpublishedTracks(e);if(n.length===0)return;const s=n.find(a=>a[0]==="videoLowTrack");return s&&s[1].track.close(),this.doUnpublish(this.connection,n)}async unpublishDataChannel(e){if(!this.connection||this.state!==en.Connected)return void e.forEach(s=>{const a=this.pendingLocalDataChannels.indexOf(s);a!==-1&&this.pendingLocalDataChannels.splice(a,1)});const n=this.filterTobeUnpublishedDataChannels(e);return n.length!==0?(n.forEach(s=>{const a=this.localDataChannels.indexOf(s);a!==-1&&this.localDataChannels.splice(a,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),n.map(s=>s.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==en.Connected)return;const e=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(!e)return;e.track.close();const n=[[Ie.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,n)}async doUnpublish(e,n){const s=this.createGatewayUnpublishMessage(n);return await e.stopSending(n.map(a=>{let[,{id:l}]=a;return l})),this.withdrawLocalTracks(n),this.unbindLocalTrackEvents(n.map(a=>{let[l,{track:u}]=a;return{type:l,track:u}})),n.forEach(a=>{let[l]=a;this.statsCollector.removeLocalStats(l)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),s}async subscribeDataChannel(e,n){if(!this.connection||this.state!==en.Connected)throw new ye(z.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const s=n.filter(a=>{var l;return!((l=this.remoteDataChannelMap.get(e))!==null&&l!==void 0&&l.get(a.id))});if(s.length!==0)return await this.connection.createDataChannels(e.uid,s),s.forEach(a=>{var l;this.remoteDataChannelMap.has(e)?(l=this.remoteDataChannelMap.get(e))===null||l===void 0||l.set(a.id,a):this.remoteDataChannelMap.set(e,new Map([[a.id,a]]));const u=this.pendingRemoteDataChannels.findIndex(p=>{let{user:m,id:g}=p;return m.uid===e.uid&&g===a.id});u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),s.map(a=>a.id)}async subscribe(e,n,s,a,l){var u;if(!this.connection||this.state!==en.Connected)throw new ye(z.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((u=this.remoteUserMap.get(e))!==null&&u!==void 0&&u.has(n))return;let p,m,g;if(l){const C=l.find(j=>{let{stream_type:P}=j;return P===n});if(!C)throw new ye(z.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(n," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(n,"."));const I=await this.connection.receive(n,C.ssrcs,String(e._uintid),C.attributes);this.connection instanceof sr&&(g=I.transceiver),p=I.track,m=I.id}else{const C=await this.connection.receive(n,[{ssrcId:s,rtx:a}],String(e._uintid),void 0);this.connection instanceof sr&&(g=C.transceiver),p=C.track,m=C.id}n===ze.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(p):(e._audioTrack=new Oa(p,e.uid,e._uintid,this.store),N.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),g&&e._audioTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(p):(e._videoTrack=new ll(p,e.uid,e._uintid,this.store),N.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),g&&e._videoTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(e,e._videoTrack)),Z("ENABLE_VIDEO_SEI")&&g&&(n==ze.VIDEO?await ice(g.receiver,{onSei:C=>{var I;(I=e._videoTrack)===null||I===void 0||I._onSei(C)}}):n==ze.AUDIO&&await tce(g.receiver));const E=this.remoteUserMap.get(e);E?E.set(n,m):this.remoteUserMap.set(e,new Map([[n,m]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const y=this.pendingRemoteTracks.findIndex(C=>{let{user:I,kind:j}=C;return I.uid===e.uid&&n===j});y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(st.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==en.Connected)throw new ye(z.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter(s=>{var a;let{user:l,mediaType:u}=s;return!((a=this.remoteUserMap.get(l))!==null&&a!==void 0&&a.has(u))});const n=await this.connection.batchReceive(e.map(s=>{let{user:a,mediaType:l,ssrcId:u,rtxSsrcId:p}=s;return{kind:l,ssrcMsg:[{ssrcId:u,rtx:p}],mslabel:String(a._uintid)}}));e.forEach((s,a)=>{let{user:l,mediaType:u}=s;const{track:p,id:m,transceiver:g}=n[a];u===ze.AUDIO?(l._audioTrack?l._audioTrack._updateOriginMediaStreamTrack(p):(l._audioTrack=new Oa(p,l.uid,l._uintid,this.store),N.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(l._audioTrack.getTrackId()))),g&&l._audioTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(l,l._audioTrack)):(l._videoTrack?l._videoTrack._updateOriginMediaStreamTrack(p):(l._videoTrack=new ll(p,l.uid,l._uintid,this.store),N.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(l._videoTrack.getTrackId()))),g&&l._videoTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(l,l._videoTrack));const E=this.remoteUserMap.get(l);E?E.set(u,m):this.remoteUserMap.set(l,new Map([[u,m]])),this.statsCollector.addRemoteStats(l.uid),this.statsUploader.startUploadInboundStats();const y=this.pendingRemoteTracks.findIndex(C=>{let{user:I,kind:j}=C;return I.uid===l.uid&&u===j});y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(st.MediaReconnectEnd,l.uid))})}async unsubscribe(e,n,s){const a=this.pendingRemoteTracks.filter(p=>{let{user:m,kind:g}=p;return n!==void 0?m.uid===e.uid&&n===g:m.uid===e.uid});if(a.forEach(p=>{const m=this.pendingRemoteTracks.indexOf(p);this.pendingRemoteTracks.splice(m,1)}),this.connection&&this.state===en.Connected||s||a.forEach(p=>{let{kind:m}=p;var g;if(m===ze.AUDIO)(g=e._audioTrack)===null||g===void 0||g._destroy(),e._audioTrack=void 0;else if(m===ze.VIDEO){var E;(E=e._videoTrack)===null||E===void 0||E._destroy(),e._videoTrack=void 0}}),!this.connection||this.state!==en.Connected)return;const l=this.filterTobeUnSubscribedTracks(e,n);if(l.length===0)return;await this.connection.stopReceiving(l.map(p=>{let[,{id:m}]=p;return m}));const u=this.createUnsubscribeMessage(l);return this.withdrawRemoteTracks(l),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),l.forEach(p=>{let[m,{kind:g}]=p;var E,y;if(g===ze.VIDEO&&m._videoSSRC&&((E=this.connection)===null||E===void 0||E.setStatsRemoteVideoIsReady(m._videoSSRC,!1)),g===ze.VIDEO)this.unbindRemoteTrackEvents(m._videoTrack),s||((y=m._videoTrack)===null||y===void 0||y._destroy(),m._videoTrack=void 0);else if(g===ze.AUDIO){var C;this.unbindRemoteTrackEvents(m._audioTrack),!s&&((C=m._audioTrack)===null||C===void 0||C._destroy(),m._audioTrack=void 0)}}),u}async unsubscribeDataChannel(e,n){if(n.forEach(l=>{const u=this.pendingRemoteDataChannels.findIndex(p=>p.id===l.id);u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),!this.connection)return;const s=this.filterTobeUnSubscribedDataChannels(e,n);if(s.length===0)return;n.forEach(l=>{l._close()});const a=this.remoteDataChannelMap.get(e);return s.forEach(l=>{a&&a.delete(l.id)}),a&&a.size===0&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),s.map(l=>l.id)}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let n=[];for(const{user:l,mediaType:u}of e){const p=this.pendingRemoteTracks.filter(m=>{let{user:g,kind:E}=m;return u!==void 0?g.uid===l.uid&&u===E:g.uid===l.uid});p.forEach(m=>{const g=this.pendingRemoteTracks.indexOf(m);this.pendingRemoteTracks.splice(g,1)}),n=n.concat(p)}if(!this.connection||this.state!==en.Connected)return void n.forEach(l=>{let{user:u,kind:p}=l;var m;if(p===ze.AUDIO)(m=u._audioTrack)===null||m===void 0||m._destroy(),u._audioTrack=void 0;else if(p===ze.VIDEO){var g;(g=u._videoTrack)===null||g===void 0||g._destroy(),u._videoTrack=void 0}});const s=ed(e).call(e,(l,u)=>{let{user:p,mediaType:m}=u;const g=this.filterTobeUnSubscribedTracks(p,m);return l.concat(g)},[]);if(s.length===0)return;await this.connection.stopReceiving(s.map(l=>{let[,{id:u}]=l;return u}));const a=this.createUnsubscribeAllMessage(s);return this.withdrawRemoteTracks(s),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),s.forEach(l=>{let[u,{kind:p}]=l;var m,g;if(p===ze.VIDEO&&u._videoSSRC&&((m=this.connection)===null||m===void 0||m.setStatsRemoteVideoIsReady(u._videoSSRC,!1)),p===ze.VIDEO)this.unbindRemoteTrackEvents(u._videoTrack),(g=u._videoTrack)===null||g===void 0||g._destroy(),u._videoTrack=void 0;else if(p===ze.AUDIO){var E;this.unbindRemoteTrackEvents(u._audioTrack),(E=u._audioTrack)===null||E===void 0||E._destroy(),u._audioTrack=void 0}}),a}async muteRemote(e,n){if(!this.connection)return;const s=this.remoteUserMap.get(e);if(!s)return void N.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!s.get(n))return void N.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."));const a=n===ze.VIDEO?e._videoSSRC:e._audioSSRC;a!==void 0&&this.connection.setStatsRemoteVideoIsReady(a,!1)}async unmuteRemote(e,n){return this.unmuteRemoteNoLock(e,n)}async unmuteRemoteNoLock(e,n){if(!this.connection)return;const s=this.remoteUserMap.get(e);if(!s)return void N.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."));s.get(n)||N.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."))}getAllTracks(e){const n=this.localTrackMap.get(Ie.LocalAudioTrack);if((n==null?void 0:n.track)instanceof Nr){const s=n.track;return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return l!==Ie.LocalAudioTrack}).filter(a=>{let[l]=a;return!(e&&l===Ie.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[a]=s;return!(e&&a===Ie.LocalVideoLowTrack)}).map(s=>{let[,{track:a}]=s;return a})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,n,s,a,l){if(e){const p=this.localTrackMap.get(Ie.LocalAudioTrack),m=a?this.localTrackMap.get(Ie.LocalVideoLowTrack):this.localTrackMap.get(Ie.LocalVideoTrack);qe.publish(this.store.sessionId,{eventElapse:Li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:m==null?void 0:m.track.getTrackLabel(),screenshare:(m==null?void 0:m.track._hints.indexOf(wn.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}else{var u;s||(s=[]);const p=s.find(g=>g instanceof ln),m=a?(u=this.localTrackMap.get(Ie.LocalVideoTrack))===null||u===void 0?void 0:u.track:s.find(g=>g instanceof At);qe.publish(this.store.sessionId,{eventElapse:Li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:p==null?void 0:p.getTrackLabel(),videoName:m==null?void 0:m.getTrackLabel(),screenshare:(m==null?void 0:m._hints.indexOf(wn.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}}reportSubscribeEvent(e,n,s,a){const l=a===ze.VIDEO?s._videoSSRC:s._audioSSRC;l&&qe.subscribe(this.store.sessionId,{succ:e,ec:n,video:a===ze.VIDEO,audio:a===ze.AUDIO,peerid:s.uid,subscribeRequestid:a===ze.VIDEO?s._videoSSRC:s._audioSSRC,p2pid:this.store.p2pId,eventElapse:Li.measureFromSubscribeStart(this.store.clientId,l)})}reset(){N.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new ii("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new Vr({},this.store):this.isPlanB?new ai({},this.store):new sr({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(Ie.LocalAudioTrack);if((e==null?void 0:e.track)instanceof Nr){if(e.track.trackList.length>0){const n=e.track;e.track.trackList.forEach(s=>{n.removeAudioTrack(s)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=en.Disconnected}getStats(){var e;return(e=this.connection)===null||e===void 0?void 0:e.getStats()}getRemoteVideoIsReady(e){var n;return((n=this.connection)===null||n===void 0?void 0:n.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(Ie.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(Ie.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const n=this.localTrackMap.get(e);return n&&n.track instanceof At||n&&n.track instanceof ln?n.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,n){if(!e)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(e);return!!s&&(!n||s.has(n))}async hasRemoteMediaWithLock(e,n){if(!e)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(e);return!!s&&(!n||s.has(n))}getRemoteMedia(e){var n;const s=Array.from(vo(n=this.remoteUserMap).call(n)).find(a=>a.uid===e);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(s=>{let[a]=s;return{uid:a.uid,level:a.audioTrack?100*a.audioTrack._source.getAccurateVolumeLevel():0}});const n=this.localTrackMap.get(Ie.LocalAudioTrack);return n&&e.push({level:100*n.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=fE(e).call(e,(s,a)=>s.level-a.level),e}async disconnectForReconnect(){this.connection&&(N.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=en.Reconnecting,Z("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n]=e;var s;n._videoTrack&&n._videoTrack._player&&((s=n._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new Vr({},this.store):this.isPlanB?new ai({},this.store):new sr({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var n;let[s,{track:a}]=e;switch(s){case Ie.LocalVideoTrack:je(n=a._hints).call(n,wn.LOW_STREAM)?a.close():this.pendingLocalTracks.push(a);break;case Ie.LocalAudioTrack:a instanceof Nr?this.pendingLocalTracks=this.pendingLocalTracks.concat(a.trackList):this.pendingLocalTracks.push(a);case Ie.LocalVideoLowTrack:}}),this.emit(st.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,s]=e;Array.from(vo(s).call(s)).forEach(a=>{this.setPendingRemoteMedia(n,a)}),this.emit(st.MediaReconnectStart,n.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(e=>{this.pendingLocalDataChannels.push(e)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(e=>{let[n,s]=e;Array.from(vo(s).call(s)).forEach(a=>{this.setPendingRemoteDataChannel(n,a)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),N.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,n){for(const s of this.pendingRemoteDataChannels){const{user:a,id:l}=s;if((e instanceof Si?e.uid:e)===a.uid&&l===n)return!0}return!1}setPendingRemoteDataChannel(e,n){this.hasPendingRemoteDataChannel(e,n)||this.pendingRemoteDataChannels.push({user:e,id:n})}hasPendingRemoteMedia(e,n){for(const s of this.pendingRemoteTracks){const{user:a,kind:l}=s;if((e instanceof Si?e.uid:e)===a.uid&&n===l)return!0}return!1}setPendingRemoteMedia(e,n){this.hasPendingRemoteMedia(e,n)||this.pendingRemoteTracks.push({user:e,kind:n})}restartICE(e){var n=this;return no(function*(){if(!n.connection||n.state!==en.Connected||n.connection instanceof Vr)return;const s=yield Ct(n.mutex.lock("From P2PChannel.restartICE"));let a;try{a=yield Ct(n.connection.restartICE(e));const u=yield Ct(a.next());if(u.done)return;const p=u.value,m=yield p;switch(n.reportPCDisconnectedOrFailed(e),e){case Pi.TCP:n._pcStatsUploadType=bc.TCP_RESTART;break;case Pi.RELAY:n._pcStatsUploadType=bc.RELAY_RESTART;break;default:n._pcStatsUploadType=bc.OLD_RESTART}n._isInRestartIce=!0,a.next(m)}catch(u){var l;(l=a)===null||l===void 0||l.throw(u)}finally{s()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),n=this.localTrackMap.get(Ie.LocalVideoTrack),s=this.localTrackMap.get(Ie.LocalAudioTrack),a=e.videoSend.find(j=>j.ssrc===(n==null?void 0:n.ssrcs[0].ssrcId)),l=e.audioSend.find(j=>j.ssrc===(s==null?void 0:s.ssrcs[0].ssrcId));if(!a||!l)return 1;const u=Qs(this,st.NeedSignalRTT),p=a?a.rttMs:void 0,m=l?l.rttMs:void 0,g=p&&m?(p+m)/2:p||m,E=(g&&u?(g+u)/2:g||u)||0,y=100*e.sendPacketLossRate*.7/50+.3*E/1500,C=y<.17?1:y<.36?2:y<.59?3:y<.1?4:5,I=n==null?void 0:n.track;if(I&&I._encoderConfig&&I._hints.indexOf(wn.SCREEN_TRACK)===-1){const j=I._encoderConfig.bitrateMax,P=e.bitrate.actualEncoded;if(j&&P){const U=(1e3*j-P)/(1e3*j);return z4[U<.15?0:U<.3?1:U<.45?2:U<.6?3:4][C]}}return C}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let n=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[a]=s;const l=a._audioSSRC,u=a._videoSSRC,p=e.audioRecv.find(P=>P.ssrc===l),m=e.videoRecv.find(P=>P.ssrc===u);if(!p&&!m)return void(n+=1);const g=Qs(this,st.NeedSignalRTT),E=e.rtt,y=(E&&g?(E+g)/2:E||g)||0,C=p?p.jitterMs:void 0,I=e.recvPacketLossRate;let j=.7*I*100/50+.3*y/1500;C&&(j=.6*I*100/50+.2*y/1500+.2*C/400),n+=j<.1?1:j<.17?2:j<.36?3:j<.59?4:5}),this.remoteUserMap.size>0?Math.round(n/this.remoteUserMap.size):n}async muteLocalTrack(e){return new pe((n,s)=>{this.handleMuteLocalTrack(e,n,s)})}async replaceTrack(e,n){var s;if(N.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(n.getTrackId(),"]")),!this.connection||this.state!==en.Connected)return;const a=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:p}]=u;return e===p});if(!a)return;const l=a[0];if(e!==n&&(this.unbindLocalTrackEvents([{track:e,type:l}]),this.bindLocalTrackEvents([{track:n,type:l}]),a[1].track=n),await((s=this.connection)===null||s===void 0?void 0:s.replaceTrack(n,a[1].id)),this.isPlanB){const u=a[1];u.id=n._mediaStreamTrack.id,this.localTrackMap.set(l,u)}if(l===Ie.LocalVideoTrack&&!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&Kt().supportDualStreamEncoding){const u=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(u){const p=e._mediaStreamTrack.clone();u.track._originMediaStreamTrack.stop(),u.track._mediaStreamTrack=p,u.track._originMediaStreamTrack=p,await new pe((m,g)=>{this.handleReplaceTrack(u.track,m,g,!0)})}}}filterTobePublishedTracks(e,n,s){const a=[],l=this.getAllTracks();e=qf(e=e.filter(g=>l.indexOf(g)===-1));let u,p=!1;const m=this.localTrackMap.get(Ie.LocalAudioTrack);for(const g of e){if(g instanceof At&&(this.localTrackMap.has(Ie.LocalVideoTrack)||p?new ye(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(a.push({track:g,type:Ie.LocalVideoTrack}),p=!0),n)){const E=this.getLowVideoTrack(g,s);a.push({track:E,type:Ie.LocalVideoLowTrack})}if(g instanceof ln)if(m){const E=m.track;if(E instanceof Nr)_x([g]),E.addAudioTrack(g),this.bindLocalAudioTrackEvents(g,!0);else{const y=Ex([E,g]);N.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(y.getTrackId(),"]")),this.replaceTrack(E,y)}}else u instanceof Nr?(_x([g]),u.addAudioTrack(g)):u||!g._useAudioElement&&Kt().webAudioMediaStreamDest&&!g._bypassWebAudio?u=Ex(u?[g,u]:[g]):u=g}return u&&(N.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(u.getTrackId(),"]")),a.push({track:u,type:Ie.LocalAudioTrack})),a}filterTobeUnpublishedTracks(e){const n=[],s=this.getAllTracks();e=qf(e=e.filter(a=>s.indexOf(a)!==-1));for(const a of e){if(a instanceof ln){const l=this.localTrackMap.get(Ie.LocalAudioTrack);if(!l)continue;l.track instanceof Nr?(l.track.removeAudioTrack(a),this.unbindLocalAudioTrackEvents(a),l.track.trackList.length===0&&(n.push([Ie.LocalAudioTrack,l]),l.track.close())):n.push([Ie.LocalAudioTrack,l])}if(a instanceof At){const l=this.localTrackMap.get(Ie.LocalVideoTrack);if(!l)continue;n.push([Ie.LocalVideoTrack,l]);const u=this.localTrackMap.get(Ie.LocalVideoLowTrack);u&&n.push([Ie.LocalVideoLowTrack,u])}}return n}filterTobePublishedDataChannels(e){return e=(e=qf(e)).filter(n=>this.localDataChannels.findIndex(s=>s.id===n.id)===-1)}filterTobeUnpublishedDataChannels(e){return e=(e=(e=qf(e)).filter(n=>this.localDataChannels.indexOf(n)!==-1)).filter(n=>n._originDataChannel)}bindLocalTrackEvents(e){e.forEach(n=>{let{track:s,type:a}=n;switch(a){case Ie.LocalVideoTrack:s.addListener(Ve.GET_STATS,this.handleGetLocalVideoStats),s.addListener(Ve.GET_RTC_STATS,this.handleGetRTCStats),s.addListener(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ve.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(Ve.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.addListener(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case Ie.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,n){e instanceof Nr?e.trackList.forEach(s=>{s.addListener(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ve.GET_STATS,this.handleGetLocalAudioStats),s.addListener(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Ve.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),n||(e.addListener(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(Ve.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(n=>{let[s,{track:a}]=n;return{track:a,type:s}})),e.forEach(n=>{let{track:s,type:a}=n;switch(a){case Ie.LocalVideoTrack:s.off(Ve.GET_STATS,this.handleGetLocalVideoStats),s.off(Ve.GET_RTC_STATS,this.handleGetRTCStats),s.off(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(Ve.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(Ve.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.off(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case Ie.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Nr?e.trackList.forEach(n=>{n.off(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(Ve.GET_STATS,this.handleGetLocalAudioStats),n.off(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Ve.GET_STATS,this.handleGetLocalAudioStats),e.off(Ve.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Ve.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Ve.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Ve.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(Ve.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Ve.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,n){n instanceof ll&&n.addListener(Ve.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(e))}),n instanceof Oa&&n.addListener(Ve.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Ve.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,s]=e;s.has(ze.AUDIO)&&this.unbindRemoteTrackEvents(n._audioTrack),s.has(ze.VIDEO)&&this.unbindRemoteTrackEvents(n._videoTrack)})}createGatewayPublishMessage(e,n){return e.map((s,a)=>{var l;let u,p,{track:m,type:g}=s;switch(g){case Ie.LocalAudioTrack:u=Qt.Audio,p={dtx:m instanceof ap&&m._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Ie.LocalVideoTrack:u=je(l=m._hints).call(l,wn.SCREEN_TRACK)?Qt.Screen:Qt.High,p=Du(Du({},p3(m)),{},{codec:this.store.codec});break;case Ie.LocalVideoLowTrack:u=Qt.Low,p=Du(Du({},p3(m)),{},{codec:this.store.codec})}return{stream_type:u,attributes:p,ssrcs:n[a]}})}createGatewayUnpublishMessage(e){return e.map(n=>{var s;let a,[l,{track:u,ssrcs:p,id:m}]=n;switch(l){case Ie.LocalVideoTrack:a=je(s=u._hints).call(s,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalAudioTrack:a=Qt.Audio;break;case Ie.LocalVideoLowTrack:a=Qt.Low}return{stream_type:a,ssrcs:p,mid:m}})}assignLocalTracks(e,n){e.forEach((s,a)=>{let{track:l,type:u}=s;this.localTrackMap.set(u,{track:l,id:n[a].id,ssrcs:n[a].localSSRC})})}withdrawLocalTracks(e){e.forEach(n=>{let[s]=n;this.localTrackMap.delete(s)})}bindConnectionEvents(e){e.onConnectionStateChange=async n=>{if(N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(n,")")),this.emit(st.PeerConnectionStateChange,n),n!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),n==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),Z("NEW_ICE_RESTART")){var s;if(je(s=this._restartStates).call(s,n)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const a=p=>{(e.iceConnectionState==="disconnected"||e.iceConnectionState==="checking"||e.iceConnectionState==="failed")&&(N.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(p)),Qs(this,st.QueryClientConnectionState)==="CONNECTED"&&this.emit(st.RequestRestartICE,p))},l=()=>{e.iceConnectionState!=="disconnected"&&e.iceConnectionState!=="checking"&&e.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),N.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(st.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},u=Z("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(Z("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Kt().supportPCSetConfiguration)a(Pi.RELAY),this._restartTimer=window.setTimeout(l,u);else if(mn())a(Pi.UDP),this._restartTimer=window.setTimeout(l,4e3);else{if(a(Pi.TCP),Kt().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{a(Pi.RELAY),this._restartTimer=window.setTimeout(l,u)},u));this._restartTimer=window.setTimeout(l,u)}},800))}}else{if(n==="disconnected"&&e.iceConnectionState==="disconnected")return setTimeout(()=>{e.iceConnectionState==="disconnected"&&Z("ICE_RESTART")&&Qs(this,st.QueryClientConnectionState)==="CONNECTED"&&this.emit(st.RequestRestartICE)},800),void setTimeout(()=>{e.peerConnectionState==="disconnected"&&(N.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(st.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);n==="failed"&&(N.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(st.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=n=>{n!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),qe.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:Bn.TRACER}).onSuccess(),this.emit(st.IceConnectionStateChange,n)},e.onICETransportStateChange=n=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},e.onDTLSTransportStateChange=n=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},e.onDTLSTransportError=n=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},e.onFirstAudioDecoded=n=>{var s;const a=Array.from(vo(s=this.remoteUserMap).call(s)).find(u=>u._audioSSRC===n);var l;a&&(this.store.subscribe(a.uid,"audio",void 0,void 0,void 0,Date.now()),(l=a.audioTrack)===null||l===void 0||l.emit(Su.FIRST_FRAME_DECODED),qe.firstRemoteFrame(this.store.sessionId,Mr.FIRST_AUDIO_DECODE,kn.FIRST_AUDIO_DECODE,{peer:a._uintid,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=n=>{var s;const a=Array.from(vo(s=this.remoteUserMap).call(s)).find(l=>l._audioSSRC===n);a&&qe.firstRemoteFrame(this.store.sessionId,Mr.FIRST_AUDIO_RECEIVED,kn.FIRST_AUDIO_RECEIVED,{peer:a._uintid,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(n,s,a)=>{this.reportVideoFirstFrameDecoded(n,s,a)},e.onFirstVideoReceived=n=>{var s;const a=Array.from(vo(s=this.remoteUserMap).call(s)).find(l=>l._videoSSRC===n);a&&qe.firstRemoteFrame(this.store.sessionId,Mr.FIRST_VIDEO_RECEIVED,kn.FIRST_VIDEO_RECEIVED,{peer:a._uintid,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(n,s)=>{const a=n.candidateType==="relay",l=s.candidateType==="relay";s.candidateType!=="unknown"&&a===l||this.emit(st.ConnectionTypeChange,a),N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(_u(s))," -> ").concat(JSON.stringify(_u(n)),")"))},e.onSelectedRemoteCandidateChanged=(n,s)=>{N.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(_u(s))," -> ").concat(JSON.stringify(_u(n)),")"))},e.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(e){const n=[];if(this.getAllTracks().indexOf(e)===-1)return n;const s=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof ln&&(s==null?void 0:s.track)instanceof Nr)return s.track.isActive||n.push([Ie.LocalAudioTrack,s]),n;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return e===u});if(a&&(n.push(a),a[0]===Ie.LocalVideoTrack)){const l=this.localTrackMap.get(Ie.LocalVideoLowTrack);l&&n.push([Ie.LocalVideoLowTrack,l])}return n}filterTobeUnmutedTracks(e){const n=[],s=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof ln&&(s==null?void 0:s.track)instanceof Nr)return s.track.isActive&&n.push([Ie.LocalAudioTrack,s]),n;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return e===u});if(a)if(a[0]===Ie.LocalVideoTrack){n.push(a);const l=this.localTrackMap.get(Ie.LocalVideoLowTrack);l&&n.push([Ie.LocalVideoLowTrack,l])}else n.push(a);return n}createMuteMessage(e){return e.map(n=>{var s;let a,[l,{track:u,ssrcs:p,id:m}]=n;switch(l){case Ie.LocalAudioTrack:a=Qt.Audio;break;case Ie.LocalVideoTrack:a=je(s=u._hints).call(s,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalVideoLowTrack:a=Qt.Low}return{stream_type:a,ssrcs:p,mid:m}})}createUnmuteMessage(e){return e.map(n=>{var s;let a,[l,{track:u,ssrcs:p,id:m}]=n;switch(l){case Ie.LocalAudioTrack:a=Qt.Audio;break;case Ie.LocalVideoTrack:a=je(s=u._hints).call(s,wn.SCREEN_TRACK)?Qt.Screen:Qt.High;break;case Ie.LocalVideoLowTrack:a=Qt.Low}return{stream_type:a,ssrcs:p,mid:m}})}filterTobeUnSubscribedTracks(e,n){const s=[],a=this.remoteUserMap.get(e);if(!a)return s;if(n){const l=a.get(n);if(!l)return s;s.push([e,{kind:n,id:l}])}else Array.from(a.entries()).forEach(l=>{let[u,p]=l;s.push([e,{kind:u,id:p}])});return s}filterTobeUnSubscribedDataChannels(e,n){const s=[];return n.forEach(a=>{var l;(l=this.remoteDataChannelMap.get(e))!==null&&l!==void 0&&l.has(a.id)&&s.push(a)}),s}createUnsubscribeMessage(e){const n=[];return e.forEach(s=>{let[a,{kind:l,id:u}]=s;switch(l){case ze.VIDEO:return void(a._videoSSRC&&n.push({stream_type:ze.VIDEO,ssrcId:a._videoSSRC}));case ze.AUDIO:return void(a._audioSSRC&&n.push({stream_type:ze.AUDIO,ssrcId:a._audioSSRC}))}}),n}createUnsubscribeAllMessage(e){const n=new Map;return e.forEach(s=>{let[a,{kind:l}]=s;if(n.has(a)){let u=n.get(a);l===ze.VIDEO?u|=Or.Video:u|=Or.Audio,n.set(a,u)}else l===ze.VIDEO?n.set(a,Or.Video):n.set(a,Or.Audio)}),{users:Array.from(n.entries()).map(s=>{let[a,l]=s;return{stream_id:a.uid,stream_type:l}})}}withdrawRemoteTracks(e){e.forEach(n=>{let[s,{kind:a}]=n;const l=this.remoteUserMap.get(s);l&&(l.delete(a),Array.from(l.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(e){const n=this.localTrackMap.get(Ie.LocalVideoTrack),s=this.localTrackMap.get(Ie.LocalVideoLowTrack);n&&await n.track.setBitrateLimit(e.uplink),s&&e.low_stream_uplink&&await s.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(e,n){return e.map((s,a)=>{var l;let{stream_type:u}=s;return(l=n.find(p=>{let{stream_type:m}=p;return u===m}))===null||l===void 0?void 0:l.attributes})}async tryToUnmuteAudio(e){for(let s=0;s<e.length;s++)if(e[s]instanceof ln){var n;const a=this.filterTobeUnmutedTracks(e[s]);if(a.length===0)continue;await((n=this.connection)===null||n===void 0?void 0:n.unmuteLocal(a.map(u=>{let[,{id:p}]=u;return p})));const l=this.createUnmuteMessage(a);return void await gn(this,st.RequestUnmuteLocal,l)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var n;return!((n=this.connection)===null||n===void 0||!n.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,n)=>this.emit(st.RequestUpload,e,n),this.statsUploader.requestUploadStats=e=>this.emit(st.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await ri(Lb(this.dtlsFailedCount,wr)),this.emit(st.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),n=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),n.length>0&&await Tr(this,st.RequestUnpublishForReconnectPC,n),this.disconnectForReconnect(),this.emit(st.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Ie.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof At)}throwIfTrackTypeNotMatch(e){if(e.filter(n=>n instanceof At).length>1)throw new ye(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(n=>n instanceof ln).length>1&&(e.some(n=>n instanceof ln&&n._bypassWebAudio)||!Kt().webAudioMediaStreamDest))throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const n of e){if(n instanceof At&&this.pendingLocalTracks.some(s=>s instanceof At))throw new ye(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n instanceof ln&&this.pendingLocalTracks.some(s=>s instanceof ln)&&(!Kt().webAudioMediaStreamDest||n._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof ln&&s._bypassWebAudio)))throw new ye(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,n){const s=!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&Kt().supportDualStreamEncoding,a=Du(Du({},{width:160,height:120,framerate:15,bitrate:50}),n);let l;l=s?e._mediaStreamTrack.clone():fx(e,a);const u=Sn(8,"track-low-"),p=new At(l,Du(Du({},s&&{scaleResolutionDownBy:DN(a,e)}),{},{frameRate:a.framerate,bitrateMax:a.bitrate,bitrateMin:a.bitrate}),void 0,void 0,u);return p.on(vu.TRANSCEIVER_UPDATED,m=>{e._updateRtpTransceiver(m,Eu.LOW_STREAM)}),p._hints.push(wn.LOW_STREAM),e.on("sei-to-send",m=>{p.emit("sei-to-send",m)}),e.addListener(Ve.NEED_CLOSE,()=>{p.close()}),p}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,n,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof sr){var l,u,p,m;const g=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:E,dtlsTransportState:y,peerConnectionState:C}=this.connection,{local:I,remote:j}=await this.connection.getSelectedCandidatePair();qe.pcStats(this.store.sessionId,{startTime:g,eventElapse:e-g||0,iceconnectionsate:E,dtlsstate:y,connectionstate:C,intSucc:n?1:2,error:a,selectedLocalCandidateProtocol:(l=I==null?void 0:I.protocol)!==null&&l!==void 0?l:"",selectedLocalCandidateType:(u=I.candidateType)!==null&&u!==void 0?u:"",selectedLocalCandidateAddress:"".concat(I.address,":").concat(I.port),selectedRemoteCandidateProtocol:(p=j.protocol)!==null&&p!==void 0?p:"",selectedRemoteCandidateType:(m=j.candidateType)!==null&&m!==void 0?m:"",selectedRemoteCandidateAddress:"".concat(j.address,":").concat(j.port),restartCnt:s})}}reportVideoFirstFrameDecoded(e,n,s,a){var l;const u=Array.from(vo(l=this.remoteUserMap).call(l)).find(p=>p._videoSSRC===e);if(u){a||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,m=p.subscribe.find(g=>g.userId===u.uid&&g.type==="video");qe.firstRemoteVideoDecode(this.store.sessionId,Mr.FIRST_VIDEO_DECODE,kn.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:n,videoheight:s,subscribeElapse:Li.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(m==null?void 0:m.subscribeEnd)||0,subscriberStart:(m==null?void 0:m.subscribeStart)||0,videoAddNotify:(m==null?void 0:m.streamAdded)||0,state:a?1:0})}}async remoteMediaSsrcChanged(e,n,s){if(!this.connection)return!1;const a=this.remoteUserMap.get(e);if(!a)return!1;const l=a.get(n);if(!l)return!1;const u=await this.connection.getRemoteSSRC(l);return u!==void 0&&u!==s}resetConnection(e){N.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat(e)),this.state===en.Connected?(N.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=e===qb.datachannel?new Vr({},this.store):this.isPlanB?new ai({},this.store):new sr({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[n,{track:s}]=e;n===Ie.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,Eu.LOW_STREAM):s._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(e){this.connection&&this.connection instanceof sr&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===bc.TCP_RESTART&&e===Pi.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,bc.DISCONNECTED_OR_FAILED)))}}function Ji(i,e,n){const s=i[e];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const a=this.mutex,l=await a.lock("From P2PChannel.".concat(e));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},n}function Nce(i){let e=q6();return function(n,s){let a=n.appId;a!==void 0&&(rn(s,10),_l(s,a));let l=n.cid;l!==void 0&&(rn(s,16),rn(s,l));let u=n.cname;u!==void 0&&(rn(s,26),_l(s,u));let p=n.deviceId;p!==void 0&&(rn(s,34),_l(s,p));let m=n.elapse;m!==void 0&&(rn(s,40),Lu(s,m));let g=n.fileSize;g!==void 0&&(rn(s,48),Lu(s,Nm(g)));let E=n.height;E!==void 0&&(rn(s,56),Lu(s,Nm(E)));let y=n.jpg;y!==void 0&&(rn(s,66),rn(s,y.length),function(io,Te){let xe=km(io,Te.length);io.bytes.set(Te,xe)}(s,y));let C=n.networkType;C!==void 0&&(rn(s,72),Lu(s,Nm(C)));let I=n.osType;I!==void 0&&(rn(s,80),Lu(s,Nm(I)));let j=n.requestId;j!==void 0&&(rn(s,90),_l(s,j));let P=n.sdkVersion;P!==void 0&&(rn(s,98),_l(s,P));let U=n.sequence;U!==void 0&&(rn(s,104),Lu(s,Nm(U)));let q=n.sid;q!==void 0&&(rn(s,114),_l(s,q));let J=n.timestamp;J!==void 0&&(rn(s,120),Lu(s,J));let se=n.uid;se!==void 0&&(rn(s,128),rn(s,se));let he=n.vid;he!==void 0&&(rn(s,136),rn(s,he));let ae=n.width;ae!==void 0&&(rn(s,144),Lu(s,Nm(ae)));let de=n.service;de!==void 0&&(rn(s,152),rn(s,de));let me=n.callbackData;me!==void 0&&(rn(s,162),_l(s,me));let ge=n.jpgEncryption;ge!==void 0&&(rn(s,168),rn(s,ge));let Oe=n.requestType;Oe!==void 0&&(rn(s,176),rn(s,Oe));let De=n.scorePorn;De!==void 0&&(rn(s,185),wx(s,De));let _t=n.scoreSexy;_t!==void 0&&(rn(s,193),wx(s,_t));let Pt=n.scoreNeutral;Pt!==void 0&&(rn(s,201),wx(s,Pt));let Rn=n.scene;Rn!==void 0&&(rn(s,208),rn(s,Rn));let kr=n.ossFilePrefix;kr!==void 0&&(rn(s,218),_l(s,kr));let xn=n.serviceVendor;if(xn!==void 0)for(let io of xn){rn(s,226);let Te=q6();Pce(io,Te),rn(s,Te.limit),Uce(s,Te),Mce(Te)}}(i,e),function(n){let s=n.bytes,a=n.limit;return s.length===a?s:s.subarray(0,a)}(e)}function kce(i){return function(n){let s={};e:for(;!X6(n);){let a=El(n);switch(a>>>3){case 0:break e;case 1:s.code=El(n);break;case 2:s.msg=J6(n,El(n));break;case 3:{let l=Dce(n);s.data=xce(n),n.limit=l;break}default:K6(n,7&a)}}return s}({bytes:e=i,offset:0,limit:e.length});var e}function xce(i){let e={};e:for(;!X6(i);){let n=El(i);switch(n>>>3){case 0:break e;case 1:e.requestId=J6(i,El(i));break;case 2:e.requestType=El(i)>>>0;break;case 3:e.scorePorn=Cx(i);break;case 4:e.scoreSexy=Cx(i);break;case 5:e.scoreNeutral=Cx(i);break;case 6:e.requestScene=El(i)>>>0;break;case 7:e.scene=El(i)>>>0;break;default:K6(i,7&n)}}return e}function Pce(i,e){let n=i.service;n!==void 0&&(rn(e,8),rn(e,n));let s=i.vendor;s!==void 0&&(rn(e,16),rn(e,s));let a=i.token;a!==void 0&&(rn(e,26),_l(e,a));let l=i.callbackUrl;l!==void 0&&(rn(e,34),_l(e,l))}function Dce(i){let e=El(i),n=i.limit;return i.limit=i.offset+e,n}function K6(i,e){switch(e){case 0:for(;128&Q6(i););break;case 2:bx(i,El(i));break;case 5:bx(i,4);break;case 1:bx(i,8);break;default:throw new Error("Unimplemented type: "+e)}}be([Ji,$("design:type",Function),$("design:paramtypes",[Object,Boolean]),$("design:returntype",pe)],ci.prototype,"startP2PConnection",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Object,Object,Array,Object,String,String]),$("design:returntype",pe)],ci.prototype,"connect",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",void 0)],ci.prototype,"updateRemoteRTPCapabilities",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Object,Object,Array,Object,String,String]),$("design:returntype",pe)],ci.prototype,"preConnect",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ci.prototype,"publishDataChannel",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ci.prototype,"unpublish",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ci.prototype,"unpublishDataChannel",null),be([Ji,$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],ci.prototype,"unpublishLowStream",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,Array]),$("design:returntype",pe)],ci.prototype,"subscribeDataChannel",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,String,Number,Number,Array]),$("design:returntype",pe)],ci.prototype,"subscribe",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ci.prototype,"massSubscribe",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,String,Boolean]),$("design:returntype",pe)],ci.prototype,"unsubscribe",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,Array]),$("design:returntype",pe)],ci.prototype,"unsubscribeDataChannel",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],ci.prototype,"massUnsubscribe",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,String]),$("design:returntype",pe)],ci.prototype,"muteRemote",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,String]),$("design:returntype",pe)],ci.prototype,"unmuteRemote",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,String]),$("design:returntype",pe)],ci.prototype,"hasRemoteMediaWithLock",null),be([Ji,$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],ci.prototype,"disconnectForReconnect",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],ci.prototype,"updateBitrateLimit",null),be([Ji,$("design:type",Function),$("design:paramtypes",[Si,String,Number]),$("design:returntype",pe)],ci.prototype,"remoteMediaSsrcChanged",null);let Lce=new Float32Array(1);new Uint8Array(Lce.buffer);let Sx=new Float64Array(1),Bs=new Uint8Array(Sx.buffer);function Nm(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}let Y6=[];function q6(){const i=Y6.pop();return i?(i.offset=i.limit=0,i):{bytes:new Uint8Array(64),offset:0,limit:0}}function Mce(i){Y6.push(i)}function bx(i,e){if(i.offset+e>i.limit)throw new Error("Skip past limit");i.offset+=e}function X6(i){return i.offset>=i.limit}function km(i,e){let n=i.bytes,s=i.offset,a=i.limit,l=s+e;if(l>n.length){let u=new Uint8Array(2*l);u.set(n),i.bytes=u}return i.offset=l,l>a&&(i.limit=l),s}function Tx(i,e){let n=i.offset;if(n+e>i.limit)throw new Error("Read past limit");return i.offset+=e,n}function J6(i,e){let n=Tx(i,e),s=String.fromCharCode,a=i.bytes,l="�",u="";for(let p=0;p<e;p++){let m,g,E,y,C=a[p+n];128&C?(224&C)==192?p+1>=e?u+=l:(m=a[p+n+1],(192&m)!=128?u+=l:(y=(31&C)<<6|63&m,y<128?u+=l:(u+=s(y),p++))):(240&C)==224?p+2>=e?u+=l:(m=a[p+n+1],g=a[p+n+2],(49344&(m|g<<8))!=32896?u+=l:(y=(15&C)<<12|(63&m)<<6|63&g,y<2048||y>=55296&&y<=57343?u+=l:(u+=s(y),p+=2))):(248&C)==240?p+3>=e?u+=l:(m=a[p+n+1],g=a[p+n+2],E=a[p+n+3],(12632256&(m|g<<8|E<<16))!=8421504?u+=l:(y=(7&C)<<18|(63&m)<<12|(63&g)<<6|63&E,y<65536||y>1114111?u+=l:(y-=65536,u+=s(55296+(y>>10),56320+(1023&y)),p+=3))):u+=l:u+=s(C)}return u}function _l(i,e){let n=e.length,s=0;for(let u=0;u<n;u++){let p=e.charCodeAt(u);p>=55296&&p<=56319&&u+1<n&&(p=(p<<10)+e.charCodeAt(++u)-56613888),s+=p<128?1:p<2048?2:p<65536?3:4}rn(i,s);let a=km(i,s),l=i.bytes;for(let u=0;u<n;u++){let p=e.charCodeAt(u);p>=55296&&p<=56319&&u+1<n&&(p=(p<<10)+e.charCodeAt(++u)-56613888),p<128?l[a++]=p:(p<2048?l[a++]=p>>6&31|192:(p<65536?l[a++]=p>>12&15|224:(l[a++]=p>>18&7|240,l[a++]=p>>12&63|128),l[a++]=p>>6&63|128),l[a++]=63&p|128)}}function Uce(i,e){let n=km(i,e.limit),s=i.bytes,a=e.bytes;for(let l=0,u=e.limit;l<u;l++)s[l+n]=a[l]}function Q6(i){return i.bytes[Tx(i,1)]}function Z6(i,e){let n=km(i,1);i.bytes[n]=e}function Cx(i){let e=Tx(i,8),n=i.bytes;return Bs[0]=n[e++],Bs[1]=n[e++],Bs[2]=n[e++],Bs[3]=n[e++],Bs[4]=n[e++],Bs[5]=n[e++],Bs[6]=n[e++],Bs[7]=n[e++],Sx[0]}function wx(i,e){let n=km(i,8),s=i.bytes;Sx[0]=e,s[n++]=Bs[0],s[n++]=Bs[1],s[n++]=Bs[2],s[n++]=Bs[3],s[n++]=Bs[4],s[n++]=Bs[5],s[n++]=Bs[6],s[n++]=Bs[7]}function El(i){let e,n=0,s=0;do e=Q6(i),n<32&&(s|=(127&e)<<n),n+=7;while(128&e);return s}function rn(i,e){for(e>>>=0;e>=128;)Z6(i,127&e|128),e>>>=7;Z6(i,e)}function Lu(i,e){let n=e.low>>>0,s=(e.low>>>28|e.high<<4)>>>0,a=e.high>>>24,l=a===0?s===0?n<16384?n<128?1:2:n<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:a<128?9:10,u=km(i,l),p=i.bytes;switch(l){case 10:p[u+9]=a>>>7&1;case 9:p[u+8]=l!==9?128|a:127&a;case 8:p[u+7]=l!==8?s>>>21|128:s>>>21&127;case 7:p[u+6]=l!==7?s>>>14|128:s>>>14&127;case 6:p[u+5]=l!==6?s>>>7|128:s>>>7&127;case 5:p[u+4]=l!==5?128|s:127&s;case 4:p[u+3]=l!==4?n>>>21|128:n>>>21&127;case 3:p[u+2]=l!==3?n>>>14|128:n>>>14&127;case 2:p[u+1]=l!==2?n>>>7|128:n>>>7&127;case 1:p[u]=l!==1?128|n:127&n}}function eW(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}const jce=new Map([["moderation",1],["supervise",2]]);class XT extends jn{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const n=this._connectionState;this._connectionState=e,this.emit(jr.CONNECTION_STATE_CHANGE,n,e)}get inspectType(){return this._inspectType}set inspectType(e){var n;this._inspectMode=ed(n=e.map(s=>jce.get(s)||0)).call(n,(s,a)=>s+a),this._inspectType=e}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(e){super(),R(this,"name","AgoraRTCVideoContentInspect"),R(this,"_connectionState",So.CONNECTING),R(this,"_innerConnectionState",void 0),R(this,"sequence",0),R(this,"inspectStartTime",void 0),R(this,"workerManagerConnection",void 0),R(this,"workerConnection",void 0),R(this,"workerMessageLengthLimit",void 0),R(this,"inspectIntervalMinimum",void 0),R(this,"qualityRatio",void 0),R(this,"_connectInfo",void 0),R(this,"_cancelTokenSource",Ls.CancelToken.source()),R(this,"_retryConfig",void 0),R(this,"wmSequence",0),R(this,"inspectInterval",void 0),R(this,"inspectTimer",null),R(this,"ossFilePrefix",void 0),R(this,"extraInfo",void 0),R(this,"_inspectType",void 0),R(this,"_inspectMode",void 0),R(this,"_quality",1),R(this,"qualityTimer",null),R(this,"_inspectId",void 0),R(this,"_needWorkUrlOnly",!1),R(this,"inspectImage",()=>{if(this.connectionState!==So.CONNECTED)throw new le(z.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===So.CONNECTED?this.requestToInspectImage():N.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=Sn(5,"inspect-"),this.workerMessageLengthLimit=Z("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=Z("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=Z("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=e.interval,this.ossFilePrefix=e.ossFilePrefix,this.extraInfo=e.extraInfo,this.inspectType=e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new ME("worker-manager-"+this._inspectId,wr),this.on(jr.STATE_CHANGE,(n,s)=>{this._innerConnectionState=n,N.debug("[".concat(this._inspectId,"] Inspect operation :").concat(bo[n]," ").concat(s||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new ME("worker-"+this._inspectId,wr),this.handleWorkerEvents()}async init(e,n){this.emit(jr.STATE_CHANGE,bo.CONNECT_AP),this._connectInfo=e;const s=this._cancelTokenSource.token;return this._retryConfig=n,new pe((a,l)=>{this.on(jr.CONNECTION_STATE_CHANGE,(u,p)=>{p===So.CONNECTED&&a()}),this.requestAP(e,s,n).then(u=>{this.connectWorkerManager(u)}).catch(u=>{l(u)})})}async requestAP(e,n,s){const a=Z("WEBCS_DOMAIN").map(p=>"https://".concat(p,"/api/v1")),l=await function(p,m,g,E){let{appId:y,areaCode:C,cname:I,sid:j,token:P,uid:U}=m;im++;const q="image_moderation_api",J={service_name:q,json_body:JSON.stringify({appId:y,areaCode:C,cname:I,command:"allocateEdge",requestId:im,seq:im,sid:j,token:P,ts:Date.now(),uid:U+""})};let se,he,ae=p[0];return vc(async()=>{se=Date.now();const de=await sd(ae,{data:J,cancelToken:g,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(he=Date.now()-se,de.code!==0){const De=new le(z.UNEXPECTED_RESPONSE,"image inspect ap error, code"+de.code,{retry:!0,responseTime:he});throw N.error(De.toString()),De}const me=JSON.parse(de.json_body);if(me.code!==200){const De=new le(z.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(me.code,", reason: ").concat(me.reason),{code:me.code,responseTime:he});throw N.error(De.toString()),De}if(!me.servers||!Array.isArray(me.servers)||me.servers.length===0){const De=new le(z.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:me.code,responseTime:he});throw N.error(De.toString()),De}const ge=Z("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Oe=Z("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:me.servers.map(De=>{let{address:_t,wss:Pt}=De;if(_t&&Pt)return"wss://".concat(_t.replace(/\./g,"-"),".").concat(ge,":").concat(Oe||Pt)}).filter(De=>!!De),workerToken:me.workerToken,vid:me.vid,responseTime:he}},(de,me)=>(qe.apworkerEvent(j,{success:!0,sc:200,serviceName:q,responseDetail:JSON.stringify(de.addressList),firstSuccess:me===0,responseTime:he,serverIp:p[me%p.length]}),!1),(de,me)=>(qe.apworkerEvent(j,{success:!1,sc:de.data&&de.data.code||200,serviceName:q,responseTime:he,serverIp:p[me%p.length]}),!!(de.code!==z.OPERATION_ABORTED&&de.code!==z.UNEXPECTED_RESPONSE||de.data&&de.data.retry)&&(ae=p[(me+1)%p.length],!0)),E)}(a,e,n,s);this.emit(jr.STATE_CHANGE,bo.AP_CONNECTED);const{addressList:u}=l;return this.wmSequence++,u}async connectWorkerManager(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=n,this.emit(jr.STATE_CHANGE,bo.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(e,1e4)}async connectWorker(e){await this.workerConnection.init([e])}handleWorkerManagerEvents(){this.workerManagerConnection.on(ct.CONNECTED,async()=>{this.emit(jr.STATE_CHANGE,bo.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.20.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(ct.CLOSED,()=>{this._innerConnectionState<bo.GET_WORKER_MANAGER_RESPONSE&&N.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(ct.FAILED,()=>{this._innerConnectionState<bo.GET_WORKER_MANAGER_RESPONSE&&N.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(ct.RECONNECTING,()=>{this._innerConnectionState<bo.GET_WORKER_MANAGER_RESPONSE&&N.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(ct.ON_MESSAGE,async e=>{this.emit(jr.STATE_CHANGE,bo.GET_WORKER_MANAGER_RESPONSE);const n=this.workerManagerConnection.url;this.workerManagerConnection.close();const s=JSON.parse(e.data);if(s.code!==200)throw N.error("[".concat(this._inspectId,"] Unexpected code ").concat(s.code," from worker manager")),new le(z.UNEXPECTED_RESPONSE,"response code of worker is unexpected",s);if(!(s.serverResponse&&s.serverResponse.portWss&&n))throw N.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(s))),new le(z.UNEXPECTED_RESPONSE,"response content of worker is unexpected",s);{const a=Z("VIDEO_INSPECT_WORKER_PORT")||s.serverResponse.portWss,l=n.replace(/:\d+\/?$/,":".concat(a));this.emit(jr.STATE_CHANGE,bo.CONNECT_WORKER,l),this._needWorkUrlOnly?this.emit(jr.REQUEST_NEW_WORKER_URL,l):await this.connectWorker(l)}}),this.workerManagerConnection.on(ct.WILL_RECONNECT,(e,n,s)=>{s(e)}),this.workerManagerConnection.on(ct.REQUEST_NEW_URLS,(e,n)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(n)})}handleWorkerEvents(){this.workerConnection.on(ct.CONNECTED,async()=>{this.emit(jr.STATE_CHANGE,bo.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=So.CONNECTED}),this.workerConnection.on(ct.ON_MESSAGE,async e=>{if(e.data instanceof ArrayBuffer){const s=kce(new Uint8Array(e.data));if(Z("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&N.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(s)),s.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(jr.INSPECT_RESULT,void 0,void 0);if(s.data&&s.data.scorePorn&&s.data.scoreSexy&&s.data.scoreNeutral){var n;const a={porn:s.data.scorePorn,sexy:s.data.scoreSexy,neutral:s.data.scoreNeutral},l=ed(n=Object.keys(a)).call(n,(p,m)=>a[p]>a[m]?p:m,"porn"),u=Object.keys(a).find(p=>p===l);this.emit(jr.INSPECT_RESULT,u)}else this.emit(jr.INSPECT_RESULT,void 0,new le(z.UNEXPECTED_RESPONSE,s.code+"","There is an unexpected data on message"))}else this.emit(jr.INSPECT_RESULT,void 0,new le(z.UNEXPECTED_RESPONSE,s.code+"",s.msg))}else N.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(jr.INSPECT_RESULT,void 0,new le(z.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(ct.CLOSED,()=>{this.connectionState=So.CLOSED}),this.workerConnection.on(ct.FAILED,()=>{this.connectionState=So.CLOSED}),this.workerConnection.on(ct.RECONNECTING,()=>{this.connectionState=this.connectionState===So.CONNECTED?So.RECONNECTING:So.CONNECTING}),this.workerConnection.on(ct.WILL_RECONNECT,(e,n,s)=>{e==="recover"&&s(e),s("tryNext")}),this.workerConnection.on(ct.REQUEST_NEW_URLS,(e,n)=>{this.workerManagerConnection.close(),this.once(jr.REQUEST_NEW_WORKER_URL,s=>{e([s])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(s=>{this.connectWorkerManager(s,!0)}).catch(s=>{n(s)})})}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){this.sequence++;const e=Qs(this,jr.CLIENT_LOCAL_VIDEO_TRACK),n={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void this.emit(jr.INSPECT_RESULT,void 0,new le(z.INVALID_OPERATION,"Only the track being played can be inspected"));const s=await this.generateRequestData(e,n);this.workerConnection.sendMessage(s,!0,!0)}else this.emit(jr.INSPECT_RESULT,void 0,new le(z.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(e,n){let{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m}=n;const g=Date.now(),E=await e.getCurrentFrameImage("image/jpeg",this.quality),y=await hV(E,s,a),C=this.sequence+"-"+l+"-"+m+"-"+g+"-"+Sn(12,""),I={appId:s,cid:l,cname:a,deviceId:"",elapse:XT.intToLong(Number(g-this.inspectStartTime)),fileSize:y.byteLength,jpgEncryption:2,height:E.height,width:E.width,jpg:y,networkType:6,osType:7,requestId:C,sdkVersion:"4.20.2",sequence:this.sequence,sid:p,timestamp:XT.intToLong(g),uid:m,vid:u,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete I.callbackData,this.ossFilePrefix===void 0&&delete I.ossFilePrefix;const j=Nce(I);if(j.byteLength<this.workerMessageLengthLimit){if(Z("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const P=function(U){for(var q=1;q<arguments.length;q++){var J=arguments[q]!=null?arguments[q]:{};q%2?eW(Object(J),!0).forEach(function(se){R(U,se,J[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(J)):eW(Object(J)).forEach(function(se){Object.defineProperty(U,se,Object.getOwnPropertyDescriptor(J,se))})}return U}({},I);delete P.jpg,N.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(P))}return j}{const P=this.quality*this.qualityRatio;return this.quality=P,await this.generateRequestData(e,{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Ls.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=So.CLOSED,this.emit(jr.STATE_CHANGE,bo.CLOSED)}}function Fce(i){let e=function(){const n=Wce.pop();return n?(n.offset=n.limit=0,n):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(n,s){let a=n.appId;a!==void 0&&(Er(s,10),Mu(s,a));let l=n.cid;l!==void 0&&(Er(s,16),Er(s,l));let u=n.cname;u!==void 0&&(Er(s,26),Mu(s,u));let p=n.deviceId;p!==void 0&&(Er(s,34),Mu(s,p));let m=n.elapse;m!==void 0&&(Er(s,40),Uu(s,m));let g=n.fileSize;g!==void 0&&(Er(s,48),Uu(s,xm(g)));let E=n.height;E!==void 0&&(Er(s,56),Uu(s,xm(E)));let y=n.jpg;y!==void 0&&(Er(s,66),Er(s,y.length),nW(s,y));let C=n.networkType;C!==void 0&&(Er(s,72),Uu(s,xm(C)));let I=n.osType;I!==void 0&&(Er(s,80),Uu(s,xm(I)));let j=n.requestId;j!==void 0&&(Er(s,90),Mu(s,j));let P=n.sdkVersion;P!==void 0&&(Er(s,98),Mu(s,P));let U=n.sequence;U!==void 0&&(Er(s,104),Uu(s,xm(U)));let q=n.sid;q!==void 0&&(Er(s,114),Mu(s,q));let J=n.timestamp;J!==void 0&&(Er(s,120),Uu(s,J));let se=n.uid;se!==void 0&&(Er(s,128),Er(s,se));let he=n.vid;he!==void 0&&(Er(s,136),Er(s,he));let ae=n.width;ae!==void 0&&(Er(s,144),Uu(s,xm(ae)));let de=n.service;de!==void 0&&(Er(s,152),Er(s,de));let me=n.callbackData;me!==void 0&&(Er(s,162),Er(s,me.length),nW(s,me));let ge=n.ticket;ge!==void 0&&(Er(s,170),Mu(s,ge));let Oe=n.vendorConfigs;Oe!==void 0&&(Er(s,178),Mu(s,Oe))}(i,e),function(n){let s=n.bytes,a=n.limit;return s.length===a?s:s.subarray(0,a)}(e)}function Vce(i){return function(n){let s={};e:for(;!$ce(n);){let a=Ev(n);switch(a>>>3){case 0:break e;case 1:s.code=Ev(n);break;case 2:s.msg=rW(n,Ev(n));break;case 3:s.requestId=rW(n,Ev(n));break;case 4:s.timestamp=Gce(n,!1);break;default:Bce(n,7&a)}}return s}({bytes:e=i,offset:0,limit:e.length});var e}function Bce(i,e){switch(e){case 0:for(;128&Ba(i););break;case 2:Rx(i,Ev(i));break;case 5:Rx(i,4);break;case 1:Rx(i,8);break;default:throw new Error("Unimplemented type: "+e)}}function xm(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}let Wce=[];function Rx(i,e){if(i.offset+e>i.limit)throw new Error("Skip past limit");i.offset+=e}function $ce(i){return i.offset>=i.limit}function JT(i,e){let n=i.bytes,s=i.offset,a=i.limit,l=s+e;if(l>n.length){let u=new Uint8Array(2*l);u.set(n),i.bytes=u}return i.offset=l,l>a&&(i.limit=l),s}function tW(i,e){let n=i.offset;if(n+e>i.limit)throw new Error("Read past limit");return i.offset+=e,n}function nW(i,e){let n=JT(i,e.length);i.bytes.set(e,n)}function rW(i,e){let n=tW(i,e),s=String.fromCharCode,a=i.bytes,l="�",u="";for(let p=0;p<e;p++){let m,g,E,y,C=a[p+n];128&C?(224&C)==192?p+1>=e?u+=l:(m=a[p+n+1],(192&m)!=128?u+=l:(y=(31&C)<<6|63&m,y<128?u+=l:(u+=s(y),p++))):(240&C)==224?p+2>=e?u+=l:(m=a[p+n+1],g=a[p+n+2],(49344&(m|g<<8))!=32896?u+=l:(y=(15&C)<<12|(63&m)<<6|63&g,y<2048||y>=55296&&y<=57343?u+=l:(u+=s(y),p+=2))):(248&C)==240?p+3>=e?u+=l:(m=a[p+n+1],g=a[p+n+2],E=a[p+n+3],(12632256&(m|g<<8|E<<16))!=8421504?u+=l:(y=(7&C)<<18|(63&m)<<12|(63&g)<<6|63&E,y<65536||y>1114111?u+=l:(y-=65536,u+=s(55296+(y>>10),56320+(1023&y)),p+=3))):u+=l:u+=s(C)}return u}function Mu(i,e){let n=e.length,s=0;for(let u=0;u<n;u++){let p=e.charCodeAt(u);p>=55296&&p<=56319&&u+1<n&&(p=(p<<10)+e.charCodeAt(++u)-56613888),s+=p<128?1:p<2048?2:p<65536?3:4}Er(i,s);let a=JT(i,s),l=i.bytes;for(let u=0;u<n;u++){let p=e.charCodeAt(u);p>=55296&&p<=56319&&u+1<n&&(p=(p<<10)+e.charCodeAt(++u)-56613888),p<128?l[a++]=p:(p<2048?l[a++]=p>>6&31|192:(p<65536?l[a++]=p>>12&15|224:(l[a++]=p>>18&7|240,l[a++]=p>>12&63|128),l[a++]=p>>6&63|128),l[a++]=63&p|128)}}function Ba(i){return i.bytes[tW(i,1)]}function iW(i,e){let n=JT(i,1);i.bytes[n]=e}function Ev(i){let e,n=0,s=0;do e=Ba(i),n<32&&(s|=(127&e)<<n),n+=7;while(128&e);return s}function Er(i,e){for(e>>>=0;e>=128;)iW(i,127&e|128),e>>>=7;iW(i,e)}function Gce(i,e){let n,s=0,a=0,l=0;return n=Ba(i),s=127&n,128&n&&(n=Ba(i),s|=(127&n)<<7,128&n&&(n=Ba(i),s|=(127&n)<<14,128&n&&(n=Ba(i),s|=(127&n)<<21,128&n&&(n=Ba(i),a=127&n,128&n&&(n=Ba(i),a|=(127&n)<<7,128&n&&(n=Ba(i),a|=(127&n)<<14,128&n&&(n=Ba(i),a|=(127&n)<<21,128&n&&(n=Ba(i),l=127&n,128&n&&(n=Ba(i),l|=(127&n)<<7))))))))),{low:s|a<<28,high:a>>>4|l<<24,unsigned:e}}function Uu(i,e){let n=e.low>>>0,s=(e.low>>>28|e.high<<4)>>>0,a=e.high>>>24,l=a===0?s===0?n<16384?n<128?1:2:n<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:a<128?9:10,u=JT(i,l),p=i.bytes;switch(l){case 10:p[u+9]=a>>>7&1;case 9:p[u+8]=l!==9?128|a:127&a;case 8:p[u+7]=l!==8?s>>>21|128:s>>>21&127;case 7:p[u+6]=l!==7?s>>>14|128:s>>>14&127;case 6:p[u+5]=l!==6?s>>>7|128:s>>>7&127;case 5:p[u+4]=l!==5?128|s:127&s;case 4:p[u+3]=l!==4?n>>>21|128:n>>>21&127;case 3:p[u+2]=l!==3?n>>>14|128:n>>>14&127;case 2:p[u+1]=l!==2?n>>>7|128:n>>>7&127;case 1:p[u]=l!==1?128|n:127&n}}const sW={},oW={},QT=4294967296,aW=QT*QT,cW=aW/2,Ix=dW(0,!0),lW=dW(0),Hce=Pm(0,-2147483648,!1),zce=Pm(-1,2147483647,!1),Kce=Pm(-1,-1,!0);function dW(i,e){let n,s,a;return e?(a=0<=(i>>>=0)&&i<256)&&(s=oW[i],s)?s:(n=Pm(i,0,!0),a&&(oW[i]=n),n):(a=-128<=(i|=0)&&i<128)&&(s=sW[i],s)?s:(n=Pm(i,i<0?-1:0,!1),a&&(sW[i]=n),n)}function Pm(i,e,n){return{low:0|i,high:0|e,unsigned:!!n}}function Yce(i,e){if(isNaN(i))return e?Ix:lW;if(e){if(i<0)return Ix;if(i>=aW)return Kce}else{if(i<=-cW)return Hce;if(i+1>=cW)return zce}return i<0?e?Ix:lW:Pm(i%QT|0,i/QT|0,e)}function uW(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}class Ax extends jn{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const n=this._connectionState;this._connectionState=e,this.emit(Jo.CONNECTION_STATE_CHANGE,e,n)}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(e){var n;super(),R(this,"name","AgoraRTCImageModeration"),R(this,"_connectionState",Zs.CONNECTING),R(this,"_sequence",0),R(this,"_moderationStartTime",void 0),R(this,"_workerConnection",void 0),R(this,"_workerMessageLengthLimit",void 0),R(this,"_qualityRatio",void 0),R(this,"_connectInfo",void 0),R(this,"_cancelTokenSource",Ls.CancelToken.source()),R(this,"_retryConfig",void 0),R(this,"_moderationInterval",void 0),R(this,"_moderationTimer",null),R(this,"_moderationMode",1),R(this,"_quality",1),R(this,"_qualityTimer",null),R(this,"_ticket",void 0),R(this,"_moderationIntervalMinimum",void 0),R(this,"_uploadFailedNum",0),R(this,"_uploadNum",0),R(this,"_uploadTimer",null),R(this,"_extraInfo",void 0),R(this,"_vendor",""),R(this,"_encoder",new TextEncoder),R(this,"_moderationId",void 0),R(this,"inspectImage",()=>{if(this.connectionState!==Zs.CONNECTED)throw new le(z.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Zs.CONNECTED?this.requestToInspectImage():N.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=Sn(5,"image-moderation-"),this._workerMessageLengthLimit=Z("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=Z("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(n=e.interval)!==null&&n!==void 0?n:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),this._qualityRatio=Z("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new ME("worker-"+this._moderationId,wr),this.on(Jo.STATE_CHANGE,(s,a)=>{N.debug("[".concat(this._moderationId,"] Moderation operation :").concat(fu[s]," ").concat(a||""))}),this.handleWorkerEvents()}async init(e,n){this.emit(Jo.STATE_CHANGE,fu.CONNECT_AP),this._connectInfo=e;const s=this._cancelTokenSource.token;return this._retryConfig=n,new pe((a,l)=>{this.on(Jo.CONNECTION_STATE_CHANGE,(u,p)=>{u===Zs.CONNECTED&&a()}),this.requestAP(e,s,n).then(u=>{this.connectWorker(u)}).catch(u=>{l(u)})})}updateConfig(e){var n;this._moderationInterval=(n=e.interval)!==null&&n!==void 0?n:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),N.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(e))),this.connectionState===Zs.CONNECTED&&this.inspectImage()}async requestAP(e,n,s){const a=Z("WEBCS_DOMAIN").map(m=>"https://".concat(m,"/api/v1")),l=await function(m,g,E,y){let{appId:C,areaCode:I,cname:j,sid:P,token:U,uid:q}=g;im++;const J="moderation_plugin",se={service_name:J,json_body:JSON.stringify({appId:C,areaCode:I,cname:j,command:"allocateEdge",requestId:im,seq:im,sid:P,appToken:U,ts:Date.now(),uid:q+""})};let he,ae,de=m[0];return vc(async()=>{he=Date.now();const me=await sd(de,{data:se,cancelToken:E,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(ae=Date.now()-he,me.code!==0){const De=new le(z.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+me.code,{retry:!0,responseTime:ae});throw N.error(De.toString()),De}const ge=JSON.parse(me.json_body);if(ge.code!==200){const De=new le(z.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(ge.code,", reason: ").concat(ge.reason),{code:ge.code,responseTime:ae});throw N.error(De.toString()),De}if(!ge.servers||!Array.isArray(ge.servers)||ge.servers.length===0){const De=new le(z.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:ge.code,responseTime:ae});throw N.error(De.toString()),De}if(!ge.servers.some(De=>!!De.wss)){const De=new le(z.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:ge.code,responseTime:ae});throw N.error(De.toString()),De}const Oe=Z("IMAGE_MODERATION_WORKER_HOST");return{addressList:ge.servers.map(De=>{let{address:_t,wss:Pt}=De;if(_t&&Pt)return"wss://".concat(_t.replace(/\./g,"-"),".").concat(Oe,":").concat(Pt,"/moderation")}).filter(De=>!!De),workerToken:ge.workerToken,vid:ge.vid,ticket:ge.appTicket,responseTime:ae}},(me,ge)=>(qe.apworkerEvent(P,{success:!0,sc:200,serviceName:J,responseDetail:JSON.stringify(me.addressList),firstSuccess:ge===0,responseTime:ae,serverIp:m[ge%m.length]}),!1),(me,ge)=>(qe.apworkerEvent(P,{success:!1,sc:me.data&&me.data.code||200,serviceName:J,responseTime:ae,serverIp:m[ge%m.length]}),!!(me.code!==z.OPERATION_ABORTED&&me.code!==z.UNEXPECTED_RESPONSE||me.data&&me.data.retry)&&(de=m[(ge+1)%m.length],!0)),y)}(a,e,n,s);this.emit(Jo.STATE_CHANGE,fu.AP_CONNECTED);const{addressList:u,ticket:p}=l;return this._ticket=p,u}async connectWorker(e){this.emit(Jo.STATE_CHANGE,fu.CONNECT_WORKER),await this._workerConnection.init(e,1e4)}handleWorkerEvents(){this._workerConnection.on(ct.CONNECTED,async()=>{this.emit(Jo.STATE_CHANGE,fu.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Zs.CONNECTED}),this._workerConnection.on(ct.CLOSED,()=>{this.connectionState=Zs.CLOSED}),this._workerConnection.on(ct.FAILED,()=>{this.connectionState=Zs.CLOSED}),this._workerConnection.on(ct.RECONNECTING,()=>{this.connectionState=this.connectionState===Zs.CONNECTED?Zs.RECONNECTING:Zs.CONNECTING}),this._workerConnection.on(ct.ON_MESSAGE,async e=>{if(e.data instanceof ArrayBuffer){const n=Vce(new Uint8Array(e.data));Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&N.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(n)),this._uploadNum++,n.code===void 0||n.code===0||(this._uploadFailedNum++,N.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(n.code,", msg is ").concat(n.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{qe.reportApiInvoke(this._connectInfo.sid||null,{name:br.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,n.code],tag:Bn.TRACER}).onError(new le(z.IMAGE_MODERATION_UPLOAD_FAILED,n.msg)),this._uploadTimer=null},Z("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else N.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(ct.WILL_RECONNECT,(e,n,s)=>{e==="recover"&&s(e),s("tryNext")}),this._workerConnection.on(ct.REQUEST_NEW_URLS,(e,n)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(n)})}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){const e=Qs(this,Jo.CLIENT_LOCAL_VIDEO_TRACK),n={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void(Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&N.debug("Only the track being played can be inspected"));this._sequence++;const s=await this.generateRequestData(e,n);this._workerConnection.sendMessage(s,!0,!0)}else Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&N.debug("Only the track being published can be inspected")}async generateRequestData(e,n){let{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m}=n;const g=Date.now(),E=await e.getCurrentFrameImage("image/jpeg",this.quality),y=await hV(E,s,a),C=this._sequence+"-"+l+"-"+m+"-"+g+"-"+Sn(12,""),I={appId:s,cid:l,cname:a,deviceId:"",elapse:Ax.intToLong(Number(g-this._moderationStartTime)),fileSize:E.buffer.byteLength,height:E.height,width:E.width,jpg:y,networkType:6,osType:7,requestId:C,sdkVersion:"4.20.2",sequence:this._sequence,sid:p,timestamp:Yce(g),uid:m,vid:u,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete I.callbackData;const j=Fce(I);if(j.byteLength<this._workerMessageLengthLimit){if(Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const P=function(U){for(var q=1;q<arguments.length;q++){var J=arguments[q]!=null?arguments[q]:{};q%2?uW(Object(J),!0).forEach(function(se){R(U,se,J[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(J)):uW(Object(J)).forEach(function(se){Object.defineProperty(U,se,Object.getOwnPropertyDescriptor(J,se))})}return U}({},I);delete P.jpg,N.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(P))}return j}{const P=this.quality*this._qualityRatio;return this.quality=P,await this.generateRequestData(e,{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Ls.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Zs.CLOSED,this.emit(Jo.STATE_CHANGE,fu.CLOSED)}}function hW(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function pW(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hW(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):hW(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}const qce=Date.now(),Xce=20,Ox=new Map,ZT=new Map;async function fW(i){const e=Ox.get(i),n=Array.isArray(e)&&e[e.length-1],s=ZT.get(i);if(!n)return void(s.isSyncing=!1);const a={uid:n.uid,payload:n.payload};s.firstRecvTs===0&&(s.firstRecvTs=n.recvTs,s.firstSendTs=n.sendTs);const l=n.sendTs-s.firstSendTs,u=l-(Date.now()-s.firstRecvTs);u>0&&(s.firstRecvTs=Date.now()-l);let p=n.mediaDelay+u;p<=0?(e.pop(),mW(n.context,a),p=0):p=Math.min(p,Xce),setTimeout(()=>e.length&&fW(i),p)}function mW(i,e){i.safeEmit(Lt.STREAM_MESSAGE,e.uid,e.payload),i.onStreamMessage&&i.onStreamMessage(e)}function Jce(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(!i.syncWithAudio)return mW(n,{uid:i.uid,payload:i.payload});const s="".concat(n.id,"-").concat(i.uid),a=Ox.get(s)||[],l=a.findIndex(g=>i.sendTs>=g.sendTs),u=pW(pW({},i),{},{context:n,mediaDelay:e,recvTs:Date.now()});l===-1?a.push(u):a.splice(l,0,u),Ox.set(s,a);let p=!1;var m;ZT.has(s)?p=!((m=ZT.get(s))===null||m===void 0||!m.isSyncing):ZT.set(s,{isSyncing:p,firstRecvTs:0,firstSendTs:0}),p||fW(s)}const Qce=zt().name;function Zce(){return!function(i,e,n){const s=zt();if(s.os!==Dr.IOS||!s.osVersion)return!1;const a=s.osVersion.split(".");return n?e&&Number(a[0])===i&&Number(a[1])<e||Number(a[0])<i:e?Number(a[0])===i&&Number(a[1])<=e||Number(a[0])<i:Number(a[0])<=i}(16,0,!0)&&!function(i,e,n){const s=zt();if(s.name!==Zt.SAFARI||!s.osVersion)return!1;const a=s.version.split(".");return n?e&&Number(a[0])===i&&Number(a[1])<e||Number(a[0])<i:e?Number(a[0])===i&&Number(a[1])<=e||Number(a[0])<i:Number(a[0])<=i}(16,0,!0)}function gW(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function Ac(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?gW(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):gW(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}ii.setLogger(N);class dn extends jn{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return((e=this._config)===null||e===void 0?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e){let n;if(super(),R(this,"store",void 0),R(this,"_uid",void 0),R(this,"_channelName",void 0),R(this,"_uintUid",void 0),R(this,"_users",[]),R(this,"_config",void 0),R(this,"_clientId",void 0),R(this,"_appId",void 0),R(this,"_sessionId",null),R(this,"_key",void 0),R(this,"_rtmConfig",{}),R(this,"_joinInfo",void 0),R(this,"_gateway",void 0),R(this,"_statsCollector",void 0),R(this,"_configDistribute",void 0),R(this,"_leaveMutex",new ii("client-leave")),R(this,"_publishMutex",new ii("client-publish")),R(this,"_renewTokenMutex",new ii("client-renewtoken")),R(this,"_subscribeMutex",new ii("client-subscribe")),R(this,"_encryptionMode","none"),R(this,"_encryptionSecret",null),R(this,"_encryptionSalt",null),R(this,"_encryptDataStream",!1),R(this,"_encryptDataStreamKey",null),R(this,"_encryptDataStreamIv",null),R(this,"_proxyServer",void 0),R(this,"_turnServer",{servers:[],mode:"auto"}),R(this,"_cloudProxyServerMode","disabled"),R(this,"_isDualStreamEnabled",!1),R(this,"_defaultStreamFallbackType",void 0),R(this,"_lowStreamParameter",void 0),R(this,"_streamFallbackTypeCacheMap",new Map),R(this,"_remoteStreamTypeCacheMap",new Map),R(this,"_axiosCancelSource",Ls.CancelToken.source()),R(this,"_audioVolumeIndicationInterval",void 0),R(this,"_networkQualityInterval",void 0),R(this,"_userOfflineTimeout",void 0),R(this,"_streamRemovedTimeout",void 0),R(this,"_injectStreamingClient",void 0),R(this,"_liveTranscodeStreamingClient",void 0),R(this,"_liveRawStreamingClient",void 0),R(this,"_channelMediaRelayClient",void 0),R(this,"_networkQualitySensitivity","normal"),R(this,"_p2pChannel",void 0),R(this,"_useLocalAccessPoint",!1),R(this,"_setLocalAPVersion",void 0),R(this,"_joinAndNotLeaveYet",!1),R(this,"_numberOfJoinCount",0),R(this,"_remoteDefaultVideoStreamType",void 0),R(this,"_inspect",void 0),R(this,"_moderation",void 0),R(this,"_license",void 0),R(this,"_pendingPublishedUsers",[]),R(this,"ntpAlignErrorCount",0),R(this,"remoteInboundOffset",0),R(this,"_handleLocalTrackEnable",(s,a,l)=>{this.publish(s,!1).then(a).catch(l)}),R(this,"_handleLocalTrackDisable",(s,a,l)=>{this.unpublish(s).then(a).catch(l)}),R(this,"_handleUserOnline",s=>{if(Z("BLOCK_LOCAL_CLIENT")&&tp(s.uid,this.channelName))return void N.debug("[".concat(s.uid,"] will be ignored in local"));this.isStringUID&&typeof s.uid!="string"&&N.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const a=this._users.find(l=>l.uid===s.uid);if(a)a._trust_in_room_=!0,a._is_pre_created&&(a._is_pre_created=!1,this.safeEmit(Lt.USER_JOINED,a));else{const l=new Si(s.uid,s.uint_id||s.uid);this._users.push(l),N.debug("[".concat(this._clientId,"] user online"),s.uid),this.safeEmit(Lt.USER_JOINED,l)}}),R(this,"_handleUserOffline",s=>{if(Z("BLOCK_LOCAL_CLIENT")&&tp(s.uid,this.channelName))return;const a=this._users.find(l=>l.uid===s.uid);a&&(this._handleRemoveStream(s),this._handleRemoveDataChannels(s),a._audio_pre_subscribed||a._video_pre_subscribed?a._is_pre_created=!0:kb(this._users,a),this._remoteStreamTypeCacheMap.delete(a.uid),this._streamFallbackTypeCacheMap.delete(a.uid),N.debug("[".concat(this._clientId,"] user offline"),s.uid,"reason:",s.reason),this.safeEmit(Lt.USER_LEAVED,a,s.reason))}),R(this,"_handleAddAudioOrVideoStream",(s,a,l,u,p,m,g)=>{if(Z("BLOCK_LOCAL_CLIENT")&&tp(a,this.channelName))return;const E=this._users.find(C=>C.uid===a);if(!E)return void N.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));N.debug("[".concat(this._clientId,"] stream added with uid ").concat(a,", type ").concat(s)),this.store.subscribe(E.uid,s,void 0,void 0,void 0,Date.now());const y=s==="audio"?E.hasAudio:E.hasVideo;E._uintid||(E._uintid=p||a),s==="audio"?E._trust_audio_stream_added_state_=!0:E._trust_video_stream_added_state_=!0,s==="audio"?(E._audio_added_=!0,l!==void 0&&(E._audioSSRC=l),u!==void 0&&(E._cname=u),m&&(E._audioOrtc=m)):(E._video_added_=!0,l!==void 0&&(E._videoSSRC=l),u!==void 0&&(E._cname=u),g!==void 0&&(E._rtxSsrcId=g),m&&(E._videoOrtc=m)),(s==="audio"?E.hasAudio:E.hasVideo)&&!y&&(N.info("[".concat(this._clientId,"] remote user ").concat(E.uid," published ").concat(s)),this.safeEmit(Lt.USER_PUBLISHED,E,s)),s==="video"?qe.onGatewayStream(this._sessionId,Mr.ON_ADD_VIDEO_STREAM,kn.ON_ADD_VIDEO_STREAM,{peer:p||a,ssrc:E._videoSSRC}):qe.onGatewayStream(this._sessionId,Mr.ON_ADD_AUDIO_STREAM,kn.ON_ADD_AUDIO_STREAM,{peer:p||a,ssrc:E._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(E,s,l).then(C=>{if(C&&(N.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(E.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof ci))return this._p2pChannel.unsubscribe(E,s,!0).then(()=>this._subscribe(E,s,!0).catch(I=>{N.error("[".concat(this._clientId,"] resubscribe error"),I.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(E,s)&&(N.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(E.uid," after reconnect.")),this._subscribe(E,s,!0).catch(C=>{N.error("[".concat(this._clientId,"] resubscribe error"),C.toString())}))}),R(this,"_handleRemoveStream",s=>{if(Z("BLOCK_LOCAL_CLIENT")&&tp(s.uid,this.channelName))return;const a=this._users.find(u=>u.uid===s.uid);if(!a)return void N.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));N.debug("[".concat(this._clientId,"] stream removed with uid ").concat(s.uid));let l=()=>{};a.hasAudio&&a.hasVideo?l=()=>{N.info("[".concat(this._clientId,"] remote user ").concat(a.uid," unpublished audio track")),this.safeEmit(Lt.USER_UNPUBLISHED,a,"audio"),N.info("[".concat(this._clientId,"] remote user ").concat(a.uid," unpublished video track")),this.safeEmit(Lt.USER_UNPUBLISHED,a,"video")}:a.hasVideo?l=()=>{N.info("[".concat(this._clientId,"] remote user ").concat(a.uid," unpublished video track")),this.safeEmit(Lt.USER_UNPUBLISHED,a,"video")}:a.hasAudio&&(l=()=>{N.info("[".concat(this._clientId,"] remote user ").concat(a.uid," unpublished audio track")),this.safeEmit(Lt.USER_UNPUBLISHED,a,"audio")}),a._video_pre_subscribed||a._audio_pre_subscribed||(a._trust_audio_stream_added_state_=!0,a._trust_video_stream_added_state_=!0,a._audio_added_=!1,a._video_added_=!1,this._p2pChannel instanceof ci&&this._p2pChannel.unsubscribe(a).then(u=>{if(u)return this._gateway.unsubscribe(u,a.uid)}),a._audioSSRC=void 0,a._videoSSRC=void 0,a._audioOrtc=void 0,a._videoOrtc=void 0,a._rtxSsrcId=void 0),qe.onGatewayStream(this._sessionId,Mr.ON_REMOVE_STREAM,kn.ON_REMOVE_STREAM,{peer:s.uint_id||s.uid}),l()}),R(this,"_handleSetStreamLocalEnable",(s,a,l)=>{if(Z("BLOCK_LOCAL_CLIENT")&&tp(a,this.channelName))return;const u=this._users.find(g=>g.uid===a);if(!u)return void N.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));N.debug("[".concat(this._clientId,"] local ").concat(s," ").concat(l?"enabled":"disabled"," with uid ").concat(a));const p=s==="audio"?u.hasAudio:u.hasVideo;if(s==="audio"){u._trust_audio_enabled_state_=!0;const g=u._audio_enabled_;if(u._audio_enabled_=l,u._audio_enabled_===g)return;{const E=u._audio_enabled_?"enable-local-audio":"disable-local-audio";N.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(a,", msg: ").concat(E)),this.safeEmit(Lt.USER_INFO_UPDATED,a,E)}}else{u._trust_video_enabled_state_=!0;const g=u._video_enabled_;if(u._video_enabled_=l,u._video_enabled_===g)return;{const E=u._video_enabled_?"enable-local-video":"disable-local-video";N.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(E)),this.safeEmit(Lt.USER_INFO_UPDATED,a,E)}}const m=s==="audio"?u.hasAudio:u.hasVideo;return p!==m?!p&&m?(N.info("[".concat(this._clientId,"] remote user ").concat(a," published ").concat(s)),void this.safeEmit(Lt.USER_PUBLISHED,u,s)):(s==="video"&&u._videoTrack&&u._videoTrack._destroy(),s==="audio"&&u._audioTrack,this._p2pChannel.muteRemote(u,s),N.info("[".concat(this._clientId,"] remote user ").concat(a," unpublished ").concat(s)),void this.safeEmit(Lt.USER_UNPUBLISHED,u,s)):void 0}),R(this,"_handleMuteStream",(s,a,l)=>{if(Z("BLOCK_LOCAL_CLIENT")&&tp(s,this.channelName))return;N.debug("[".concat(this._clientId,"] receive mute message"),s,a,l);const u=this._users.find(g=>g.uid===s);if(!u)return void N.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(s));const p=a==="audio"?u.hasAudio:u.hasVideo;if(a==="audio"){u._trust_audio_mute_state_=!0;const g=u._audio_muted_;if(u._audio_muted_=l,u._audio_muted_===g)return;{const E=u._audio_muted_?"mute-audio":"unmute-audio";N.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(s,", msg: ").concat(E)),this.safeEmit(Lt.USER_INFO_UPDATED,s,E)}}else{u._trust_video_mute_state_=!0;const g=u._video_muted_;if(u._video_muted_=l,u._video_muted_===g)return;{const E=u._video_muted_?"mute-video":"unmute-video";N.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(s,", msg: ").concat(E)),this.safeEmit(Lt.USER_INFO_UPDATED,s,E)}}const m=a==="audio"?u.hasAudio:u.hasVideo;if(p!==m){if(!p&&m)return(a==="audio"?u._audioSSRC:u._videoSSRC)?(N.info("[".concat(this._clientId,"] remote user ").concat(s," published ").concat(a)),void this.safeEmit(Lt.USER_PUBLISHED,u,a)):void N.warning("[".concat(this._clientId,"] remote user ").concat(s," receive ").concat(a," unmute message  before add stream message, ").concat(a," SSRC doesn't exist yet."));a==="video"&&u._videoTrack&&!u._video_pre_subscribed&&u._videoTrack._destroy(),a==="audio"&&u._audioTrack,this._p2pChannel.muteRemote(u,a),N.info("[".concat(this._clientId,"] remote user ").concat(s," unpublished ").concat(a)),this.safeEmit(Lt.USER_UNPUBLISHED,u,a)}}),R(this,"_handleP2PLost",async s=>{N.debug("[".concat(this._clientId,"] receive p2p lost"),s),parseInt(s.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():N.warning("[".concat(this._clientId,"] P2PLost stream not found"),s)}),R(this,"_handleTokenWillExpire",()=>{N.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Lt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),R(this,"_handleBeforeUnload",s=>{s.type==="beforeunload"&&s.returnValue!==void 0&&s.returnValue!==""||(this.leave(),N.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),R(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Lt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const s={downlinkNetworkQuality:0,uplinkNetworkQuality:0};s.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),s.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Lt.NETWORK_QUALITY,s)}),R(this,"_handleP2PAddAudioOrVideoStream",(s,a,l,u)=>{const p=this._users.find(g=>g.uid===a);if(!p)return void N.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));N.debug("[".concat(this._clientId,"] stream added with uid ").concat(a,", type ").concat(s)),this.store.subscribe(p.uid,s,void 0,void 0,void 0,Date.now());const m=s==="audio"?p.hasAudio:p.hasVideo;s==="audio"?p._trust_audio_stream_added_state_=!0:p._trust_video_stream_added_state_=!0,s==="audio"?(p._audio_added_=!0,l!==void 0&&(p._audioSSRC=l),u!==void 0&&(p._audioMid=u)):(p._video_added_=!0,l!==void 0&&(p._videoSSRC=l),u!==void 0&&(p._videoMid=u)),(s==="audio"?p.hasAudio:p.hasVideo)&&!m&&(N.info("[".concat(this._clientId,"] remote user ").concat(p.uid," published ").concat(s)),this.safeEmit(Lt.USER_PUBLISHED,p,s)),this._p2pChannel.hasPendingRemoteMedia(p,s)&&(N.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(p.uid," after reconnect.")),this._subscribe(p,s,!0).catch(g=>{N.error("[".concat(this._clientId,"] resubscribe error"),g.toString())}))}),this._config=e,this._clientId=Sn(5,"client-"),this.store=new aie(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),N.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(qo," build: ").concat(vN,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{H5(e.clientRoleOptions),n=Object.assign({},e.clientRoleOptions)}catch(s){N.warning("[".concat(this._clientId,"] ").concat(s.toString()))}this._statsCollector=new mv(this.store),this._statsCollector.onStatsException=(s,a,l)=>{N.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(s,", msg: ").concat(a,", uid: ").concat(l)),this.safeEmit(Lt.EXCEPTION,{code:s,msg:a,uid:l})},this._statsCollector.onUploadPublishDuration=(s,a,l,u)=>{const p=this._users.find(m=>m.uid===s);p&&qe.peerPublishStatus(this._sessionId,{subscribeElapse:u,audioPublishDuration:a,videoPublishDuration:l,peer:p._uintid})},this.store.useDataChannel=Kt().supportDataChannel&&Z("SIGNAL_CHANNEL"),this.store.useP2P=e.mode==="p2p",this._gateway=new Hie(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||wr,httpRetryConfig:e.httpRetryConfig||wr,forceWaitGatewayResponse:e.forceWaitGatewayResponse===void 0||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:n}),this._configDistribute=new ese,this.store.useP2P?(this._p2pChannel=new Fr(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new ci(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,n,s,a,l){let u=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],p=arguments.length>6&&arguments[6]!==void 0&&arguments[6];fn("JOIN_GATEWAY_USE_443PORT_ONLY",u),fn("JOIN_GATEWAY_USE_DUAL_DOMAIN",p);const m=this._gateway.signal.websocket;return m instanceof LE&&(m.use443PortOnly=u,m.tryDoubleDomain=p),async function(g,E,y){wb.get(g)||wb.set(g,[]),Rb.get(g)||Rb.set(g,E),tl.get(g)||tl.set(g,0);const C=wb.get(g),I=Rb.get(g);if(!C||!I)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(tl.get(g)===I){const J=TE();C.push(J),await J.promise}tl.set(g,tl.get(g)+1);for(var j=arguments.length,P=new Array(j>3?j-3:0),U=3;U<j;U++)P[U-3]=arguments[U];const q=await y(...P);return tl.set(g,tl.get(g)-1),tl.get(g)===I-1&&C.length>0&&(C[0].resolve(),C.shift()),tl.get(g)===0&&(wb.set(g,[]),Rb.set(g,0),tl.set(g,0)),q}("client.join",Z("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,n,s,a,l)}async join(e,n,s,a,l){const u=++this._numberOfJoinCount;this.store.joinStart(),a&&(this.store.uid=a);const p=oie(),m=L4()?window.isSecureContext:"Browser Not Support";(!L4()&&!p||!window.isSecureContext)&&N.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser");const g=JO();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),N.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const E=qe.reportApiInvoke(g,{name:br.JOIN,options:[e,n,s,a],states:{isHttps:p,isSecureContext:m},tag:Bn.TRACER});qe.setAppId(e);try{if(!s&&s!==null)throw new le(z.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));s&&xi(s,"token",1,2047),xi(e,"appid",1,2047),TN(n),a&&CN(a),l&&xi(l,"optionalInfo",1,2047)}catch(P){throw E.onError(P),P}if(N.info("[".concat(this._clientId,"] start join channel ").concat(n,", join number: ").concat(u)),this._leaveMutex.isLocked&&(N.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),N.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const P=new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw E.onError(P),P}this._sessionId||(this._sessionId=g,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const y=Ac(Ac({},this._rtmConfig),{},{clientId:this._clientId,appId:e,sid:this._sessionId,cname:n,uid:typeof a!="string"?a:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:s||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:l,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(y.setLocalAPVersion=this._setLocalAPVersion),typeof a=="string"&&(y.stringUid=a,this._uintUid?(y.uid=this._uintUid,this._uintUid=void 0):y.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(y.aesmode=this._encryptionMode,y.aespassword=await Cre(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(y.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const P=new TextEncoder,U=Z("USE_PURE_ENCRYPTION_MASTER_KEY")?P.encode(y.appId+this._encryptionSecret+this._encryptionSecret):P.encode(y.appId+y.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(q,J,se){const he=await window.crypto.subtle.importKey("raw",J,"PBKDF2",!1,["deriveBits","deriveKey"]),ae=q==="aes-128-gcm2"?128:256,de=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:F4,hash:"SHA-256",salt:se},he,ae+cie);return new Uint8Array(de).subarray(ae/8)}(this._encryptionMode,U,RE(this._encryptionSalt)),this._encryptDataStreamKey=await async function(q,J,se){const he=await window.crypto.subtle.importKey("raw",J,"PBKDF2",!1,["deriveBits","deriveKey"]),ae=q==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:F4,hash:"SHA-256",salt:se},he,{name:"AES-GCM",length:ae},!0,["encrypt","decrypt"])}(this._encryptionMode,U,RE(this._encryptionSalt))}else m?N.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):N.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,N.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:n,appId:e,stringUid:y.stringUid});const C=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&C===this._sessionId&&qe.joinChannelTimeout(this._sessionId,5)},5e3);try{var I;let P;const U=y.cloudProxyServer;if(je(I=["proxy3","proxy4","proxy5"]).call(I,U)){const ae=Z("PROXY_SERVER_TYPE3");Array.isArray(ae)?y.proxyServer=ae[0]:y.proxyServer=ae}if(qe.setProxyServer(y.proxyServer),N.setProxyServer(y.proxyServer),this.store.requestAPStart(),y.stringUid&&!y.uid){let ae;[ae,P]=await pe.all([A3(y.stringUid,y,this._axiosCancelSource.token,this._config.httpRetryConfig||wr,this.store),I3(y,this._axiosCancelSource.token,this._config.httpRetryConfig||wr,!0,this.store)]),N.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(y.stringUid," => ").concat(ae)),y.uid=ae,P.gatewayInfo.uid=ae,P.gatewayInfo.res.uid=ae}else P=await I3(y,this._axiosCancelSource.token,this._config.httpRetryConfig||wr,!0,this.store);if(!this._joinAndNotLeaveYet)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(y,this._axiosCancelSource.token),this._configDistribute.on(DE.UPDATE_BITRATE_LIMIT,ae=>{this._p2pChannel.updateBitrateLimit(ae)})},0),this._key=s||e;const q=P.gatewayInfo,J=y.uid?y.uid:q.uid;this._joinInfo=Ac(Ac({},y),{},{cid:q.cid,uid:J,vid:q.vid,apResponse:q.res,uni_lbs_ip:q.uni_lbs_ip,gatewayAddrs:q.gatewayAddrs}),this.store.intUid=J;const se=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));E.onSuccess(se),this._appId=e,this._channelName=y.cname,this._uid=se,this.store.uid=se,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(vi()?"beforeunload":"pagehide",this._handleBeforeUnload)},0);const he=y.stringUid?"string uid: ".concat(y.stringUid,",uid: ").concat(y.uid):"uid: ".concat(this._uid);return N.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(n,",").concat(he)),setTimeout(()=>{N.startUpload()},5e3),this.store.joinEnd(),j=this,je(uu).call(uu,j)||uu.push(j),se}catch(P){const U=Array.isArray(P)?P[0]:P;throw U&&U.code===z.OPERATION_ABORTED?N.warning("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),U):N.error("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),U),U.code!==z.OPERATION_ABORTED&&this._numberOfJoinCount===u&&(this._gateway.state="DISCONNECTED",this._reset()),E.onError(U),U}var j}_joinGateway(){if(!this._joinInfo||!this._key)throw new le(z.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!Z("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(e=>e).catch(e=>{if(e.code===z.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,Dt.FALLBACK),e;if(e.code===z.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,Dt.FALLBACK),e;throw e}).then(e=>{if(e instanceof le){if(e.code===z.INIT_WEBSOCKET_TIMEOUT){if(N.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new le(z.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const n=Z("PROXY_SERVER_TYPE3");if(Array.isArray(n))if(this._joinInfo.apUrl){const a=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),l=a.slice(a.length-2).join(".");n.forEach(u=>{this._joinInfo&&je(u).call(u,l)&&(this._joinInfo.proxyServer=u)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=n[0])}else this._joinInfo.proxyServer=n[0];else this._joinInfo.proxyServer=n;const s=Z("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return s&&s[1]&&s[1]!=="443"&&N.setProxyServer(this._joinInfo.proxyServer),Z("STATS_COLLECTOR_PORT").toString()!=="443"&&qe.setProxyServer(this._joinInfo.proxyServer),qe.reportApiInvoke(this._sessionId,{name:br.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:Bn.TRACER}).onSuccess(),this.safeEmit(Lt.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),Z("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach(a=>{"forceturn"in a&&(a.forceturn=!0)}),this._gateway.join(this._joinInfo,this._key)}if(N.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new le(z.INVALID_OPERATION);return qe.reportApiInvoke(this._sessionId,{name:br.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:Bn.TRACER}).onSuccess(),this._joinGateway()}return e}).then(e=>e)}async leave(){N.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(vi()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(n){const s=uu.indexOf(n);s!==-1&&uu.splice(s,1)}(this);const e=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return N.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave(this.connectionState!=="CONNECTED"),N.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(e)){if(!(e instanceof Di))return this._publishDataChannel(e);e=[e]}if(e.length===0)throw new le(z.INVALID_PARAMS,"param list is empty");const s=e;if(this._gateway.role==="audience")throw new le(z.INVALID_OPERATION,"audience can not publish stream");for(const l of s){if(!(l instanceof Di))throw new le(z.INVALID_PARAMS,"parameter is not local track");if(!l._enabled&&n)throw new le(z.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(l.getTrackId()))}N.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(s.map(l=>"".concat(l.getTrackId()," "))));const a=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),n&&s.forEach(l=>{const u=this._configDistribute.getBitrateLimit();l instanceof At&&u&&l.setBitrateLimit(u.uplink)});try{await this._publishHighStream(s),N.info("[".concat(this._clientId,"] Publish success, id ").concat(s.map(l=>"".concat(l.getTrackId()," "))))}catch(l){throw N.error("[".concat(this._clientId,"] publish error"),l.toString()),l}finally{a()}}async _publishDataChannel(e){pn(e.id,"id",0,65535,!0),Jl(e.ordered,"ordered"),xi(e.metadata,"metadata",0,512),N.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const n=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(a=>a.id===e.id)!==-1)throw new le(z.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new le(z.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Z("FORCE_TURN")&&!Z("TURN_ENABLE_TCP")&&!Z("TURN_ENABLE_UDP"))throw new le(z.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const s=new iB(e);if(await this._p2pChannel.publishDataChannel([s]),!this._p2pChannel.isP2PDisconnected()){if(typeof s._originDataChannelId!="number")throw N.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new le(z.CREATE_DATACHANNEL_ERROR);try{const a={streamId:e.id,ordered:e.ordered,maxRetransmits:Z("DATASTREAM_MAX_RETRANSMITS"),metadata:e.metadata,channelId:s._originDataChannelId};await this._gateway.publishDataChannel(this._uid,a,!0),await s._waitTillOpen()}catch(a){if(a.code!==z.DISCONNECT_P2P)throw a}}return N.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(s.id)),s}catch(s){throw N.error("[".concat(this._clientId,"] publish datachannels error"),s.toString()),s}finally{n()}}async unpublish(e){if(!this._joinInfo||this._uid===void 0)throw new le(z.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let n=[];if(e)if(Array.isArray(e))n=e;else{if(!(e instanceof Di))return this._unpublishDataChannel([e]);n=[e]}else this.store.useP2P||await this._unpublishDataChannel(),n=this._p2pChannel.getAllTracks(!0);N.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(n.map(a=>"".concat(a.getTrackId()," "))," "));const s=await this._publishMutex.lock();try{if(this._p2pChannel instanceof Fr){const a=await this._p2pChannel.unpublish(n);a&&await this._gateway.sendExtensionMessage(tr.UNPUBLISH,{unpubMsg:a},!0)}else{const a=await this._p2pChannel.unpublish(n);a&&await this._gateway.unpublish(a,this._uid),N.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(n.map(l=>"".concat(l.getTrackId()))))}}catch(a){throw N.error("[".concat(this._clientId,"] unpublish error"),a.toString()),a}finally{s&&s()}}async _unpublishDataChannel(e){e!==void 0&&e.length!==0||(e=this._p2pChannel.getAllDataChannels()),N.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map(s=>"".concat(s.id," "))," "));const n=await this._publishMutex.lock();try{const s=await this._p2pChannel.unpublishDataChannel(e);s&&await this._gateway.unpublishDataChannel(s),N.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map(a=>"".concat(a.id))))}catch(s){throw N.error("[".concat(this._clientId,"] unpublish dataChannel error"),s.toString()),s}finally{n&&n()}}async subscribe(e,n,s){return n==="datachannel"?this._subscribeDataChannel(e,s):this._subscribe(e,n)}async presubscribe(e,n){if(Lr(n,"mediaType",["audio","video"]),this._p2pChannel instanceof Fr)throw new le(z.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new le(z.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const s=n===ze.AUDIO,a=n===ze.VIDEO,l=await this._subscribeMutex.lock();try{const{ssrcId:u,ortc:p,rtxSsrcId:m,cname:g,uint_id:E}=await this._gateway.presubscribe(e,n,!0);if(u==null)throw new le(z.UNEXPECTED_RESPONSE,"no ssrc id");let y=this._users.find(I=>I.uid===e);y||(y=new Si(e,E||e),y._is_pre_created=!0,this._users.push(y)),g&&(y._cname=g),y._uintid||(y._uintid=E||e),s&&(y._audioSSRC=u,y._audio_pre_subscribed=!0,p&&(y._audioOrtc=p)),a&&(y._videoSSRC=u,y._video_pre_subscribed=!0,p&&(y._videoOrtc=p),m!=null&&(y._rtxSsrcId=m)),N.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(u)),await this._p2pChannel.subscribe(y,n,u,m,p);const C=s?y._audioTrack:y._videoTrack;if(!C)throw new le(z.UNEXPECTED_ERROR,"can not find remote track in user");return s&&(y._trust_audio_stream_added_state_=!0,y._audio_added_=!0),a&&(y._trust_video_stream_added_state_=!0,y._video_added_=!0),C}catch(u){throw N.error("[".concat(this._clientId,"] presub user ").concat(e," error"),u),u}finally{l()}}async _subscribeDataChannel(e,n){var s;if(pn(n,"channelId",0,65535,!0),!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(p=>p===e))throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new le(z.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&e._dataChannels.length===0)throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new le(z.INVALID_REMOTE_USER,"user is not published");const a=(s=e._dataChannels)===null||s===void 0?void 0:s.find(p=>p.id===n);if(!a)throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new le(z.REMOTE_USER_IS_NOT_PUBLISHED);const l=await this._subscribeMutex.lock();N.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const p=await this._p2pChannel.subscribeDataChannel(e,[a]);if(p&&je(p).call(p,a.id))try{var u;if(typeof a._originDataChannelId!="number")throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new le(z.CREATE_DATACHANNEL_ERROR);const m={id:a.id,datachannelId:a._originDataChannelId,ordered:a.ordered,maxRetransmits:a.maxRetransmits,metadata:(u=a.metadata)!==null&&u!==void 0?u:""};await this._gateway.subscribeDataChannel(e.uid,m,!0),await a._waitTillOpen()}catch(m){if((m==null?void 0:m.code)!==z.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[a]),m;await this._p2pChannel.unsubscribeDataChannel(e,[a]),this._p2pChannel.setPendingRemoteDataChannel(e,a.id)}return N.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),a}finally{l()}}async _p2pSubscribe(e,n,s){if(Lr(n,"mediaType",["audio","video"]),!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(l=>l===e)){const l=new le(z.INVALID_REMOTE_USER,"user is not in the channel");throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),l}if(!e.hasAudio&&!e.hasVideo){const l=new le(z.INVALID_REMOTE_USER,"user is not published");throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),l}if(!s&&(n==="audio"&&!e.hasAudio||n==="video"&&!e.hasVideo)){const l=new le(z.REMOTE_USER_IS_NOT_PUBLISHED);throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(n,", remote track is not published")),l}const a=await this._subscribeMutex.lock();N.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(n));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,n))await this._p2pChannel.unmuteRemote(e,n);else try{const u=n==="audio"?e._audioSSRC:e._videoSSRC,p=n==="audio"?e._audioMid:e._videoMid;this.store.subscribe(e.uid,n,Date.now()),this._p2pChannel instanceof Fr&&await this._p2pChannel.subscribe(e,n,u,p)}catch(u){throw u}N.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(n)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(u=>{N.warning("[".concat(this._clientId,"] auto set fallback failed"),u)});const l=n==="audio"?e._audioTrack:e._videoTrack;if(!l)throw new le(z.UNEXPECTED_ERROR,"can not find remote track in user object");return l}catch(l){throw N.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),l),l}finally{a()}}async _subscribe(e,n,s){if(this._p2pChannel instanceof Fr)return this._p2pSubscribe(e,n);if(Lr(n,"mediaType",["audio","video"]),!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(g=>g===e)){const g=new le(z.INVALID_REMOTE_USER,"user is not in the channel");throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),g}if(!e.hasAudio&&!e.hasVideo){const g=new le(z.INVALID_REMOTE_USER,"user is not published");throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),g}if(!(s||(n!=="audio"||e.hasAudio&&e._audioSSRC!==void 0)&&(n!=="video"||e.hasVideo&&e._videoSSRC!==void 0))){const g=new le(z.REMOTE_USER_IS_NOT_PUBLISHED);throw N.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(n,", remote track is not published")),g}let a=n==="audio"?e._audioSSRC:e._videoSSRC,l=n==="audio"?e._audioOrtc:e._videoOrtc,u=n==="video"?e._rtxSsrcId:void 0,p={stream_type:n==="audio"?ze.AUDIO:ze.VIDEO,ssrcId:a};const m=await this._subscribeMutex.lock();N.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(n));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,n))await this._p2pChannel.unmuteRemote(e,n);else try{const E=n==="audio"?e._audioSSRC:e._videoSSRC;E!==void 0&&E!==a&&(a=E,l=n==="audio"?e._audioOrtc:e._videoOrtc,u=n==="video"?e._rtxSsrcId:void 0,p={stream_type:n==="audio"?ze.AUDIO:ze.VIDEO,ssrcId:a}),Li.markSubscribeStart(this.store.clientId,a),this.store.subscribe(e.uid,n,Date.now()),await this._p2pChannel.subscribe(e,n,a,u,l);try{await this._gateway.subscribe(e.uid,p,!0)}catch(y){if((y==null?void 0:y.code)!==z.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,n),y;await this._p2pChannel.unsubscribe(e,n,!0),this._p2pChannel.setPendingRemoteMedia(e,n)}this.store.subscribe(e.uid,n,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,n)}catch(E){throw this._p2pChannel.reportSubscribeEvent(!1,E==null?void 0:E.code,e,n),E}N.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(n)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(E=>{N.warning("[".concat(this._clientId,"] auto set fallback failed"),E)});const g=n==="audio"?e._audioTrack:e._videoTrack;if(!g)throw new le(z.UNEXPECTED_ERROR,"can not find remote track in user object");return g}catch(g){throw N.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),g),g}finally{m()}}async massSubscribe(e){if(Ql(e,"subscribeList"),!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const n=Date.now(),s=new Map,a=await this._subscribeMutex.lock();N.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(m=>{let{user:g,mediaType:E}=m;return"user: ".concat(g==null?void 0:g.uid,", mediaType: ").concat(E)}).join("; ")));const l=(e=[...e]).map(m=>{let{user:g,mediaType:E}=m;return{user:g,mediaType:E}}),u=await this._p2pChannel.globalLock();try{var p;for(let g=e.length-1;g>=0;g--){const E=e[g],{user:y,mediaType:C}=E;if(Lr(C,"mediaType",["audio","video"]),!y){const P=new le(z.INVALID_PARAMS,"user property does not exist in subscribeList item");throw N.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),P}if(!this._users.find(P=>P===y)){const P=new le(z.INVALID_REMOTE_USER,"user is not in the channel");N.error("[".concat(this._clientId,"] can not massSubscribe ").concat(y.uid,", this user is not in the channel")),l[g].error=P,e.splice(g,1);continue}if(C==="audio"&&(!y.hasAudio||y._audioSSRC===void 0)||C==="video"&&(!y.hasVideo||y._videoSSRC===void 0)){const P=new le(z.REMOTE_USER_IS_NOT_PUBLISHED);N.error("[".concat(this._clientId,"] can not subscribe ").concat(y.uid," with mediaType ").concat(C,", remote user is not published")),l[g].error=P,e.splice(g,1);continue}const I=Or.Video|Or.LwoVideo,j=s.get(y);if(j){if(C==="video"?j&I:j&Or.Audio){e.splice(g,1),N.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(y.uid,", mediaType:").concat(C," twice"));continue}s.set(y,j|(C==="video"?I:Or.Audio))}else s.set(y,C==="video"?I:Or.Audio)}for(let g=e.length-1;g>=0;g--){const E=e[g],{user:y,mediaType:C}=E,I=Or.Video|Or.LwoVideo;if(this._p2pChannel.hasRemoteMedia(y,C)){await this._p2pChannel.unmuteRemoteNoLock(y,C);const j=s.get(y);s.set(y,C==="video"?j^I:j^Or.Audio),e.splice(g,1)}}this.store.massSubscribe(e.map(g=>({userId:g.user.uid,type:g.mediaType})),n);const m=ed(p=Array.from(s.entries())).call(p,(g,E)=>{let[y,C]=E;if(C===0)return g;const I={stream_id:y.uid,stream_type:C};return C&Or.Audio&&(I.audio_ssrc=y._audioSSRC),C&Or.Video&&(I.video_ssrc=y._videoSSRC),g.push(I),g},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(E=>{let{user:y,mediaType:C}=E;return{user:y,mediaType:C,ssrcId:C===ze.VIDEO?y._videoSSRC:y._audioSSRC,rtxSsrcId:C===ze.VIDEO?y._rtxSsrcId:void 0}}));const g=new Map;if(m.length>0){const E=await this._gateway.subscribeAll(m,!0);((E==null?void 0:E.users)||[]).forEach(y=>{let{stream_id:C,video_error_code:I,audio_error_code:j,error_code:P}=y;(I||j||P)&&g.set(C,{video_error_code:I,audio_error_code:j,error_code:P})})}if(Array.from(g.entries()).length>0){const E=[];Array.from(g.entries()).forEach(y=>{let[C,I]=y;const j=this.remoteUsers.find(P=>P.uid===C);if(j){let P;I.error_code||I.video_error_code&&I.audio_error_code?P=void 0:I.video_error_code?P=ze.VIDEO:I.audio_error_code&&(P=ze.AUDIO),E.push({user:j,mediaType:P})}}),E.length>0&&await this._p2pChannel.massUnsubscribeNoLock(E)}for(const E of l){const y=g.get(E.user.uid);if(y){const C=y.error_code||E.mediaType==="audio"&&y.audio_error_code||E.mediaType==="video"&&y.video_error_code;if(C){const I=rp(C);N.error("user:".concat(E.user.uid," mediaType:").concat(E.mediaType," has massSubscribe error ").concat(I.desc)),E.error=new le(z.SUBSCRIBE_FAILED,"code ".concat(C,": ").concat(I.desc))}}E.error||(E.mediaType==="video"?E.track=E.user.videoTrack:E.track=E.user.audioTrack)}return this.store.massSubscribe(l.filter(E=>!E.error).map(E=>({userId:E.user.uid,type:E.mediaType})),void 0,Date.now()),l.forEach(E=>{var y;qe.subscribe(this.store.sessionId,{succ:!!E.error,ec:((y=E.error)===null||y===void 0?void 0:y.code)||null,video:E.mediaType===ze.VIDEO,audio:E.mediaType===ze.AUDIO,peerid:E.user.uid,subscribeRequestid:E.mediaType===ze.VIDEO?E.user._videoSSRC:E.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-n)},!0)}),N.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(E=>{let{user:y,mediaType:C}=E;return"user: ".concat(y==null?void 0:y.uid,", mediaType: ").concat(C)}).join("; "))),l}catch(g){throw await this._p2pChannel.massUnsubscribeNoLock(e),g}}finally{u(),a()}}async unsubscribe(e,n,s){if(n||this.store.useP2P){if(n==="datachannel")return this._unsubscribeDataChannel(e,s)}else await this._unsubscribeDataChannel(e,s);if(n&&Lr(n,"mediaType",["audio","video"]),!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(l=>l===e)){const l=new le(z.INVALID_REMOTE_USER,"user is not in the channel");throw N.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),l}N.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(n));const a=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof Fr)await this._p2pChannel.unsubscribe(e,n);else{const l=await this._p2pChannel.unsubscribe(e,n);l&&await this._gateway.unsubscribe(l,e.uid),n&&n!=="audio"||(e._audio_pre_subscribed=!1),n&&n!=="video"||(e._video_pre_subscribed=!1),e._is_pre_created&&kb(this._users,e),N.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(n))}}catch(l){if(l.code===z.DISCONNECT_P2P)return void N.warning("disconnecting p2p, abort unsubscribe request.");throw N.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),l.toString()),l}finally{a()}}async _unsubscribeDataChannel(e,n){if(n&&pn(n,"id",0,65535,!0),!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(a=>a===e)){const a=new le(z.INVALID_REMOTE_USER,"user is not in the channel");throw N.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),a}let s;if(typeof n=="number"){const a=e._dataChannels.find(l=>l.id===n);a&&(s=[a])}else s=e._dataChannels;if(s===void 0){const a=new le(z.REMOTE_USER_IS_NOT_PUBLISHED);throw N.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(n,", remote datachannel is not published")),a}N.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(s.map(a=>a.id)));try{const a=await this._p2pChannel.unsubscribeDataChannel(e,s);a&&await this._gateway.unsubscribeDataChannel(a,e.uid),N.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(a))}catch(a){if(a.code===z.DISCONNECT_P2P)return void N.warning("disconnecting p2p, abort unsubscribe request.");throw N.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),a.toString()),a}}async massUnsubscribe(e){if(Ql(e,"unsubscribeList"),!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");N.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(s=>{let{user:a,mediaType:l}=s;return"user: ".concat(a==null?void 0:a.uid,", mediaType: ").concat(l,";")}).join())),e=[...e];const n=new Map;for(let s=e.length-1;s>=0;s--){const{user:a,mediaType:l}=e[s];if(!a){const p=new le(z.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw N.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),p}if(Lr(l,"mediaType",["video","audio",void 0]),!this._users.find(p=>p===a)){N.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(a.uid,", user is not in the channel")),e.splice(s,1);continue}const u=Or.Video|Or.LwoVideo;if(n.has(a)){const p=n.get(a);let m;switch(l){case"video":m=p&u;break;case"audio":m=p&Or.Audio;break;default:m=p&(Or.Audio|u)}if(m){N.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(a.uid,",mediaType:").concat(l," twice.")),e.splice(s,1);continue}l?l==="audio"?n.set(a,p|Or.Audio):l==="video"&&n.set(a,p|u):n.set(a,p|Or.Audio|u)}else l?l==="audio"?n.set(a,Or.Audio):l==="video"&&n.set(a,u):n.set(a,Or.Audio|u)}try{const s=await this._p2pChannel.massUnsubscribe(e);s&&await this._gateway.massUnsubscribe(s),N.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(a=>{let{user:l,mediaType:u}=a;return"user: ".concat(l==null?void 0:l.uid,", mediaType: ").concat(u,";")}).join()))}catch(s){if(s.code===z.DISCONNECT_P2P)return void N.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw N.error("[".concat(this._clientId,"] massUnsubscribe error"),s.toString()),s}}async setLowStreamParameter(e){(function(s){if(!s)throw new ye(z.INVALID_PARAMS);Xn(s.width)||zO(s.width,"streamParameter.width"),Xn(s.height)||zO(s.height,"streamParameter.height"),Xn(s.framerate)||zO(s.framerate,"streamParameter.framerate"),Xn(s.bitrate)||pn(s.bitrate,"streamParameter.bitrate")})(e),(!e.width&&e.height||e.width&&!e.height)&&N.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),N.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const n=this._configDistribute.getLowStreamConfigDistribute();if(n&&n.bitrate&&e.bitrate&&n.bitrate<e.bitrate&&(e.bitrate=n.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,Ie.LocalVideoLowTrack)}async enableDualStream(){if(!Kt().supportDualStream)throw qe.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new le(z.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new le(z.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw qe.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,qe.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),N.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new le(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Ie.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw qe.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,qe.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),N.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,n){if(function(s){Lr(s,"role",["audience","host"])}(e),n&&H5(n),this.mode==="rtc"||this.mode==="p2p")throw N.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new le(z.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(n&&n.level&&e==="host")throw new le(z.INVALID_OPERATION,"host mode can not set audience latency level");if(e==="audience"&&this._p2pChannel.hasLocalMedia())throw new le(z.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(e,n),this._config.role=e,N.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(n&&n.level))}getRemoteInboundOffset(){var e;const n=(e=this._p2pChannel.getStats())===null||e===void 0?void 0:e.audioSend[0];if(!n||!n.timestamp)return 0;const s=n.timestamp-Date.now();return Math.abs(s)>1e3+n.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?s:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,n){if(xi(e,"proxyServer"),!n){if(this.connectionState!=="DISCONNECTED")throw new le(z.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new le(z.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,qe.setProxyServer(this._proxyServer),N.setProxyServer(this._proxyServer),N.info("[".concat(this._clientId,"] Set proxy server ").concat(n?"by initialize call":""," success."))}setTurnServer(e,n){if(Array.isArray(e)||(e=[e]),!n){if(this.connectionState!=="DISCONNECTED")throw new le(z.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new le(z.INVALID_OPERATION,"You have already set the proxy")}if(Yf(e))return this._turnServer={servers:e,mode:"original-manual"},void N.info("[".concat(this._clientId,"] Set original turnserver ").concat(n?"by initialize call":""," success: ").concat(e.map(s=>s.urls).join(","),"."));e.forEach(s=>G5(s)),this._turnServer={servers:e,mode:"manual"},N.info("[".concat(this._clientId,"] Set turnserver ").concat(n?"by initialize call":""," success."))}setLicense(e){if(this.connectionState!=="DISCONNECTED")throw new le(z.INVALID_OPERATION,"you should set license before join channel");if(xi(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new le(z.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,N.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if(this.connectionState!=="DISCONNECTED")throw new le(z.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new le(z.INVALID_OPERATION,"You have already set the proxy");const n=[3,4,5];let s;switch(e===void 0&&(e=3),e){case 1:case 2:throw new le(z.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:s="proxy3";break;case 4:s="proxy4";break;case 5:s="proxy5";break;default:throw new le(z.INVALID_PARAMS,"proxy server mode must be ".concat(n.join("|")))}this._cloudProxyServerMode=s,this.store.cloudProxyServerMode=s,N.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new le(z.INVALID_OPERATION,"Stop proxy server after leave channel");qe.setProxyServer(),N.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",N.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new le(z.INVALID_PARAMS,"accessPoints is required.");Ql(e.accessPoints.serverList,"accessPoints.serverList"),xi(e.accessPoints.domain,"accessPoints.domain");const n=(I,j)=>{pn(I,j,0,65535,!0)};let s=443;if(e.accessPoints.port&&(n(e.accessPoints.port,"accessPoints.port"),s=e.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new le(z.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");Z("CLOSE_AFB_FOR_LOCAL_AP")&&(fn("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),fn("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const a=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,l=e.accessPoints.domain,u=e.accessPoints.serverList.map(I=>a.test(I)?"".concat(I.replace(/\./g,"-"),".").concat(l):I),p=u.map(I=>"".concat(I,":").concat(s));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,fn("WEBCS_DOMAIN",p),fn("WEBCS_DOMAIN_BACKUP_LIST",p),fn("GATEWAY_DOMAINS",[l]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(Ql(e.report.hostname,"report.hostname"),fn("EVENT_REPORT_DOMAIN",e.report.hostname[0]),fn("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(fn("EVENT_REPORT_DOMAIN",u[0]),fn("EVENT_REPORT_BACKUP_DOMAIN",u[1]||u[0]));let m=6443;e.report&&e.report.port&&(n(e.report.port,"report.port"),m=e.report.port),fn("STATS_COLLECTOR_PORT",m),e.report?fn("ENABLE_EVENT_REPORT",!0):fn("ENABLE_EVENT_REPORT",!1);let g="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(Ql(e.log.hostname,"log.hostname"),g=e.log.hostname[0]):g=u[0];let E=6444;e.log&&e.log.port&&(n(e.log.port,"log.port"),E=e.log.port),fn("LOG_UPLOAD_SERVER","".concat(g,":").concat(E));let y=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(Ql(e.cds.hostname,"cds.hostname"),y=e.cds.hostname):y=u;let C=443;e.cds&&e.cds.port&&(n(e.cds.port,"cds.port"),C=e.cds.port),fn("CDS_AP",y.map(I=>"".concat(I,":").concat(C))),e.cds?fn("ENABLE_CONFIG_DISTRIBUTE",!0):fn("ENABLE_CONFIG_DISTRIBUTE",!1),N.info("set local access point v2 success")}setLocalAccessPoints(e,n){if(Ql(e,"serverList"),xi(n,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new le(z.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const s=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(a=>s.test(a)?"".concat(a.replace(/\./g,"-"),".").concat(n):a),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,fn("WEBCS_DOMAIN",e),fn("WEBCS_DOMAIN_BACKUP_LIST",e),fn("GATEWAY_DOMAINS",[n]),fn("EVENT_REPORT_DOMAIN",e[0]),fn("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),fn("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),N.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(Lr(e,"streamType",[0,1]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(n){throw N.error("[".concat(this._clientId,"] set default remote video stream type error"),n.toString()),n}else N.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,n){Lr(n,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(e,n),setTimeout(()=>{const s=this._users.find(a=>a.uid===e);s&&s.videoTrack&&s.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(s){throw N.error("[".concat(this._clientId,"] set remote video stream type error"),s.toString()),s}N.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(n)),this._remoteStreamTypeCacheMap.set(e,n)}async setStreamFallbackOption(e,n){Lr(n,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(e,n)}catch(s){throw N.error("[".concat(this._clientId,"] set stream fallback option"),s.toString()),s}N.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(n)),this._streamFallbackTypeCacheMap.set(e,n)}setEncryptionConfig(e,n,s,a){(function(u){Lr(u,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(e),xi(n,"secret");const l=["aes-128-gcm2","aes-256-gcm2"];if(je(l).call(l,e)){if(!s||!(s instanceof Uint8Array&&s.length===32))throw new le(z.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(s)throw new le(z.INVALID_PARAMS,"current encrypt mode does not need salt");if(a){if(Jl(a,"encryptDataStream"),!je(l).call(l,e))throw new le(z.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(n)||N.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=e,this._encryptionSecret=n,s&&(this._encryptionSalt=Jf(s))}async renewToken(e){if(xi(e,"token",1,2047),!this._key||!this._joinInfo)throw new le(z.INVALID_OPERATION,"renewToken should not be called before user join");const n=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const s=await this._renewTokenMutex.lock();try{if(Z("USE_NEW_TOKEN")){N.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const a=await Zie(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||wr);N.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:a})}else N.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});N.debug("[".concat(this._clientId,"] renewToken success"))}catch(a){throw this._key=n,this._joinInfo.token=n,N.error("[".concat(this._clientId,"] renewToken failed"),a.toString()),a}finally{s()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?N.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(Lt.VOLUME_INDICATOR,e)},Z("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),n=this._gateway.getInChannelInfo();return e.Duration=Math.round(n.duration/1e3),e}async startLiveStreaming(e,n){if(!n){if(this.codec!=="h264")throw new le(z.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new le(z.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new le(z.LIVE_STREAMING_TASK_CONFLICT);const s=n?Ur.TRANSCODE:Ur.RAW;return this._createLiveStreamingClient(s).startLiveStreamingTask(e,s)}setLiveTranscoding(e){return this._createLiveStreamingClient(Ur.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const n=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(s=>s&&s.hasUrl(e));if(!n.length)throw new le(z.INVALID_PARAMS,"can not find live streaming url to stop");await pe.all(n.map(s=>s&&s.stopLiveStreamingTask(e)))}async addInjectStreamUrl(e,n){if(!this._joinInfo)throw new le(z.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const s=this._createLiveStreamingClient(Ur.INJECT);s.setInjectStreamConfig(n,0),await s.startLiveStreamingTask(e,Ur.INJECT)}async removeInjectStreamUrl(){var e;const n=this._createLiveStreamingClient(Ur.INJECT),s=Array.from(yc(e=n.streamingTasks).call(e)).find(a=>a.mode===Ur.INJECT);if(!this._joinInfo||!s)throw new le(z.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await n.stopLiveStreamingTask(s.url)}async startChannelMediaRelay(e){k6(e),await this._createChannelMediaRelayClient().startChannelMediaRelay(e)}async updateChannelMediaRelay(e){k6(e),await this._createChannelMediaRelayClient().updateChannelMediaRelay(e)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}async sendStreamMessage(e){var n;let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new le(z.INVALID_OPERATION,"can not send data stream, not joined");if((typeof e=="string"||e instanceof Uint8Array)&&(e={payload:e}),typeof e.payload=="string"){const l=new TextEncoder;e.payload=l.encode(e.payload)}let a=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&je(n=["aes-128-gcm2","aes-256-gcm2"]).call(n,this._encryptionMode)&&(a=!0,e.payload=await async function(l,u,p){var m;const g=ed(m=Array.from(p)).call(m,(U,q)=>U+q,0),E={serverTs:0,seq:lie++,length:p.length,checkSum:g},y=new Uint8Array(e4(g,2)),C=new ArrayBuffer(tm),I=new DataView(C);I.setUint32(0,E.serverTs),I.setUint16(4,E.seq),I.setUint16(6,E.length),I.setUint16(8,E.checkSum);const j=16-p.length%16;p=q5(p,new Uint8Array(j));const P=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:l,tagLength:j4,additionalData:y},u,p);return q5(new Uint8Array(C),new Uint8Array(P))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new le(z.INVALID_PARAMS,a?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(Xe.DATA_STREAM,{payload:Jf(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-qce},!s)}sendMetadata(e){if(!this._joinInfo)throw new le(z.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new le(z.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Xe.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Jf(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(uie),!this._joinInfo)throw new le(z.INVALID_OPERATION,"can not send custom report, not joined");await qe.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,n){Lr(n.spatialLayer,"spatialLayer",[0,1,2,3]),Lr(n.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,n)}catch(s){throw N.error("[".concat(this._clientId,"] pick SVC layer failed"),s.toString()),s}}async setRTMConfig(e){const{apRTM:n=!1,rtmFlag:s}=e;if(Jl(n,"apRTM"),pn(s,"rtmFlag",0),this._rtmConfig.apRTM=n,this._rtmConfig.rtmFlag=s,N.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=n,this._joinInfo.rtmFlag=s,this._gateway.setRTM2Flag(s)}_reset(){if(N.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=Ls.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach(n=>n._close()),e._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new ii("client-publish"),this._subscribeMutex=new ii("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(e,n){var s;const a=e||JO();e?N.debug("[".concat(this._clientId,"] new Session ").concat(a)):N.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(a));const l=e?"":this._sessionId||"";this._sessionId=a,this.store.sessionId=a;const u={lts:new Date().getTime(),mode:this.mode,stringUid:(n==null?void 0:n.stringUid)||((s=this._joinInfo)===null||s===void 0?void 0:s.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:l,clientRole:this.role==="audience"?2:1};n?qe.sessionInit(this._sessionId,Ac({cname:n.channel,appid:n.appId},u)):this._joinInfo?qe.sessionInit(this._sessionId,Ac({cname:this._joinInfo.cname,appid:this._joinInfo.appId},u)):this._gateway.joinInfo&&qe.sessionInit(this._sessionId,Ac({cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId},u)),this._joinInfo&&(this._joinInfo.sid=a),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=a)}async _publishHighStream(e){if(!this._joinInfo||this._uid===void 0)throw new le(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Z("FORCE_TURN")&&!Z("TURN_ENABLE_TCP")&&!Z("TURN_ENABLE_UDP"))throw new le(z.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");N.debug("[".concat(this._clientId,"] publish high stream"));try{const s=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this._p2pChannel instanceof Fr){const a=(await s.next()).value;if(a){try{await this._gateway.sendExtensionMessage(tr.PUBLISH,a,!0)}catch(l){throw s.throw(l),l}await s.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const a=(await s.next()).value;if(a){var n;let l;try{l=await this._gateway.publish(this._uid,a,!0)}catch(u){if(u.code!==z.DISCONNECT_P2P)throw s.throw(u),u}await s.next(((n=l)===null||n===void 0?void 0:n.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const l of e)l instanceof At&&l._encoderConfig&&this._gateway.setVideoProfile(l._encoderConfig),!l.muted&&l.enabled||await this._p2pChannel.muteLocalTrack(l)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,e),(s==null?void 0:s.code)===z.WS_ABORT)return;throw s}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new le(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new le(z.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));N.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const s=await this._p2pChannel.publishLowStream(this._lowStreamParameter),a=(await s.next()).value;if(a){var n;let l;try{l=await this._gateway.publish(this._uid,a,!0)}catch(u){if(u.code!==z.DISCONNECT_P2P)throw s.throw(u),u}s.next(((n=l)===null||n===void 0?void 0:n.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,void 0,!0),(s==null?void 0:s.code)===z.WS_ABORT)return;throw s}}_createLiveStreamingClient(e){if(!this._joinInfo||!this._appId)return new le(z.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const n=()=>new Rce(this._joinInfo,this._config.websocketRetryConfig||wr,this._config.httpRetryConfig||wr),s=a=>{a.onLiveStreamError=(l,u)=>{qe.reportApiInvoke(this._sessionId,{name:br.ON_LIVE_STREAM_ERROR,options:[l,u],tag:Bn.TRACER}).onSuccess(),this.safeEmit(Lt.LIVE_STREAMING_ERROR,l,u)},a.onLiveStreamWarning=(l,u)=>{qe.reportApiInvoke(this._sessionId,{name:br.ON_LIVE_STREAM_WARNING,options:[l,u],tag:Bn.TRACER}).onSuccess(),this.safeEmit(Lt.LIVE_STREAMING_WARNING,l,u)},a.on(rm.REQUEST_WORKER_MANAGER_LIST,(l,u,p)=>{if(!this._joinInfo)return p(new le(z.INVALID_OPERATION,"can not find join info to get worker manager"));N3(l,this._joinInfo,this._axiosCancelSource.token,wr).then(u).catch(p)})};switch(e){case Ur.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=n(),s(this._liveRawStreamingClient)),this._liveRawStreamingClient;case Ur.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=n(),s(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case Ur.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=n(),this._injectStreamingClient.on(rm.REQUEST_WORKER_MANAGER_LIST,(a,l,u)=>{if(!this._joinInfo)return u(new le(z.INVALID_OPERATION,"can not find join info to get worker manager"));N3(a,this._joinInfo,this._axiosCancelSource.token,wr).then(l).catch(u)}),this._injectStreamingClient.onInjectStatusChange=(a,l,u)=>{this.safeEmit(Lt.INJECT_STREAM_STATUS,a,l,u)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new le(z.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:e,sendResolutionHeight:n}=this.getLocalVideoStats(),s={width:e,height:n};this._channelMediaRelayClient=new Ace(this._joinInfo,this._clientId,this._config.websocketRetryConfig||wr,this._config.httpRetryConfig||wr,s),this._channelMediaRelayClient.on("state",a=>{a===hs.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(Lt.CHANNEL_MEDIA_RELAY_STATE,a)}),this._channelMediaRelayClient.on("event",a=>{this.safeEmit(Lt.CHANNEL_MEDIA_RELAY_EVENT,a)}),this._statsCollector.onStatsChanged=(a,l)=>{var u;a==="resolution"&&((u=this._channelMediaRelayClient)===null||u===void 0||u.setVideoProfile(l))}}return this._channelMediaRelayClient}_handleUpdateDataChannel(e,n){const{added:s,deleted:a}=e,l=[];Array.isArray(s)&&s.length>0&&s.forEach(u=>{const{uid:p,stream_id:m,ordered:g,max_retrans_times:E,metadata:y}=u,C=this._users.find(I=>I._uintid===p);if(!C)return void N.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(N.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(p)),je(l).call(l,C)||l.push(C),C._uintid||(C._uintid=p),C._dataChannels.findIndex(I=>I.id===u.stream_id)===-1){const I={id:m,ordered:!!g,maxRetransmits:E,metadata:y},j=new voe(I);C._dataChannels.push(j),N.info("[".concat(this._clientId,"] remote user ").concat(C.uid," published datachannel")),n||this.safeEmit(Lt.USER_PUBLISHED,C,"datachannel",I)}this._p2pChannel.hasPendingRemoteDataChannel(C,u.stream_id)&&(N.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(C.uid," after reconnect.")),this._subscribeDataChannel(C,u.stream_id).catch(I=>{N.error("[".concat(this._clientId,"] resubscribe datachannel error"),I.toString())}))}),n&&(this.safeEmit(Lt.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(a)&&a.length>0&&a.forEach(u=>{const{uid:p,stream_id:m}=u,g=this._users.find(y=>y._uintid===p);if(!g)return void N.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const E=g._dataChannels.find(y=>y.id===u.stream_id);E&&(N.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(p)),this._p2pChannel.unsubscribeDataChannel(g,[E]).then(y=>{if(g._dataChannels=g._dataChannels.filter(C=>C!==E),y)return this._gateway.unsubscribeDataChannel(y,g.uid)}),N.info("[".concat(this._clientId,"] remote user ").concat(p," unpublished datachannel ,id:").concat(E.id)),this.safeEmit(Lt.USER_UNPUBLISHED,g,"datachannel",E._config))})}_handleRemoveDataChannels(e){const n=this._users.find(s=>s.uid===e.uid);if(n){if(n._dataChannels!==void 0&&n._dataChannels.length>0){N.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const s=()=>{N.info("[".concat(this._clientId,"] remote user ").concat(n.uid," unpublished datachannel")),n._dataChannels.forEach(a=>{this.safeEmit(Lt.USER_UNPUBLISHED,n,"datachannel",a._config)})};this._p2pChannel.unsubscribeDataChannel(n,n._dataChannels).then(a=>{if(a)return this._gateway.unsubscribeDataChannel(a,n.uid)}),s()}}else N.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(er.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(er.CONNECTION_STATE_CHANGE,(e,n,s)=>{var a;if(s===Dt.FALLBACK)return;const l=()=>{this.safeEmit(Lt.CONNECTION_STATE_CHANGE,e,n,s)};if(qe.reportApiInvoke(this._sessionId||((a=this._gateway.joinInfo)===null||a===void 0?void 0:a.sid)||null,{name:br.CONNECTION_STATE_CHANGE,options:[e,n,s],tag:Bn.TRACER}).onSuccess(JSON.stringify({cur:e,prev:n,reason:s})),N.info("[".concat(this._clientId,"] connection state change: ").concat(n," -> ").concat(e)),e==="DISCONNECTED")return this._reset(),void l();if(e==="RECONNECTING")this._users.forEach(p=>{p._trust_in_room_=!1,p._trust_audio_enabled_state_=!1,p._trust_video_enabled_state_=!1,p._trust_audio_mute_state_=!1,p._trust_video_mute_state_=!1,p._trust_audio_stream_added_state_=!1,p._trust_video_stream_added_state_=!1,p._is_pre_created||(p._audio_pre_subscribed||(p._audioSSRC=void 0,p._audioOrtc=void 0),p._video_pre_subscribed||(p._videoSSRC=void 0,p._videoOrtc=void 0,p._rtxSsrcId=void 0),p._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(e==="CONNECTED"){var u;this._streamFallbackTypeCacheMap.forEach((p,m)=>{this._gateway.setStreamFallbackOption(m,p).catch(g=>{N.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),g)})}),this._remoteStreamTypeCacheMap.forEach((p,m)=>{this._gateway.setRemoteVideoStreamType(m,p).catch(g=>{N.warning("[".concat(this._clientId,"] auto set remote stream type failed"),g)})}),this._remoteDefaultVideoStreamType!==void 0&&((u=this._joinInfo)===null||u===void 0?void 0:u.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{N.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(p=>{N.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(p))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(p=>!p._trust_in_room_).forEach(p=>{N.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(p.uid)),this._handleUserOffline({uid:p.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(p=>{p._trust_audio_mute_state_||(N.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,ze.AUDIO,!1)),p._trust_video_mute_state_||(N.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,ze.VIDEO,!1)),p._trust_audio_enabled_state_||(N.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(p.uid)),this._handleSetStreamLocalEnable("audio",p.uid,!0)),p._trust_video_enabled_state_||(N.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(p.uid)),this._handleSetStreamLocalEnable("video",p.uid,!0)),p._trust_video_stream_added_state_||(N.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(p.uid)),this._handleResetAddStream(p,"video")),p._trust_audio_stream_added_state_||(N.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(p.uid)),this._handleResetAddStream(p,"audio")),p._video_added_||p._audio_added_||(N.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(p.uid)),this._handleRemoveStream({uid:p.uid,uint_id:p._uintid}))}))},1e3))}l()}),this._gateway.on(er.REQUEST_NEW_GATEWAY_LIST,(e,n)=>{if(!this._joinInfo)return n(new le(z.UNEXPECTED_ERROR,"can not recover, no join info"));WN(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||wr,this.store).then(s=>{this._joinInfo&&(this._joinInfo.apResponse=s.gatewayInfo.res,this._joinInfo.gatewayAddrs=s.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=s.gatewayInfo.uni_lbs_ip);const a=[];s.gatewayInfo.gatewayAddrs.forEach(l=>{let{address:u}=l;const[p,m]=u.split(":");this._joinInfo&&this._joinInfo.proxyServer?a.push({proxy:this._joinInfo.proxyServer,host:p,port:m}):a.push({host:p,port:m})}),e(a)}).catch(n)}),this._gateway.on(er.NETWORK_QUALITY,e=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Lt.NETWORK_QUALITY,e)}),this._gateway.on(er.STREAM_TYPE_CHANGE,(e,n)=>{this.safeEmit(Lt.STREAM_TYPE_CHANGED,e,n),qe.reportApiInvoke(this._sessionId,{name:br.STREAM_TYPE_CHANGE,options:[e,n],tag:Bn.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:n}))}),this._gateway.on(er.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(er.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(er.REQUEST_P2P_CONNECTION_PARAMS,async(e,n,s)=>{try{n(await this._p2pChannel.startP2PConnection(e))}catch(a){s(a)}}),this._gateway.on(er.JOIN_RESPONSE,(e,n)=>{if(this.store.useP2P)return;const{dtlsParameters:s,iceParameters:a,candidates:l,rtpCapabilities:u,setup:p,cname:m}=y6(e.ortc,n);this._p2pChannel.connect(a,s,l,u,p,m)}),this._gateway.on(er.REQUEST_DC_CONNECTION_PARAMS,e=>{e(this._p2pChannel.getEstablishParams())}),this._gateway.on(er.RESET_SIGNAL,e=>{this._p2pChannel.resetConnection(e),this._handleGatewaySignalEvents()}),this._gateway.on(er.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(er.DATACHANNEL_PRECONNECT,async(e,n,s,a)=>{var l,u,p,m,g,E;await this._p2pChannel.startP2PConnection({turnServer:(l=this._joinInfo)===null||l===void 0?void 0:l.turnServer},!0);const y=function(C,I){let j;return I&&I.ip&&typeof I.port=="number"?(j=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:I.ip,port:I.port.toString(),type:"host",extension:{}}],N.debug("Using remote candidate from AP ".concat(I.ip,":").concat(I.port)),I.ip6&&(j.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:I.ip6,port:I.port.toString(),type:"host",extension:{}}),N.debug("Using IPV6 remote candidate from AP ".concat(I.ip6,":").concat(I.port)))):j=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:C.ip,port:C.port.toString(),type:"host",extension:{}}],j}(e,n);return this._p2pChannel.preConnect({iceUfrag:"".concat((u=this._joinInfo)===null||u===void 0?void 0:u.apResponse.cid,"_").concat((p=this._joinInfo)===null||p===void 0?void 0:p.apResponse.cert),icePwd:"".concat((m=this._joinInfo)===null||m===void 0?void 0:m.apResponse.cid,"_").concat((g=this._joinInfo)===null||g===void 0?void 0:g.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(E=Z("FINGERPRINT"))!==null&&E!==void 0?E:e.fingerprint}]},y,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(s).catch(a)})}_handleGatewaySignalEvents(){this._gateway.signal.on(ht.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(ht.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(ht.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(ht.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(ht.ON_REMOTE_DATASTREAM_UPDATE,e=>{this._handleUpdateDataChannel(e)}),this._gateway.signal.on(ht.ON_REMOTE_FULL_DATASTREAM_INFO,e=>{this._handleUpdateDataChannel({added:e.datastreams,deleted:[]},!0)}),this._gateway.signal.on(ht.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(ht.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(ht.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,ze.AUDIO,!0)),this._gateway.signal.on(ht.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,ze.AUDIO,!1)),this._gateway.signal.on(ht.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,ze.VIDEO,!0)),this._gateway.signal.on(ht.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,ze.VIDEO,!1)),this._gateway.signal.on(ht.RECEIVE_METADATA,e=>{const n=RE(e.metadata);this.safeEmit(Lt.RECEIVE_METADATA,e.uid,n)}),this._gateway.signal.on(ht.ON_DATA_STREAM,async e=>{var n;if(!e)return;let s=RE(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&je(n=["aes-128-gcm2","aes-256-gcm2"]).call(n,this._encryptionMode)){if(e.payload.length<tm)throw new le(z.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(tm));s=await async function(u,p,m){const g=m.subarray(0,tm),E=g.slice(8,tm),y=(E[0]<<8)+E[1],C=(g[6]<<8)+g[7],I=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:u,tagLength:j4,additionalData:new Uint8Array(e4(y,2))},p,m.subarray(tm));return new Uint8Array(I).subarray(0,C)}(this._encryptDataStreamIv,this._encryptDataStreamKey,s)}let a=0;if(e.ordered||e.syncWithAudio){const l=this._p2pChannel.getStats(),u=this.remoteUsers.find(m=>m.uid===e.uid),p=l==null?void 0:l.audioRecv.find(m=>m.ssrc===(u==null?void 0:u._audioSSRC));a=p==null?void 0:p.jitterBufferMs}a==null&&(a=0),Jce(Ac(Ac({},e),{},{payload:s}),a,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(ht.ON_CRYPT_ERROR,()=>{Xf(()=>{N.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Lt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(ht.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(ht.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{N.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Dt.TOKEN_EXPIRE),this.safeEmit(Lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(ht.ON_STREAM_FALLBACK_UPDATE,e=>{N.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(Lt.STREAM_FALLBACK,e.stream_id,e.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(ht.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),N.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))}),this._gateway.signal.on(ht.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(ht.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(We.REQUEST_TIMEOUT,(e,n)=>{if(this._joinInfo)switch(e){case Xe.PUBLISH:{if(!n)return;const l=n.ortc;if(l){var s,a;const u=l.some(g=>{let{stream_type:E}=g;return E===Qt.Audio}),p=l.some(g=>{let{stream_type:E}=g;return E!==Qt.Audio}),m=l.some(g=>{let{stream_type:E}=g;return E===Qt.Screen||E===Qt.ScreenLow});n.state==="offer"&&qe.publish(this._joinInfo.sid,{eventElapse:Li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:z.TIMEOUT,audio:u,video:p,p2pid:n.p2p_id,publishRequestid:this.store.pubId,screenshare:m,audioName:u?(s=l.find(g=>{let{stream_type:E}=g;return E===Qt.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0,videoName:p?(a=l.find(g=>{let{stream_type:E}=g;return E!==Qt.Audio}))===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId.toString():void 0})}break}case Xe.SUBSCRIBE:n&&qe.subscribe(this._joinInfo.sid,{succ:!1,ec:z.TIMEOUT,audio:n.stream_type===ze.AUDIO,video:n.stream_type===ze.VIDEO,peerid:n.stream_id,subscribeRequestid:n.ssrcId,p2pid:this.store.p2pId,eventElapse:Li.measureFromSubscribeStart(this.store.clientId,n.ssrcId)})}}),this._gateway.signal.on(ht.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(ht.ON_PUBLISHED_USER_LIST,e=>{if(e==null||!e.users)return;Z("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter(a=>!tp(a.string_id||a.stream_id,this.channelName)));const n=[],s=[];for(const a of e.users){let l=this._users.find(y=>y._uintid===a.stream_id);l?l._trust_in_room_=!0:(l=new Si(a.string_id||a.stream_id,a.stream_id),this._users.push(l),this.getListeners(Lt.PUBLISHED_USER_LIST).length===0&&(N.debug("[".concat(this._clientId,"] user online"),a.stream_id),this.safeEmit(Lt.USER_JOINED,l)));const u=Or.Audio&a.stream_type,p=(Or.Video|Or.LwoVideo)&a.stream_type,m=(65280&a.stream_type)!=0,g=u&&l.hasAudio,E=p&&l.hasVideo;p&&(l._trust_video_stream_added_state_=!0,l._video_added_=!0,l._videoSSRC=a.video_ssrc,l._rtxSsrcId=a.video_rtx),u&&(l._trust_audio_stream_added_state_=!0,l._audio_added_=!0,l._audioSSRC=a.audio_ssrc),u&&!g&&this.getListeners(Lt.PUBLISHED_USER_LIST).length===0&&(N.info("[".concat(this._clientId,"] remote user ").concat(l.uid," published audio")),this.safeEmit(Lt.USER_PUBLISHED,l,"audio")),p&&!E&&this.getListeners(Lt.PUBLISHED_USER_LIST).length===0&&(N.info("[".concat(this._clientId,"] remote user ").concat(l.uid," published video")),this.safeEmit(Lt.USER_PUBLISHED,l,"video")),(u&&!g||p&&!E||m)&&n.push(l),p&&this._p2pChannel.hasPendingRemoteMedia(l,"video")&&s.push({user:l,mediaType:"video"}),u&&this._p2pChannel.hasPendingRemoteMedia(l,"audio")&&s.push({user:l,mediaType:"audio"})}s.length>0&&(N.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(s.map(a=>"user: ".concat(a.user.uid,", mediaType: ").concat(a.mediaType)).join("; ")," ")),this.massSubscribe(s).catch(a=>{N.error("[".concat(this._clientId,"] mass resubscribe error"),a.toString())})),this.getListeners(Lt.PUBLISHED_USER_LIST).length>0?Z("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=n:(N.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(n.map(a=>a.uid).join(", "))),this.safeEmit(Lt.PUBLISHED_USER_LIST,n)):N.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(n.map(a=>a.uid).join(", ")))}),this._gateway.signal.on(ht.ON_RTP_CAPABILITY_CHANGE,e=>{const{video_codec:n}=e;this._p2pChannel instanceof ci&&this._p2pChannel.updateRemoteRTPCapabilities(n.map(s=>s.toLowerCase()).filter(s=>{var a;return je(a=Object.keys(du)).call(a,s)}))})}_handleP2PEvents(){this._gateway.signal.on(ht.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(tr.PUBLISH,(e,n,s)=>{const{uid:a}=e;e.forEach(l=>{const{kind:u,ssrcs:p,mid:m,isMuted:g}=l;this._handleP2PAddAudioOrVideoStream(u,a,p[0].ssrcId,m);const E=this._users.find(y=>y.uid===a);return E&&this._p2pChannel instanceof Fr?this._p2pChannel.mockSubscribe(E,u,p[0].ssrcId,m).then(()=>{n()}).catch(s):n(),this._handleMuteStream(a,u,!!g)})}),this._gateway.signal.on(tr.CALL,async(e,n,s)=>{if(this._p2pChannel instanceof Fr)try{var a;n(await this._p2pChannel.startP2P({turnServer:(a=this._joinInfo)===null||a===void 0?void 0:a.turnServer},e))}catch(l){s(l)}}),this._gateway.signal.on(We.P2P_CONNECTION,async e=>{this._p2pChannel instanceof Fr&&await this._p2pChannel.p2pConnect(e)}),this._gateway.signal.on(tr.UNPUBLISH,async(e,n,s)=>{if(this._p2pChannel instanceof Fr){const{unpubMsg:a,uid:l}=e,u=this._users.find(p=>p.uid===l);if(!u)return N.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(l)),void n();try{a.forEach(async p=>{let{stream_type:m}=p;const g=m===Qt.Audio?ze.AUDIO:ze.VIDEO;await this._p2pChannel.unsubscribe(u,g),this._handleMuteStream(l,g,!0)}),n()}catch(p){s(p)}}}),this._gateway.signal.on(tr.CONTROL,async(e,n)=>{const{action:s}=e;switch(s){case al.MUTE_LOCAL_VIDEO:this._handleMuteStream(n,ze.VIDEO,!0);break;case al.MUTE_LOCAL_AUDIO:this._handleMuteStream(n,ze.AUDIO,!0);break;case al.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",n),this._handleMuteStream(n,ze.VIDEO,!1);break;case al.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",n),this._handleMuteStream(n,ze.AUDIO,!1)}}),this._gateway.signal.on(tr.RESTART_ICE,async(e,n,s)=>{if(this._p2pChannel instanceof Fr)try{const{direction:a,iceParameter:l}=e;a!==zi.SEND_ONLY||l?n(await this._p2pChannel.restartICE(a,l)):(this._p2pChannel.handleDisconnect(a),n())}catch(a){s(a)}}),this._gateway.signal.on(tr.CANDIDATE,e=>{if(this._p2pChannel instanceof Fr){const{candidate:n,direction:s}=e;this._p2pChannel.addRemoteCandidate(n,s)}}),this._p2pChannel.on(st.RequestP2PRestartICE,async(e,n,s)=>{try{const{direction:a}=e;n(await this._gateway.sendExtensionMessage(tr.RESTART_ICE,e,a===zi.SEND_ONLY))}catch(a){s(a)}}),this._p2pChannel.on(st.LocalCandidate,e=>{this._gateway.sendExtensionMessage(tr.CANDIDATE,JSON.stringify(e),!0)}),this._p2pChannel.on(st.RequestP2PMuteLocal,async(e,n,s)=>{try{await this._gateway.sendExtensionMessage(tr.CONTROL,e,!0),n()}catch(a){s(a)}}),this._p2pChannel.on(st.RequestP2PUnmuteRemote,async(e,n,s)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(a){a.code===z.DISCONNECT_P2P?n():s(a)}else n()}),this._p2pChannel.on(st.RequestP2PMuteRemote,async(e,n,s)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(a){a.code===z.DISCONNECT_P2P?n():s(a)}else n()}),this._p2pChannel.on(st.StateChange,(e,n)=>{n===en.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(st.RequestMuteLocal,async(e,n,s)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(a){a.code===z.DISCONNECT_P2P?n():s(a)}else n()}),this._p2pChannel.on(st.RequestUnmuteLocal,async(e,n,s)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(a){a.code===z.DISCONNECT_P2P?n():s(a)}else n()}),this._p2pChannel.on(st.RequestRePublish,(e,n,s)=>{this.publish(e,!1).then(n).catch(s)}),this._p2pChannel.on(st.RequestRePublishDataChannel,(e,n,s)=>{pe.all(e.map(async a=>{await this._p2pChannel.publishDataChannel([a]);const l={streamId:a.id,ordered:a.ordered,maxRetransmits:a.maxRetransmits,metadata:a.metadata,channelId:a._originDataChannelId};try{await this._gateway.publishDataChannel(this._uid,l,!0)}catch(u){if(u.code!==z.DISCONNECT_P2P)throw u}})).then(n).catch(s)}),this._p2pChannel.on(st.RequestReSubscribe,async(e,n,s)=>{try{for(const{user:a,kind:l}of e)l===ze.VIDEO?await this.subscribe(a,"video"):await this.subscribe(a,"audio");n()}catch(a){s(a)}}),this._p2pChannel.on(st.RequestUpload,(e,n)=>{this._gateway.upload(e,n)}),this._p2pChannel.on(st.RequestUploadStats,e=>{this._gateway.uploadWRTCStats(e)}),this._p2pChannel.on(st.MediaReconnectStart,e=>{this.safeEmit(Lt.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(st.MediaReconnectEnd,e=>{this.safeEmit(Lt.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(st.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(st.RequestRestartICE,async e=>{if(this._p2pChannel instanceof Fr)return;const n=await this._p2pChannel.restartICE(e),s=await n.next();if(s.done)return;const a=s.value;let l;try{l=await this._gateway.restartICE({iceParameters:a})}catch(p){return void n.throw(p)}const{iceParameters:u}=function(p){const m=p.iceParameters;return{iceParameters:{iceUfrag:m.iceUfrag,icePwd:m.icePwd}}}(l);await n.next({remoteIceParameters:u})}),this._p2pChannel.on(st.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(st.RequestReconnectPC,async()=>{var e;const{iceParameters:n,dtlsParameters:s,rtpCapabilities:a}=await this._p2pChannel.startP2PConnection({turnServer:(e=this._joinInfo)===null||e===void 0?void 0:e.turnServer}),{gatewayEstablishParams:l,gatewayAddress:u}=await this._gateway.reconnectPC({iceParameters:n,dtlsParameters:s,rtpCapabilities:a}),{dtlsParameters:p,iceParameters:m,candidates:g,rtpCapabilities:E,setup:y,cname:C}=y6(l,u);await this._p2pChannel.connect(m,p,g,E,y,C),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(st.RequestUnpublishForReconnectPC,async(e,n,s)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(e,this._uid),n()):s()}),this._p2pChannel.on(st.P2PLost,()=>{this.safeEmit(Lt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(st.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(st.ConnectionTypeChange,e=>{this.safeEmit(Lt.IS_USING_CLOUD_PROXY,e)}),this._p2pChannel.on(st.RequestLowStreamParameter,e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(st.QueryClientConnectionState,e=>{e(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!e)throw new le(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!e.inspectType||!Array.isArray(e.inspectType))throw new le(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const n=[...new Set(e.inspectType)];n.forEach(s=>{var a;if(!je(a=["supervise","moderation"]).call(a,s))throw new le(z.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(s," is not a valid inspect type."))}),e.inspectType=n}if(e&&e.extraInfo&&e.extraInfo.length>1024)throw new le(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const n=new XT(e);this._inspect=n,this.handleVideoInspectEvents(this._inspect),await n.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},wr)}catch(n){throw Array.isArray(n)?n[0]:n}}async disableContentInspect(){if(!this._inspect)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,n){if(Jl(e,"enabled"),e){if(!n)throw new le(z.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(pn(n.interval,"interval",1e3,1/0),n&&n.extraInfo&&n.extraInfo.length>1024)throw new le(z.INVALID_PARAMS,"[".concat(this._clientId,"] config.extraInfo length cannot exceed 1024 bytes"));if(n&&n.vendor&&n.vendor.length>1024)throw new le(z.INVALID_PARAMS,"[".concat(this._clientId,"] config.vendor length cannot exceed 1024 bytes"));if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(n);const s=new Ax(n);this._moderation=s,this.handleImageModerationEvents(this._moderation),await s.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},wr)}catch(s){throw Array.isArray(s)?s[0]:s}}else{if(!this._moderation)throw new le(z.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(s){throw Array.isArray(s)?s[0]:s}}}setP2PTransport(e){if(function(n){Lr(n,"transport",["default","auto","relay","sd-rtn"])}(e),this.mode!=="p2p")throw new le(z.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,N.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}handleImageModerationEvents(e){e.on(Jo.CONNECTION_STATE_CHANGE,(n,s)=>{if(this.safeEmit(Lt.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,n,s),n===Zs.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new le(z.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}}),e.on(Jo.CLIENT_LOCAL_VIDEO_TRACK,n=>{n(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}handleVideoInspectEvents(e){e.on(jr.CONNECTION_STATE_CHANGE,(n,s)=>{if(this.safeEmit(Lt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,n,s),s===So.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Lt.CONTENT_INSPECT_ERROR,new le(z.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}}),e.on(jr.INSPECT_RESULT,(n,s)=>{var a;if((s==null?void 0:s.code)===z.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return N.debug("Stop inspect content because that has left channel"),this==null||(a=this._inspect)===null||a===void 0||a.close(),void(this._inspect=void 0);this.safeEmit(Lt.CONTENT_INSPECT_RESULT,n,s)}),e.on(jr.CLIENT_LOCAL_VIDEO_TRACK,n=>{n(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return N.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){Jl(e,"enabled"),fn("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,n){switch(n){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}}be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],dn.prototype,"leave",null),be([it({argsMap:(i,e)=>{if(!Array.isArray(e)){if(!(e instanceof Di))return[e];e=[e]}return e.map(n=>n?Object(n).toString():"null")}}),$("design:type",Function),$("design:paramtypes",[Object,Boolean]),$("design:returntype",pe)],dn.prototype,"publish",null),be([it({argsMap:(i,e)=>(e||(e=[]),e instanceof iB?[e.getChannelId()]:(Array.isArray(e)||(e=[e]),e.map(n=>n.getTrackId())))}),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],dn.prototype,"unpublish",null),be([it({argsMap:(i,e,n,s)=>[e.uid,n,s]}),$("design:type",Function),$("design:paramtypes",[Si,String,Number]),$("design:returntype",pe)],dn.prototype,"subscribe",null),be([it({argsMap:(i,e,n)=>[e,n]}),$("design:type",Function),$("design:paramtypes",[Object,String]),$("design:returntype",pe)],dn.prototype,"presubscribe",null),be([it({argsMap:(i,e)=>e.map(n=>{let{user:s,mediaType:a}=n;return[s==null?void 0:s.uid,a]})}),$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],dn.prototype,"massSubscribe",null),be([it({argsMap:(i,e,n,s)=>[e.uid,n,s]}),$("design:type",Function),$("design:paramtypes",[Si,String,Number]),$("design:returntype",pe)],dn.prototype,"unsubscribe",null),be([it({argsMap:(i,e)=>e.map(n=>{let{user:s,mediaType:a}=n;return{uid:s==null?void 0:s.uid,mediaType:a}})}),$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",pe)],dn.prototype,"massUnsubscribe",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],dn.prototype,"setLowStreamParameter",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],dn.prototype,"enableDualStream",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],dn.prototype,"disableDualStream",null),be([it(),$("design:type",Function),$("design:paramtypes",[String,Object]),$("design:returntype",pe)],dn.prototype,"setClientRole",null),be([it(),$("design:type",Function),$("design:paramtypes",[String,Boolean]),$("design:returntype",void 0)],dn.prototype,"setProxyServer",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object,Boolean]),$("design:returntype",void 0)],dn.prototype,"setTurnServer",null),be([it(),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",void 0)],dn.prototype,"setLicense",null),be([it(),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",void 0)],dn.prototype,"startProxyServer",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],dn.prototype,"stopProxyServer",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",void 0)],dn.prototype,"setLocalAccessPointsV2",null),be([it(),$("design:type",Function),$("design:paramtypes",[Array,String]),$("design:returntype",void 0)],dn.prototype,"setLocalAccessPoints",null),be([it(),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",pe)],dn.prototype,"setRemoteDefaultVideoStreamType",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object,Number]),$("design:returntype",pe)],dn.prototype,"setRemoteVideoStreamType",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object,Number]),$("design:returntype",pe)],dn.prototype,"setStreamFallbackOption",null),be([it({argsMap:(i,e)=>[e]}),$("design:type",Function),$("design:paramtypes",[String,String,Uint8Array,Boolean]),$("design:returntype",void 0)],dn.prototype,"setEncryptionConfig",null),be([it(),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],dn.prototype,"renewToken",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",void 0)],dn.prototype,"enableAudioVolumeIndicator",null),be([it(),$("design:type",Function),$("design:paramtypes",[String,Boolean]),$("design:returntype",pe)],dn.prototype,"startLiveStreaming",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],dn.prototype,"setLiveTranscoding",null),be([it(),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",pe)],dn.prototype,"stopLiveStreaming",null),be([it(),$("design:type",Function),$("design:paramtypes",[String,Object]),$("design:returntype",pe)],dn.prototype,"addInjectStreamUrl",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],dn.prototype,"removeInjectStreamUrl",null),be([it(),$("design:type",Function),$("design:paramtypes",[GT]),$("design:returntype",pe)],dn.prototype,"startChannelMediaRelay",null),be([it(),$("design:type",Function),$("design:paramtypes",[GT]),$("design:returntype",pe)],dn.prototype,"updateChannelMediaRelay",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],dn.prototype,"stopChannelMediaRelay",null),be([it({argsMap:(i,e)=>(Array.isArray(e)||(e=[e]),[JSON.stringify(e)])}),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],dn.prototype,"sendCustomReportMessage",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object,Object]),$("design:returntype",pe)],dn.prototype,"pickSVCLayer",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],dn.prototype,"setRTMConfig",null),be([it(),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",pe)],dn.prototype,"enableContentInspect",null),be([it(),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",pe)],dn.prototype,"disableContentInspect",null),be([it(),$("design:type",Function),$("design:paramtypes",[Boolean,Object]),$("design:returntype",pe)],dn.prototype,"setImageModeration",null),be([it(),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",void 0)],dn.prototype,"setP2PTransport",null),be([it({reportResult:!0}),$("design:type",Function),$("design:paramtypes",[]),$("design:returntype",Array)],dn.prototype,"getJoinChannelServiceRecords",null),be([it(),$("design:type",Function),$("design:paramtypes",[Boolean]),$("design:returntype",pe)],dn.prototype,"setPublishAudioFilterEnabled",null);class vv{constructor(e,n){R(this,"id",0),R(this,"element",void 0),R(this,"peerPair",void 0),R(this,"context",void 0),R(this,"audioPlayerElement",void 0),R(this,"audioTrack",void 0),vv.count+=1,this.id=vv.count,this.element=e,this.context=n}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=e=>{const n=document.createElement("audio");n.srcObject=new MediaStream([e.track]),n.play(),this.audioPlayerElement=n}}async switchSdp(){if(!this.peerPair)return;const e=async(s,a)=>{const l=a==="offer"?await s.createOffer():await s.createAnswer();return await s.setLocalDescription(l),s.iceGatheringState==="complete"?s.localDescription:new pe(u=>{s.onicegatheringstatechange=()=>{s.iceGatheringState==="complete"&&u(s.localDescription)}})},n=async(s,a)=>await s.setRemoteDescription(a);try{const s=await e(this.peerPair[0],"offer");await n(this.peerPair[1],s);const a=await e(this.peerPair[1],"answer");await n(this.peerPair[0],a)}catch(s){throw new le(z.LOCAL_AEC_ERROR,s.toString()).print()}}async getTracksFromMediaElement(e){if(this.audioTrack)return this.audioTrack;let n;try{e instanceof HTMLVideoElement&&(e.captureStream?e.captureStream():e.mozCaptureStream()),n=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(e).connect(n)}catch(a){throw new le(z.LOCAL_AEC_ERROR,a.toString()).print()}if(!n)throw new le(z.LOCAL_AEC_ERROR,"no dest node when local aec").print();const s=n.stream.getAudioTracks()[0];return this.audioTrack=s,s}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const e=this.element,n=await this.getTracksFromMediaElement(e);this.peerPair&&this.peerPair[0].addTrack(n),await this.switchSdp()}close(){N.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(e=>{e.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}R(vv,"count",0);const ele=window.AudioContext||window.webkitAudioContext;class _W{constructor(){R(this,"units",[]),R(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return N.debug("the system does not need to process local aec"),-1;this.context||(this.context=new ele);let n=this.units.find(s=>s&&s.getElement()===e);return n||(n=new vv(e,this.context),this.units.push(n)),n.startEchoCancellation(),N.debug("start processing local audio echo cancellation, id is",n.id),n.id}_doesEnvironmentNeedAEC(){return zt().name!==Zt.SAFARI}}be([it({report:qe}),$("design:type",Function),$("design:paramtypes",[HTMLAudioElement]),$("design:returntype",Number)],_W.prototype,"processExternalMediaAEC",null);const tle=new _W;function EW(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),n.push.apply(n,s)}return n}function vW(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EW(Object(n),!0).forEach(function(s){R(i,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):EW(Object(n)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(n,s))})}return i}const Nx=window||document;function yW(i){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!Nx)return;const n=Rr._cspEventHandlerPointer;if(n&&e)return void console.error(n,e);const s=a=>{if(!(a&&a.blockedURI&&(Rr.onSecurityPolicyViolation||Rr.getListeners(wa.SECURITY_POLICY_VIOLATION).length>0)))return;const l=a.blockedURI;Z("CSP_DETECTED_HOSTNAME_LIST").some(u=>je(l).call(l,u))&&(Rr.onSecurityPolicyViolation&&typeof Rr.onSecurityPolicyViolation=="function"&&Rr.onSecurityPolicyViolation(a),Rr.getListeners(wa.SECURITY_POLICY_VIOLATION).length>0&&Rr.safeEmit(wa.SECURITY_POLICY_VIOLATION,a))};n&&Nx.removeEventListener("securitypolicyviolation",n),(e||i&&typeof i=="function"||Rr.getListeners(wa.SECURITY_POLICY_VIOLATION).length>0)&&Nx.addEventListener("securitypolicyviolation",s),Rr._cspEventHandlerPointer=s}fn("PROCESS_ID","process-".concat(Sn(8,""),"-").concat(Sn(4,""),"-").concat(Sn(4,""),"-").concat(Sn(4,""),"-").concat(Sn(12,""))),function(){let i;try{i=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void N.error("Error loading sdk config",e.message)}if(i)try{const e=JSON.parse(window.atob(i)),n=Date.now();N.debug("Loading global parameters from cache",e),Object.keys(e).forEach(s=>{if(Object.prototype.hasOwnProperty.call(rs,s)){const{value:a,expires:l}=e[s];if(l&&l<=n)return;lu[s]=a,rs[s]=a}})}catch(e){N.error("Error loading mutableParamsCache: ".concat(i),e.message)}}(),Array.isArray(lu.AREAS)&&lu.AREAS.length>0&&jN(lu.AREAS,!0);const SW=(i,e,n)=>{N.debug("setParameter key:".concat(i,", value:").concat(JSON.stringify(e))),fn(i,e,n)},Rr=function(i){const e=new jn,n=i,s={getListeners:e.getListeners.bind(e),on:(a,l)=>(function(u,p){u===wa.SECURITY_POLICY_VIOLATION&&yW(p,!0)}(a,l),e.on.bind(e)(a,l)),addListener:e.addListener.bind(e),once:e.once.bind(e),off:e.off.bind(e),removeAllListeners:e.removeAllListeners.bind(e),emit:e.emit.bind(e),safeEmit:e.safeEmit.bind(e)};return vW(vW({},n),s)}({__TRACK_LIST__:am,VERSION:qo,BUILD:vN,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:SW,getParameter:Z,getSupportedCodec:async function(){let i={audio:[],video:[]};try{let e=new RTCPeerConnection;e.addTransceiver("video",{direction:"recvonly"}),e.addTransceiver("audio",{direction:"recvonly"});const n=(await e.createOffer()).sdp;if(!n)return i;e.close(),e=null,i=function(s){const a={video:[],audio:[]};return s.match(/ VP8/i)&&a.video.push("VP8"),s.match(/ VP9/i)&&a.video.push("VP9"),s.match(/ AV1/i)&&a.video.push("AV1"),s.match(/ H264/i)&&a.video.push("H264"),s.match(/ H265/i)&&a.video.push("H265"),s.match(/ opus/i)&&a.audio.push("OPUS"),s.match(/ PCMU/i)&&a.audio.push("PCMU"),s.match(/ PCMA/i)&&a.audio.push("PCMA"),s.match(/ G722/i)&&a.audio.push("G722"),a}(n)}catch(e){throw new le(z.CREATE_OFFER_FAILED,e.toString&&e.toString()).print()}return i},checkSystemRequirements:function(){const i=qe.reportApiInvoke(null,{name:br.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Bn.TRACER});let e=!1;try{const l=window.RTCPeerConnection,u=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,p=window.WebSocket;e=!!(l&&u&&p)}catch(l){return N.error("check system requirement failed: ",l),!1}let n=!1;const s=zt();s.name===Zt.CHROME&&Number(s.version)>=58&&(!Tre()||bre())&&(n=!0),s.name===Zt.FIREFOX&&Number(s.version)>=56&&(n=!0),s.name===Zt.OPERA&&Number(s.version)>=45&&(n=!0),s.name===Zt.SAFARI&&Number(s.version)>=11&&(n=!0),(L5()||zt().name===Zt.QQ)&&(n=!0),N.debug("checkSystemRequirements, api:",e,"browser",n);const a=e&&n;return i.onSuccess(a),a},getDevices:function(i){return Ro.enumerateDevices(!0,!0,i)},getMicrophones:function(i){return Ro.getRecordingDevices(i)},getCameras:function(i){return Ro.getCamerasDevices(i)},getElectronScreenSources:G3,getPlaybackDevices:function(i){return Ro.getSpeakers(i)},createClient:function(){var i;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const n=qe.reportApiInvoke(null,{name:br.CREATE_CLIENT,options:[e],tag:Bn.TRACER});try{(function(s){Lr(s.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Lr(s.mode,"config.mode",["rtc","live","p2p"]),s.audioCodec!==void 0&&Lr(s.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),s.proxyServer!==void 0&&xi(s.proxyServer,"config.proxyServer",1,1e4),s.turnServer!==void 0&&G5(s.turnServer),s.httpRetryConfig!==void 0&&$5(s.httpRetryConfig),s.websocketRetryConfig!==void 0&&$5(s.websocketRetryConfig)})(e)}catch(s){throw n.onError(s),s}return Zce()||(e.codec==="vp9"&&(e.codec="vp8",N.debug("browser not support vp9, force use vp8")),fn("UNSUPPORTED_VIDEO_CODEC",["vp9"])),e.audioCodec===void 0&&(e.audioCodec="opus"),n.onSuccess(),new dn(Ac(Ac({forceWaitGatewayResponse:!0},e),{},{role:je(i=["rtc","p2p"]).call(i,e.mode)?"host":e.role||"audience"}))},createCameraVideoTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CREATE_CAM_VIDEO_TRACK,options:[dT({},i)]}),n=lT(i),s=Sn(8,"track-cam-");let a=null;const l=i.encoderConfig==="720p_auto";N.info("start create camera video track with config",JSON.stringify(i),"trackId",s);try{a=(await wo({video:n},s)).getVideoTracks()[0]||null}catch(p){throw e.onError(p),p}if(!a){const p=new ye(z.UNEXPECTED_ERROR,"can not find track in media stream");return e.onError(p),p.throw(N)}i.optimizationMode&&ik(s,a,i,cl(i.encoderConfig));const u=new Tu(a,i,n,i.scalabiltyMode?sT(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,s);return l&&u.startMonitorStats(),e.onSuccess(u.getTrackId()),N.info("create camera video success, trackId:",s),u},createCustomVideoTrack:function(i){const e=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CREATE_CUSTOM_VIDEO_TRACK,options:[i]}),n=new At(i.mediaStreamTrack,{width:i.width,height:i.height,frameRate:i.frameRate,bitrateMax:i.bitrateMax,bitrateMin:i.bitrateMin},i.scalabiltyMode?sT(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,Sn(8,"track-cus-"),[wn.CUSTOM_TRACK]);return e.onSuccess(n.getTrackId()),N.info("create custom video track success with config",i,"trackId",n.getTrackId()),n},createScreenVideoTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const n=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CREATE_SCREEN_VIDEO_TRACK,options:[dT({},i),e]}),s=i.encoderConfig==="720p_auto";i.encoderConfig?typeof i.encoderConfig=="string"||i.encoderConfig.width&&i.encoderConfig.height||(i.encoderConfig.width={max:1920},i.encoderConfig.height={max:1080}):i.encoderConfig="1080p_2";const a=function(y){const C={};y.screenSourceType&&(C.mediaSource=y.screenSourceType),y.extensionId&&Xl()&&(C.extensionId=y.extensionId);const{displaySurface:I,selfBrowserSurface:j,surfaceSwitching:P,systemAudio:U}=y;(GO(107)||N5(107)||k5(93))&&(I&&(Lr(I,"displaySurface",["browser","window","monitor"]),C.displaySurface=I),j?(Lr(j,"selfBrowserSurface",["exclude","include"]),C.selfBrowserSurface=j):C.selfBrowserSurface="include",P&&(Lr(P,"surfaceSwitching",["exclude","include"]),C.surfaceSwitching=P)),(GO(105)||N5(105)||k5(91))&&U&&(Lr(U,"systemAudio",["exclude","include"]),C.systemAudio=U),y.electronScreenSourceId&&(C.sourceId=y.electronScreenSourceId);const q=y.encoderConfig?GN(y.encoderConfig):null;return C.mandatory={chromeMediaSource:"desktop",maxWidth:q?q.width:void 0,maxHeight:q?q.height:void 0},q&&(q.frameRate&&(typeof q.frameRate=="number"?(C.mandatory.maxFrameRate=q.frameRate,C.mandatory.minFrameRate=q.frameRate):(C.mandatory.maxFrameRate=q.frameRate.max||q.frameRate.ideal||q.frameRate.exact||void 0,C.mandatory.minFrameRate=q.frameRate.min||q.frameRate.ideal||q.frameRate.exact||void 0),C.frameRate=q.frameRate),q.width&&(C.width=q.width),q.height&&(C.height=q.height)),C}(i),l=Sn(8,"track-scr-v-");let u=null,p=null;const m=Kt();if(!m.supportShareAudio&&e==="enable"){const y=new ye(z.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return n.onError(y),y.throw(N)}N.info("start create screen video track with config",i,"withAudio",e,"trackId",l);try{const y=await wo({screen:a,screenAudio:e==="auto"?m.supportShareAudio:e==="enable"},l);u=y.getVideoTracks()[0]||null,p=y.getAudioTracks()[0]||null}catch(y){throw n.onError(y),y}if(!u){const y=new ye(z.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(y),y.throw(N)}if(!p&&e==="enable"){u&&u.stop();const y=new ye(z.SHARE_AUDIO_NOT_ALLOWED);return n.onError(y),y.throw(N)}i.optimizationMode||(i.optimizationMode="detail"),i.optimizationMode&&(ik(l,u,i,i.encoderConfig&&GN(i.encoderConfig)||void 0),i.encoderConfig&&typeof i.encoderConfig!="string"&&(i.encoderConfig.bitrateMin=i.encoderConfig.bitrateMax));const g=new At(u,i.encoderConfig?GN(i.encoderConfig):{},i.scalabiltyMode?sT(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,l,[wn.SCREEN_TRACK]);if(s&&g.startMonitorStats(),!p)return n.onSuccess(g.getTrackId()),N.info("create screen video track success","video:",g.getTrackId()),g;const E=new ln(p,void 0,Sn(8,"track-scr-a-"),!1);return n.onSuccess([g.getTrackId(),E.getTrackId()]),N.info("create screen video track success","video:",g.getTrackId(),"audio:",E.getTrackId()),[g,E]},createMicrophoneAndCameraTracks:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CREATE_MIC_AND_CAM_TRACKS,options:[i,e]}),s=e.encoderConfig==="720p_auto",a=lT(e),l=iV(i),u=Sn(8,"track-mic-"),p=Sn(8,"track-cam-");let m=null,g=null;N.info("start create camera video track(".concat(p,") and microphone audio track(").concat(u,") with config, audio: ").concat(JSON.stringify(i),", video: ").concat(JSON.stringify(e)));try{const C=await wo({audio:l,video:a},"".concat(u,"-").concat(p));m=C.getAudioTracks()[0],g=C.getVideoTracks()[0]}catch(C){throw n.onError(C),C}if(!m||!g){const C=new ye(z.UNEXPECTED_ERROR,"can not find tracks in media stream");return n.onError(C),C.throw(N)}e.optimizationMode&&ik(p,g,e,cl(e.encoderConfig));const E=new ap(m,i,l,u),y=new Tu(g,e,a,e.scalabiltyMode?sT(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,p);return s&&y.startMonitorStats(),n.onSuccess([E.getTrackId(),y.getTrackId()]),N.info("create camera video track(".concat(p,") and microphone audio track(").concat(u,") success")),[E,y]},createMicrophoneAudioTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CREATE_MIC_AUDIO_TRACK,options:[i]}),n=iV(i),s=Sn(8,"track-mic-");let a=null;N.info("start create microphone audio track with config",JSON.stringify(i),"trackId",s);try{a=(await wo({audio:n},s)).getAudioTracks()[0]||null}catch(u){throw e.onError(u),u}if(!a){const u=new ye(z.UNEXPECTED_ERROR,"can not find track in media stream");return e.onError(u),u.throw(N)}const l=new ap(a,i,n,s);return e.onSuccess(l.getTrackId()),N.info("create microphone audio track success, trackId:",s),l},createCustomAudioTrack:function(i){const e=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CREATE_CUSTOM_AUDIO_TRACK,options:[i]}),n=new ln(i.mediaStreamTrack,i.encoderConfig?oT(i.encoderConfig):{},Sn(8,"track-cus-"),!1);return N.info("create custom audio track success with config",i,"trackId",n.getTrackId()),e.onSuccess(n.getTrackId()),n},createBufferSourceAudioTrack:async function(i){var e;const{cacheOnlineFile:n,encoderConfig:s}=i;let{source:a}=i;const l={source:a instanceof AudioBuffer?"AudioBuffer":a instanceof File?(e=File.name)!==null&&e!==void 0?e:"File":a,cacheOnlineFile:n,encoderConfig:s},u=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CREATE_BUFFER_AUDIO_TRACK,options:[l]});if(Z("DISABLE_WEBAUDIO"))throw new ye(z.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const p=Sn(8,"track-buf-");N.info("start create buffer source audio track with config",JSON.stringify(l),"trackId",p);const m=a;if(!(a instanceof AudioBuffer))try{a=await hse(a,n)}catch(y){return u.onError(y),y.throw(N)}const g=new use(a),E=new bu(m,g,s?oT(s):{},p);return N.info("create buffer source audio track success, trackId:",p),u.onSuccess(E.getTrackId()),E},setAppType:function(i){if(N.debug("setAppType: ".concat(i)),!(Number.isInteger(i)&&i>=0))throw N.debug("Invalid appType"),new le(z.INVALID_PARAMS,"invalid app type",i);fn("APP_TYPE",Math.floor(i))},setLogLevel:function(i){N.setLogLevel(i)},enableLogUpload:function(){Z("USE_NEW_LOG")?fn("UPLOAD_LOG",!0):N.enableLogUpload()},disableLogUpload:function(){Z("USE_NEW_LOG")?fn("UPLOAD_LOG",!1):N.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new GT},checkAudioTrackIsActive:async function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const n=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[e]});if(!(i instanceof ln||i instanceof Oa)){const m=new le(z.INVALID_TRACK,"the parameter is not a audio track");return n.onError(m),m.throw()}e&&e<1e3&&(e=1e3);const s=i instanceof ln?i.getTrackLabel():"remote_track",a=i.getVolumeLevel();let l=a,u=a;const p=Date.now();return new pe(m=>{const g=setInterval(()=>{const E=i.getVolumeLevel();l=E>l?E:l,u=E<u?E:u;const y=l-u>1e-4,C=Date.now()-p;if(y||C>e){clearInterval(g);const I=y,j={duration:C,deviceLabel:s,maxVolumeLevel:l,result:I};N.info("[track-".concat(i.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(j))),n.onSuccess(j),m(I)}},200)})},checkVideoTrackIsActive:async function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const n=qe.reportApiInvoke(null,{tag:Bn.TRACER,name:br.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[e]});if(!(i instanceof At||i instanceof ll)){const y=new le(z.INVALID_TRACK,"the parameter is not a video track");return n.onError(y),y.throw()}e&&e<1e3&&(e=1e3);const s=i instanceof At?i.getTrackLabel():"remote_track",a=i.getMediaStreamTrack(!0),l=document.createElement("video");l.style.width="1px",l.style.height="1px",l.setAttribute("muted",""),l.muted=!0,l.setAttribute("playsinline",""),l.controls=!1,(vi()||Ab())&&(l.style.opacity="0.01",l.style.position="fixed",l.style.left="0",l.style.top="0",document.body.appendChild(l)),l.srcObject=new MediaStream([a]),l.play();const u=document.createElement("canvas");u.width=160,u.height=120;let p=0,m=0;try{const y=Date.now();p=await function(C,I,j,P){let U,q=0,J=null;return new pe((se,he)=>{function ae(){q>P&&U&&(U(),se(q));const de=j.getContext("2d");if(!de){const Oe=new le(z.UNEXPECTED_ERROR,"can not get canvas 2d context.");return N.error(Oe.toString()),void he(Oe)}de.drawImage(C,0,0,160,120);const me=de.getImageData(0,0,j.width,j.height),ge=Math.floor(me.data.length/3);if(J){for(let Oe=0;Oe<ge;Oe+=3)if(me.data[Oe]!==J[Oe])return q+=1,void(J=me.data);J=me.data}else J=me.data}setTimeout(()=>{U&&(U(),se(q))},I),U=JN(()=>{ae()},30)})}(l,e,u,4),m=Date.now()-y}catch(y){throw n.onError(y),y}Qce===Zt.SAFARI&&(l.pause(),l.remove()),l.srcObject=null;const g=p>4,E={duration:m,changedPicNum:p,deviceLabel:s,result:g};return N.info("[track-".concat(i.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(E))),n.onSuccess(E),g},setArea:jN,audioElementPlayCenter:Ss,resumeAudioContext:function(){Ss.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(i){tle.processExternalMediaAEC(i)},registerExtensions:function(i){const e=Z("PLUGIN_INFO")||[];i.forEach(n=>{"name"in n&&!je(e).call(e,n.name)&&e.push(n.name);const s=n;s.__registered__=!0,s.logger.hookLog=N.extLog,s.reporter.hookApiInvoke=qe.extApiInvoke,s.parameters&&Object.keys(s.parameters).forEach(a=>{s.parameters[a]=Z(a)})}),SW("PLUGIN_INFO",e)},ChannelMediaRelayError:pu,ChannelMediaRelayEvent:Sc,ChannelMediaRelayState:hs,RemoteStreamFallbackType:zN,RemoteStreamType:HN,ConnectionDisconnectedReason:Dt,AudienceLatencyLevelType:qO,AREAS:$t});return Object.defineProperties(Rr,{onAudioAutoplayFailed:{get:()=>Io.onAudioAutoplayFailed,set:i=>{Io.onAudioAutoplayFailed=i}},onAutoplayFailed:{get:()=>Io.onAutoplayFailed,set:i=>{Io.onAutoplayFailed=i}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>Rr._onSecurityPolicyViolation,set(i){Rr._onSecurityPolicyViolation=i,yW(i)}},__CLIENT_LIST__:{get:()=>Z("SHOW_GLOBAL_CLIENT_LIST")?uu:[]}}),Ro.on(od.CAMERA_DEVICE_CHANGED,i=>{N.info("camera device changed",JSON.stringify(i)),Rr.onCameraChanged&&Rr.onCameraChanged(i),Rr.safeEmit(wa.CAMERA_CHANGED,i)}),Ro.on(od.RECORDING_DEVICE_CHANGED,i=>{N.info("microphone device changed",JSON.stringify(i)),Rr.onMicrophoneChanged&&Rr.onMicrophoneChanged(i),Rr.safeEmit(wa.MICROPHONE_CHANGED,i)}),Ro.on(od.PLAYOUT_DEVICE_CHANGED,i=>{N.debug("playout device changed",JSON.stringify(i)),Rr.onPlaybackDeviceChanged&&Rr.onPlaybackDeviceChanged(i),Rr.safeEmit(wa.PLAYBACK_DEVICE_CHANGED,i)}),Ss.onAutoplayFailed=()=>{N.info("detect audio element autoplay failed"),Io.onAudioAutoplayFailed&&Io.onAudioAutoplayFailed()},cn.on("autoplay-failed",()=>{N.info("detect webaudio autoplay failed"),Io.onAudioAutoplayFailed&&Io.onAudioAutoplayFailed(),Rr.safeEmit(wa.AUTOPLAY_FAILED)}),cn.on(Kr.STATE_CHANGE,(i,e)=>{N.info("audio context state changed: ".concat(e," => ").concat(i)),Rr.onAudioContextStateChanged&&Rr.onAudioContextStateChanged(i,e),Rr.safeEmit(wa.AUDIO_CONTEXT_STATE_CHANGED,i,e)}),Cr.on(Zl.NETWORK_STATE_CHANGE,(i,e)=>{N.info("[network-indicator] network state changed, ".concat(e," => ").concat(i))}),window&&(window.__ARTC__=Rr),Rr})})(nJ);var VNe=nJ.exports;const rJ=Yg(VNe),BNe=wI(T.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"CloseOutlined"),WNe=({user:t})=>{const r=K.useRef();return K.useEffect(()=>(t.videoTrack&&t.videoTrack.play(r.current),()=>{t.videoTrack&&t.videoTrack.stop()}),[t.videoTrack]),T.jsxs("div",{className:"video-player",children:[T.jsx("div",{ref:r,style:{width:"200px",height:"200px"}}),T.jsxs("div",{className:"user-info",children:[" ",T.jsxs("p",{children:["Name: ",t.name]}),T.jsxs("p",{children:["UID: ",t.uid]})]})]})},$Ne="a4a08025b4c2430e8c2028952579050c",GNe="007eJxTYOh5YPDE/uLqHpbj4kz8mh2J81mOzOW3tZm3y/mEs+KCTRcUGBJNEg0sDIxMk0ySjUyMDVItko0MjCwsTY1MzS0NTA2SryV4pDUEMjIEOmcyMjJAIIjPwVCWmVqSnJFYwsAAABwnHiw=",HNe="vietchat",gd=rJ.createClient({mode:"rtc",codec:"vp8"}),iJ=({handleClose:t,id:r,name:o})=>{const[c,d]=K.useState([]),[h,f]=K.useState([]),_=async(b,A)=>{if(await gd.subscribe(b,A),A==="video"){const w=c.find(x=>x.uid===b.uid);w&&(w.name=b.name),d(x=>[...x,b])}},v=b=>{d(A=>A.filter(w=>w.uid!==b.uid))};return K.useEffect(()=>((async()=>{gd.on("user-published",_),gd.on("user-left",v);const A=await gd.join($Ne,HNe,GNe,null),[w,x]=await rJ.createMicrophoneAndCameraTracks();f([w,x]),d(M=>[...M,{uid:A,name:o,id:r,videoTrack:x,audioTrack:w}]),await gd.publish([w,x])})(),()=>{(async()=>{for(let w of h)w.stop(),w.close();gd.off("user-published",_),gd.off("user-left",v),h.length>0&&(await gd.unpublish(h),await gd.leave())})()}),[h]),T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"body fixed w-[50%] h-[80%] top-0 mt-[7%] bg-[#00665] !z-50 flex",children:T.jsxs("div",{className:"main bg-[#00665] text-white",children:[T.jsxs("div",{className:"flex justify-between",children:[T.jsx("h1",{id:"site-title",children:"Viet Chat"}),T.jsx("div",{onClick:t,children:T.jsx(rNe,{icon:BNe})})]}),T.jsx("div",{style:{display:"flex",justifyContent:"center"},children:T.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 200px)"},children:c.map(b=>T.jsx("div",{className:"gap-2 ",children:T.jsx(WNe,{user:b},b.uid)}))})})]})}),T.jsx("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"})]})};function zNe({searchQuery:t,results:r,navigateToMessage:o}){const c=h=>{var f=h.substring(0,10);return f},d=h=>{o(h)};return T.jsxs("div",{className:"bg-gray-50  h-full border border-black font-semibold",style:{position:"absolute",top:"-2px",left:"64px",width:"347px",maxHeight:"1000px",overflowY:"scroll"},children:[T.jsx("div",{className:"py-2 px-2",children:T.jsx("h3",{children:"Kết quả tìm kiếm"})}),t&&r.length>0?r.map((h,f)=>{var _;return T.jsxs("div",{className:"grid grid-cols-3 bg-white p-3 mt-5 hover:bg-gray-200 cursor-pointer",onClick:()=>d(h.messageId),children:[T.jsx(pi,{sx:{width:35,height:35},src:(_=h.sender)==null?void 0:_.thumbnailAvatar,alt:"",className:"w-20 h-20 rounded-full border-2 border-white",tyle:{position:"absolute",top:"-20px",left:"15px"}}),T.jsxs("div",{style:{width:"200px"},children:[T.jsxs("p",{className:"mt-4 ",style:{marginLeft:"-60px",marginTop:"-5px"},children:[h.sender.firstName," ",h.sender.lastName]}),T.jsx("p",{className:"mt-4 text-sm truncate font-normal",style:{marginLeft:"-60px",marginTop:"-1px"},children:h.content})]}),T.jsx("p",{className:"text-sm font-normal",style:{marginTop:"-5px",marginLeft:"40px",fontSize:"12px"},children:c(h.createdAt)})]},f)}):T.jsx("p",{className:"p-3 text-gray-500",children:"Không có kết quả tìm kiếm"})]})}const KNe=Rt(BSe)(({theme:t})=>({"& .MuiBadge-badge":{backgroundColor:"#44b700",color:"#44b700",boxShadow:`0 0 0 2px ${t.palette.background.paper}`,"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}})),jH=()=>{Os();const[t,r]=K.useState(""),[o,c]=K.useState(""),[d,h]=K.useState(""),[f,_]=K.useState(""),[v,b]=K.useState(""),[A,w]=K.useState([]);K.useState(!1);const[x,M]=K.useState(!1);qs({token:o,setToken:c,setProfile:_,setPhone:h});const[V,G]=K.useState([]);let H=new y0,F=new MNe;const{chatId:B,chat:L,setChat:X}=K.useContext(Wc),ee=yh({queryKey:["chat",L==null?void 0:L.id],queryFn:async()=>H.getMessages(o,B).then(rt=>{if(rt.data)return G(rt.data.content),rt.data.content}).catch(rt=>{console.error(rt)}),enabled:(L==null?void 0:L.id)!==""&&(L==null?void 0:L.id)!==void 0&&o!==""&&o!==void 0&&(L==null?void 0:L.id)!==null&&(L==null?void 0:L.id)!=="null"}),[ce,ie]=K.useState(""),ne=async(rt,_n)=>{if(console.log("mes",_n),console.log("file",rt),!rt)return null;const Kn={filename:rt.name,type:"MESSAGE"};await F.file(o,Kn).then(async En=>{if((await Gn.put(En.data,rt).catch(fr=>console.log(fr))).status===200){const fr=En.data.substring(0,En.data.indexOf("?"));ie(fr),dH(L,{sender:f==null?void 0:f.id,content:_n,attachments:[{type:"IMAGE",url:fr,filename:fr.split("/")[fr.split("/").length-1]}]},G,o)}}).catch(En=>{console.log(En),St({title:"Eror",icon:"error"})})};console.log("toklennnnn",o);async function fe(rt,_n){console.log("file",_n),f!=null&&f.id&&(L!=null&&L.id)&&!_n&&rt?dH(L,{sender:f==null?void 0:f.id,content:rt},G,o):_n&&await ne(_n,rt)}const oe=rt=>{const _n=rt.target.value.toLowerCase();b(_n),M(_n.length>0);const Kn=V.filter(En=>En.content.toLowerCase().includes(_n));w(Kn),console.log(Kn)},[ue,Ne]=K.useState(!1),Ee=()=>{Ne(!ue),M(!0)},[we,Re]=K.useState(!1),Pe=()=>{Re(!0)},[$e,Ce]=K.useState(!1),Fe=()=>{Ce(!0)},Ye=()=>{M(!1),Ne(!1),b("")};let Mt=new XI;const[yt,Xt]=K.useState([]),Ue=yh({queryKey:["members"],queryFn:()=>Mt.getMembers(o,L==null?void 0:L.groupId).then(rt=>{if(rt!=null&&rt.data)return Xt(rt.data.map(_n=>_n.profile)),rt==null?void 0:rt.data}).catch(rt=>{console.error(rt)}),enabled:o!==void 0&&(L==null?void 0:L.groupId)!==void 0&&yt.length<=0&&we});K.useEffect(()=>{L!=null&&L.id&&Ue.refetch()},[L]);const[Be,at]=K.useState("");K.useEffect(()=>{var rt,_n;if(yt){const Kn=(rt=Ue==null?void 0:Ue.data)==null?void 0:rt.find(En=>En.role==="GROUP_LEADER");console.log("groupLeader ",Kn),Kn&&at((_n=Kn==null?void 0:Kn.profile)==null?void 0:_n.id)}},[yt]);const[Jt,un]=K.useState(""),Ut=K.useRef(null),Gr=()=>{const rt=(f==null?void 0:f.firstName)+" "+(f==null?void 0:f.lastName);un(rt)},sn=rt=>{const _n=hn.current[rt];_n&&_n.scrollIntoView({behavior:"smooth"})},hn=K.useRef({}),[Ht,on]=K.useState([]);return yh({queryKey:["members"],queryFn:()=>{o!==void 0&&(L==null?void 0:L.groupId)!==void 0&&Mt.getMembers(o,L==null?void 0:L.groupId).then(rt=>{if(rt!=null&&rt.data)return on(rt.data.map(_n=>_n.profile)),rt==null?void 0:rt.data}).catch(rt=>{console.error(rt)})}}),K.useEffect(()=>{},[V]),T.jsxs("div",{className:"h-screen w-full",children:[T.jsx("div",{className:"h-[68px] w-full px-4",children:T.jsxs("div",{className:"flex h-full w-full flex-row items-center justify-between",children:[T.jsxs("div",{className:"flex flex-row items-center gap-x-2",children:[T.jsx("div",{className:"hidden lg:block",children:T.jsx(KNe,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:T.jsx(pi,{sx:{width:40,height:40},alt:"",src:L==null?void 0:L.avatar,className:"m-4"})})}),T.jsxs("div",{className:"flex flex-col",children:[T.jsx("div",{className:" text-lg font-medium text-[#081c36]",children:T.jsx("span",{children:L?`${L==null?void 0:L.name}`:T.jsx(Ju,{variant:"text",width:150})})}),T.jsxs("div",{className:"flex items-center text-sm text-[#7589a3]",children:[L!=null&&L.isGroup?T.jsx("button",{onClick:()=>Fe(),children:"thành viên"}):T.jsx("span",{children:"Vừa truy cập"}),T.jsx(FNe,{showMember:$e,setShowMember:Ce,member:Ht,setMember:on,idLead:Be,setIdLead:at,groupId:L==null?void 0:L.groupId}),T.jsx("span",{className:"text-[#D7DBE0]",children:"  | "}),T.jsx("span",{className:"flex items-center justify-center",children:T.jsx("img",{className:"mt-[1px] h-[10px]",src:"/src/assets/tag.png",alt:""})})]})]})]}),T.jsxs("div",{className:"flex flex-row items-center",children:[(L==null?void 0:L.isGroup)&&T.jsx("a",{onClick:()=>Pe(),className:" cursor-pointer hover:bg-gray-200",children:T.jsx("img",{src:"/src/assets/group-user-plus.png",alt:""})}),(L==null?void 0:L.groupId)&&T.jsx(jNe,{members:Ht,setMembers:on,groupId:L==null?void 0:L.groupId,querychat:ee,showAddGroup:we,setShowAddGroup:Re}),T.jsx("a",{onClick:()=>Ee(),className:"p-2 cursor-pointer",children:T.jsx("img",{src:"/src/assets/mini-search.png",alt:"",className:"m-1 h-4 w-4"})}),ue&&T.jsx("div",{className:"bg-white absolute z-50 right-20 mt-40 w-64 py-2 border border-gray-200 shadow-2xl",style:{display:"none;"},children:T.jsx("div",{className:"py-2 border-b w-full",children:T.jsxs("div",{className:"flex w-full",children:[T.jsx("div",{className:"text-gray-700 text-xs px-6 uppercase mb-1 w-full",children:T.jsx("input",{type:"text",className:"w-full h-full bg-gray-200 focus:outline-none px-4 py-2 border-none rounded-full",value:v,onChange:oe,placeholder:"Tìm ..."})}),T.jsx("div",{style:{marginRight:"5px",marginTop:"3px"},children:T.jsx("button",{className:"bg-white hover:bg-gray-100 text-gray-800 font-semibold py-1 px-4 rounded text-xs",onClick:Ye,children:"Đóng"})}),T.jsx("div",{style:{marginRight:"5px",marginTop:"3px"},children:T.jsx("button",{className:"bg-white hover:bg-gray-100 text-gray-800 font-semibold py-1 px-4 rounded text-xs",onClick:Ye,children:"Đóng"})})]})})}),T.jsx("a",{onClick:()=>Gr(),className:"p-2 cursor-pointer hover:bg-gray-200",children:T.jsx("img",{src:"/src/assets/video.png",alt:"",className:"m-1 h-5 w-5"})}),T.jsx("a",{href:"",className:"p-2",children:T.jsx("img",{src:"/src/assets/right-bar.png",alt:"",className:"m-1 h-4 w-4"})})]})]})}),T.jsx("div",{className:"h-[calc(100vh-174px)] w-full flex-1 overflow-auto bg-[#A4BEEB] p-4 pr-3",children:V==null?void 0:V.map(rt=>T.jsx(uAe,{searchQuery:v,setChats:G,mesref:hn,message:rt,chatId:L==null?void 0:L.id,querychat:ee,isGroup:L==null?void 0:L.isGroup},rt.id))}),T.jsx("div",{className:" bg-white"}),T.jsx("div",{className:"h-16",children:T.jsx(LNe,{onSendMessage:fe})}),Jt!==""&&Jt!==null&&T.jsx(iJ,{videoRef:Ut,id:t,name:(f==null?void 0:f.firstName)+" "+(f==null?void 0:f.lastName),handleClose:()=>un("")}),x&&T.jsx(zNe,{searchQuery:v,results:A,onClose:()=>M(!1),navigateToMessage:sn})]})};function YNe({component:t}){const[r,o]=K.useState(window.innerWidth);return K.useLayoutEffect(()=>{const c=()=>{o(window.innerWidth)};return window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[]),T.jsx("div",{className:"flex h-screen w-full overflow-hidden",children:T.jsxs("div",{className:"flex h-screen w-full ",children:[T.jsx(xNe,{}),T.jsxs("div",{className:"flex h-screen w-full grid-flow-col ",children:[T.jsx("div",{className:"ml-16 w-full max-w-fit flex-1 md:w-[345px] border-r",children:T.jsx("div",{className:"flex-1 text-gray-500 ",children:T.jsx(sM,{})})}),T.jsx("div",{className:"hidden w-full overflow-hidden md:flex ",children:T.jsx("div",{className:"h-fit w-max flex-1",children:t})})]})]})})}function qNe(){return T.jsx("div",{children:T.jsx(sM,{})})}function XNe(t,r){return`${t}${r}`}const FH="/",JNe={root:FH,general:{app:XNe(FH,"app")}},QNe=JNe.general.app;var PU={},ZNe=qM;Object.defineProperty(PU,"__esModule",{value:!0});var sJ=PU.default=void 0,eke=ZNe(DNe()),tke=T;sJ=PU.default=(0,eke.default)((0,tke.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");function nke(){const[t,r]=K.useState({}),o=yh({queryKey:["getUser"]});return K.useEffect(()=>{var c;(c=o.data)!=null&&c.firstName&&(r(o.data),o.refetch())},[t]),T.jsxs("div",{className:"flex h-[74px] w-full items-center pr-2 pr-1",children:[T.jsx("img",{src:"https://s120-ava-talk.zadn.vn/2/5/a/5/6/120/5ded83a5856f6d2af9fce6eac4b8d6d2.jpg",alt:"avatar",className:"aspect-w-1 aspect-h-1 h-12 w-12 rounded-full object-cover"}),T.jsxs("div",{className:"flex grow justify-between pl-3 md:w-[342px]",id:"content",children:[T.jsx("div",{className:"",children:T.jsx(T.Fragment,{children:T.jsxs("div",{className:"grid gap-y-1",children:[T.jsx("div",{children:T.jsx("span",{className:"text-base font-semibold text-[#081C36]",children:"Trần Quang Huy"})}),T.jsx("div",{className:"transition-min-width flex min-w-[calc(100vw-200px)] items-center text-sm font-medium text-[#081C36] duration-200  md:min-w-full",children:T.jsx("span",{className:"overflow-hidden truncate overflow-ellipsis whitespace-nowrap md:w-[175px]",children:"Xin Chào"})})]})})}),T.jsxs("div",{className:"mt-[-4px] grid gap-y-1 ",children:[T.jsx("div",{children:T.jsx("span",{className:"truncate text-xs",children:"1"})}),T.jsx(T.Fragment,{children:T.jsx("div",{className:"flex h-4 w-4 flex-grow items-center justify-center place-self-end rounded-full bg-[#C81A1F] text-white",children:T.jsx("span",{className:"text-xs",children:"1"})})})]})]})]})}const VH=[{name:"Afghanistan",flag:"🇦🇫",code:"AF",dial_code:"+93"},{name:"Åland Islands",flag:"🇦🇽",code:"AX",dial_code:"+358"},{name:"Albania",flag:"🇦🇱",code:"AL",dial_code:"+355"},{name:"Algeria",flag:"🇩🇿",code:"DZ",dial_code:"+213"},{name:"American Samoa",flag:"🇦🇸",code:"AS",dial_code:"+1684"},{name:"Andorra",flag:"🇦🇩",code:"AD",dial_code:"+376"},{name:"Angola",flag:"🇦🇴",code:"AO",dial_code:"+244"},{name:"Anguilla",flag:"🇦🇮",code:"AI",dial_code:"+1264"},{name:"Antarctica",flag:"🇦🇶",code:"AQ",dial_code:"+672"},{name:"Antigua and Barbuda",flag:"🇦🇬",code:"AG",dial_code:"+1268"},{name:"Argentina",flag:"🇦🇷",code:"AR",dial_code:"+54"},{name:"Armenia",flag:"🇦🇲",code:"AM",dial_code:"+374"},{name:"Aruba",flag:"🇦🇼",code:"AW",dial_code:"+297"},{name:"Australia",flag:"🇦🇺",code:"AU",dial_code:"+61"},{name:"Austria",flag:"🇦🇹",code:"AT",dial_code:"+43"},{name:"Azerbaijan",flag:"🇦🇿",code:"AZ",dial_code:"+994"},{name:"Bahamas",flag:"🇧🇸",code:"BS",dial_code:"+1242"},{name:"Bahrain",flag:"🇧🇭",code:"BH",dial_code:"+973"},{name:"Bangladesh",flag:"🇧🇩",code:"BD",dial_code:"+880"},{name:"Barbados",flag:"🇧🇧",code:"BB",dial_code:"+1246"},{name:"Belarus",flag:"🇧🇾",code:"BY",dial_code:"+375"},{name:"Belgium",flag:"🇧🇪",code:"BE",dial_code:"+32"},{name:"Belize",flag:"🇧🇿",code:"BZ",dial_code:"+501"},{name:"Benin",flag:"🇧🇯",code:"BJ",dial_code:"+229"},{name:"Bermuda",flag:"🇧🇲",code:"BM",dial_code:"+1441"},{name:"Bhutan",flag:"🇧🇹",code:"BT",dial_code:"+975"},{name:"Bolivia, Plurinational State of bolivia",flag:"🇧🇴",code:"BO",dial_code:"+591"},{name:"Bosnia and Herzegovina",flag:"🇧🇦",code:"BA",dial_code:"+387"},{name:"Botswana",flag:"🇧🇼",code:"BW",dial_code:"+267"},{name:"Bouvet Island",flag:"🇧🇻",code:"BV",dial_code:"+47"},{name:"Brazil",flag:"🇧🇷",code:"BR",dial_code:"+55"},{name:"British Indian Ocean Territory",flag:"🇮🇴",code:"IO",dial_code:"+246"},{name:"Brunei Darussalam",flag:"🇧🇳",code:"BN",dial_code:"+673"},{name:"Bulgaria",flag:"🇧🇬",code:"BG",dial_code:"+359"},{name:"Burkina Faso",flag:"🇧🇫",code:"BF",dial_code:"+226"},{name:"Burundi",flag:"🇧🇮",code:"BI",dial_code:"+257"},{name:"Cambodia",flag:"🇰🇭",code:"KH",dial_code:"+855"},{name:"Cameroon",flag:"🇨🇲",code:"CM",dial_code:"+237"},{name:"Canada",flag:"🇨🇦",code:"CA",dial_code:"+1"},{name:"Cape Verde",flag:"🇨🇻",code:"CV",dial_code:"+238"},{name:"Cayman Islands",flag:"🇰🇾",code:"KY",dial_code:"+345"},{name:"Central African Republic",flag:"🇨🇫",code:"CF",dial_code:"+236"},{name:"Chad",flag:"🇹🇩",code:"TD",dial_code:"+235"},{name:"Chile",flag:"🇨🇱",code:"CL",dial_code:"+56"},{name:"China",flag:"🇨🇳",code:"CN",dial_code:"+86"},{name:"Christmas Island",flag:"🇨🇽",code:"CX",dial_code:"+61"},{name:"Cocos (Keeling) Islands",flag:"🇨🇨",code:"CC",dial_code:"+61"},{name:"Colombia",flag:"🇨🇴",code:"CO",dial_code:"+57"},{name:"Comoros",flag:"🇰🇲",code:"KM",dial_code:"+269"},{name:"Congo",flag:"🇨🇬",code:"CG",dial_code:"+242"},{name:"Congo, The Democratic Republic of the Congo",flag:"🇨🇩",code:"CD",dial_code:"+243"},{name:"Cook Islands",flag:"🇨🇰",code:"CK",dial_code:"+682"},{name:"Costa Rica",flag:"🇨🇷",code:"CR",dial_code:"+506"},{name:"Cote d'Ivoire",flag:"🇨🇮",code:"CI",dial_code:"+225"},{name:"Croatia",flag:"🇭🇷",code:"HR",dial_code:"+385"},{name:"Cuba",flag:"🇨🇺",code:"CU",dial_code:"+53"},{name:"Cyprus",flag:"🇨🇾",code:"CY",dial_code:"+357"},{name:"Czech Republic",flag:"🇨🇿",code:"CZ",dial_code:"+420"},{name:"Denmark",flag:"🇩🇰",code:"DK",dial_code:"+45"},{name:"Djibouti",flag:"🇩🇯",code:"DJ",dial_code:"+253"},{name:"Dominica",flag:"🇩🇲",code:"DM",dial_code:"+1767"},{name:"Dominican Republic",flag:"🇩🇴",code:"DO",dial_code:"+1849"},{name:"Ecuador",flag:"🇪🇨",code:"EC",dial_code:"+593"},{name:"Egypt",flag:"🇪🇬",code:"EG",dial_code:"+20"},{name:"El Salvador",flag:"🇸🇻",code:"SV",dial_code:"+503"},{name:"Equatorial Guinea",flag:"🇬🇶",code:"GQ",dial_code:"+240"},{name:"Eritrea",flag:"🇪🇷",code:"ER",dial_code:"+291"},{name:"Estonia",flag:"🇪🇪",code:"EE",dial_code:"+372"},{name:"Ethiopia",flag:"🇪🇹",code:"ET",dial_code:"+251"},{name:"Falkland Islands (Malvinas)",flag:"🇫🇰",code:"FK",dial_code:"+500"},{name:"Faroe Islands",flag:"🇫🇴",code:"FO",dial_code:"+298"},{name:"Fiji",flag:"🇫🇯",code:"FJ",dial_code:"+679"},{name:"Finland",flag:"🇫🇮",code:"FI",dial_code:"+358"},{name:"France",flag:"🇫🇷",code:"FR",dial_code:"+33"},{name:"French Guiana",flag:"🇬🇫",code:"GF",dial_code:"+594"},{name:"French Polynesia",flag:"🇵🇫",code:"PF",dial_code:"+689"},{name:"French Southern Territories",flag:"🇹🇫",code:"TF",dial_code:"+262"},{name:"Gabon",flag:"🇬🇦",code:"GA",dial_code:"+241"},{name:"Gambia",flag:"🇬🇲",code:"GM",dial_code:"+220"},{name:"Georgia",flag:"🇬🇪",code:"GE",dial_code:"+995"},{name:"Germany",flag:"🇩🇪",code:"DE",dial_code:"+49"},{name:"Ghana",flag:"🇬🇭",code:"GH",dial_code:"+233"},{name:"Gibraltar",flag:"🇬🇮",code:"GI",dial_code:"+350"},{name:"Greece",flag:"🇬🇷",code:"GR",dial_code:"+30"},{name:"Greenland",flag:"🇬🇱",code:"GL",dial_code:"+299"},{name:"Grenada",flag:"🇬🇩",code:"GD",dial_code:"+1473"},{name:"Guadeloupe",flag:"🇬🇵",code:"GP",dial_code:"+590"},{name:"Guam",flag:"🇬🇺",code:"GU",dial_code:"+1671"},{name:"Guatemala",flag:"🇬🇹",code:"GT",dial_code:"+502"},{name:"Guernsey",flag:"🇬🇬",code:"GG",dial_code:"+44"},{name:"Guinea",flag:"🇬🇳",code:"GN",dial_code:"+224"},{name:"Guinea-Bissau",flag:"🇬🇼",code:"GW",dial_code:"+245"},{name:"Guyana",flag:"🇬🇾",code:"GY",dial_code:"+592"},{name:"Haiti",flag:"🇭🇹",code:"HT",dial_code:"+509"},{name:"Heard Island and Mcdonald Islands",flag:"🇭🇲",code:"HM",dial_code:"+672"},{name:"Holy See (Vatican City State)",flag:"🇻🇦",code:"VA",dial_code:"+379"},{name:"Honduras",flag:"🇭🇳",code:"HN",dial_code:"+504"},{name:"Hong Kong",flag:"🇭🇰",code:"HK",dial_code:"+852"},{name:"Hungary",flag:"🇭🇺",code:"HU",dial_code:"+36"},{name:"Iceland",flag:"🇮🇸",code:"IS",dial_code:"+354"},{name:"India",flag:"🇮🇳",code:"IN",dial_code:"+91"},{name:"Indonesia",flag:"🇮🇩",code:"ID",dial_code:"+62"},{name:"Iran, Islamic Republic of Persian Gulf",flag:"🇮🇷",code:"IR",dial_code:"+98"},{name:"Iraq",flag:"🇮🇶",code:"IQ",dial_code:"+964"},{name:"Ireland",flag:"🇮🇪",code:"IE",dial_code:"+353"},{name:"Isle of Man",flag:"🇮🇲",code:"IM",dial_code:"+44"},{name:"Israel",flag:"🇮🇱",code:"IL",dial_code:"+972"},{name:"Italy",flag:"🇮🇹",code:"IT",dial_code:"+39"},{name:"Jamaica",flag:"🇯🇲",code:"JM",dial_code:"+1876"},{name:"Japan",flag:"🇯🇵",code:"JP",dial_code:"+81"},{name:"Jersey",flag:"🇯🇪",code:"JE",dial_code:"+44"},{name:"Jordan",flag:"🇯🇴",code:"JO",dial_code:"+962"},{name:"Kazakhstan",flag:"🇰🇿",code:"KZ",dial_code:"+7"},{name:"Kenya",flag:"🇰🇪",code:"KE",dial_code:"+254"},{name:"Kiribati",flag:"🇰🇮",code:"KI",dial_code:"+686"},{name:"Korea, Democratic People's Republic of Korea",flag:"🇰🇵",code:"KP",dial_code:"+850"},{name:"Korea, Republic of South Korea",flag:"🇰🇷",code:"KR",dial_code:"+82"},{name:"Kosovo",flag:"🇽🇰",code:"XK",dial_code:"+383"},{name:"Kuwait",flag:"🇰🇼",code:"KW",dial_code:"+965"},{name:"Kyrgyzstan",flag:"🇰🇬",code:"KG",dial_code:"+996"},{name:"Laos",flag:"🇱🇦",code:"LA",dial_code:"+856"},{name:"Latvia",flag:"🇱🇻",code:"LV",dial_code:"+371"},{name:"Lebanon",flag:"🇱🇧",code:"LB",dial_code:"+961"},{name:"Lesotho",flag:"🇱🇸",code:"LS",dial_code:"+266"},{name:"Liberia",flag:"🇱🇷",code:"LR",dial_code:"+231"},{name:"Libyan Arab Jamahiriya",flag:"🇱🇾",code:"LY",dial_code:"+218"},{name:"Liechtenstein",flag:"🇱🇮",code:"LI",dial_code:"+423"},{name:"Lithuania",flag:"🇱🇹",code:"LT",dial_code:"+370"},{name:"Luxembourg",flag:"🇱🇺",code:"LU",dial_code:"+352"},{name:"Macao",flag:"🇲🇴",code:"MO",dial_code:"+853"},{name:"Macedonia",flag:"🇲🇰",code:"MK",dial_code:"+389"},{name:"Madagascar",flag:"🇲🇬",code:"MG",dial_code:"+261"},{name:"Malawi",flag:"🇲🇼",code:"MW",dial_code:"+265"},{name:"Malaysia",flag:"🇲🇾",code:"MY",dial_code:"+60"},{name:"Maldives",flag:"🇲🇻",code:"MV",dial_code:"+960"},{name:"Mali",flag:"🇲🇱",code:"ML",dial_code:"+223"},{name:"Malta",flag:"🇲🇹",code:"MT",dial_code:"+356"},{name:"Marshall Islands",flag:"🇲🇭",code:"MH",dial_code:"+692"},{name:"Martinique",flag:"🇲🇶",code:"MQ",dial_code:"+596"},{name:"Mauritania",flag:"🇲🇷",code:"MR",dial_code:"+222"},{name:"Mauritius",flag:"🇲🇺",code:"MU",dial_code:"+230"},{name:"Mayotte",flag:"🇾🇹",code:"YT",dial_code:"+262"},{name:"Mexico",flag:"🇲🇽",code:"MX",dial_code:"+52"},{name:"Micronesia, Federated States of Micronesia",flag:"🇫🇲",code:"FM",dial_code:"+691"},{name:"Moldova",flag:"🇲🇩",code:"MD",dial_code:"+373"},{name:"Monaco",flag:"🇲🇨",code:"MC",dial_code:"+377"},{name:"Mongolia",flag:"🇲🇳",code:"MN",dial_code:"+976"},{name:"Montenegro",flag:"🇲🇪",code:"ME",dial_code:"+382"},{name:"Montserrat",flag:"🇲🇸",code:"MS",dial_code:"+1664"},{name:"Morocco",flag:"🇲🇦",code:"MA",dial_code:"+212"},{name:"Mozambique",flag:"🇲🇿",code:"MZ",dial_code:"+258"},{name:"Myanmar",flag:"🇲🇲",code:"MM",dial_code:"+95"},{name:"Namibia",flag:"🇳🇦",code:"NA",dial_code:"+264"},{name:"Nauru",flag:"🇳🇷",code:"NR",dial_code:"+674"},{name:"Nepal",flag:"🇳🇵",code:"NP",dial_code:"+977"},{name:"Netherlands",flag:"🇳🇱",code:"NL",dial_code:"+31"},{name:"Netherlands Antilles",flag:"",code:"AN",dial_code:"+599"},{name:"New Caledonia",flag:"🇳🇨",code:"NC",dial_code:"+687"},{name:"New Zealand",flag:"🇳🇿",code:"NZ",dial_code:"+64"},{name:"Nicaragua",flag:"🇳🇮",code:"NI",dial_code:"+505"},{name:"Niger",flag:"🇳🇪",code:"NE",dial_code:"+227"},{name:"Nigeria",flag:"🇳🇬",code:"NG",dial_code:"+234"},{name:"Niue",flag:"🇳🇺",code:"NU",dial_code:"+683"},{name:"Norfolk Island",flag:"🇳🇫",code:"NF",dial_code:"+672"},{name:"Northern Mariana Islands",flag:"🇲🇵",code:"MP",dial_code:"+1670"},{name:"Norway",flag:"🇳🇴",code:"NO",dial_code:"+47"},{name:"Oman",flag:"🇴🇲",code:"OM",dial_code:"+968"},{name:"Pakistan",flag:"🇵🇰",code:"PK",dial_code:"+92"},{name:"Palau",flag:"🇵🇼",code:"PW",dial_code:"+680"},{name:"Palestinian Territory, Occupied",flag:"🇵🇸",code:"PS",dial_code:"+970"},{name:"Panama",flag:"🇵🇦",code:"PA",dial_code:"+507"},{name:"Papua New Guinea",flag:"🇵🇬",code:"PG",dial_code:"+675"},{name:"Paraguay",flag:"🇵🇾",code:"PY",dial_code:"+595"},{name:"Peru",flag:"🇵🇪",code:"PE",dial_code:"+51"},{name:"Philippines",flag:"🇵🇭",code:"PH",dial_code:"+63"},{name:"Pitcairn",flag:"🇵🇳",code:"PN",dial_code:"+64"},{name:"Poland",flag:"🇵🇱",code:"PL",dial_code:"+48"},{name:"Portugal",flag:"🇵🇹",code:"PT",dial_code:"+351"},{name:"Puerto Rico",flag:"🇵🇷",code:"PR",dial_code:"+1939"},{name:"Qatar",flag:"🇶🇦",code:"QA",dial_code:"+974"},{name:"Romania",flag:"🇷🇴",code:"RO",dial_code:"+40"},{name:"Russia",flag:"🇷🇺",code:"RU",dial_code:"+7"},{name:"Rwanda",flag:"🇷🇼",code:"RW",dial_code:"+250"},{name:"Reunion",flag:"🇷🇪",code:"RE",dial_code:"+262"},{name:"Saint Barthelemy",flag:"🇧🇱",code:"BL",dial_code:"+590"},{name:"Saint Helena, Ascension and Tristan Da Cunha",flag:"🇸🇭",code:"SH",dial_code:"+290"},{name:"Saint Kitts and Nevis",flag:"🇰🇳",code:"KN",dial_code:"+1869"},{name:"Saint Lucia",flag:"🇱🇨",code:"LC",dial_code:"+1758"},{name:"Saint Martin",flag:"🇲🇫",code:"MF",dial_code:"+590"},{name:"Saint Pierre and Miquelon",flag:"🇵🇲",code:"PM",dial_code:"+508"},{name:"Saint Vincent and the Grenadines",flag:"🇻🇨",code:"VC",dial_code:"+1784"},{name:"Samoa",flag:"🇼🇸",code:"WS",dial_code:"+685"},{name:"San Marino",flag:"🇸🇲",code:"SM",dial_code:"+378"},{name:"Sao Tome and Principe",flag:"🇸🇹",code:"ST",dial_code:"+239"},{name:"Saudi Arabia",flag:"🇸🇦",code:"SA",dial_code:"+966"},{name:"Senegal",flag:"🇸🇳",code:"SN",dial_code:"+221"},{name:"Serbia",flag:"🇷🇸",code:"RS",dial_code:"+381"},{name:"Seychelles",flag:"🇸🇨",code:"SC",dial_code:"+248"},{name:"Sierra Leone",flag:"🇸🇱",code:"SL",dial_code:"+232"},{name:"Singapore",flag:"🇸🇬",code:"SG",dial_code:"+65"},{name:"Slovakia",flag:"🇸🇰",code:"SK",dial_code:"+421"},{name:"Slovenia",flag:"🇸🇮",code:"SI",dial_code:"+386"},{name:"Solomon Islands",flag:"🇸🇧",code:"SB",dial_code:"+677"},{name:"Somalia",flag:"🇸🇴",code:"SO",dial_code:"+252"},{name:"South Africa",flag:"🇿🇦",code:"ZA",dial_code:"+27"},{name:"South Sudan",flag:"🇸🇸",code:"SS",dial_code:"+211"},{name:"South Georgia and the South Sandwich Islands",flag:"🇬🇸",code:"GS",dial_code:"+500"},{name:"Spain",flag:"🇪🇸",code:"ES",dial_code:"+34"},{name:"Sri Lanka",flag:"🇱🇰",code:"LK",dial_code:"+94"},{name:"Sudan",flag:"🇸🇩",code:"SD",dial_code:"+249"},{name:"Suriname",flag:"🇸🇷",code:"SR",dial_code:"+597"},{name:"Svalbard and Jan Mayen",flag:"🇸🇯",code:"SJ",dial_code:"+47"},{name:"Swaziland",flag:"🇸🇿",code:"SZ",dial_code:"+268"},{name:"Sweden",flag:"🇸🇪",code:"SE",dial_code:"+46"},{name:"Switzerland",flag:"🇨🇭",code:"CH",dial_code:"+41"},{name:"Syrian Arab Republic",flag:"🇸🇾",code:"SY",dial_code:"+963"},{name:"Taiwan",flag:"🇹🇼",code:"TW",dial_code:"+886"},{name:"Tajikistan",flag:"🇹🇯",code:"TJ",dial_code:"+992"},{name:"Tanzania, United Republic of Tanzania",flag:"🇹🇿",code:"TZ",dial_code:"+255"},{name:"Thailand",flag:"🇹🇭",code:"TH",dial_code:"+66"},{name:"Timor-Leste",flag:"🇹🇱",code:"TL",dial_code:"+670"},{name:"Togo",flag:"🇹🇬",code:"TG",dial_code:"+228"},{name:"Tokelau",flag:"🇹🇰",code:"TK",dial_code:"+690"},{name:"Tonga",flag:"🇹🇴",code:"TO",dial_code:"+676"},{name:"Trinidad and Tobago",flag:"🇹🇹",code:"TT",dial_code:"+1868"},{name:"Tunisia",flag:"🇹🇳",code:"TN",dial_code:"+216"},{name:"Turkey",flag:"🇹🇷",code:"TR",dial_code:"+90"},{name:"Turkmenistan",flag:"🇹🇲",code:"TM",dial_code:"+993"},{name:"Turks and Caicos Islands",flag:"🇹🇨",code:"TC",dial_code:"+1649"},{name:"Tuvalu",flag:"🇹🇻",code:"TV",dial_code:"+688"},{name:"Uganda",flag:"🇺🇬",code:"UG",dial_code:"+256"},{name:"Ukraine",flag:"🇺🇦",code:"UA",dial_code:"+380"},{name:"United Arab Emirates",flag:"🇦🇪",code:"AE",dial_code:"+971"},{name:"United Kingdom",flag:"🇬🇧",code:"GB",dial_code:"+44"},{name:"United States",flag:"🇺🇸",code:"US",dial_code:"+1"},{name:"Uruguay",flag:"🇺🇾",code:"UY",dial_code:"+598"},{name:"Uzbekistan",flag:"🇺🇿",code:"UZ",dial_code:"+998"},{name:"Vanuatu",flag:"🇻🇺",code:"VU",dial_code:"+678"},{name:"Venezuela, Bolivarian Republic of Venezuela",flag:"🇻🇪",code:"VE",dial_code:"+58"},{name:"Vietnam",flag:"🇻🇳",code:"VN",dial_code:"+84"},{name:"Virgin Islands, British",flag:"🇻🇬",code:"VG",dial_code:"+1284"},{name:"Virgin Islands, U.S.",flag:"🇻🇮",code:"VI",dial_code:"+1340"},{name:"Wallis and Futuna",flag:"🇼🇫",code:"WF",dial_code:"+681"},{name:"Yemen",flag:"🇾🇪",code:"YE",dial_code:"+967"},{name:"Zambia",flag:"🇿🇲",code:"ZM",dial_code:"+260"},{name:"Zimbabwe",flag:"🇿🇼",code:"ZW",dial_code:"+263"}],rke=[{id:1,name:"John Doe",avatar:"/avatars/john.jpg"},{id:2,name:"Jane Smith",avatar:"/avatars/jane.jpg"},{id:3,name:"Bob Johnson",avatar:"/avatars/bob.jpg"}],ike=[{id:4,name:"Alice Brown",avatar:"/avatars/alice.jpg"},{id:5,name:"Charlie Green",avatar:"/avatars/charlie.jpg"},{id:6,name:"David White",avatar:"/avatars/david.jpg"},{id:7,name:"Eva Black",avatar:"/avatars/eva.jpg"}];function ske(){const t=Os(),[r,o]=K.useState(!1),[c,d]=K.useState(""),[h,f]=K.useState(""),[_,v]=K.useState(),[b,A]=K.useState(),[w,x]=K.useState(""),[M,V]=K.useState({name:"Vietnam",flag:"🇻🇳",code:"VN",dial_code:"+84"});qs({token:w,setToken:x,setPhone:A,setProfile:v});const[G,H]=K.useState(rke),[F,B]=K.useState(ike),{sent:L,friend:X}=K.useContext(Wc);K.useState(M);const ee=()=>{o(!0)},ce=()=>{o(!1)};let ie=new dU;const ne=ki({mutationKey:["findFriend"],mutationFn:()=>{ie.findByPhone(h,w).then(Ue=>{Ue.error&&St({title:"Error",icon:"error"}),Ue.data&&Ee.mutate(Ue.data.id)}).catch(Ue=>{var Be,at,Jt,un;St({title:`${(at=(Be=Ue==null?void 0:Ue.response)==null?void 0:Be.data)!=null&&at.detail?(un=(Jt=Ue==null?void 0:Ue.response)==null?void 0:Jt.data)==null?void 0:un.detail:"Error"}`,icon:"error"})})}}),[fe,oe]=K.useState(),[ue,Ne]=K.useState(!1),Ee=ki({mutationKey:["addFriend"],mutationFn:Ue=>{Ue&&w&&(console.log(w),ie.addFriend(w,Ue).then(Be=>{Be.data&&(console.log("add friend data ",Be.data),St({title:"Success",text:"You have pressed the button!",icon:"success"}),t.invalidateQueries(["friendRequest"]))}).catch(Be=>{var at,Jt;console.log(Be),St({title:`${(Jt=(at=Be==null?void 0:Be.response)==null?void 0:at.data)==null?void 0:Jt.detail}`,icon:"error"})}))}}),we=()=>{ie.findByPhone(h.trim(),w).then(Ue=>{var Be;Ue.data&&(oe(Ue.data),Ne(!0),(Be=Ue==null?void 0:Ue.data)!=null&&Be.id&&(console.log("findUser",fe),X==null||X.map(at=>{var Jt,un;((Jt=at==null?void 0:at.profile)==null?void 0:Jt.id)===((un=Ue==null?void 0:Ue.data)==null?void 0:un.id)&&$e(!0)}),L==null||L.map(at=>{var Jt,un;((Jt=at==null?void 0:at.profile)==null?void 0:Jt.id)===((un=Ue==null?void 0:Ue.data)==null?void 0:un.id)&&Fe(!0)})))}).catch(Ue=>{oe(null)})},Re=Ue=>{f(Ue.target.value)},[Pe,$e]=K.useState(!1),[Ce,Fe]=K.useState(!1);K.useEffect(()=>{$e(!1),Fe(!1),we()},[h]);const Ye=()=>{console.log(`Add friend with prefix: ${c}, phone number: ${h}`),ne.mutate(),ce()},Mt=Ue=>{},yt=Ue=>{const Be=Ue.target.value,at=VH.find(Jt=>Jt.code===Be);V(at)},Xt=()=>{Ne(!1)};return T.jsxs(K.Fragment,{children:[T.jsx("button",{onClick:ee,className:"w-9 cursor-pointer hover:bg-gray-200 mx-1 justify-center items-center",children:T.jsx("img",{src:"/src/assets/user-plus.png",alt:"",className:"",style:{width:"100%",height:"100%"}})}),T.jsxs(gbe,{open:r,onClose:ce,children:[T.jsxs("div",{className:"flex items-center justify-between border p-2",children:[T.jsx(Bbe,{sx:{padding:0},children:T.jsx("span",{className:"pl-2 text-base font-bold text-tblack",children:"Thêm bạn"})}),T.jsx(Gv,{onClick:ce,style:{color:"#000000"},children:T.jsx(sJ,{})})]}),T.jsxs(kbe,{className:"p-4",children:[T.jsxs("div",{className:"flex items-center border",children:[T.jsx("div",{className:"w-1/3",children:T.jsx(rq,{size:"small",value:M.code,onChange:yt,renderValue:Ue=>T.jsxs("div",{className:"flex items-center border",children:[T.jsx("span",{className:"text-tblack text-3xl",children:M.flag}),T.jsxs("span",{className:" text-tblack pl-1 text-sm",children:["(",M.dial_code,")"]})]}),inputProps:{"aria-label":"Without label"},children:VH.map(Ue=>T.jsx(Hv,{value:Ue.code,children:T.jsxs("div",{className:"flex  w-full",children:[T.jsx("div",{className:"flex-none",children:T.jsx("span",{children:Ue.flag})}),T.jsx("div",{className:"flex-1",children:T.jsx("span",{children:Ue.name})}),T.jsx("div",{className:"flex justify-end",children:T.jsx("span",{children:Ue.dial_code})})]})},Ue.code))})}),T.jsx("div",{className:"relative w-2/3",children:T.jsx(iq,{required:!0,margin:"dense",id:"phoneNumber",label:"Số điện thoại",type:"tel",fullWidth:!0,value:h,onChange:Ue=>Re(Ue)})}),fe&&ue&&T.jsx("div",{onBlur:Xt,className:"absolute flex justify-center items-center mt-40 top-0 bg-blue-200 p-4 hover:bg-gray-300",children:T.jsxs("div",{className:"flex grow justify-between p-2 md:w-[23rem]",id:"content",children:[T.jsxs("div",{className:"flex",children:[T.jsx(pi,{src:fe==null?void 0:fe.thumbnailAvatar,alt:"avatar",sx:{width:48,height:48},className:"min-w-12"}),T.jsx(T.Fragment,{children:T.jsx("div",{className:"grid gap-y-1 ml-3",children:T.jsx("div",{children:T.jsxs("span",{className:"text-base font-semibold text-[#081C36]",children:[fe==null?void 0:fe.firstName," ",fe==null?void 0:fe.lastName]})})})})]}),Ce&&T.jsx("div",{className:"items-center flex",children:T.jsx("p",{className:"text-sm",children:"chờ phản hồi"})}),!Ce&&!Pe&&T.jsx("div",{className:"",children:T.jsx(Gv,{onClick:Ye,variant:"contained",color:"primary",children:"Add Friend"})})]})})]}),T.jsxs("div",{className:"mt-3",children:[T.jsx(gG,{children:"Recent Searches:"}),T.jsx(nke,{}),T.jsx("ul",{children:G.map((Ue,Be)=>T.jsxs("li",{className:"flex items-center space-x-2 mt-2",children:[T.jsx(pi,{src:Ue.avatar,alt:Ue.name}),T.jsx("span",{children:Ue.name})]},Be))})]}),T.jsxs("div",{className:"mt-3",children:[T.jsx(gG,{children:"Suggested Friends:"}),T.jsx("ul",{children:F.map((Ue,Be)=>T.jsxs("li",{className:"flex justify-between items-center space-x-2 mt-2",children:[T.jsxs("div",{className:"flex space-x-2",children:[T.jsx(pi,{src:Ue.avatar,alt:Ue.name}),T.jsx("span",{children:Ue.name})]}),T.jsx(Gv,{onClick:()=>Mt(),variant:"outlined",children:"Add Friend"})]},Be))})]})]}),T.jsx(bbe,{className:"p-4",children:T.jsx(Gv,{onClick:ce,children:"Cancel"})})]})]})}const oke=({showCreateGroup:t,setShowCreateGroup:r})=>{const o=()=>{r(!1)},[c,d]=K.useState(!1),h=()=>{d(!0)},[f,_]=K.useState(!1),[v,b]=K.useState(""),[A,w]=K.useState(""),[x,M]=K.useState("");qs({token:v,setToken:b,setProfile:M,setPhone:w});const{friend:V,sent:G}=K.useContext(Wc),H=()=>{_(!f)},F=Os(),B=f?"blue-500":"gray-400",[L,X]=K.useState([]),ee=Pe=>{L.includes(Pe)?X(L.filter($e=>$e!==Pe)):X([...L,Pe])},[ce,ie]=K.useState(),[ne,fe]=K.useState(""),[oe,ue]=K.useState(""),Ne="https://res.zaloapp.com/pc/avt_group/6_work.jpg",Ee=()=>{if((oe==null?void 0:oe.trim())===""){St({title:"Tên nhóm không được để trống",icon:"warning"});return}let Pe=[],$e=[];L.forEach(Fe=>{var Ye;Pe.push((Ye=Fe.profile)==null?void 0:Ye.id),$e.push(Fe.displayName)});const Ce={name:oe&&oe!=""?oe:$e.join(", "),thumbnailAvatar:ne!==""&&ne?ne:Ne,members:Pe};Re.mutate(Ce)};let we=new XI;const Re=ki({mutationKey:["createGroup"],mutationFn:Pe=>we.createGroup(v,Pe).then($e=>{if($e.data)return console.log($e.data),r(!1),F.invalidateQueries(["chat"]),$e.data}).catch($e=>{console.error($e)})});return T.jsx(T.Fragment,{children:t&&T.jsx("div",{className:"fixed z-50 bg-black bg-opacity-30 justify-center items-center w-full inset-0 ",children:T.jsx("div",{className:"z-50 p-4 min-w-[30rem] relative rounded pb-3 pt-1 mx-auto my-20 bg-white lg:max-w-[400px] max-w-screen-lg",children:T.jsxs("div",{className:"relative bg-white  rounded-lg dark:bg-gray-700",children:[T.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Tạo nhóm"}),T.jsxs("button",{onClick:()=>o(),className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal",children:[T.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:T.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),T.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),T.jsxs("div",{className:"flex gap-2 mt-2",children:[T.jsx("div",{onClick:()=>h(),className:`${ne?"":"border"} cursor-pointer border-gray-500 p-2 rounded-full flex justify-center items-center`,children:ne?T.jsx(pi,{src:ne,sx:{width:40,height:40}}):T.jsx(Dn,{icon:y9,className:"text-gray-400"})}),c&&T.jsx(UNe,{selectedItems:L,preview:ce,setPreview:ie,setSelectedAvatar:fe,showAvatarGroup:c,setShowAvatarGroup:d}),T.jsx("div",{className:"w-full focus:outline-none flex justify-center items-center",children:T.jsx("input",{value:oe,onChange:Pe=>ue(Pe.target.value),type:"text",placeholder:"Nhập tên nhóm",className:"w-full pl-2 border-b border-gray-200 focus:outline-none focus:border-blue-500"})})]}),T.jsx("div",{className:"mt-5 border-b pb-5",children:T.jsxs("div",{className:`md:flex hidden md:items-center w-full bg-white py-1 px-2 rounded-full border transition-all ${f?"border-blue-500 ":"border-gray-600 "} `,children:[T.jsx("span",{children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-${B}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),T.jsx("input",{className:"h-7 bg-white focus:outline-none px-4 py-2 border-none rounded-full",type:"text",placeholder:"Tìm kiếm",onFocus:H,onBlur:H})]})}),T.jsxs("div",{className:"text-black grid grid-cols-3 w-full my-2",children:[T.jsxs("div",{className:"col-span-2 w-full",children:[T.jsx("div",{children:T.jsx("h3",{children:"Chọn thành viên"})}),(V==null?void 0:V.length)>0&&(V==null?void 0:V.map((Pe,$e)=>{var Ce;return T.jsxs("div",{className:"flex gap-2 w-full mt-3",onClick:()=>ee(Pe),children:[T.jsx("input",{type:"radio",checked:L.includes(Pe),onChange:()=>ee(Pe),onClick:()=>ee(Pe)}),T.jsx(pi,{sx:{width:40,height:40},src:(Ce=Pe==null?void 0:Pe.profile)==null?void 0:Ce.thumbnailAvatar}),T.jsxs("div",{className:"ml-2",children:[" ",Pe==null?void 0:Pe.displayName," "]})]},$e)}))]}),L.length>0&&T.jsxs("div",{className:"col-span-1 p-2 border text-sm",children:[T.jsx("div",{children:T.jsx("h3",{children:"Đã chọn"})}),T.jsx("div",{className:"mt-3 rounded-full w-full",children:L.map((Pe,$e)=>{var Ce,Fe;return T.jsxs("div",{className:"justify-between flex mt-4 p-2 bg-blue-100",children:[T.jsxs("div",{className:"flex w-full",children:[T.jsx(pi,{sx:{width:20,height:20},src:(Ce=Pe==null?void 0:Pe.profile)==null?void 0:Ce.thumbnailAvatar}),T.jsxs("div",{className:"ml-1",children:[" ",(Fe=Pe==null?void 0:Pe.profile)==null?void 0:Fe.lastName," "]})]},$e),T.jsx(Dn,{icon:Ny,className:"cursor-pointer",onClick:()=>ee(Pe)})]})})})]})]}),T.jsxs("div",{className:"flex mt-3 justify-end gap-5",children:[T.jsx("button",{onClick:()=>o(),className:" p-2 rounded-md bg-gray-100",children:"Hủy"}),T.jsx("button",{onClick:()=>Ee(),className:`${L.length<=1?" bg-blue-300 ":"bg-blue-700"} p-2 rounded-md text-white`,disabled:L.length<=1,children:"Tạo nhóm"})]})]})})})})};function BH(){const[t,r]=K.useState(""),o=f=>{r(f.target.value)},[c,d]=K.useState(!1),h=()=>{d(!0)};return K.useState([]),T.jsxs("div",{className:"h-[68px] w-full flex-1 flex-col",children:[T.jsx("div",{className:"w-full flex-1 flex-col border-b px-4",children:T.jsxs("div",{className:"mb-1 flex items-center py-4",children:[T.jsx(Dn,{icon:Phe,size:"sm",className:"absolute pl-3",style:{color:"RGB(71, 85, 100)"}}),T.jsx("input",{type:"text",placeholder:"Tìm kiếm",value:t,onChange:o,className:"h-8 w-full rounded-md border bg-[#EAEDF0] p-2 pl-[30px] text-sm focus:outline-none"}),T.jsx(ske,{}),T.jsx(K.Fragment,{children:T.jsx("button",{onClick:()=>h(),className:"w-11 cursor-pointer hover:bg-gray-200 mr-1 justify-center items-center",children:T.jsx("img",{src:"/src/assets/group-user-plus.png",alt:"",className:"cursor-pointer items-center justify-center",style:{width:"100%",height:"100%"}})})}),c&&T.jsx(oke,{showCreateGroup:c,setShowCreateGroup:d})]})}),T.jsx("div",{className:"flex-1 pl-4 ",children:T.jsx(sM,{})})]})}function ake(){const[t,r]=K.useState(!1),[o,c]=K.useState(!1),[d,h]=K.useState(""),f=Wd(),{phoneP:_}=xR(),[v,b]=K.useState(Hn.get("token")?Hn.get("token"):""),A=()=>{f("/auth/login")},[w,x]=K.useState(!1),M=new NM,[V,G]=K.useState(_&&_!="null"?_:"");Os();const[H,F]=K.useState(""),[B,L]=K.useState(""),X=ki({mutationKey:["sendOtp"],mutationFn:()=>{M.sendOtp(V).then(Re=>{Re.data&&(console.log("data",Re.data),Re.data.token&&Hn.set("token",Re.data.token)),Re.status===200?St({title:"Thành công",text:"You have pressed the button!",icon:"success"}):St({title:"Error",text:"You have pressed the button!",icon:"error"})})},onSuccess:Re=>{console.log("data",Re)},onSettled:Re=>{console.log("done",Re)},onError:Re=>{console.error("err",Re),St({title:"Error",text:"You have pressed the button!",icon:"error"})}}),ee=ki({mutationKey:["changePass"],mutationFn:()=>{console.log(Hn.get("token")),console.log(H),M.changPass(v,H).then(Re=>{Re.data&&(console.log("data",Re.data),Re.data.token?Hn.set("token",Re.data.token):St({title:"Error",text:"You have pressed the button!",icon:"error"})),Re.status===200?(St({title:"Thành công",text:"You have pressed the button!",icon:"success"}),f("/auth/login")):St({title:"Error",text:"You have pressed the button!",icon:"error"})})},onSuccess:Re=>{console.log("data",Re)},onSettled:Re=>{console.log("done",Re)},onError:Re=>{console.error("err",Re),St({title:"Error",text:"You have pressed the button!",icon:"error"})}});K.useEffect(()=>{},[v]);const ce=ki({mutationKey:["verifyOtp"],mutationFn:()=>{M.verifyOtp(V,d).then(Re=>{Re.data&&(console.log("data",Re.data),Re.data.token&&Hn.set("token",Re.data.token)),Re.status===200?(St({title:"Thành công",text:"You have pressed the button!",icon:"success"}),r(!t),c(!o)):St({title:"Error",text:"You have pressed the button!",icon:"error"}),Re.error&&St({title:"Error",text:"You have pressed the button!",icon:"error"})})},onSuccess:Re=>{console.log("data",Re),Re.token&&Hn.set("token",Re.token)},onSettled:(Re,Pe)=>{console.log("done",Re),Pe&&St({title:"Error",text:"You have pressed the button!",icon:"error"})},onError:Re=>{console.error("err",Re),St({title:"Error",text:"You have pressed the button!",icon:"error"})}}),ie=()=>{X.mutate(),x(!w)},ne=()=>{x(!w)},fe=()=>{r(!t),c(!o)},oe=()=>{ce.mutate()},ue=()=>{ee.mutate()},[Ne,Ee]=K.useState(!0),we=()=>{Ee(!Ne)};return T.jsxs("div",{className:"w-full",children:[T.jsx("div",{className:"absolute inset-0",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1280 654",preserveAspectRatio:"xMinYMin slice",children:[T.jsx("rect",{x:"1",y:"1",width:"1280",height:"654",fill:"#e8f3ff"}),T.jsx("path",{fill:"#e8f3ff",d:"M1181.68 655C1163.95 469.296 1031.95 86.8402 963 1H1279V655H1181.68Z"}),T.jsx("path",{fill:"#e8f3ff",d:"M1.5 142.5C52.5 267 131.5 487 172 653H1.5V142.5Z"}),T.jsx("path",{fill:"#aad6ff",d:"M519.5 1.5H685H964.5C1046 135 1167 469 1180 655.5H767.5C704.5 505.5 604.5 304.5 464 148.5L519.5 1.5Z"}),T.jsx("path",{fill:"#d0e4fc",d:"M1 144V1.5H519.5C456 189 322.5 475.5 220 652.5H171.5C138.5 509 51.5 262.5 1 144Z"})]})}),T.jsxs("div",{className:"relative flex flex-col overflow-hidden",children:[T.jsxs("div",{className:"",children:[T.jsx("h1",{className:"text-center text-6xl text-blue-600 font-semibold p-3 mt-10",children:"Viet Chat"}),T.jsx("h2",{className:"text-center font-big",children:"Khôi phục mật khẩu viet chat"}),T.jsx("h2",{className:"text-center font-normal",children:"chat.vietchat.me"})]}),T.jsx("div",{className:"w-full pb-10 mx-auto my-5 bg-white shadow-md lg:max-w-[400px]",children:w?T.jsxs(T.Fragment,{children:[t?null:T.jsxs("div",{className:"pb-3 pt-1 mx-auto my-4 bg-sky-100 shadow-md lg:max-w-[320px]",children:[T.jsx("p",{className:"text-center my-1 text-sm",children:"Mã kích hoạt đã được gửi đến số điện thoại:"}),T.jsx("p",{className:"text-center text-2xl text-blue-600 font-semibold",children:V}),T.jsx("div",{className:"mx-auto my-5 bg-white shadow-md lg:max-w-[180px]",children:T.jsx("input",{type:"number",min:"0",max:"999999",maxLength:"6",onChange:Re=>h(Re.target.value),className:"text-center appearance-none bg-gray-50 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})}),T.jsx("div",{className:"flex justify-center",children:T.jsx("a",{href:"#",className:"text-center text-blue-500 underline",children:"Nhận lại mã kích hoạt"})}),T.jsx("div",{className:"flex justify-center mt-5",children:T.jsx("button",{type:"button",className:`text-white bg-gradient-to-r from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br focus:ring-4 focus:outline-none \r
                        focus:ring-blue-300 dark:focus:ring-blue-800 \r
                        font-medium rounded-lg text-sm py-2.5 text-center mx-1 px-20 mt-15 `,onClick:oe,children:"Tiếp tục"})}),T.jsx("div",{className:"mt-5 ",children:T.jsx("a",{className:`text-sm p-2 ml-4 from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br\r
                       hover:text-white\r
                        font-medium rounded-lg text-center mx-1`,href:"#",onClick:ne,children:"<< Quay lại"})})]}),o?T.jsxs("div",{children:[T.jsxs("div",{className:" pt-1 mx-auto bg-white lg:max-w-[300px]",children:[T.jsx("div",{className:"mb-2 mx-2 py-4 border-b-2 justify-center",children:T.jsx("h2",{className:"text-xl text-center font-semibold",children:"Mật khẩu mới"})}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{onChange:Re=>F(Re.target.value),type:Ne?"password":"text",className:"focus:outline-none focus:border-blue-500 focus:border-b-2 mx-3 px-3",placeholder:"Nhập mật khẩu mới"})]}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{onChange:Re=>L(Re.target.value),type:Ne?"password":"text",className:"focus:outline-none focus:border-blue-500 focus:border-b-2 mx-3 px-3",placeholder:"Nhập lại mật khẩu"})]}),T.jsx("div",{className:"mt-3",children:T.jsx("a",{className:"text-blue-700 text-sm",onClick:we,children:Ne?"Hiện mật khẩu":"Ẩn mật khẩu"})}),T.jsx("div",{className:"flex justify-center",children:T.jsx("button",{onClick:ue,type:"button",className:`text-white bg-gradient-to-r from-blue-500 \r
                              via-blue-600 to-blue-700 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 \r
                              font-medium rounded-lg text-sm py-2.5 text-center mx-1 px-20 mt-7`,children:"Xác nhận"})})]}),T.jsx("div",{className:"mt-5 ",children:T.jsx("a",{className:`text-sm p-2 ml-4 from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br\r
                       hover:text-white\r
                        font-medium rounded-lg text-center mx-1`,href:"#",onClick:fe,children:"<< Quay lại"})})]}):null]}):T.jsxs(T.Fragment,{children:[T.jsx("p",{className:"text-center my-1 text-sm mt-10",children:"Nhập số điện thoại nhận mã xác thực:"}),T.jsxs("div",{className:"mx-10 py-4 border-b-2",children:[T.jsx(Dn,{icon:Vw,className:"mx-3"}),T.jsxs("select",{id:"contryOption",className:"text-center mx-3",children:[T.jsx("option",{value:"",children:"+84"}),T.jsx("option",{value:"option1",children:"+1"}),T.jsx("option",{value:"option2",children:"+2"}),T.jsx("option",{value:"option3",children:"+3"})]}),T.jsx("input",{id:"input-phone",placeholder:"Số điện thoại",onChange:Re=>G(Re.target.value),value:V,className:"px-3"})]}),T.jsx("div",{className:"flex justify-center mt-3 px-20",children:T.jsx("button",{type:"button",className:`text-white bg-gradient-to-r from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br focus:ring-4 focus:outline-none \r
                        focus:ring-blue-300 dark:focus:ring-blue-800 \r
                        font-medium rounded-lg text-sm py-2.5 text-center mx-1 px-20 mt-15 `,onClick:ie,children:"Tiếp tục"})}),T.jsx("div",{className:"mt-5 ",children:T.jsx("a",{className:`text-sm p-2 ml-4 from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br\r
                       hover:text-white\r
                        font-medium rounded-lg text-center mx-1`,href:"#",onClick:A,children:"<< Quay lại"})})]})}),T.jsx("div",{className:"m-3",children:T.jsxs("p",{className:"text-center text-blue-600 text-xs m-12",children:[T.jsx("a",{className:"font-semibold",href:"#",children:"Tiếng Việt"})," ",T.jsx("span",{children:" "}),T.jsx("a",{className:"font-thin",href:"#",children:"English "})]})})]})]})}function cke(){K.useState(!1),K.useState(!1),K.useState("");const t=Wd(),{phoneP:r}=xR(),[o,c]=K.useState(Hn.get("token")?Hn.get("token"):""),d=()=>{t("/auth/login")},[h,f]=K.useState(!1),_=new NM,[v,b]=K.useState(r&&r!="null"?r:"");Os();const[A,w]=K.useState(""),[x,M]=K.useState(""),[V,G]=K.useState(""),H=ki({mutationKey:["changePass"],mutationFn:()=>{console.log(Hn.get("token")),console.log(A),_.change({passwordold:x,passwordnew:A,phone:v}).then(ce=>{ce.data&&(console.log("data",ce.data),ce.data.token?Hn.set("token",ce.data.token):St({title:"Error",text:"You have pressed the button!",icon:"error"})),ce.status===200?(St({title:"Thành công",text:"You have pressed the button!",icon:"success"}),t("/auth/login")):St({title:"Error",text:"You have pressed the button!",icon:"error"})})},onSuccess:ce=>{console.log("data",ce)},onSettled:ce=>{console.log("done",ce)},onError:ce=>{console.error("err",ce),St({title:"Error",text:"You have pressed the button!",icon:"error"})}});K.useEffect(()=>{},[o]);const F=()=>{f(!h)},B=()=>{H.mutate()},[L,X]=K.useState(!0),ee=()=>{X(!L)};return T.jsxs("div",{className:"w-full",children:[T.jsx("div",{className:"absolute inset-0",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1280 654",preserveAspectRatio:"xMinYMin slice",children:[T.jsx("rect",{x:"1",y:"1",width:"1280",height:"654",fill:"#e8f3ff"}),T.jsx("path",{fill:"#e8f3ff",d:"M1181.68 655C1163.95 469.296 1031.95 86.8402 963 1H1279V655H1181.68Z"}),T.jsx("path",{fill:"#e8f3ff",d:"M1.5 142.5C52.5 267 131.5 487 172 653H1.5V142.5Z"}),T.jsx("path",{fill:"#aad6ff",d:"M519.5 1.5H685H964.5C1046 135 1167 469 1180 655.5H767.5C704.5 505.5 604.5 304.5 464 148.5L519.5 1.5Z"}),T.jsx("path",{fill:"#d0e4fc",d:"M1 144V1.5H519.5C456 189 322.5 475.5 220 652.5H171.5C138.5 509 51.5 262.5 1 144Z"})]})}),T.jsxs("div",{className:"relative flex flex-col overflow-hidden",children:[T.jsxs("div",{className:"",children:[T.jsx("h1",{className:"text-center text-6xl text-blue-600 font-semibold p-3 mt-10",children:"Viet Chat"}),T.jsx("h2",{className:"text-center font-big",children:"Khôi phục mật khẩu viet chat"}),T.jsx("h2",{className:"text-center font-normal",children:"chat.vietchat.me"})]}),T.jsx("div",{className:"w-full pb-10 mx-auto my-5 bg-white shadow-md lg:max-w-[400px]",children:h?T.jsxs("div",{children:[T.jsxs("div",{className:" pt-1 mx-auto bg-white lg:max-w-[300px]",children:[T.jsx("div",{className:"mb-2 mx-2 py-4 border-b-2 justify-center",children:T.jsx("h2",{className:"text-xl text-center font-semibold",children:"Đổi mật khẩu"})}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{onChange:ce=>M(ce.target.value),type:L?"password":"text",className:"focus:outline-none focus:border-blue-500 focus:border-b-2 mx-3 px-3",placeholder:"Nhập mật khẩu hiện tại"})]}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{onChange:ce=>w(ce.target.value),type:L?"password":"text",className:"focus:outline-none focus:border-blue-500 focus:border-b-2 mx-3 px-3",placeholder:"Nhập mật khẩu mới"})]}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{onChange:ce=>G(ce.target.value),type:L?"password":"text",className:"focus:outline-none focus:border-blue-500 focus:border-b-2 mx-3 px-3",placeholder:"Nhập lại mật khẩu"})]}),T.jsx("div",{className:"mt-3",children:T.jsx("a",{className:"text-blue-700 text-sm",onClick:()=>ee(),children:L?"Hiện mật khẩu":"Ẩn mật khẩu"})}),T.jsx("div",{className:"flex justify-center",children:T.jsx("button",{onClick:()=>B(),type:"button",className:`text-white bg-gradient-to-r from-blue-500 \r
                              via-blue-600 to-blue-700 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 \r
                              font-medium rounded-lg text-sm py-2.5 text-center mx-1 px-20 mt-7`,children:"Xác nhận"})})]}),T.jsx("div",{className:"mt-5 ",children:T.jsx("a",{className:`text-sm p-2 ml-4 from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br\r
                       hover:text-white\r
                        font-medium rounded-lg text-center mx-1`,href:"#",onClick:()=>F(),children:"<< Quay lại"})})]}):T.jsxs(T.Fragment,{children:[T.jsx("p",{className:"text-center my-1 text-sm mt-10",children:"Nhập số điện thoại:"}),T.jsxs("div",{className:"mx-10 py-4 border-b-2",children:[T.jsx(Dn,{icon:Vw,className:"mx-3"}),T.jsxs("select",{id:"contryOption",className:"text-center mx-3",children:[T.jsx("option",{value:"",children:"+84"}),T.jsx("option",{value:"option1",children:"+1"}),T.jsx("option",{value:"option2",children:"+2"}),T.jsx("option",{value:"option3",children:"+3"})]}),T.jsx("input",{id:"input-phone",placeholder:"Số điện thoại",onChange:ce=>b(ce.target.value),value:v,className:"px-3"})]}),T.jsx("div",{className:"flex justify-center mt-3 px-20",children:T.jsx("button",{type:"button",className:`text-white bg-gradient-to-r from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br focus:ring-4 focus:outline-none \r
                        focus:ring-blue-300 dark:focus:ring-blue-800 \r
                        font-medium rounded-lg text-sm py-2.5 text-center mx-1 px-20 mt-15 `,onClick:()=>F(),children:"Tiếp tục"})}),T.jsx("div",{className:"mt-5 ",children:T.jsx("a",{className:`text-sm p-2 ml-4 from-blue-500 \r
                        via-blue-600 to-blue-700 hover:bg-gradient-to-br\r
                       hover:text-white\r
                        font-medium rounded-lg text-center mx-1`,href:"#",onClick:()=>d(),children:"<< Quay lại"})})]})}),T.jsx("div",{className:"m-3",children:T.jsxs("p",{className:"text-center text-blue-600 text-xs m-12",children:[T.jsx("a",{className:"font-semibold",href:"#",children:"Tiếng Việt"})," ",T.jsx("span",{children:" "}),T.jsx("a",{className:"font-thin",href:"#",children:"English "})]})})]})]})}function lke(t){const r=new Date(t),o=String(r.getDate()).padStart(2,"0"),c=String(r.getMonth()+1).padStart(2,"0"),d=r.getFullYear();return`${o}-${c}-${d}`}const dke=()=>{const[t,r]=K.useState(!0),[o,c]=K.useState(""),[d,h]=K.useState(""),[f,_]=K.useState(""),[v,b]=K.useState("");xR();const[A,w]=K.useState(""),[x,M]=K.useState(),{errors:V,handleBlur:G}=DK(),[H,F]=K.useState(""),B=()=>{r(!t)},L=()=>(G({field:"password",password:o}),G({field:"cppassword",cppassword:A,password:o}),G({field:"firstName",firstName:d}),G({field:"lastName",lastName:f}),G({field:"birthday",birthday:v}),G({field:"gender",gender:x}),V.password==="*"&&V.cppassword==="*"&&V.firstName==="*"&&V.lastName==="*"&&V.birthday==="*"&&V.gender==="*"),X=Wd();K.useEffect(()=>{const ne=Hn.get("token");console.log(Hn.get("token")),ne&&(F(ne),console.log(ne))},[V,H,Hn.get("token")]);let ee=new xK;const ce=ki({mutationKey:["register"],mutationFn:()=>{console.log(H);const ne={firstName:d,lastName:f,gender:!!(x==="true"&&x),birthday:lke(v),password:o};H&&ee.register(ne,H).then(fe=>{fe.data&&(console.log("data",fe.data),fe.data.token&&Hn.set("token",fe.data.token)),fe.status===200?(St({title:"Thành công",text:"You have pressed the button!",icon:"success"}),console.log("thanh cong"),X("/")):St({title:"Error",text:"You have pressed the button!",icon:"error"})})},onSuccess:ne=>{console.log("data",ne)},onSettled:(ne,fe)=>{ne&&console.log("done",ne),console.log("error",fe)},onError:ne=>{console.error("err",ne),St({title:"Error",text:"You have pressed the button!",icon:"error"})}}),ie=ne=>{ne.preventDefault(),console.log(V),L()?L()===!0?(ce.mutate(),console.log("ok")):St({title:"Hãy nhập đúng và đủ thông tin",icon:"error"}):St({title:"Hãy nhập đúng và đủ thông tin",icon:"error"})};return T.jsx("div",{children:T.jsxs("div",{className:"w-full",children:[T.jsx("div",{className:"absolute inset-0",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1280 654",preserveAspectRatio:"xMinYMin slice",children:[T.jsx("rect",{x:"1",y:"1",width:"1280",height:"654",fill:"#e8f3ff"}),T.jsx("path",{fill:"#e8f3ff",d:"M1181.68 655C1163.95 469.296 1031.95 86.8402 963 1H1279V655H1181.68Z"}),T.jsx("path",{fill:"#e8f3ff",d:"M1.5 142.5C52.5 267 131.5 487 172 653H1.5V142.5Z"}),T.jsx("path",{fill:"#aad6ff",d:"M519.5 1.5H685H964.5C1046 135 1167 469 1180 655.5H767.5C704.5 505.5 604.5 304.5 464 148.5L519.5 1.5Z"}),T.jsx("path",{fill:"#d0e4fc",d:"M1 144V1.5H519.5C456 189 322.5 475.5 220 652.5H171.5C138.5 509 51.5 262.5 1 144Z"})]})}),T.jsxs("div",{className:"relative flex flex-col overflow-hidden",children:[T.jsxs("div",{className:"",children:[T.jsx("h1",{className:"text-center text-6xl text-blue-600 font-semibold p-3 mt-10",children:"Viet Chat"}),T.jsx("h1",{className:"text-center font-semibold text-3xl mt-3",children:"ĐĂNG KÝ"})]}),T.jsx("div",{className:"w-full pb-6 mx-auto my-6 bg-white shadow-md lg:max-w-[400px]",children:T.jsx(T.Fragment,{children:T.jsxs("div",{className:"mt-2 px-6",children:[T.jsxs("div",{className:"mb-2 py-4 border-b-2 flex gap-2",children:[T.jsxs("div",{children:[T.jsx("label",{children:"Họ đệm"}),T.jsx("input",{type:"text",value:d,onBlur:()=>G({field:"firstName",firstName:d}),onChange:ne=>h(ne.target.value),placeholder:"Nhập họ đệm",className:"mt-3"}),T.jsx("p",{style:{color:"red"},children:V.firstName})]}),T.jsxs("div",{children:[T.jsx("label",{children:"Tên"}),T.jsx("input",{onBlur:()=>G({field:"lastName",lastName:f}),type:"text",value:f,onChange:ne=>_(ne.target.value),placeholder:"Nhập tên",className:"mt-3"}),T.jsx("p",{style:{color:"red"},children:V.lastName})]})]}),T.jsxs("div",{className:"mb-2 py-4 border-b-2  w-full",children:[T.jsxs("div",{className:"flex",children:[T.jsx("label",{htmlFor:"male",className:"mr-4",children:"Nam"}),T.jsx("input",{type:"radio",id:"male",name:"gender",value:"true",checked:x==="true",onChange:ne=>{M(ne.target.value),G({field:"gender",gender:"true"})},className:"mr-2"}),T.jsx("label",{className:"ml-2",htmlFor:"female",children:"Nữ"}),T.jsx("input",{type:"radio",id:"female",name:"gender",value:"false",checked:x==="false",onChange:ne=>{M(ne.target.value),G({field:"gender",gender:"false"})},className:"ml-2"})]}),T.jsx("p",{style:{color:"red"},children:V.gender})]}),T.jsxs("div",{className:"mb-2 py-4 border-b-2",children:[T.jsx("input",{value:v,type:"date",className:"w-full",onBlur:()=>G({field:"birthday",birthday:v}),onChange:ne=>b(ne.target.value)}),T.jsx("br",{}),T.jsx("p",{style:{color:"red"},children:V.birthday})]}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{type:t?"password":"text",value:o,onChange:ne=>c(ne.target.value),placeholder:"Mật khẩu",onBlur:()=>G({field:"password",password:o}),className:"mx-3 px-3"}),T.jsx("p",{style:{color:"red"},children:V.password})]}),T.jsxs("div",{className:"mb-2 mx-2 py-4 border-b-2",children:[T.jsx(Dn,{icon:vh,className:"mx-3"}),T.jsx("input",{type:t?"password":"text",value:A,onBlur:()=>G({field:"cppassword",cppassword:A,password:o}),onChange:ne=>w(ne.target.value),placeholder:"Xác nhận mật khẩu",className:"mx-3 px-3"}),T.jsx("p",{style:{color:"red"},children:V.cppassword})]}),T.jsx("div",{className:"mt-3",children:T.jsx("a",{className:"text-blue-700 text-sm cursor-pointer",onClick:B,children:t?"Hiện mật khẩu":"Ẩn mật khẩu"})}),T.jsx("div",{className:"mt-6",children:T.jsx("button",{onClick:ne=>ie(ne),className:"w-full py-2 tracking-wide text-white transition-colors duration-200 transform bg-tblue rounded-md",children:"Đăng ký"})}),T.jsx("div",{className:"mt-4"})]})})})]})]})})};function uke(){const[t,r]=K.useState(""),[o,c]=K.useState(""),[d,h]=K.useState({});qs({token:o,setToken:c,setProfile:h,setPhone:r});const[f,_]=K.useState(T.jsx(jH,{})),v=sf();return K.useEffect(()=>{v.pathname==="/app"?_(T.jsx(jH,{})):v.pathname==="/contact"&&_(T.jsx(ZX,{}))},[v.pathname]),rhe([{path:"/auth",element:T.jsx(qNe,{}),children:[{path:"login",element:T.jsx(Nge,{})},{path:"register/:phoneP",element:T.jsx(dke,{})},{path:"forgot-password/:phoneP",element:T.jsx(ake,{})},{path:"change-password/:phoneP",element:T.jsx(cke,{})},{path:"callVideo",element:T.jsx(iJ,{})}]},{path:"/",element:T.jsx(YNe,{component:f}),children:[{element:T.jsx(ghe,{to:QNe,replace:!0}),index:!0},{path:"/app",element:T.jsx(BH,{}),children:[{path:"",element:T.jsx(ANe,{})},{path:"other-message",element:T.jsx(ONe,{})}]},{path:"/contact",element:[T.jsx(BH,{}),T.jsx(aNe,{setComp:_})]},{path:"todo",element:T.jsx(cNe,{})}]}])}const hke=()=>T.jsx(uke,{});var pke=function(){return null};const fke=new zfe;ZP.createRoot(document.getElementById("root")).render(T.jsx(gt.StrictMode,{children:T.jsx(Che,{basename:"/",children:T.jsx(_we,{children:T.jsxs(Jfe,{client:fke,children:[T.jsx(hke,{}),T.jsx(pke,{initialIsOpen:!1})]})})})}));export{m1e as a,Tke as c,Cke as g};
